BEGIN_GUI_DESCR

	SHOW_PARAM STRING 	PROCESS_MESSAGE
	SHOW_PARAM STRING 	ITEM_NUM
	SHOW_PARAM STRING 	SUB_TYPE
	SHOW_PARAM INTEGER	OPENING_TYPE
	SHOW_PARAM STRING 	DOOR_ITEM_DESC
	SHOW_PARAM DOUBLE 	PUSH_PLATE_CENTER
	SHOW_PARAM DOUBLE 	PUSH_BAR_CENTER
	SHOW_PARAM DOUBLE 	PULL_PLATE_CENTER
	SHOW_PARAM DOUBLE 	FLUSH_PULL_CENTER
			
	IF SUB_TYPE == "P"
		CHECKBOX_PARAM INTEGER EQUAL_PUSH_PULLS
	END_IF
	
	CHECKBOX_PARAM INTEGER PUSH_PLATE "YES/NO"
	CHECKBOX_PARAM INTEGER PULL_PLATE "YES/NO"
	CHECKBOX_PARAM INTEGER PUSH_BAR "YES/NO"
	
	IF PUSH_BAR == 1
		CHECKBOX_PARAM INTEGER PRE_PUNCH_PULL_BAR "YES/NO"	
	END_IF
	
	CHECKBOX_PARAM INTEGER FLUSH_PULL "YES/NO"

	IF PUSH_PLATE == 1
		USER_INPUT_PARAM DOUBLE PUSH_PLATE_CENTER
	END_IF

	IF PULL_PLATE == 1
		USER_INPUT_PARAM DOUBLE PULL_PLATE_CENTER
		USER_INPUT_PARAM DOUBLE PULL_PLATE_HEIGHT
		USER_INPUT_PARAM DOUBLE PUSH_PULL_WIDTH
	END_IF
	
	IF PUSH_BAR == 1
		USER_INPUT_PARAM DOUBLE PUSH_BAR_CENTER
	END_IF
	
	IF PRE_PUNCH_PULL_BAR == 1
		USER_INPUT_PARAM DOUBLE PULL_BAR_HOLE_CENTERS REQUIRED
		USER_INPUT_PARAM DOUBLE PULL_BAR_BACKSET REQUIRED
		USER_INPUT_PARAM DOUBLE PULL_BAR_SCREW_SIZE REQUIRED
	END_IF

END_GUI_DESCR

BEGIN_ASM_DESCR

	DECLARE_VARIABLE INTEGER 	OPERATION
	DECLARE_VARIABLE STRING 	PROCESS_MESSAGE
	DECLARE_VARIABLE STRING 	ITEM_NUM
	DECLARE_VARIABLE STRING 	SUB_TYPE
	DECLARE_VARIABLE INTEGER 	OPENING_TYPE
	DECLARE_VARIABLE STRING 	DOOR_ITEM_DESC
	DECLARE_VARIABLE INTEGER 	EQUAL_PUSH_PULLS
	DECLARE_VARIABLE INTEGER 	FLUSH_PULL
	DECLARE_VARIABLE INTEGER 	FLUSH_PULL_UDF
	DECLARE_VARIABLE INTEGER 	FLUSH_PULL_INST
	DECLARE_VARIABLE DOUBLE	FLUSH_PULL_BACKSET
	DECLARE_VARIABLE DOUBLE	FLUSH_PULL_CENTER	
	DECLARE_VARIABLE INTEGER 	FLUSH_PULL_SIDE		
	DECLARE_VARIABLE INTEGER 	PULL_PLATE
	DECLARE_VARIABLE DOUBLE	PULL_PLATE_CENTER	
	DECLARE_VARIABLE DOUBLE	PULL_PLATE_HEIGHT	
	DECLARE_VARIABLE INTEGER 	PUSH_BAR
	DECLARE_VARIABLE DOUBLE	PUSH_BAR_CENTER		
	DECLARE_VARIABLE INTEGER 	PUSH_PLATE
	DECLARE_VARIABLE DOUBLE	PUSH_PLATE_CENTER	
	DECLARE_VARIABLE DOUBLE	PUSH_PULL_CENTER	
	DECLARE_VARIABLE DOUBLE	PUSH_PULL_HEIGHT		
	DECLARE_VARIABLE DOUBLE	PUSH_PULL_WIDTH
	DECLARE_VARIABLE INTEGER 	WELDED_PREPS
	DECLARE_VARIABLE DOUBLE 	PULL_BAR_HOLE_CENTERS
	DECLARE_VARIABLE DOUBLE 	PULL_BAR_BACKSET
	DECLARE_VARIABLE DOUBLE 	PULL_BAR_SCREW_SIZE
	DECLARE_VARIABLE INTEGER 	PRE_PUNCH_PULL_BAR
	DECLARE_VARIABLE DOUBLE 	BU_OFFSET	

	IF OPERATION == 0
		! PUSH_PLATE_CENTER = 45
		! PUSH_BAR_CENTER = 45
		! PULL_PLATE_CENTER = 45
		! PULL_PLATE_HEIGHT = 16
		IF PUSH_PULL_WIDTH == 0
			PUSH_PULL_WIDTH = 5
		END_IF
		
		CONFIG_ELEM

		IF PULL_PLATE == 1 AND PUSH_BAR == 0
			IF PULL_PLATE_HEIGHT <= 16
				PUSH_PULL_HEIGHT = 18
			ELSE
				PUSH_PULL_HEIGHT = PULL_PLATE_HEIGHT + 2
			END_IF
			PUSH_PULL_CENTER = PULL_PLATE_CENTER
		END_IF
		
		IF PULL_PLATE == 1 AND PUSH_BAR == 1
			IF PULL_PLATE_HEIGHT <= 16
				PUSH_PULL_HEIGHT = 18
			ELSE
				PUSH_PULL_HEIGHT = PULL_PLATE_HEIGHT + 2
			END_IF
			PUSH_PULL_CENTER = PULL_PLATE_CENTER
		END_IF

		IF FLUSH_PULL == 1 AND (OPENING_TYPE == 1 OR OPENING_TYPE == 3)
			CALL_EX flush_pull.tab
				VAR_IN		OPERATION				OPERATION
				VAR_IN		PROCESS_MESSAGE			PROCESS_MESSAGE
				VAR_IN		ITEM_NUM					ITEM_NUM
				VAR_IN		SUB_TYPE					SUB_TYPE
				VAR_IN		OPENING_TYPE				OPENING_TYPE
				VAR_IN		DOOR_ITEM_DESC			DOOR_ITEM_DESC
				VAR_IN		WELDED_PREPS			WELDED_PREPS
				VAR_INOUT	FLUSH_PULL_MANUFACTURER	FLUSH_PULL_MANUFACTURER
				VAR_INOUT	FLUSH_PULL_MODEL			FLUSH_PULL_MODEL
				VAR_INOUT	FLUSH_PULL_UDF			FLUSH_PULL_UDF
				VAR_INOUT	FLUSH_PULL_INST			FLUSH_PULL_INST				
				VAR_INOUT	FLUSH_PULL_BACKSET		FLUSH_PULL_BACKSET
				VAR_INOUT	FLUSH_PULL_CENTER			FLUSH_PULL_CENTER
				VAR_INOUT	FLUSH_PULL_SIDE			FLUSH_PULL_SIDE
			END_CALL_EX
		END_IF
		
		
	END_IF

	! !BEGIN PRIMARY PUSH PULL 4/9/2013
	IF OPERATION > 0
	
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			BU_OFFSET = .200
		ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
			BU_OFFSET = .600
		END_IF
		
		IF PRE_PUNCH_PULL_BAR == 1
		
			IF	HAND_ == "LHR" OR HAND_ == "LHRA1" OR HAND_ == "LHR1" OR HAND_ == "RH" OR HAND_ == "RHA2"
				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
				SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
			END_IF
	
			IF	HAND_ == "RHR" OR HAND_ == "RHRA2" OR HAND_ == "RHR2" OR HAND_ == "LH" OR HAND_ == "LHA1"
				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
				SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
			END_IF
			
			CREATE_UDF udf\pull_holes DOOR_ASM
				UDF_REF ATTACH1 ATTACH
				UDF_REF ATTACH2 ATTACH1
				UDF_DIM STRIKE_CTR PULL_PLATE_CENTER
				UDF_DIM OFFSET 0
				UDF_DIM BACKSET PULL_BAR_BACKSET
				UDF_DIM d1174 PULL_BAR_HOLE_CENTERS/2
				UDF_DIM d1177 -PULL_BAR_HOLE_CENTERS/2
				UDF_DIM d1200 PULL_BAR_SCREW_SIZE+.0625
				UDF_DIM d1205 PULL_BAR_SCREW_SIZE+.0625
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF PULL_PLATE == 1
			IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+(PUSH_PULL_WIDTH/2))	
				UDF_DIM	LOCY PUSH_PULL_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+(PUSH_PULL_WIDTH/2))
				UDF_DIM	LOCY PUSH_PULL_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			RETRIEVE_MDL REINFORCEMENT.ASM COMP							
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			
				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "EMJACDESC" "Push Pull Reinf"
				SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
				SET_MDL_PARAM COMP "LENGTH" PUSH_PULL_HEIGHT
				SET_MDL_PARAM COMP "WIDTH" PUSH_PULL_WIDTH
				
				SET_MDL_PARAM COMP "XX_ORIENT" "V"
				
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX	
						
			REGEN_MDL COMP FORCE	
		END_IF

		IF PULL_PLATE == 1 AND PUSH_BAR == 1
			IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+(PUSH_PULL_WIDTH/2))
				UDF_DIM	LOCY PUSH_BAR_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+(PUSH_PULL_WIDTH/2))
				UDF_DIM	LOCY PUSH_BAR_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			RETRIEVE_MDL REINFORCEMENT.ASM COMP							
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			
				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "EMJACDESC" "Push Bar Reinf"
				SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
				SET_MDL_PARAM COMP "LENGTH" 16
				SET_MDL_PARAM COMP "WIDTH" 5
				
				SET_MDL_PARAM COMP "XX_ORIENT" "V"
				
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX	
						
			REGEN_MDL COMP FORCE				
		END_IF		
		
		IF PULL_PLATE == 0 AND PUSH_BAR == 1
			! IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
				! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+(PUSH_PULL_WIDTH/2))
				UDF_DIM	LOCY PUSH_BAR_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH1 CSYS 0
				END_CREATE_UDF
			! END_IF

			! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+(PUSH_PULL_WIDTH/2))
				UDF_DIM	LOCY PUSH_BAR_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF
			! END_IF

			RETRIEVE_MDL REINFORCEMENT.ASM GENERIC
			INSERT_FAMINSTANCE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "THICKNESS" DOOR_THICKNESS - .175
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" 8
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" 4
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "XX_ORIENT" "V"
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "M49" "PB__"+itos(DOOR_INDEX)+"_"+ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "M50" "PB__"+itos(DOOR_INDEX)+"_"+ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F51" "N"
			SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACDESC" "Push Bar Reinf"
			! SET_FAMITEM_VALUE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACNUM" "PB_"+ITEM_NUM
			
			GET_REF_FAMINSTANCE GENERIC "PB_"+itos(DOOR_INDEX)+"_" + ITEM_NUM INST
			SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

			RETRIEVE_MDL REINFORCEMENT_CHANNEL.PRT GENERIC
			INSERT_FAMINSTANCE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "USED" 0
			SET_FAMITEM_VALUE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" 8
			SET_FAMITEM_VALUE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" 4
			SET_FAMITEM_VALUE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "d45" DOOR_THICKNESS - .235
			SET_FAMITEM_VALUE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F1033" "N"
			SET_FAMITEM_VALUE GENERIC "PB__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "COMMENTS" "SHEAR"
			
				ASSEMBLE INST DOOR_ASM
					CSYS ATTACH1 PLACEMENT
				END_ASSEMBLE

				ASSEMBLE INST DOOR_ASM
					CSYS ATTACH2 PLACEMENT
				END_ASSEMBLE
				REGEN_MDL INST												
		END_IF	
		
		IF FLUSH_PULL == 1
		
			CALL flush_pull.tab

			! DECLARE_VARIABLE STRING UDF
			! DECLARE_VARIABLE STRING UDF_INST

			! SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
				! IF	HAND_ == "LHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1"
					! SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH_
					! IF FLUSH_PULL_SIDE == 0
						! UDF_INST = "ro_94c_is"
					! ELSE_IF FLUSH_PULL_SIDE == 1
						! UDF_INST = "ro_94c_os"
					! END_IF
				! END_IF
				! IF	HAND_ == "RH" OR HAND_ == "RH2" OR HAND_ == "RHA2"
					! SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH_
					! IF FLUSH_PULL_SIDE == 0
						! UDF_INST = "ro_94c_os"
					! ELSE_IF FLUSH_PULL_SIDE == 1
						! UDF_INST = "ro_94c_is"
					! END_IF
				! END_IF
				! IF	HAND_ == "RHR" OR HAND_ == "RHR2" OR HAND_ == "RHRA2"
					! SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH_
					! IF FLUSH_PULL_SIDE == 0
						! UDF_INST = "ro_94c_is"
					! ELSE_IF FLUSH_PULL_SIDE == 1
						! UDF_INST = "ro_94c_os"
					! END_IF
				! END_IF
				! IF	HAND_ == "LH" OR HAND_== "LH1" OR HAND_ == "LHA1"
					! SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH_
					! IF FLUSH_PULL_SIDE == 0
						! UDF_INST = "ro_94c_os"
					! ELSE_IF FLUSH_PULL_SIDE == 1
						! UDF_INST = "ro_94c_is"
					! END_IF
				! END_IF

				! CREATE_UDF udf\ro_94c DOOR_ASM
				! UDF_INSTANCE UDF_INST
				! UDF_REF ATTACH1 ATTACH_
				! UDF_REF ATTACH2 ATTACH1
				! UDF_DIM	STRIKE_CTR FLUSH_PULL_CENTER
				! UDF_DIM	OFFSET 0
				! UDF_DIM	BACKSET FLUSH_PULL_BACKSET
				! UDF_INTERSECTION * PART_LEVEL
				! END_CREATE_UDF
		END_IF		
	END_IF

END_ASM_DESCR
