BEGIN_GUI_DESCR

	SHOW_PARAM	INTEGER		OPERATION
	SHOW_PARAM	STRING		ITEM_NUM
	SHOW_PARAM	STRING		SUB_TYPE
	SHOW_PARAM	INTEGER		OPENING_TYPE
	SHOW_PARAM	STRING		DOOR_ITEM_DESC
	SHOW_PARAM	STRING		FRAME_ITEM_DESC

	SHOW_PARAM	INTEGER		STRIKE
	SHOW_PARAM	DOUBLE		STRIKE_CENTER
	SHOW_PARAM	STRING		STRIKE_DESC
	SHOW_PARAM	DOUBLE		STRIKE_HEIGHT
	SHOW_PARAM	DOUBLE		STRIKE_LIP_HEIGHT
	SHOW_PARAM	DOUBLE		STRIKE_LIP_THICKNESS
	SHOW_PARAM	INTEGER		STRIKE_TYPE
	SHOW_PARAM	STRING		STRIKE_UDF
	SHOW_PARAM	DOUBLE		STRIKE_WIDTH

	USER_INPUT_PARAM DOUBLE STRIKE_CENTER

	IF STRIKE_TYPE == 3 OR STRIKE_TYPE == 4
		USER_INPUT_PARAM STRING STRIKE_MODEL REQUIRED
	END_IF
	
	IF STRIKE_TYPE == 3
		USER_INPUT_PARAM DOUBLE STRIKE_PLATE_THICKNESS REQUIRED
		USER_INPUT_PARAM DOUBLE ELEC_STRIKE_LIP_THICKNESS REQUIRED
	ELSE
		STRIKE_PLATE_THICKNESS = STRIKE_LIP_THICKNESS
	END_IF
	
	CHECKBOX_PARAM INTEGER VERIFY_STRIKE "Y/N"
	CHECKBOX_PARAM INTEGER STRIKE_ELECTRIFIED "Y/N"
	CHECKBOX_PARAM INTEGER ALT_STRIKE_CENTER_ "Y/N"

END_GUI_DESCR

BEGIN_TAB_DESCR
BEGIN_TABLE	STRIKES	"STRIKES"
TABLE_OPTION 	NO_FILTER DEPEND_ON_INPUT
SEL_STRING	STRIKE_TYPE	STRIKE_UDF	STRIKE_HEIGHT	STRIKE_WIDTH	STRIKE_LIP_HEIGHT	STRIKE_LIP_THICKNESS	STRIKE_DESC	S_TABLE	
STRING	INTEGER	STRING	DOUBLE	DOUBLE	DOUBLE	DOUBLE      	STRING	SUBTABLE	 
NONE	0	0	0	0	0	0	NONE	NO_VALUE
ASA 2-3/4	1	strike4	2.75	1.125	1.5	.105	2-3/4	NO_VALUE	
ASA 4-7/8	2	strike4	4.875	1.25	3.375	.105	4-7/8	NO_VALUE	
4-7/8 ELECTRIC	3	strike4	4.875	1.25	3.375	.125	ELECTRIC	NO_VALUE
RIM	4	0	0	0	0	0	RIM	NO_VALUE
CUSTOM	5	0	0	0	0	0	CUSTOM	NO_VALUE
DB 2-3/4	6	strike-d	2.75	1.125	0	0	DB 2-3/4	NO_VALUE	
DB 3-1/2	7	strike-d	3.5	1.125	0	0	DB 3-1/2	NO_VALUE	
DB 4-7/8	8	strike-d	4.875	1.25	0	0	DB 4-7/8	NO_VALUE
GENERIC	9	0	0	0	0	0	NONE	NO_VALUE
RIM_ELEC	10	0	0	0	0	0	NONE	RIM_ELEC
SVR_TOP	81	0	0	0	0	0	SVR-TOP	NO_VALUE
SVR_BOT	82	0	0	0	0	0	SVR-BOT	NO_VALUE
SVR_TOP_BOT	83	0	0	0	0	0	SVR-TOP & BOT	NO_VALUE
CVR_TOP	84	0	0	0	0	0	CVR-TOP	NO_VALUE
CVR_BOT	85	0	0	0	0	0	CVR-BOT	NO_VALUE
CVR_TOP_BOT	86	0	0	0	0	0	CVR-TOP & BOT	NO_VALUE
END_TABLE

! BEGIN_TABLE	EXIT_STRIKES	"EXIT STRIKES"
! TABLE_OPTION 	DEPEND_ON_INPUT NO_FILTER
! SEL_STRING	STRIKE_TYPE	STRIKE_UDF	STRIKE_HEIGHT	STRIKE_WIDTH	STRIKE_LIP_HEIGHT	STRIKE_LIP_THICKNESS	STRIKE_DESC	S_TABLE		
! STRING	INTEGER	STRING	DOUBLE	DOUBLE	DOUBLE	DOUBLE      	STRING	SUBTABLE
! SVR_TOP	81	NO_VALUE					SVR-TOP	NO_VALUE
! SVR_BOT	82	NO_VALUE					SVR-BOT	NO_VALUE
! SVR_TOP_BOT	83	NO_VALUE					SVR-TOP & BOT	NO_VALUE
! CVR_TOP	84	NO_VALUE					CVR-TOP	NO_VALUE
! CVR_BOT	85	NO_VALUE					CVR-BOT	NO_VALUE
! CVR_TOP_BOT	86	NO_VALUE					CVR-TOP & BOT	NO_VALUE
! !LOCK_BACKSET IS FROM THE STOP
! END_TABLE

BEGIN_TABLE	RIM_ELEC	"ELECTRIC RIM STRIKES"
TABLE_OPTION 	NO_FILTER DEPEND_ON_INPUT
SEL_STRING	STRIKE_UDF	STRIKE_REINF_MODEL	STRIKE_DESC	STRIKE_HEIGHT	STRIKE_WIDTH	STRIKE_LIP_HEIGHT	STRIKE_LIP_THICKNESS	STRIKE_BACKSET
STRING	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	DOUBLE	DOUBLE	
VON DUPRIN 6111	STRIKE_VD_6111	VD_6111	VD 6111	4.5	1.4375	2.1875	0.5	0.75	
END_TABLE


END_TAB_DESCR

BEGIN_ASM_DESCR

DECLARE_VARIABLE	INTEGER		OPERATION
DECLARE_VARIABLE	STRING		ITEM_NUM
DECLARE_VARIABLE	STRING		SUB_TYPE
DECLARE_VARIABLE	INTEGER		OPENING_TYPE
DECLARE_VARIABLE	STRING		DOOR_ITEM_DESC
DECLARE_VARIABLE	STRING		FRAME_ITEM_DESC
DECLARE_VARIABLE DOUBLE 		BU_OFFSET	

DECLARE_VARIABLE	INTEGER		STRIKE
DECLARE_VARIABLE	DOUBLE		STRIKE_CENTER
DECLARE_VARIABLE	STRING		STRIKE_DESC
DECLARE_VARIABLE	INTEGER		STRIKE_ELECTRIFIED
DECLARE_VARIABLE	DOUBLE		STRIKE_HEIGHT
DECLARE_VARIABLE	DOUBLE		STRIKE_LIP_HEIGHT
DECLARE_VARIABLE	DOUBLE		STRIKE_LIP_THICKNESS
DECLARE_VARIABLE	DOUBLE		ELEC_STRIKE_LIP_THICKNESS
DECLARE_VARIABLE	DOUBLE		STRIKE_PLATE_THICKNESS
DECLARE_VARIABLE	INTEGER		STRIKE_TYPE
DECLARE_VARIABLE	INTEGER		VERIFY_STRIKE
DECLARE_VARIABLE	STRING		STRIKE_UDF
DECLARE_VARIABLE	DOUBLE		STRIKE_WIDTH
DECLARE_VARIABLE	STRING		STRIKE_REINF_MODEL
DECLARE_VARIABLE	DOUBLE		STRIKE_BACKSET
DECLARE_VARIABLE	STRING		STRIKE_MODEL
DECLARE_VARIABLE	DOUBLE		ALT_STRIKE_CENTER
DECLARE_VARIABLE	INTEGER		ALT_STRIKE_CENTER_

IF OPERATION == 0
	IF STRIKE_TYPE == 3
		ELEC_STRIKE_LIP_THICKNESS = STRIKE_LIP_THICKNESS
		STRIKE_LIP_THICKNESS = .125
	END_IF
	
	IF ALT_STRIKE_CENTER_ == 1
		STRIKE_CENTER = ALT_STRIKE_CENTER
	END_IF
	
	! CONFIG_ELEM
	
	IF STRIKE_TYPE == 0
		STRIKE_DESC = ""
	END_IF
	
	IF STRIKE_TYPE == 3
		STRIKE_LIP_THICKNESS = ELEC_STRIKE_LIP_THICKNESS
	END_IF
	
END_IF

IF OPERATION == 1
	IF PRIMARY_STRIKE_TYPE == 2 OR PRIMARY_STRIKE_TYPE == 3
		IF HAND_ == "LHI1" OR HAND_ == "RHRI2"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
				
			CREATE_UDF udf\strike4	DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM D966 ARMOR_BEVEL
				UDF_DIM D968 0
				UDF_DIM D969 0
				UDF_DIM LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
				UDF_DIM STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
				UDF_DIM STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
				UDF_DIM LIP_DEPTH_X PRIMARY_STRIKE_LIP_THICKNESS
				UDF_DIM LIP_DEPTHX .03
				UDF_EXP_REF ATTACH CSYS 5
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF HAND_ == "RHI2" OR HAND_ == "LHRI1"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike4	DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM D966 -ARMOR_BEVEL
				UDF_DIM D968 0
				UDF_DIM D969 0
				UDF_DIM LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
				UDF_DIM STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
				UDF_DIM STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
				UDF_DIM LIP_DEPTH_X PRIMARY_STRIKE_LIP_THICKNESS
				UDF_DIM LIP_DEPTHX .03
				UDF_EXP_REF ATTACH CSYS 5
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL DOOR_STRIKE_TABS_4875.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE STRIKE DOOR_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			
		IF PRIMARY_STRIKE_TYPE == 3
			SET_REF_NAME ATTACH "ELEC2"
		END_IF	
	
	END_IF
	
	IF SUB_TYPE == "P" AND PRIMARY_STRIKE_TYPE == 4
	
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			BU_OFFSET = .200
		ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
			BU_OFFSET = .600
		END_IF
	
		IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
			HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

			SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
			CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -BU_OFFSET-2.5
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
			HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
			HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

			SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
			CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -BU_OFFSET-2.5
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL REINFORCEMENT.ASM COMP							
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE COMP DOOR_ASM
				 CSYS ATTACH PLACEMENT
			END_ASSEMBLE
		
			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" ""
			SET_MDL_PARAM COMP "EMJACDESC" "Rim Strike Reinf"
			SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
			SET_MDL_PARAM COMP "LENGTH" 16
			SET_MDL_PARAM COMP "WIDTH" 5
			
			SET_MDL_PARAM COMP "XX_ORIENT" "V"
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX	
					
		REGEN_MDL COMP FORCE
	END_IF
	
	IF PRIMARY_STRIKE_TYPE == 81 OR PRIMARY_STRIKE_TYPE == 82 OR PRIMARY_STRIKE_TYPE == 83		
		IF	HAND_ == "LHR1" OR HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHR"				
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
		END_IF

		IF	HAND_ == "RHR2" OR HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHR"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
		END_IF

		IF PRIMARY_STRIKE_TYPE == 81 OR PRIMARY_STRIKE_TYPE == 83
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -2.75
				UDF_DIM	LOCY JOH - 5
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL REINFORCEMENT.ASM COMP							
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				
				SET_REF_NAME ATTACH "SVR_NOTE_1"
				
				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "EMJACDESC" "SVR Reinf"
				SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
				SET_MDL_PARAM COMP "LENGTH" 8
				SET_MDL_PARAM COMP "WIDTH" 4
				
				SET_MDL_PARAM COMP "XX_ORIENT" "V"
				
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX	
						
			REGEN_MDL COMP FORCE			
		END_IF

		IF PRIMARY_STRIKE_TYPE == 82 OR PRIMARY_STRIKE_TYPE == 83
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -2.75
				UDF_DIM	LOCY UNDERCUT + 5.5
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL REINFORCEMENT.ASM COMP							
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_REF_NAME ATTACH "SVR_NOTE_2"
			
			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" ""
			SET_MDL_PARAM COMP "EMJACDESC" "SVR Reinf"
			SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
			SET_MDL_PARAM COMP "LENGTH" 8
			SET_MDL_PARAM COMP "WIDTH" 4
			
			SET_MDL_PARAM COMP "XX_ORIENT" "V"
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX	
					
			REGEN_MDL COMP FORCE
		END_IF
	END_IF
	
	IF PRIMARY_STRIKE_TYPE == 84 OR PRIMARY_STRIKE_TYPE == 85 OR PRIMARY_STRIKE_TYPE == 86
		IF	HAND_ == "LHR1" OR HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHR"				
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
		END_IF

		IF	HAND_ == "RHR2" OR HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHR"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
		END_IF
		
		IF PRIMARY_STRIKE_TYPE == 84 OR PRIMARY_STRIKE_TYPE == 86
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -2.75
				UDF_DIM	LOCY JOH - 2
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			SET_REF_NAME ATTACH "CVR_NOTE_1"
		END_IF
		IF PRIMARY_STRIKE_TYPE == 85 OR PRIMARY_STRIKE_TYPE == 86
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -2.75
				UDF_DIM	LOCY UNDERCUT + 2
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			SET_REF_NAME ATTACH "CVR_NOTE_2"
		END_IF
		
		! RETRIEVE_MDL REINFORCEMENT.ASM COMP							
		! SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			! ASSEMBLE COMP DOOR_ASM
				 ! CSYS ATTACH PLACEMENT
			! END_ASSEMBLE
			
			
			! SET_MDL_PARAM COMP "STOCKTYPE" 1
			! SET_MDL_PARAM COMP "EMJACNUM" ""
			! SET_MDL_PARAM COMP "EMJACDESC" "SVR Reinf"
			! SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
			! SET_MDL_PARAM COMP "LENGTH" 8
			! SET_MDL_PARAM COMP "WIDTH" 4
			
			! SET_MDL_PARAM COMP "XX_ORIENT" "V"
			
			! CALL_EX instantiate.tab
				! VAR_IN	COMP	COMP
			! END_CALL_EX	
					
		! REGEN_MDL COMP FORCE			
			
			! CREATE_UDF udf\csys DOOR_ASM
				! UDF_REF ATTACH ASM_CSYS
				! UDF_DIM	ROTX 0
				! UDF_DIM	ROTY 0
				! UDF_DIM	ROTZ 0
				! UDF_DIM	LOCX -2.75
				! UDF_DIM	LOCY UNDERCUT + 5.5
				! UDF_DIM	LOCZ 0
				! UDF_EXP_REF ATTACH CSYS 0
			! END_CREATE_UDF

		! RETRIEVE_MDL REINFORCEMENT.ASM COMP							
		! SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			! ASSEMBLE COMP DOOR_ASM
				 ! CSYS ATTACH PLACEMENT
			! END_ASSEMBLE

			! SET_REF_NAME ATTACH "SVR_NOTE_2"
			
			! SET_MDL_PARAM COMP "STOCKTYPE" 1
			! SET_MDL_PARAM COMP "EMJACNUM" ""
			! SET_MDL_PARAM COMP "EMJACDESC" "SVR Reinf"
			! SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
			! SET_MDL_PARAM COMP "LENGTH" 8
			! SET_MDL_PARAM COMP "WIDTH" 4
			
			! SET_MDL_PARAM COMP "XX_ORIENT" "V"
			
			! CALL_EX instantiate.tab
				! VAR_IN	COMP	COMP
			! END_CALL_EX	
					
		! REGEN_MDL COMP FORCE			
	END_IF
	
END_IF

END_ASM_DESCR
