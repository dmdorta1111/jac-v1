
BEGIN_ASM_DESCR

!BEGIN PROCESS DECLARATIONS
DECLARE_ARRAY 		EXCEL_FILES
DECLARE_ARRAY 		STATUS
DECLARE_ARRAY 		ARRAYITEMS

DECLARE_REFERENCE 	refDrawing
DECLARE_REFERENCE 	ASSEM
DECLARE_REFERENCE 	FRAME_ASM
DECLARE_REFERENCE 	DOOR_ASM
DECLARE_REFERENCE 	FBT
DECLARE_REFERENCE 	FBTC
DECLARE_REFERENCE 	FBTD
DECLARE_REFERENCE 	FBB
DECLARE_REFERENCE 	FBBC
DECLARE_REFERENCE 	FBBD

DECLARE_VARIABLE 	BOOL		ANCHOR_EOF FALSE
DECLARE_VARIABLE 	INTEGER		ANCHOR_ROW 0
DECLARE_VARIABLE 	STRING 		ASSEM_MDL_NAME
DECLARE_VARIABLE 	INTEGER		CHOICE
DECLARE_VARIABLE	STRING		CLOSER_DESC_
DECLARE_VARIABLE	STRING		CLOSER_SIDE_
DECLARE_VARIABLE	STRING		CLOSER_TYPE_
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER_MANUFACTURER_
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER_MODEL_NUMBER_
DECLARE_VARIABLE 	STRING 		CONFIG
DECLARE_VARIABLE	INTEGER		DENOMENATOR 32
DECLARE_VARIABLE 	DOUBLE 		DOOR_CTR
DECLARE_VARIABLE 	DOUBLE 		DOOR_HEIGHT
DECLARE_VARIABLE 	INTEGER 	DOOR_INDEX
DECLARE_VARIABLE	INTEGER		DOOR_NUMBER
DECLARE_VARIABLE 	DOUBLE 		DOOR_WIDTH
DECLARE_VARIABLE 	STRING 		DR_SCALE "1 = 1"
DECLARE_VARIABLE 	STRING 		DRAWING_NOTE
DECLARE_VARIABLE 	STRING 		DRW_NOTE_0
DECLARE_VARIABLE 	STRING 		DRW_NOTE_1
DECLARE_VARIABLE 	STRING 		DRW_NOTE_2
DECLARE_VARIABLE 	STRING 		DRW_NOTE_3
DECLARE_VARIABLE 	STRING 		DRW_NOTE_4
DECLARE_VARIABLE 	INTEGER		DW_RTRN_
DECLARE_VARIABLE 	BOOL 		EOF FALSE
DECLARE_VARIABLE 	INTEGER		EXCEL_COLUMN
DECLARE_VARIABLE 	STRING		EXCEL_DOCUMENT_NAME
DECLARE_VARIABLE 	INTEGER		EXISTING_DIRECTORY
DECLARE_VARIABLE 	INTEGER		EXISTING_EXCEL
DECLARE_VARIABLE 	DOUBLE		FR_THICKNESS
DECLARE_VARIABLE	STRING		FRACTION
DECLARE_VARIABLE 	INTEGER 	HAND_
DECLARE_VARIABLE 	STRING 		HANDI_
DECLARE_VARIABLE 	INTEGER		HINGE_INDEX 0
DECLARE_VARIABLE 	STRING 		HINGE_UDF
DECLARE_VARIABLE	STRING		HOLDER_STOP_MANUFACTURER_
DECLARE_VARIABLE	STRING		HOLDER_STOP_MODEL_
DECLARE_VARIABLE	STRING		HOLDER_STOP_TYPE_
DECLARE_VARIABLE 	INTEGER		LOCK_INDEX 0
DECLARE_VARIABLE 	STRING 		LOCKTAB
DECLARE_VARIABLE 	STRING 		MODELL
DECLARE_VARIABLE	INTEGER		NUMBER
DECLARE_VARIABLE 	INTEGER 	OPERATION
DECLARE_VARIABLE 	DOUBLE 		POS_X
DECLARE_VARIABLE 	DOUBLE 		POS_Y
DECLARE_VARIABLE	STRING		PROCESS_MESSAGE
DECLARE_VARIABLE 	STRING		PROJECT_DIRECTORY
DECLARE_VARIABLE 	DOUBLE 		SCALE 1/12
DECLARE_VARIABLE	INTEGER		SDI_LOCATION
DECLARE_VARIABLE 	DOUBLE		SECT_SCALE
DECLARE_VARIABLE 	DOUBLE		SM_THICK
DECLARE_VARIABLE	INTEGER		SPACELOC
DECLARE_VARIABLE	INTEGER		STRIKE_NUMBER
DECLARE_VARIABLE 	STRING 		SUB_TYPE1
DECLARE_VARIABLE 	STRING 		SUB_TYPE2
DECLARE_VARIABLE	DOUBLE		SURFACE_CLOSER_LENGTH_
DECLARE_VARIABLE	DOUBLE		SURFACE_CLOSER_WIDTH_
DECLARE_VARIABLE 	STRING 		TAB
DECLARE_VARIABLE 	DOUBLE 		TEMPD
DECLARE_VARIABLE 	DOUBLE		TEMPN
DECLARE_VARIABLE 	INTEGER		TEST_COL
DECLARE_VARIABLE 	STRING 		TEST_EOF FALSE
DECLARE_VARIABLE 	STRING		TEST_ITEM_NUM
DECLARE_VARIABLE 	INTEGER		TEST_ITEM_QTY
DECLARE_VARIABLE 	STRING 		TYPE
DECLARE_VARIABLE 	INTEGER		TYPE_
DECLARE_VARIABLE 	DOUBLE		VIEW_POS
DECLARE_VARIABLE 	STRING 		WO_NUM
DECLARE_VARIABLE 	INTEGER		WO_TYPE
DECLARE_VARIABLE 	INTEGER		XDW_RTRN_
DECLARE_VARIABLE	INTEGER		TEXT_LEN
DECLARE_VARIABLE	INTEGER		TEXT_INDEX
DECLARE_VARIABLE	INTEGER		HISTORY_INDEX
DECLARE_VARIABLE	STRING		VALUE1 ""
DECLARE_VARIABLE	STRING		VALUE2 ""
DECLARE_VARIABLE	STRING		VALUE3 ""
!END PROCESS DECLARATIONS

!BEGIN SPREADSHEET VARIABLES
DECLARE_VARIABLE	STRING		CUSTOMER_NAME
DECLARE_VARIABLE	STRING		JOB_NAME
DECLARE_VARIABLE	STRING		SO_NUM
DECLARE_VARIABLE	STRING		READY
DECLARE_VARIABLE	STRING		DONE
DECLARE_VARIABLE	STRING		ITEM_NUM
DECLARE_VARIABLE	STRING		SUB_JOB_NAME
DECLARE_VARIABLE	STRING		HAND
DECLARE_VARIABLE	INTEGER		QTY
DECLARE_VARIABLE	DOUBLE		JOW
DECLARE_VARIABLE	DOUBLE		JOH
DECLARE_VARIABLE	INTEGER		FIRE_RATING
DECLARE_VARIABLE	STRING		HARDWARE_SCHEDULE_ID
DECLARE_VARIABLE	STRING		MANUFACTURERS_LOCATIONS
DECLARE_VARIABLE	STRING		HINGE_TYPE
DECLARE_VARIABLE	INTEGER		HINGE_QTY
DECLARE_VARIABLE	DOUBLE		HINGE_HEIGHT
DECLARE_VARIABLE	DOUBLE		HINGE_THICKNESS
DECLARE_VARIABLE	STRING		HINGE_LOCATIONS
DECLARE_VARIABLE	DOUBLE		HINGE_SPACING
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_1
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_2
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_3
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_4
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_5
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_6
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_7
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_8
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_9
DECLARE_VARIABLE	DOUBLE		HINGE_LOCATION_10
DECLARE_VARIABLE	DOUBLE		MAXIMUM_HINGE_SPACING
DECLARE_VARIABLE	INTEGER		ELECTRIC_HINGE_POSITION
DECLARE_VARIABLE	DOUBLE		PRIMARY_STRIKE_CENTER
DECLARE_VARIABLE	STRING		PRIMARY_STRIKE_TYPE
DECLARE_VARIABLE	STRING		PRIMARY_STRIKE_UDF
DECLARE_VARIABLE	DOUBLE		PRIMARY_STRIKE_LIP_THICKNESS
DECLARE_VARIABLE	DOUBLE		SECONDARY_STRIKE_CENTER
DECLARE_VARIABLE	STRING		SECONDARY_STRIKE_TYPE
DECLARE_VARIABLE	STRING		SECONDARY_STRIKE_UDF
DECLARE_VARIABLE	DOUBLE		SECOMDARY_STRIKE_LIP_THICKNESS
DECLARE_VARIABLE	STRING		SURFACE_MOUNTED_CLOSER
DECLARE_VARIABLE	STRING		CLOSER_SIDE
DECLARE_VARIABLE	DOUBLE		SURFACE_CLOSER_LENGTH
DECLARE_VARIABLE	DOUBLE		SURFACE_CLOSER_WIDTH
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER_MANUFACTURER
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER_MODEL_NUMBER
DECLARE_VARIABLE	STRING		HOLD_OPEN_STOP_DEVICE
DECLARE_VARIABLE	STRING		HOLD_OPEN_STOP_MANUFACTURER
DECLARE_VARIABLE	STRING		HOLD_OPEN_STOP_MODEL_NUMBER
DECLARE_VARIABLE	DOUBLE		HOLD_OPEN_STOP_DEGREE
DECLARE_VARIABLE	STRING		MAGNETIC_LOCK
DECLARE_VARIABLE	INTEGER		FLUSH_BOLTS
DECLARE_VARIABLE	STRING		DOOR_GRADE
DECLARE_VARIABLE	STRING		SUB_TYPE
DECLARE_VARIABLE	STRING		DOOR_ITEM_DESC
DECLARE_VARIABLE	STRING		DOOR_ELEVATION
DECLARE_VARIABLE	INTEGER		DOOR_GAUGE
DECLARE_VARIABLE	STRING		BODY_SIDE_FINISH
DECLARE_VARIABLE	STRING		COVER_SIDE_FINISH
DECLARE_VARIABLE	STRING		DOOR_CONSTRUCTION
DECLARE_VARIABLE	STRING		HINGE_EDGE_SHAPE
DECLARE_VARIABLE	STRING		STRIKE_EDGE_SHAPE
DECLARE_VARIABLE	STRING		TOP_EDGE
DECLARE_VARIABLE	STRING		BOTTOM_EDGE
DECLARE_VARIABLE	DOUBLE		DOOR_THICKNESS
DECLARE_VARIABLE	DOUBLE		HINGE_GAP
DECLARE_VARIABLE	DOUBLE		STRIKE_GAP
DECLARE_VARIABLE	DOUBLE		TOP_GAP
DECLARE_VARIABLE	DOUBLE		UNDERCUT
DECLARE_VARIABLE	DOUBLE		ACTIVE_LEAF
DECLARE_VARIABLE	STRING		CORE
DECLARE_VARIABLE	DOUBLE		TOP_CHANNEL_DEPTH
DECLARE_VARIABLE	DOUBLE		BOTTOM_CHANNEL_DEPTH
DECLARE_VARIABLE	DOUBLE		CLOSURE_CHANNEL_CLEARANCE
DECLARE_VARIABLE	STRING		STEEL_STIFFENER_MATERIAL
DECLARE_VARIABLE	INTEGER		STEEL_STIFFENER_GAUGE
DECLARE_VARIABLE	STRING		STEEL_STIFFENER_INSULATION
DECLARE_VARIABLE	DOUBLE		STEEL_STIFFENER_WIDTH
DECLARE_VARIABLE	DOUBLE		MAXIMUM_STIFFENER_CTR
DECLARE_VARIABLE	DOUBLE		CORE_EDGE_SPACE
DECLARE_VARIABLE	DOUBLE		CORE_CLEARANCE
DECLARE_VARIABLE	STRING		ASTRAGAL
DECLARE_VARIABLE	STRING		DOOR_LITE_TRIM_TYPE
DECLARE_VARIABLE	STRING		VISION_SHAPE
DECLARE_VARIABLE	DOUBLE		VISION_DIAMETER
DECLARE_VARIABLE	DOUBLE		VISION_WIDTH
DECLARE_VARIABLE	DOUBLE		VISION_HEIGHT
DECLARE_VARIABLE	DOUBLE		VISION_TOP_RAIL
DECLARE_VARIABLE	DOUBLE		VISION_BOTTOM_RAIL
DECLARE_VARIABLE	DOUBLE		VISION_HINGE_STILE
DECLARE_VARIABLE	DOUBLE		VISION_STRIKE_STILE
DECLARE_VARIABLE	STRING		GLASS_INFORMATION
DECLARE_VARIABLE	DOUBLE		GLASS_THICKNESS
DECLARE_VARIABLE	STRING		GLASS_SUPPLIER
DECLARE_VARIABLE	STRING		GLASS_INSTALLER
DECLARE_VARIABLE	STRING		GLASS_TYPE
DECLARE_VARIABLE	STRING		DOOR_LOUVER_INFORMATION
DECLARE_VARIABLE	DOUBLE		LOUVER_WIDTH
DECLARE_VARIABLE	DOUBLE		LOUVER_HEIGHT
DECLARE_VARIABLE	DOUBLE		LOUVER_TOP_RAIL
DECLARE_VARIABLE	DOUBLE		LOUVER_BOTTOM_RAIL
DECLARE_VARIABLE	DOUBLE		LOUVER_HINGE_STILE
DECLARE_VARIABLE	DOUBLE		LOUVER_STRIKE_STILE
DECLARE_VARIABLE	STRING		LOUVER_SUPPLIER
DECLARE_VARIABLE	STRING		LOUVER_INSTALLER
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_TYPE
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_MANUFACTURER
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_SERIES_MODEL
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_FUNCTION
DECLARE_VARIABLE	DOUBLE		PRIMARY_LOCK_BACKSET
DECLARE_VARIABLE	DOUBLE		PRIMARY_LOCK_OFFSET
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_TRIM
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_UDF
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_INST
DECLARE_VARIABLE	DOUBLE		PRIMARY_LOCK_ARMOR_HEIGHT
DECLARE_VARIABLE	DOUBLE		PRIMARY_LOCK_ARMOR_WIDTH
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_TYPE
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_MANUFACTURER
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_SERIES_MODEL
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_FUNCTION
DECLARE_VARIABLE	DOUBLE		SECONDARY_LOCK_BACKSET
DECLARE_VARIABLE	DOUBLE		SECONDARY_LOCK_OFFSET
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_TRIM
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_UDF
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_INST
DECLARE_VARIABLE	STRING		FRAME_ITEM_DESC
DECLARE_VARIABLE	INTEGER		FRAME_ELEVATION
DECLARE_VARIABLE	INTEGER		FRAME_GAUGE
DECLARE_VARIABLE	STRING		FRAME_GRADE
DECLARE_VARIABLE	STRING		FRAME_FINISH
DECLARE_VARIABLE	STRING		FRAME_CONSTRUCTION
DECLARE_VARIABLE	DOUBLE		JD
DECLARE_VARIABLE	INTEGER		SECTION
DECLARE_VARIABLE	DOUBLE		FACEE
DECLARE_VARIABLE	DOUBLE		HEAD
DECLARE_VARIABLE	STRING		FLOOR_CLIPS
DECLARE_VARIABLE	STRING		ANCHOR_TYPE
DECLARE_VARIABLE	STRING		DUST_BOXES
DECLARE_VARIABLE	STRING		SILENCERS
DECLARE_VARIABLE	STRING		HOSPITAL_STOPS
DECLARE_VARIABLE	DOUBLE		STOPP
DECLARE_VARIABLE	DOUBLE		RABBET
DECLARE_VARIABLE	DOUBLE		XRABBET
DECLARE_VARIABLE	DOUBLE		RETURN
DECLARE_VARIABLE	DOUBLE		XRETURN
DECLARE_VARIABLE	STRING		DW_RTRN
DECLARE_VARIABLE	STRING		XDW_RTRN
DECLARE_VARIABLE	DOUBLE		MINIMUM_SOFFIT
DECLARE_VARIABLE	DOUBLE		HEAD_STOPP
DECLARE_VARIABLE	DOUBLE		XFACEE
DECLARE_VARIABLE	DOUBLE		XHEAD
DECLARE_VARIABLE	STRING		HEAD_GRAIN
DECLARE_VARIABLE	DOUBLE		THROAT
DECLARE_VARIABLE	DOUBLE		SOFFIT
DECLARE_VARIABLE	STRING		MAT_TYPE
DECLARE_VARIABLE	DOUBLE		JAMB_HINGE_SETBACK
DECLARE_VARIABLE	DOUBLE		DOOR_HINGE_SETBACK
DECLARE_VARIABLE	DOUBLE		DOOR_FACE_SETBACK
DECLARE_VARIABLE	DOUBLE		DOOR_GAP
DECLARE_VARIABLE	DOUBLE		TOP_HINGE
DECLARE_VARIABLE	DOUBLE		BOTTOM_HINGE
DECLARE_VARIABLE	DOUBLE		SECONDARY_LOCK_ARMOR_HEIGHT
DECLARE_VARIABLE	DOUBLE		SECONDARY_LOCK_ARMOR_WIDTH
! ! DECLARE_VARIABLE	STRING		PRIMARY_STRIKE_MODEL
DECLARE_VARIABLE	DOUBLE		PRIMARY_STRIKE_HEIGHT
DECLARE_VARIABLE	DOUBLE		PRIMARY_STRIKE_WIDTH
DECLARE_VARIABLE	DOUBLE		PRIMARY_STRIKE_LIP_HEIGHT
! ! DECLARE_VARIABLE	STRING		SECONDARY_STRIKE_MODEL
DECLARE_VARIABLE	DOUBLE		SECONDARY_STRIKE_HEIGHT
DECLARE_VARIABLE	DOUBLE		SECONDARY_STRIKE_WIDTH
DECLARE_VARIABLE	DOUBLE		SECONDARY_STRIKE_LIP_HEIGHT
DECLARE_VARIABLE	STRING		ANCHOR_BOLTS
DECLARE_VARIABLE	STRING 		ANCHOR_MDL
DECLARE_VARIABLE	DOUBLE 		ANCHOR_JB_DIST
DECLARE_VARIABLE	DOUBLE 		ANCHOR_JT_DIST
DECLARE_VARIABLE	DOUBLE 		ANCHOR_JMAX
DECLARE_VARIABLE	DOUBLE 		ANCHOR_HDJ_DIST
DECLARE_VARIABLE	DOUBLE 		ANCHOR_HMAX
DECLARE_VARIABLE	INTEGER 	ANCHOR_QTY
DECLARE_VARIABLE	DOUBLE 		ANCHOR_SPACING
DECLARE_VARIABLE	DOUBLE 		ANCHOR_CTR
DECLARE_VARIABLE	INTEGER 	ANCHOR_TYPE_
DECLARE_VARIABLE	STRING		CLOSER_TYPE
DECLARE_VARIABLE	STRING		ANCHOR_DESC
DECLARE_VARIABLE	STRING		DPS_MODEL
DECLARE_VARIABLE	DOUBLE		TRANSOM_HEIGHT
DECLARE_VARIABLE	DOUBLE		SILENCER_HOLE_DIA
DECLARE_VARIABLE	DOUBLE		FLUSH_BOLT_CENTER_TOP
DECLARE_VARIABLE	DOUBLE		FLUSH_BOLT_CENTER_BOTTOM
DECLARE_VARIABLE	INTEGER		SURFACE_VERTICLE_RODS
DECLARE_VARIABLE	INTEGER		CONCEALED_VERTICLE_RODS
DECLARE_VARIABLE	STRING		HOLDER_STOP_MANUFACTURER
DECLARE_VARIABLE	STRING		HOLDER_STOP_TYPE
DECLARE_VARIABLE	STRING		HOLDER_STOP_MODEL
DECLARE_VARIABLE	STRING		DPS_POSITION
DECLARE_VARIABLE	DOUBLE		DPS_LOCATION
DECLARE_VARIABLE	DOUBLE		DPS_HOLE_DIA
DECLARE_VARIABLE	INTEGER		ELECTRIC_HINGE_QTY
DECLARE_VARIABLE	DOUBLE		EXIT_CENTER
DECLARE_VARIABLE	STRING		EXIT_STRIKE_TYPE
DECLARE_VARIABLE	DOUBLE		EXIT_STRIKE_CENTER
DECLARE_VARIABLE	STRING		STD_REV
DECLARE_VARIABLE	DOUBLE		ANCHOR_RECESS
DECLARE_VARIABLE	DOUBLE		ABH_DIM_A
DECLARE_VARIABLE	DOUBLE		ABH_DIM_B
DECLARE_VARIABLE	DOUBLE		ABH_DIM_C
DECLARE_VARIABLE	DOUBLE		ABH_DIM_D
DECLARE_VARIABLE	DOUBLE		ABH_DIM_E
DECLARE_VARIABLE	STRING		HINGE_DESC
DECLARE_VARIABLE	STRING		PRIMARY_STRIKE_DESC
DECLARE_VARIABLE	STRING		SECONDARY_STRIKE_DESC
DECLARE_VARIABLE	STRING		PRIMARY_LOCK_DESC
DECLARE_VARIABLE	STRING		SECONDARY_LOCK_DESC
DECLARE_VARIABLE	STRING		VISION_CONSTRUCTION_A
DECLARE_VARIABLE	STRING		VISION_CONSTRUCTION_B
DECLARE_VARIABLE	STRING		DPS
DECLARE_VARIABLE	STRING		EPT
DECLARE_VARIABLE	INTEGER		DPS_
DECLARE_VARIABLE	INTEGER		EPT_
DECLARE_VARIABLE	INTEGER		MAG_LOCK_
DECLARE_VARIABLE	STRING		DWG
DECLARE_VARIABLE	DOUBLE		TRANSOM_HEAD
DECLARE_VARIABLE	INTEGER		TRANSOM_SECTION
DECLARE_VARIABLE	STRING		CLOSER_DESC
DECLARE_VARIABLE	DOUBLE		TRANSOM_STOPP
DECLARE_VARIABLE	DOUBLE		TRANSOM_ANCHOR_CENTER
DECLARE_VARIABLE	INTEGER		DOOR_QTY
DECLARE_VARIABLE	STRING		DOOR_ELEVATION_2
DECLARE_VARIABLE	STRING		EQUAL_CLOSERS
DECLARE_VARIABLE	STRING		CLOSER_TYPE_2
DECLARE_VARIABLE	STRING		CLOSER_SIDE_2
DECLARE_VARIABLE	STRING		CLOSER_DESC_2
DECLARE_VARIABLE	STRING		SURFACE_CLOSER_LENGTH_2
DECLARE_VARIABLE	STRING		SURFACE_CLOSER_WIDTH_2
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER_MANUFACTURER_2
DECLARE_VARIABLE	STRING		CONCEALED_CLOSER_MODEL_NUMBER_2
DECLARE_VARIABLE	STRING		HOLDER_STOP_MANUFACTURER_2
DECLARE_VARIABLE	STRING		HOLDER_STOP_TYPE_2
DECLARE_VARIABLE	STRING		HOLDER_STOP_MODEL_2
DECLARE_VARIABLE	DOUBLE		ASTRAGAL_WIDTH
! DECLARE_VARIABLE	INTEGER		REV_NUM
DECLARE_VARIABLE	STRING		DRW_NOTE
DECLARE_VARIABLE	DOUBLE		PUSH_PULL_CENTER
DECLARE_VARIABLE	STRING		PRIMARY_STRIKE_TYPE
DECLARE_VARIABLE	STRING		SECONDARY_STRIKE_TYPE
DECLARE_VARIABLE	DOUBLE		TRANSOM_PANEL_HEIGHT
DECLARE_VARIABLE	DOUBLE		MULLION
DECLARE_VARIABLE	DOUBLE		TRANSOM_PANEL_THICKNESS
DECLARE_VARIABLE	INTEGER		TRANSOM_PANEL_ATTACH_METHOD
DECLARE_VARIABLE	STRING		TRANSOM_PANEL_CORE_DESC
DECLARE_VARIABLE	STRING		TRANSOM_PANEL
DECLARE_VARIABLE	INTEGER		TRANSOM_PANEL_CORE
DECLARE_VARIABLE	INTEGER		TRANSOM_PANEL_GAUGE
DECLARE_VARIABLE	STRING		CONCEALED_COMPONENT_GRADE
DECLARE_VARIABLE	STRING		EXPOSED_COMPONENET_GRADE
DECLARE_VARIABLE	STRING		CONCEALED_COMPONENT_MATERIAL
DECLARE_VARIABLE	STRING		EXPOSED_COMPONENET_MATERIAL
DECLARE_VARIABLE	STRING		FRAME_WO
DECLARE_VARIABLE	STRING		DOOR_WO
DECLARE_VARIABLE	INTEGER		DOOR_LITE
DECLARE_VARIABLE	DOUBLE		ALT_STRIKE_CENTER
DECLARE_VARIABLE	DOUBLE		VISION_CTR_TOP
DECLARE_VARIABLE	DOUBLE		VISION_CTR_BOTTOM
DECLARE_VARIABLE	DOUBLE		PRIMARY_LOCK_ARMOR_THICKNESS
DECLARE_VARIABLE	DOUBLE		SECONDARY_LOCK_ARMOR_THICKNESS

DECLARE_VARIABLE	STRING		MASTER_TAG
DECLARE_VARIABLE	STRING		SUB_TAGS
DECLARE_VARIABLE	INTEGER		SHEET
DECLARE_VARIABLE	INTEGER		SHEET_QTY
DECLARE_VARIABLE	INTEGER		TOTAL_SHEETS

DECLARE_VARIABLE	STRING		DRAWING_HISTORY
DECLARE_VARIABLE	STRING		AS_BUILT

!END SPREADSHEET VARIABLES

USER_INPUT_PARAM STRING SO_NUM

SET_WORKING_DIRECTORY "C:\000_SDI"
PROJECT_DIRECTORY = "C:\000_SDI\\" + SO_NUM
READ_SUBDIRECTORIES . PROJECTS

EXISTING_DIRECTORY = -1

FOR PROJECT REF ARRAY PROJECTS
	EXISTING_DIRECTORY = strfind (PROJECT, SO_NUM)
	IF EXISTING_DIRECTORY <> -1
		SET_WORKING_DIRECTORY PROJECT_DIRECTORY
		BREAK
	END_IF
END_FOR

IF EXISTING_DIRECTORY == -1
	MESSAGE_BOX " SALES ORDER NUMBER DOES NOT EXIST"
	EXIT
END_IF

CLEAR_ARRAY EXCEL_FILES
EXCEL_DOCUMENT_NAME = SO_NUM
EXISTING_EXCEL = -1
READ_DIRECTORY PROJECT_DIRECTORY "*.xls" EXCEL_FILES
GET_ARRAY_SIZE EXCEL_FILES sizeTestArray

IF sizeTestArray > 0
	FOR EXCEL_DOCUMENT REF ARRAY EXCEL_FILES
		EXISTING_EXCEL = strfind (EXCEL_DOCUMENT, EXCEL_DOCUMENT_NAME)
		IF EXISTING_EXCEL <> -1
			EXCEL_CONNECT
			EXCEL_LOAD_DOCUMENT EXCEL_DOCUMENT
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
			EXCEL_GET_VALUE CELL_BY_NAME "B1" CUSTOMER_NAME
			EXCEL_GET_VALUE CELL_BY_NAME "B2" JOB_NAME
			EXCEL_GET_VALUE CELL_BY_NAME "B3" SO_NUM
			BREAK
		END_IF
	END_FOR
END_IF

IF EXISTING_EXCEL == -1
	MESSAGE_BOX "EXCEL FILE DOES NOT EXIST"
	EXIT
END_IF

ADD_SEARCH_PATH "C:\00WF4\MODELS\SDIParts"
EXCEL_COLUMN = 1

EXCEL_GET_VALUE 0	EXCEL_COLUMN	TEST_EOF
IF TEST_EOF == ""
	EOF = TRUE
ELSE
	EOF = FALSE
END_IF


WHILE EOF == FALSE
	EXCEL_GET_VALUE 0	EXCEL_COLUMN	CUSTOMER_NAME
	EXCEL_GET_VALUE 1	EXCEL_COLUMN	JOB_NAME
	EXCEL_GET_VALUE 2	EXCEL_COLUMN	SO_NUM
	EXCEL_GET_VALUE 3	EXCEL_COLUMN	READY
	EXCEL_GET_VALUE 4	EXCEL_COLUMN	DONE
	EXCEL_GET_VALUE 5	EXCEL_COLUMN	ITEM_NUM
	EXCEL_GET_VALUE 6	EXCEL_COLUMN	SUB_JOB_NAME
	EXCEL_GET_VALUE 7	EXCEL_COLUMN	HAND
	EXCEL_GET_VALUE 8	EXCEL_COLUMN	QTY
	EXCEL_GET_VALUE 9	EXCEL_COLUMN	JOW
	EXCEL_GET_VALUE 10	EXCEL_COLUMN	JOH
	EXCEL_GET_VALUE 11	EXCEL_COLUMN	FIRE_RATING
	EXCEL_GET_VALUE 12	EXCEL_COLUMN	HARDWARE_SCHEDULE_ID
	EXCEL_GET_VALUE 13	EXCEL_COLUMN	MANUFACTURERS_LOCATIONS
	EXCEL_GET_VALUE 14	EXCEL_COLUMN	HINGE_TYPE
	EXCEL_GET_VALUE 15	EXCEL_COLUMN	HINGE_QTY
	EXCEL_GET_VALUE 16	EXCEL_COLUMN	HINGE_HEIGHT
	EXCEL_GET_VALUE 17	EXCEL_COLUMN	HINGE_THICKNESS
	EXCEL_GET_VALUE 18	EXCEL_COLUMN	HINGE_LOCATIONS
	EXCEL_GET_VALUE 19	EXCEL_COLUMN	HINGE_SPACING
	EXCEL_GET_VALUE 20	EXCEL_COLUMN	HINGE_LOCATION_1
	EXCEL_GET_VALUE 21	EXCEL_COLUMN	HINGE_LOCATION_2
	EXCEL_GET_VALUE 22	EXCEL_COLUMN	HINGE_LOCATION_3
	EXCEL_GET_VALUE 23	EXCEL_COLUMN	HINGE_LOCATION_4
	EXCEL_GET_VALUE 24	EXCEL_COLUMN	HINGE_LOCATION_5
	EXCEL_GET_VALUE 25	EXCEL_COLUMN	HINGE_LOCATION_6
	EXCEL_GET_VALUE 26	EXCEL_COLUMN	HINGE_LOCATION_7
	EXCEL_GET_VALUE 27	EXCEL_COLUMN	HINGE_LOCATION_8
	EXCEL_GET_VALUE 28	EXCEL_COLUMN	HINGE_LOCATION_9
	EXCEL_GET_VALUE 29	EXCEL_COLUMN	HINGE_LOCATION_10
	EXCEL_GET_VALUE 30	EXCEL_COLUMN	MAXIMUM_HINGE_SPACING
	EXCEL_GET_VALUE 31	EXCEL_COLUMN	ELECTRIC_HINGE_POSITION
	EXCEL_GET_VALUE 32	EXCEL_COLUMN	PRIMARY_STRIKE_CENTER
	EXCEL_GET_VALUE 33	EXCEL_COLUMN	PRIMARY_STRIKE_TYPE
	EXCEL_GET_VALUE 34	EXCEL_COLUMN	PRIMARY_STRIKE_UDF
	EXCEL_GET_VALUE 35	EXCEL_COLUMN	PRIMARY_STRIKE_LIP_THICKNESS
	EXCEL_GET_VALUE 36	EXCEL_COLUMN	SECONDARY_STRIKE_CENTER
	EXCEL_GET_VALUE 37	EXCEL_COLUMN	SECONDARY_STRIKE_TYPE
	EXCEL_GET_VALUE 38	EXCEL_COLUMN	SECONDARY_STRIKE_UDF
	EXCEL_GET_VALUE 39	EXCEL_COLUMN	SECOMDARY_STRIKE_LIP_THICKNESS
	! EXCEL_GET_VALUE 40	EXCEL_COLUMN	SURFACE_MOUNTED_CLOSER
	EXCEL_GET_VALUE 41	EXCEL_COLUMN	CLOSER_SIDE
	EXCEL_GET_VALUE 42	EXCEL_COLUMN	SURFACE_CLOSER_LENGTH
	EXCEL_GET_VALUE 43	EXCEL_COLUMN	SURFACE_CLOSER_WIDTH
	! EXCEL_GET_VALUE 44	EXCEL_COLUMN	CONCEALED_CLOSER
	! EXCEL_GET_VALUE 45	EXCEL_COLUMN	CONCEALED_CLOSER_MANUFACTURER
	EXCEL_GET_VALUE 46	EXCEL_COLUMN	CONCEALED_CLOSER_MODEL_NUMBER
	! EXCEL_GET_VALUE 47	EXCEL_COLUMN	HOLD_OPEN_STOP_DEVICE
	! EXCEL_GET_VALUE 48	EXCEL_COLUMN	HOLD_OPEN_STOP_MANUFACTURER
	! EXCEL_GET_VALUE 49	EXCEL_COLUMN	HOLD_OPEN_STOP_MODEL_NUMBER
	! EXCEL_GET_VALUE 50	EXCEL_COLUMN	HOLD_OPEN_STOP_DEGREE
	EXCEL_GET_VALUE 51	EXCEL_COLUMN	MAGNETIC_LOCK
	EXCEL_GET_VALUE 52	EXCEL_COLUMN	FLUSH_BOLTS
	EXCEL_GET_VALUE 53	EXCEL_COLUMN	DOOR_GRADE
	EXCEL_GET_VALUE 54	EXCEL_COLUMN	SUB_TYPE
	EXCEL_GET_VALUE 55	EXCEL_COLUMN	DOOR_ITEM_DESC
	EXCEL_GET_VALUE 56	EXCEL_COLUMN	DOOR_ELEVATION
	EXCEL_GET_VALUE 57	EXCEL_COLUMN	DOOR_GAUGE
	EXCEL_GET_VALUE 58	EXCEL_COLUMN	BODY_SIDE_FINISH
	EXCEL_GET_VALUE 59	EXCEL_COLUMN	COVER_SIDE_FINISH
	EXCEL_GET_VALUE 60	EXCEL_COLUMN	DOOR_CONSTRUCTION
	EXCEL_GET_VALUE 61	EXCEL_COLUMN	HINGE_EDGE_SHAPE
	EXCEL_GET_VALUE 62	EXCEL_COLUMN	STRIKE_EDGE_SHAPE
	EXCEL_GET_VALUE 63	EXCEL_COLUMN	TOP_EDGE
	EXCEL_GET_VALUE 64	EXCEL_COLUMN	BOTTOM_EDGE
	EXCEL_GET_VALUE 65	EXCEL_COLUMN	DOOR_THICKNESS
	EXCEL_GET_VALUE 66	EXCEL_COLUMN	HINGE_GAP
	EXCEL_GET_VALUE 67	EXCEL_COLUMN	STRIKE_GAP
	EXCEL_GET_VALUE 68	EXCEL_COLUMN	TOP_GAP
	EXCEL_GET_VALUE 69	EXCEL_COLUMN	UNDERCUT
	EXCEL_GET_VALUE 70	EXCEL_COLUMN	ACTIVE_LEAF
	EXCEL_GET_VALUE 71	EXCEL_COLUMN	CORE
	EXCEL_GET_VALUE 72	EXCEL_COLUMN	TOP_CHANNEL_DEPTH
	EXCEL_GET_VALUE 73	EXCEL_COLUMN	BOTTOM_CHANNEL_DEPTH
	EXCEL_GET_VALUE 74	EXCEL_COLUMN	CLOSURE_CHANNEL_CLEARANCE
	EXCEL_GET_VALUE 75	EXCEL_COLUMN	STEEL_STIFFENER_MATERIAL
	EXCEL_GET_VALUE 76	EXCEL_COLUMN	STEEL_STIFFENER_GAUGE
	EXCEL_GET_VALUE 77	EXCEL_COLUMN	STEEL_STIFFENER_INSULATION
	EXCEL_GET_VALUE 78	EXCEL_COLUMN	STEEL_STIFFENER_WIDTH
	EXCEL_GET_VALUE 79	EXCEL_COLUMN	MAXIMUM_STIFFENER_CTR
	EXCEL_GET_VALUE 80	EXCEL_COLUMN	CORE_EDGE_SPACE
	EXCEL_GET_VALUE 81	EXCEL_COLUMN	CORE_CLEARANCE
	EXCEL_GET_VALUE 82	EXCEL_COLUMN	ASTRAGAL
	EXCEL_GET_VALUE 83	EXCEL_COLUMN	DOOR_LITE_TRIM_TYPE
	EXCEL_GET_VALUE 84	EXCEL_COLUMN	VISION_SHAPE
	EXCEL_GET_VALUE 85	EXCEL_COLUMN	VISION_DIAMETER
	EXCEL_GET_VALUE 86	EXCEL_COLUMN	VISION_WIDTH
	EXCEL_GET_VALUE 87	EXCEL_COLUMN	VISION_HEIGHT
	EXCEL_GET_VALUE 88	EXCEL_COLUMN	VISION_TOP_RAIL
	EXCEL_GET_VALUE 89	EXCEL_COLUMN	VISION_BOTTOM_RAIL
	EXCEL_GET_VALUE 90	EXCEL_COLUMN	VISION_HINGE_STILE
	EXCEL_GET_VALUE 91	EXCEL_COLUMN	VISION_STRIKE_STILE
	EXCEL_GET_VALUE 92	EXCEL_COLUMN	GLASS_INFORMATION
	EXCEL_GET_VALUE 93	EXCEL_COLUMN	GLASS_THICKNESS
	EXCEL_GET_VALUE 94	EXCEL_COLUMN	GLASS_SUPPLIER
	EXCEL_GET_VALUE 95	EXCEL_COLUMN	GLASS_INSTALLER
	EXCEL_GET_VALUE 96	EXCEL_COLUMN	GLASS_TYPE
	EXCEL_GET_VALUE 97	EXCEL_COLUMN	DOOR_LOUVER_INFORMATION
	EXCEL_GET_VALUE 98	EXCEL_COLUMN	LOUVER_WIDTH
	EXCEL_GET_VALUE 99	EXCEL_COLUMN	LOUVER_HEIGHT
	EXCEL_GET_VALUE 100	EXCEL_COLUMN	LOUVER_TOP_RAIL
	EXCEL_GET_VALUE 101	EXCEL_COLUMN	LOUVER_BOTTOM_RAIL
	EXCEL_GET_VALUE 102	EXCEL_COLUMN	LOUVER_HINGE_STILE
	EXCEL_GET_VALUE 103	EXCEL_COLUMN	LOUVER_STRIKE_STILE
	EXCEL_GET_VALUE 104	EXCEL_COLUMN	LOUVER_SUPPLIER
	EXCEL_GET_VALUE 105	EXCEL_COLUMN	LOUVER_INSTALLER
	EXCEL_GET_VALUE 106	EXCEL_COLUMN	PRIMARY_LOCK_TYPE
	EXCEL_GET_VALUE 107	EXCEL_COLUMN	PRIMARY_LOCK_MANUFACTURER
	EXCEL_GET_VALUE 108	EXCEL_COLUMN	PRIMARY_LOCK_SERIES_MODEL
	EXCEL_GET_VALUE 109	EXCEL_COLUMN	PRIMARY_LOCK_FUNCTION
	EXCEL_GET_VALUE 110	EXCEL_COLUMN	PRIMARY_LOCK_BACKSET
	EXCEL_GET_VALUE 111	EXCEL_COLUMN	PRIMARY_LOCK_OFFSET
	EXCEL_GET_VALUE 112	EXCEL_COLUMN	PRIMARY_LOCK_TRIM
	EXCEL_GET_VALUE 113	EXCEL_COLUMN	PRIMARY_LOCK_UDF
	EXCEL_GET_VALUE 114	EXCEL_COLUMN	PRIMARY_LOCK_INST
	EXCEL_GET_VALUE 115	EXCEL_COLUMN	PRIMARY_LOCK_ARMOR_HEIGHT
	EXCEL_GET_VALUE 116	EXCEL_COLUMN	PRIMARY_LOCK_ARMOR_WIDTH
	EXCEL_GET_VALUE 117	EXCEL_COLUMN	SECONDARY_LOCK_TYPE
	EXCEL_GET_VALUE 118	EXCEL_COLUMN	SECONDARY_LOCK_MANUFACTURER
	EXCEL_GET_VALUE 119	EXCEL_COLUMN	SECONDARY_LOCK_SERIES_MODEL
	EXCEL_GET_VALUE 120	EXCEL_COLUMN	SECONDARY_LOCK_FUNCTION
	EXCEL_GET_VALUE 121	EXCEL_COLUMN	SECONDARY_LOCK_BACKSET
	EXCEL_GET_VALUE 122	EXCEL_COLUMN	SECONDARY_LOCK_OFFSET
	EXCEL_GET_VALUE 123	EXCEL_COLUMN	SECONDARY_LOCK_TRIM
	EXCEL_GET_VALUE 124	EXCEL_COLUMN	SECONDARY_LOCK_UDF
	EXCEL_GET_VALUE 125	EXCEL_COLUMN	SECONDARY_LOCK_INST
	EXCEL_GET_VALUE 126	EXCEL_COLUMN	FRAME_ITEM_DESC
	EXCEL_GET_VALUE 127	EXCEL_COLUMN	FRAME_ELEVATION
	EXCEL_GET_VALUE 128	EXCEL_COLUMN	FRAME_GAUGE
	EXCEL_GET_VALUE 129	EXCEL_COLUMN	FRAME_GRADE
	EXCEL_GET_VALUE 130	EXCEL_COLUMN	FRAME_FINISH
	EXCEL_GET_VALUE 131	EXCEL_COLUMN	FRAME_CONSTRUCTION
	EXCEL_GET_VALUE 132	EXCEL_COLUMN	JD
	EXCEL_GET_VALUE 133	EXCEL_COLUMN	SECTION
	EXCEL_GET_VALUE 134	EXCEL_COLUMN	FACEE
	EXCEL_GET_VALUE 135	EXCEL_COLUMN	HEAD
	EXCEL_GET_VALUE 136	EXCEL_COLUMN	FLOOR_CLIPS
	EXCEL_GET_VALUE 137	EXCEL_COLUMN	ANCHOR_TYPE
	EXCEL_GET_VALUE 138	EXCEL_COLUMN	DUST_BOXES
	EXCEL_GET_VALUE 139	EXCEL_COLUMN	SILENCERS
	EXCEL_GET_VALUE 140	EXCEL_COLUMN	HOSPITAL_STOPS
	EXCEL_GET_VALUE 141	EXCEL_COLUMN	STOPP
	EXCEL_GET_VALUE 142	EXCEL_COLUMN	RABBET
	EXCEL_GET_VALUE 143	EXCEL_COLUMN	XRABBET
	EXCEL_GET_VALUE 144	EXCEL_COLUMN	RETURN
	EXCEL_GET_VALUE 145	EXCEL_COLUMN	XRETURN
	EXCEL_GET_VALUE 146	EXCEL_COLUMN	DW_RTRN
	EXCEL_GET_VALUE 147	EXCEL_COLUMN	XDW_RTRN
	EXCEL_GET_VALUE 148	EXCEL_COLUMN	MINIMUM_SOFFIT
	EXCEL_GET_VALUE 149	EXCEL_COLUMN	HEAD_STOPP
	EXCEL_GET_VALUE 150	EXCEL_COLUMN	XFACEE
	EXCEL_GET_VALUE 151	EXCEL_COLUMN	XHEAD
	EXCEL_GET_VALUE 152	EXCEL_COLUMN	HEAD_GRAIN
	EXCEL_GET_VALUE 153	EXCEL_COLUMN	THROAT
	EXCEL_GET_VALUE 154	EXCEL_COLUMN	SOFFIT
	EXCEL_GET_VALUE 155	EXCEL_COLUMN	MAT_TYPE
	EXCEL_GET_VALUE 156	EXCEL_COLUMN	JAMB_HINGE_SETBACK
	EXCEL_GET_VALUE 157	EXCEL_COLUMN	DOOR_HINGE_SETBACK
	EXCEL_GET_VALUE 158	EXCEL_COLUMN	DOOR_FACE_SETBACK
	EXCEL_GET_VALUE 159	EXCEL_COLUMN	DOOR_GAP
	EXCEL_GET_VALUE 160	EXCEL_COLUMN	TOP_HINGE
	EXCEL_GET_VALUE 161	EXCEL_COLUMN	BOTTOM_HINGE
	EXCEL_GET_VALUE 162	EXCEL_COLUMN	SECONDARY_LOCK_ARMOR_HEIGHT
	EXCEL_GET_VALUE 163	EXCEL_COLUMN	SECONDARY_LOCK_ARMOR_WIDTH
	! ! EXCEL_GET_VALUE 164	EXCEL_COLUMN	PRIMARY_STRIKE_MODEL
	EXCEL_GET_VALUE 165	EXCEL_COLUMN	PRIMARY_STRIKE_HEIGHT
	EXCEL_GET_VALUE 166	EXCEL_COLUMN	PRIMARY_STRIKE_WIDTH
	EXCEL_GET_VALUE 167	EXCEL_COLUMN	PRIMARY_STRIKE_LIP_HEIGHT
	! ! EXCEL_GET_VALUE 168	EXCEL_COLUMN	SECONDARY_STRIKE_MODEL
	EXCEL_GET_VALUE 169	EXCEL_COLUMN	SECONDARY_STRIKE_HEIGHT
	EXCEL_GET_VALUE 170	EXCEL_COLUMN	SECONDARY_STRIKE_WIDTH
	EXCEL_GET_VALUE 171	EXCEL_COLUMN	SECONDARY_STRIKE_LIP_HEIGHT
	EXCEL_GET_VALUE 172	EXCEL_COLUMN	ANCHOR_BOLTS
	EXCEL_GET_VALUE 173	EXCEL_COLUMN	ANCHOR_MDL
	EXCEL_GET_VALUE 174	EXCEL_COLUMN	ANCHOR_JB_DIST
	EXCEL_GET_VALUE 175	EXCEL_COLUMN	ANCHOR_JT_DIST
	EXCEL_GET_VALUE 176	EXCEL_COLUMN	ANCHOR_JMAX
	EXCEL_GET_VALUE 177	EXCEL_COLUMN	ANCHOR_HDJ_DIST
	EXCEL_GET_VALUE 178	EXCEL_COLUMN	ANCHOR_HMAX
	EXCEL_GET_VALUE 179	EXCEL_COLUMN	ANCHOR_QTY
	EXCEL_GET_VALUE 180	EXCEL_COLUMN	ANCHOR_SPACING
	EXCEL_GET_VALUE 181	EXCEL_COLUMN	ANCHOR_CTR
	EXCEL_GET_VALUE 182	EXCEL_COLUMN	ANCHOR_TYPE_
	! EXCEL_GET_VALUE 183	EXCEL_COLUMN	PRIMARY_LOCK_BACKSET
	! EXCEL_GET_VALUE 184	EXCEL_COLUMN	SECONDARY_LOCK_BACKSET
	EXCEL_GET_VALUE 185	EXCEL_COLUMN	CLOSER_TYPE
	EXCEL_GET_VALUE 186	EXCEL_COLUMN	ANCHOR_DESC
	EXCEL_GET_VALUE 187	EXCEL_COLUMN	DPS_MODEL
	EXCEL_GET_VALUE 188	EXCEL_COLUMN	TRANSOM_HEIGHT
	EXCEL_GET_VALUE 189	EXCEL_COLUMN	SILENCER_HOLE_DIA
	EXCEL_GET_VALUE 190	EXCEL_COLUMN	FLUSH_BOLT_CENTER_TOP
	EXCEL_GET_VALUE 191	EXCEL_COLUMN	FLUSH_BOLT_CENTER_BOTTOM
	EXCEL_GET_VALUE 192	EXCEL_COLUMN	SURFACE_VERTICAL_RODS
	EXCEL_GET_VALUE 193	EXCEL_COLUMN	CONCEALED_VERTICAL_RODS
	EXCEL_GET_VALUE 194	EXCEL_COLUMN	HOLDER_STOP_MANUFACTURER
	EXCEL_GET_VALUE 195	EXCEL_COLUMN	HOLDER_STOP_TYPE
	EXCEL_GET_VALUE 196	EXCEL_COLUMN	HOLDER_STOP_MODEL
	EXCEL_GET_VALUE 197	EXCEL_COLUMN	DPS_POSITION
	EXCEL_GET_VALUE 198	EXCEL_COLUMN	DPS_LOCATION
	EXCEL_GET_VALUE 199	EXCEL_COLUMN	DPS_HOLE_DIA
	EXCEL_GET_VALUE 200	EXCEL_COLUMN	ELECTRIC_HINGE_QTY
	EXCEL_GET_VALUE 201	EXCEL_COLUMN	EXIT_CENTER
	EXCEL_GET_VALUE 202	EXCEL_COLUMN	EXIT_STRIKE_TYPE
	EXCEL_GET_VALUE 203	EXCEL_COLUMN	EXIT_STRIKE_CENTER
	EXCEL_GET_VALUE 204	EXCEL_COLUMN	STD_REV
	EXCEL_GET_VALUE 205	EXCEL_COLUMN	ANCHOR_RECESS
	EXCEL_GET_VALUE 206	EXCEL_COLUMN	ABH_DIM_A
	EXCEL_GET_VALUE 207	EXCEL_COLUMN	ABH_DIM_B
	EXCEL_GET_VALUE 208	EXCEL_COLUMN	ABH_DIM_C
	EXCEL_GET_VALUE 209	EXCEL_COLUMN	ABH_DIM_D
	EXCEL_GET_VALUE 210	EXCEL_COLUMN	ABH_DIM_E
	EXCEL_GET_VALUE 211	EXCEL_COLUMN	HINGE_DESC
	EXCEL_GET_VALUE 212	EXCEL_COLUMN	PRIMARY_STRIKE_DESC
	EXCEL_GET_VALUE 213	EXCEL_COLUMN	SECONDARY_STRIKE_DESC
	EXCEL_GET_VALUE 214	EXCEL_COLUMN	PRIMARY_LOCK_DESC
	EXCEL_GET_VALUE 215	EXCEL_COLUMN	SECONDARY_LOCK_DESC
	EXCEL_GET_VALUE 216	EXCEL_COLUMN	VISION_CONSTRUCTION_A
	EXCEL_GET_VALUE 217	EXCEL_COLUMN	VISION_CONSTRUCTION_B
	EXCEL_GET_VALUE 218	EXCEL_COLUMN	DPS
	EXCEL_GET_VALUE 219	EXCEL_COLUMN	EPT
	EXCEL_GET_VALUE 220	EXCEL_COLUMN	DPS_
	EXCEL_GET_VALUE 221	EXCEL_COLUMN	EPT_
	EXCEL_GET_VALUE 222	EXCEL_COLUMN	MAG_LOCK_
	EXCEL_GET_VALUE 223	EXCEL_COLUMN	DWG
	EXCEL_GET_VALUE 224	EXCEL_COLUMN	TRANSOM_HEAD
	EXCEL_GET_VALUE 225	EXCEL_COLUMN	TRANSOM_SECTION
	EXCEL_GET_VALUE 226	EXCEL_COLUMN	CLOSER_DESC
	EXCEL_GET_VALUE 227	EXCEL_COLUMN	TRANSOM_STOPP
	EXCEL_GET_VALUE 228	EXCEL_COLUMN	TRANSOM_ANCHOR_CENTER
	EXCEL_GET_VALUE 229	EXCEL_COLUMN	DOOR_QTY
	EXCEL_GET_VALUE 230	EXCEL_COLUMN	DOOR_ELEVATION_2
	EXCEL_GET_VALUE 231	EXCEL_COLUMN	EQUAL_CLOSERS
	EXCEL_GET_VALUE 232	EXCEL_COLUMN	CLOSER_TYPE_2
	EXCEL_GET_VALUE 233	EXCEL_COLUMN	CLOSER_SIDE_2
	EXCEL_GET_VALUE 234	EXCEL_COLUMN	CLOSER_DESC_2
	EXCEL_GET_VALUE 235	EXCEL_COLUMN	SURFACE_CLOSER_LENGTH_2
	EXCEL_GET_VALUE 236	EXCEL_COLUMN	SURFACE_CLOSER_WIDTH_2
	EXCEL_GET_VALUE 237	EXCEL_COLUMN	CONCEALED_CLOSER_MANUFACTURER_2
	EXCEL_GET_VALUE 238	EXCEL_COLUMN	CONCEALED_CLOSER_MODEL_NUMBER_2
	EXCEL_GET_VALUE 239	EXCEL_COLUMN	HOLDER_STOP_MANUFACTURER_2
	EXCEL_GET_VALUE 240	EXCEL_COLUMN	HOLDER_STOP_TYPE_2
	EXCEL_GET_VALUE 241	EXCEL_COLUMN	HOLDER_STOP_MODEL_2
	EXCEL_GET_VALUE 242	EXCEL_COLUMN	ASTRAGAL_WIDTH
	! EXCEL_GET_VALUE 243	EXCEL_COLUMN	REV_NUM
	EXCEL_GET_VALUE 244	EXCEL_COLUMN	DRW_NOTE
	EXCEL_GET_VALUE 245	EXCEL_COLUMN	PUSH_PULL_CENTER
	!EXCEL_GET_VALUE 246	EXCEL_COLUMN	PRIMARY_STRIKE_TYPE
	!EXCEL_GET_VALUE 247	EXCEL_COLUMN	SECONDARY_STRIKE_TYPE
	EXCEL_GET_VALUE 248	EXCEL_COLUMN	TRANSOM_PANEL_HEIGHT
	EXCEL_GET_VALUE 249	EXCEL_COLUMN	MULLION
	EXCEL_GET_VALUE 250	EXCEL_COLUMN	TRANSOM_PANEL_THICKNESS
	EXCEL_GET_VALUE 251	EXCEL_COLUMN	TRANSOM_PANEL_ATTACH_METHOD
	EXCEL_GET_VALUE 252	EXCEL_COLUMN	TRANSOM_PANEL_CORE_DESC
	EXCEL_GET_VALUE 253	EXCEL_COLUMN	TRANSOM_PANEL
	EXCEL_GET_VALUE 254	EXCEL_COLUMN	TRANSOM_PANEL_CORE
	EXCEL_GET_VALUE 255	EXCEL_COLUMN	TRANSOM_PANEL_GAUGE
	EXCEL_GET_VALUE 268	EXCEL_COLUMN	CONCEALED_COMPONENT_GRADE
	EXCEL_GET_VALUE 269	EXCEL_COLUMN	EXPOSED_COMPONENET_GRADE
	EXCEL_GET_VALUE 270	EXCEL_COLUMN	CONCEALED_COMPONENT_MATERIAL
	EXCEL_GET_VALUE 271	EXCEL_COLUMN	EXPOSED_COMPONENET_MATERIAL
	EXCEL_GET_VALUE 272	EXCEL_COLUMN	FRAME_WO
	EXCEL_GET_VALUE 261	EXCEL_COLUMN	DOOR_WO
	EXCEL_GET_VALUE 262	EXCEL_COLUMN	DOOR_LITE
	EXCEL_GET_VALUE 263	EXCEL_COLUMN	ALT_STRIKE_CENTER
	EXCEL_GET_VALUE 264	EXCEL_COLUMN	VISION_CTR_TOP
	EXCEL_GET_VALUE 265	EXCEL_COLUMN	VISION_CTR_BOTTOM
	EXCEL_GET_VALUE 266	EXCEL_COLUMN	PRIMARY_LOCK_ARMOR_THICKNESS
	EXCEL_GET_VALUE 267	EXCEL_COLUMN	SECONDARY_LOCK_ARMOR_THICKNESS
	EXCEL_GET_VALUE 268	EXCEL_COLUMN	MASTER_TAG
	EXCEL_GET_VALUE 269	EXCEL_COLUMN	SUB_TAGS
	EXCEL_GET_VALUE 270	EXCEL_COLUMN	SHEET
	EXCEL_GET_VALUE 271	EXCEL_COLUMN	SHEET_QTY
	EXCEL_GET_VALUE 272	EXCEL_COLUMN	TOTAL_SHEETS
	EXCEL_GET_VALUE 273	EXCEL_COLUMN	DRAWING_HISTORY
	EXCEL_GET_VALUE 274	EXCEL_COLUMN	AS_BUILT


	IF READY == "YES" AND ITEM_NUM == MASTER_TAG

		USE_LIBRARY_MDL ASSEM asm ASSEM
		SET_MDL_NAME ASSEM "ASM_"+SO_NUM+"_"+ ITEM_NUM
		SET_MDL_PARAM ASSEM "CUSTOMER_NAME" CUSTOMER_NAME
		SET_MDL_PARAM ASSEM "JOB_NAME" JOB_NAME
		SET_MDL_PARAM ASSEM "SO_NUM" SO_NUM
		GET_MDL_NAME ASSEM ASSEM_MDL_NAME

		SET_MDL_PARAM ASSEM "SUB_JOB_NAME" SUB_JOB_NAME
		SET_MDL_PARAM ASSEM "ITEM_NUM" " "
		SET_MDL_PARAM ASSEM "QTY" QTY
		SET_MDL_PARAM ASSEM "ITEM_DESC" "SEE TABLE"

		IF strleft(HAND, 1) == "L"
			SET_MDL_PARAM ASSEM "ORIENT" 180
		ELSE_IF strleft(HAND, 1) == "R"
			SET_MDL_PARAM ASSEM "ORIENT" 0
		END_IF

		IF HAND == "LH" OR HAND == "RH" OR HAND == "LH/RH" OR HAND == "LHA" OR HAND == "RHA"
			SET_MDL_PARAM ASSEM "DOOR_LOC" -JD+(RABBET/2)
		ELSE_IF HAND == "LHR" OR HAND == "RHR" OR HAND == "LHR/RHR" OR HAND == "LHRA" OR HAND == "RHRA"
			SET_MDL_PARAM ASSEM "DOOR_LOC" -RABBET/2
		END_IF

		REGEN_MDL ASSEM

		IF (HOLDER_STOP_MANUFACTURER == "ABH" OR HOLDER_STOP_MANUFACTURER_2 == "ABH") AND ABH_DIM_A <1
			IF HOLDER_STOP_MODEL == "40*" OR HOLDER_STOP_MODEL_2 == "40*"
				HOLDER_STOP_TYPE = "CONCEALED"
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM A"
				USER_INPUT_PARAM DOUBLE ABH_DIM_A
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM B"
				USER_INPUT_PARAM DOUBLE ABH_DIM_B
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM C"
				USER_INPUT_PARAM DOUBLE ABH_DIM_C
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM D"
				USER_INPUT_PARAM DOUBLE ABH_DIM_D
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM E"
				USER_INPUT_PARAM DOUBLE ABH_DIM_E
			ELSE_IF HOLDER_STOP_MODEL == "90*" OR HOLDER_STOP_MODEL_2 == "90*"
				HOLDER_STOP_TYPE = "SURFACE"
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM A"
				USER_INPUT_PARAM DOUBLE ABH_DIM_A
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM B"
				USER_INPUT_PARAM DOUBLE ABH_DIM_B
				PRINT "ENTER ABH HOLDER/STOP TEMPLATE DIM C"
				USER_INPUT_PARAM DOUBLE ABH_DIM_C
			END_IF
			EXCEL_SET_VALUE 206	EXCEL_COLUMN	ABH_DIM_A
			EXCEL_SET_VALUE 207	EXCEL_COLUMN	ABH_DIM_B
			EXCEL_SET_VALUE 208	EXCEL_COLUMN	ABH_DIM_C
			EXCEL_SET_VALUE 209	EXCEL_COLUMN	ABH_DIM_D
			EXCEL_SET_VALUE 210	EXCEL_COLUMN	ABH_DIM_E
		END_IF

		IF HINGE_TYPE == "BUTT"
			DECLARE_ARRAY HINGE_LOCATIONS_ARRAY
			IF HINGE_TYPE == "BUTT" AND FRAME_ITEM_DESC <> "FRAME"
				IF HINGE_LOCATION_1 > 0
					HINGE_LOCATION_1 = HINGE_LOCATION_1 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_1
				END_IF
				IF HINGE_LOCATION_2 > 0
					HINGE_LOCATION_2 = HINGE_LOCATION_2 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_2
				END_IF
				IF HINGE_LOCATION_3 > 0
					HINGE_LOCATION_3 = HINGE_LOCATION_3 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_3
				END_IF
				IF HINGE_LOCATION_4 > 0
					HINGE_LOCATION_4 = HINGE_LOCATION_4 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_4
				END_IF
				IF HINGE_LOCATION_5 > 0
					HINGE_LOCATION_5 = HINGE_LOCATION_5 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_5
				END_IF
				IF HINGE_LOCATION_6 > 0
					HINGE_LOCATION_6 = HINGE_LOCATION_6 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_6
				END_IF
				IF HINGE_LOCATION_7 > 0
					HINGE_LOCATION_7 = HINGE_LOCATION_7 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_7
				END_IF
				IF HINGE_LOCATION_8 > 0
					HINGE_LOCATION_8 = HINGE_LOCATION_8 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_8
				END_IF
				IF HINGE_LOCATION_9 > 0
					HINGE_LOCATION_9 = HINGE_LOCATION_9 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_9
				END_IF
				IF HINGE_LOCATION_10 > 0
					HINGE_LOCATION_10 = HINGE_LOCATION_10 - TOP_GAP
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_10
				END_IF
			ELSE
				IF HINGE_LOCATION_1 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_1
				END_IF
				IF HINGE_LOCATION_2 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_2
				END_IF
				IF HINGE_LOCATION_3 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_3
				END_IF
				IF HINGE_LOCATION_4 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_4
				END_IF
				IF HINGE_LOCATION_5 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_5
				END_IF
				IF HINGE_LOCATION_6 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_6
				END_IF
				IF HINGE_LOCATION_7 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_7
				END_IF
				IF HINGE_LOCATION_8 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_8
				END_IF
				IF HINGE_LOCATION_9 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_9
				END_IF
				IF HINGE_LOCATION_10 > 0
					ADD_ARRAY_ELEM HINGE_LOCATIONS_ARRAY HINGE_LOCATION_10
				END_IF
			END_IF
		END_IF

		IF FRAME_ITEM_DESC == "FRAME"

			IF FRAME_GAUGE == 16
				FR_THICKNESS = .06
			ELSE_IF FRAME_GAUGE == 14
				FR_THICKNESS = .075
			ELSE_IF FRAME_GAUGE == 12
				FR_THICKNESS = .105
			END_IF

			!BEGIN VERIFY FRAME STANDARDS

			WHILE SECTION == 2 AND SOFFIT < MINIMUM_SOFFIT
				MESSAGE_BOX "THERE IS A PROBLEM WITH THE CONFIGURATION"
				PRINT "PLEASE VERIFY THE AND RE-ENTER THE SECTION #"
				USER_INPUT_PARAM INTEGER SECTION
				PRINT "PLEASE VERIFY THE AND RE-ENTER THE XRABBET"
				USER_INPUT_PARAM DOUBLE XRABBET
				PRINT "PLEASE VERIFY THE AND RE-ENTER THE MINIMUM SOFFIT SIZE"
				USER_INPUT_PARAM DOUBLE MINIMUM_SOFFIT
			END_WHILE

			IF FR_GAUGE == 12
				IF RETURN < .625 OR XRETURN < .625 OR STOPP < .75 OR HEAD_STOPP < .75
					DECLARE_ARRAY arrayButtons
					ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
					ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
					ADD_ARRAY_ELEM arrayButtons "ADJUST THROAT"
					ADD_ARRAY_ELEM arrayButtons "EXIT"
			  MESSAGE_BOX_EX QUESTION "12 GAUGE RETURNS OR STOPS ARE TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
					IF CHOICE == 0 OR CHOICE == 4
						EXIT
					END_IF
					IF CHOICE == 2 OR CHOICE == 3
						IF RETURN < .625
							RETURN = .625
						END_IF
						IF XRETURN < .625
							XRETURN = .625
						END_IF
						IF STOPP < .75
							STOPP = .75
						END_IF
						IF HEAD_STOPP < .75
							HEAD_STOPP = .75
						END_IF
						IF CHOICE == 2
							JD = THROAT+RETURN+XRETURN
						END_IF
						IF CHOICE == 3
							THROAT = JD-RETURN-XRETURN
						END_IF
					END_IF
				END_IF
			END_IF

			IF SECTION == 2
				IF JD-RABBET-XRABBET<MINIMUM_SOFFIT
					DECLARE_ARRAY arrayButtons
					ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
					ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
					ADD_ARRAY_ELEM arrayButtons "ADJUST XRABBET"
					ADD_ARRAY_ELEM arrayButtons "MAKE SINGLE RABBET"
					ADD_ARRAY_ELEM arrayButtons "EXIT"
				MESSAGE_BOX_EX QUESTION "THE SOFFIT IS TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
					IF CHOICE == 0 OR CHOICE == 5
						EXIT
					END_IF
					IF CHOICE == 2
						JD = RABBET + XRABBET + MIINIMUM_SOFFIT
					END_IF
					IF CHOICE == 3
						XRABBET = JD-MINIMUM_SOFFIT
					END_IF
					IF CHOICE == 4
						SECTION = 1
					END_IF
				END_IF
			END_IF

			IF FRAME_ELEVATION == 3 AND (SECTION == 0 OR SECTION == 1 OR SECTION == 2)

				IF FRAME_ELEVATION == 3 AND SECTION == 0
					RETRIEVE_MDL frame_3_0.asm FRAME_ASM
				ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 1
					RETRIEVE_MDL frame_3_1.asm FRAME_ASM
				ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 2
					RETRIEVE_MDL frame_3_2.asm FRAME_ASM
				END_IF

				SEARCH_MDL_REF ASSEM CSYS "FRAME" ATTACH
				SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
					ASSEMBLE FRAME_ASM ASSEM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SET_MDL_NAME FRAME_ASM "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM

				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB*L*" JAMB1
				SET_MDL_NAME JAMB1 "JAMB1_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB1_"+SO_NUM+"_"+ ITEM_NUM JAMB1

				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB*R*" JAMB2
				SET_MDL_NAME JAMB2 "JAMB2_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB2_"+SO_NUM+"_"+ ITEM_NUM JAMB2

				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD*" HEAD
				SET_MDL_NAME HEAD "HEAD_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD_"+SO_NUM+"_"+ ITEM_NUM HEAD

				SET_MDL_PARAM FRAME_ASM "CUSTOMER_NAME" CUSTOMER_NAME
				SET_MDL_PARAM FRAME_ASM "JOB_NAME" JOB_NAME
				SET_MDL_PARAM FRAME_ASM "SO_NUM" SO_NUM

				SET_MDL_PARAM FRAME_ASM "SUB_JOB_NAME" SUB_JOB_NAME
				SET_MDL_PARAM FRAME_ASM "ITEM_NUM" ITEM_NUM
				SET_MDL_PARAM FRAME_ASM "QTY" QTY
				SET_MDL_PARAM FRAME_ASM "ITEM_DESC" FRAME_ITEM_DESC

				SET_MDL_PARAM FRAME_ASM "RABBET" RABBET
				SET_MDL_PARAM FRAME_ASM "XRABBET" XRABBET
				SET_MDL_PARAM FRAME_ASM "STOPP" STOPP
				SET_MDL_PARAM FRAME_ASM "HEAD_STOPP" HEAD_STOPP
				SET_MDL_PARAM FRAME_ASM "JD" JD
				SET_MDL_PARAM FRAME_ASM "JOW" JOW
				SET_MDL_PARAM FRAME_ASM "JOH" JOH+TRANSOM_PANEL_HEIGHT
				SET_MDL_PARAM FRAME_ASM "FACEE" FACEE
				SET_MDL_PARAM FRAME_ASM "XFACEE" XFACEE
				SET_MDL_PARAM FRAME_ASM "HEAD" HEAD
				SET_MDL_PARAM FRAME_ASM "XHEAD" XHEAD
				SET_MDL_PARAM FRAME_ASM "RETURN" RETURN
				SET_MDL_PARAM FRAME_ASM "XRETURN" XRETURN
				SET_MDL_PARAM FRAME_ASM "HAND" HAND
				SET_MDL_PARAM FRAME_ASM "ANCHOR_CTR" -ANCHOR_CTR


				SET_MDL_PARAM JAMB1 "SMT_THICKNESS" FR_THICKNESS
				SET_MDL_PARAM JAMB1 "TYPE" MAT_TYPE
				SET_MDL_PARAM JAMB1 "GRADE"FRAME_GRADE
				SET_MDL_PARAM JAMB1 "FINISH" FRAME_FINISH
				SET_MDL_PARAM JAMB1 "GRAIN" 1
				SET_MDL_PARAM JAMB1 "EMJACNUM" "JAMB1-"+ITEM_NUM

				SET_MDL_PARAM JAMB2 "SMT_THICKNESS" FR_THICKNESS
				SET_MDL_PARAM JAMB2 "TYPE" MAT_TYPE
				SET_MDL_PARAM JAMB2 "GRADE"FRAME_GRADE
				SET_MDL_PARAM JAMB2 "FINISH" FRAME_FINISH
				SET_MDL_PARAM JAMB2 "GRAIN" 1
				SET_MDL_PARAM JAMB2 "EMJACNUM" "JAMB2-"+ITEM_NUM

				SET_MDL_PARAM HEAD "SMT_THICKNESS" FR_THICKNESS
				SET_MDL_PARAM HEAD "TYPE" MAT_TYPE
				SET_MDL_PARAM HEAD "GRADE"FRAME_GRADE
				SET_MDL_PARAM HEAD "FINISH" FRAME_FINISH
				SET_MDL_PARAM HEAD "EMJACNUM" "HEAD-"+ITEM_NUM

				IF GRAIN == "VERTICAL"
						SET_MDL_PARAM HEAD "GRAIN" 2
				ELSE_IF GRAIN == "HORIZONTAL"
						SET_MDL_PARAM HEAD "GRAIN" 1
				END_IF
			END_IF

			IF FRAME_ELEVATION == 5 AND SECTION == 2
				RETRIEVE_MDL frame_5_20.asm FRAME_ASM

				IF TRANSOM_HEIGHT < 1
					PRINT "ENTER TRANSOM JOH"
					USER_INPUT_PARAM DOUBLE TRANSOM_JOH
					SET_MDL_PARAM FRAME_ASM "TRANSOM_HEIGHT" TRANSOM_JOH/25.4
				END_IF

				SEARCH_MDL_REF ASSEM CSYS "FRAME" ATTACH
				SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
					ASSEMBLE FRAME_ASM ASSEM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SET_MDL_NAME FRAME_ASM "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SET_MDL_PARAM FRAME_ASM "CUSTOMER_NAME" CUSTOMER_NAME
					SET_MDL_PARAM FRAME_ASM "JOB_NAME" JOB_NAME
					SET_MDL_PARAM FRAME_ASM "SO_NUM" SO_NUM
					SET_MDL_PARAM FRAME_ASM "SUB_JOB_NAME" SUB_JOB_NAME
					SET_MDL_PARAM FRAME_ASM "ITEM_NUM" ITEM_NUM
					SET_MDL_PARAM FRAME_ASM "QTY" QTY
					SET_MDL_PARAM FRAME_ASM "ITEM_DESC" FRAME_ITEM_DESC
					SET_MDL_PARAM FRAME_ASM "RABBET" RABBET
					SET_MDL_PARAM FRAME_ASM "XRABBET" XRABBET
					SET_MDL_PARAM FRAME_ASM "STOPP" STOPP
					SET_MDL_PARAM FRAME_ASM "HEAD_STOPP" HEAD_STOPP
					SET_MDL_PARAM FRAME_ASM "JD" JD
					SET_MDL_PARAM FRAME_ASM "JOW" JOW
					SET_MDL_PARAM FRAME_ASM "JOH" JOH+TRANSOM_PANEL_HEIGHT
					SET_MDL_PARAM FRAME_ASM "FACEE" FACEE
					SET_MDL_PARAM FRAME_ASM "XFACEE" XFACEE
					SET_MDL_PARAM FRAME_ASM "HEAD" HEAD
					SET_MDL_PARAM FRAME_ASM "XHEAD" XHEAD
					SET_MDL_PARAM FRAME_ASM "RETURN" RETURN
					SET_MDL_PARAM FRAME_ASM "XRETURN" XRETURN
					SET_MDL_PARAM FRAME_ASM "HAND" HAND
					SET_MDL_PARAM FRAME_ASM "ANCHOR_CTR" -ANCHOR_CTR

				REGEN_MDL FRAME_ASM
				REGEN_MDL FRAME_ASM

				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB_5_20L" JAMB1
				SET_MDL_NAME JAMB1 "JAMB1_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB1_"+SO_NUM+"_"+ ITEM_NUM JAMB1
					SET_MDL_PARAM JAMB1 "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM JAMB1 "TYPE" MAT_TYPE
					SET_MDL_PARAM JAMB1 "GRADE"FRAME_GRADE
					SET_MDL_PARAM JAMB1 "FINISH" FRAME_FINISH
					SET_MDL_PARAM JAMB1 "GRAIN" 1
					DELETE_FAMINSTANCE JAMB1 "*INST*"


				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB_5_20R" JAMB2
				SET_MDL_NAME JAMB2 "JAMB2_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB2_"+SO_NUM+"_"+ ITEM_NUM JAMB2
					SET_MDL_PARAM JAMB2 "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM JAMB2 "TYPE" MAT_TYPE
					SET_MDL_PARAM JAMB2 "GRADE"FRAME_GRADE
					SET_MDL_PARAM JAMB2 "FINISH" FRAME_FINISH
					SET_MDL_PARAM JAMB2 "GRAIN" 1

				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "MULLION_5_20" HEAD
				SET_MDL_NAME HEAD "HEAD_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD_"+SO_NUM+"_"+ ITEM_NUM HEAD
					SET_MDL_PARAM HEAD "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM HEAD "TYPE" MAT_TYPE
					SET_MDL_PARAM HEAD "GRADE"FRAME_GRADE
					SET_MDL_PARAM HEAD "FINISH" FRAME_FINISH


				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "FILLER_5_20" MULLION_FILLER
				SET_MDL_NAME MULLION_FILLER "FILLER_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "FILLER_"+SO_NUM+"_"+ ITEM_NUM MULLION_FILLER
					SET_MDL_PARAM MULLION_FILLER "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM MULLION_FILLER "TYPE" MAT_TYPE
					SET_MDL_PARAM MULLION_FILLER "GRADE" FRAME_GRADE
					SET_MDL_PARAM MULLION_FILLER "FINISH" FRAME_FINISH


				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*HEAD" TRANSOM_HEAD
				SET_MDL_NAME TRANSOM_HEAD "TRANSOM_HEAD_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_HEAD_"+SO_NUM+"_"+ ITEM_NUM TRANSOM_HEAD
					SET_MDL_PARAM TRANSOM_HEAD "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM TRANSOM_HEAD "TYPE" MAT_TYPE
					SET_MDL_PARAM TRANSOM_HEAD "GRADE" FRAME_GRADE
					SET_MDL_PARAM TRANSOM_HEAD "FINISH" FRAME_FINISH


				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_L" TRANSOM_JAMB_L
				SET_MDL_NAME TRANSOM_JAMB_L "TRANSOM_JAMB_L_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_L_"+SO_NUM+"_"+ ITEM_NUM TRANSOM_JAMB_L
					SET_MDL_PARAM TRANSOM_JAMB_L "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM TRANSOM_JAMB_L "TYPE" MAT_TYPE
					SET_MDL_PARAM TRANSOM_JAMB_L "GRADE" FRAME_GRADE
					SET_MDL_PARAM TRANSOM_JAMB_L "FINISH" FRAME_FINISH
					SET_MDL_PARAM TRANSOM_JAMB_L "GRAIN" 1


				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_R" TRANSOM_JAMB_R
				SET_MDL_NAME TRANSOM_JAMB_R "TRANSOM_JAMB_R_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_R_"+SO_NUM+"_"+ ITEM_NUM TRANSOM_JAMB_R
					SET_MDL_PARAM TRANSOM_JAMB_R "SMT_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM TRANSOM_JAMB_R "TYPE" MAT_TYPE
					SET_MDL_PARAM TRANSOM_JAMB_R "GRADE" FRAME_GRADE
					SET_MDL_PARAM TRANSOM_JAMB_R "FINISH" FRAME_FINISH
					SET_MDL_PARAM TRANSOM_JAMB_R "GRAIN" 1

				IF GRAIN == "VERTICAL"
						SET_MDL_PARAM HEAD "GRAIN" 2
						SET_MDL_PARAM TRANSOM_HEAD "GRAIN" 2
						SET_MDL_PARAM MULLION_FILLER "GRAIN" 2
				ELSE_IF GRAIN == "HORIZONTAL"
						SET_MDL_PARAM HEAD "GRAIN" 1
						SET_MDL_PARAM TRANSOM_HEAD "GRAIN" 1
						SET_MDL_PARAM MULLION_FILLER "GRAIN" 1
				END_IF
			END_IF

			IF TRANSOM_PANEL == "YES"
				SEARCH_MDL_REF FRAME_ASM CSYS "T_PANEL"  T_PANEL_CSYS

				RETRIEVE_MDL	transom_panel.asm	T_PANEL
				SET_MDL_NAME T_PANEL "T_PANEL_"+SO_NUM+"_"+ ITEM_NUM
				SET_MDL_PARAM T_PANEL "LENGTH" JOW
				SET_MDL_PARAM T_PANEL "HEIGHT" TRANSOM_PANEL_HEIGHT
				SET_MDL_PARAM T_PANEL "RABBET" RABBET
				SET_MDL_PARAM T_PANEL "STOPP" STOPP
				SET_MDL_PARAM T_PANEL "THICKNESS" TRANSOM_PANEL_THICKNESS
				SET_MDL_PARAM T_PANEL "GRADE" GRADE
				SET_MDL_PARAM T_PANEL "FINISH" FINISH
				SET_MDL_PARAM T_PANEL "ATTACH_METHOD" TRANSOM_PANEL_ATTACH_METHOD
				SET_MDL_PARAM T_PANEL "CORE" TRANSOM_PANEL_CORE_DESC

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_PANEL_BODY" T_BODY
				SET_MDL_NAME T_BODY "T_PANEL_BODY_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_PANEL_BODY_"+SO_NUM+"_"+ ITEM_NUM T_BODY

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_PANEL_COVER" T_COVER
				SET_MDL_NAME T_COVER "T_PANEL_COVER_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_PANEL_COVER_"+SO_NUM+"_"+ ITEM_NUM T_COVER

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_CHANNEL" T_CHANNEL
				SET_MDL_NAME T_CHANNEL "T_CHANNEL_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_CHANNEL_"+SO_NUM+"_"+ ITEM_NUM T_CHANNEL

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_PANEL_CORE" T_CORE
				SET_MDL_NAME T_CORE "T_CORE_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_CORE_"+SO_NUM+"_"+ ITEM_NUM T_CORE

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_ASTRAGAL" T_ASTRAGAL
				SET_MDL_NAME T_ASTRAGAL "T_ASTRAGAL_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_ASTRAGAL_"+SO_NUM+"_"+ ITEM_NUM T_ASTRAGAL

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_ANGLE_1" TANGLE1
				SET_MDL_NAME TANGLE1 "T_ANGLE1"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_ANGLE1"+SO_NUM+"_"+ ITEM_NUM TANGLE1

				SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_ANGLE_2" TANGLE2
				SET_MDL_NAME TANGLE2 "T_ANGLE2"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF T_PANEL COMPONENT "T_ANGLE2"+SO_NUM+"_"+ ITEM_NUM TANGLE2

				IF TRANSOM_PANEL_ATTACH_METHOD == 0 OR TRANSOM_PANEL_ATTACH_METHOD == 2
					SEARCH_MDL_REFS ALLOW_SUPPRESSED T_PANEL COMPONENT "*ANGLE*" refFeats
					FOR refFeat REF ARRAY refFeats
						SET_FEATURE_STATE refFeat SUPPRESSED
					END_FOR
				END_IF

				SEARCH_MDL_REF T_PANEL CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE T_PANEL FRAME_ASM
					CSYS T_PANEL_CSYS PLACEMENT
				END_ASSEMBLE
			END_IF

			IF DW_RTRN <> "NO"
				SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED ASSEM FEATURE "DW*"+DW_RTRN refFeats
					FOR refFeat REF ARRAY refFeats
						SET_FEATURE_STATE refFeat RESUMED
					END_FOR
			END_IF

			IF XDW_RTRN <> "NO"
				SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED ASSEM FEATURE "XDW*"+XDW_RTRN refFeats
					FOR refFeat REF ARRAY refFeats
						SET_FEATURE_STATE refFeat RESUMED
					END_FOR
			END_IF

			IF SUB_TYPE == "P"
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

				IF ACTIVE_LEAF < 1 OR ACTIVE_LEAF == JOW/2 OR ACTIVE_LEAF == 99
					DOOR_CTR = 0
				ELSE_IF HAND == "LHA" OR HAND == "RHRA"
					DOOR_CTR = (JOW/2) - ACTIVE_LEAF
				ELSE_IF HAND == "RHA" OR HAND == "LHRA"
					DOOR_CTR = -((JOW/2) - ACTIVE_LEAF)
				ELSE
					DOOR_CTR = 0
				END_IF

				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX DOOR_CTR
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ 0
					UDF_EXP_REF DOOR_CTR_CSYS CSYS 0
				END_CREATE_UDF
			END_IF

			IF HOSPITAL_STOPS == "YES"
				SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB1 FEATURE "*HOSPITAL*" refFeat1
					SET_FEATURE_STATE refFeat1 RESUMED
				SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB2 FEATURE "*HOSPITAL*" refFeat2
					SET_FEATURE_STATE refFeat2 RESUMED
				REGEN_MDL ASSEM FORCE
				REGEN_MDL ASSEM FORCE
				SEARCH_MDL_REF JAMB1 CSYS "HOSPITAL_STOP*" FILLER
				SEARCH_FEAT_PARAM FILLER "MODEL" COMP
				SEARCH_FEAT_PARAM FILLER "LENGTH" LENGTH
				SEARCH_FEAT_PARAM FILLER "WIDTH" WIDTH
				RETRIEVE_MDL COMP COMP
				GET_MDL_NAME COMP PRT_NAME
				INSERT_FAMINSTANCE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM
				SET_FAMITEM_VALUE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM "LENGTH" LENGTH
				SET_FAMITEM_VALUE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM "WIDTH" WIDTH
				SET_FAMITEM_VALUE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM "SMT_THICKNESS" FR_THICKNESS
				GET_REF_FAMINSTANCE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM INST

				SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE INST FRAME_ASM
						CSYS FILLER PLACEMENT
					END_ASSEMBLE

				SEARCH_MDL_REF JAMB2 CSYS "HOSPITAL_STOP*" FILLER
					ASSEMBLE INST FRAME_ASM
						CSYS FILLER PLACEMENT
					END_ASSEMBLE
			END_IF

			REGEN_MDL ASSEM FORCE

			IF SILENCERS == "YES"
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
				IF SUB_TYPE == "S"
					IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
					   HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 90
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX (JOW/2) - (STOPP/2)
							UDF_DIM	LOCY JOH - 8
							UDF_DIM	LOCZ (JD/2) - RABBET
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\hole FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	DIA SILENCER_HOLE_DIA
							UDF_DIM	DEPTH .25
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 90
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX (JOW/2) - (STOPP/2)
							UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
							UDF_DIM	LOCZ (JD/2) - RABBET
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\hole FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	DIA SILENCER_HOLE_DIA
							UDF_DIM	DEPTH .25
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 90
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX (JOW/2) - (STOPP/2)
							UDF_DIM	LOCY 8
							UDF_DIM	LOCZ (JD/2) - RABBET
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\hole FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	DIA SILENCER_HOLE_DIA
							UDF_DIM	DEPTH .25
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
					END_IF
					IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
					  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 90
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
							UDF_DIM	LOCY JOH - 8
							UDF_DIM	LOCZ (JD/2) - RABBET
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\hole FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	DIA SILENCER_HOLE_DIA
							UDF_DIM	DEPTH .25
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 90
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
							UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
							UDF_DIM	LOCZ (JD/2) - RABBET
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\hole FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	DIA SILENCER_HOLE_DIA
							UDF_DIM	DEPTH .25
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 90
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
							UDF_DIM	LOCY 8
							UDF_DIM	LOCZ (JD/2) - RABBET
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\hole FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	DIA SILENCER_HOLE_DIA
							UDF_DIM	DEPTH .25
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
					END_IF
				END_IF
				IF SUB_TYPE == "P"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH DOOR_CTR_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 90
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 6
						UDF_DIM	LOCY JOH - (HEAD_STOPP/2)
						UDF_DIM	LOCZ (JD/2) - RABBET
						UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH refCsys
						UDF_DIM	DIA SILENCER_HOLE_DIA
						UDF_DIM	DEPTH .25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH DOOR_CTR_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 90
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -6
						UDF_DIM	LOCY JOH - (HEAD_STOPP/2)
						UDF_DIM	LOCZ (JD/2) - RABBET
						UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH refCsys
						UDF_DIM	DIA SILENCER_HOLE_DIA
						UDF_DIM	DEPTH .25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_IF
			END_IF

			IF (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) AND SUB_TYPE == "P"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH DOOR_CTR_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY JOH + FR_THICKNESS +.01
					UDF_DIM	LOCZ (JD/2) - (RABBET/2)
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\rect_cut FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIMY .25
					UDF_DIM	DIMZ 1.015
					UDF_DIM	DIMX 3.515
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
			RETRIEVE_MDL FLUSH_BOLT_HEAD_ASM.ASM FLBLT
			SEARCH_MDL_REF FLBLT CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE FLBLT FRAME_ASM
					CSYS refCsys PLACEMENT
				END_ASSEMBLE
			END_IF

			IF HINGE_TYPE == "BUTT"
				DECLARE_VARIABLE STRING LOOKUPSTRINGNO
								LOOKUPSTRINGNO = "HINGE_HEIGHT == " + ftos(HINGE_HEIGHT,3) + " AND HINGE_THICKNESS == " + ftos(HINGE_THICKNESS,3) + \
								 " AND FR_GA == " + ftos(FR_THICKNESS,3) + " AND GRADE == " +FRAME_GRADE + " AND ELEC == 0"
				DECLARE_VARIABLE STRING LOOKUPSTRINGYES
								LOOKUPSTRINGYES = "HINGE_HEIGHT == " + ftos(HINGE_HEIGHT,3) + " AND HINGE_THICKNESS == " + ftos(HINGE_THICKNESS,3)	 + \
								" AND FR_GA == " + ftos(FR_THICKNESS,3) + " AND GRADE == " +FRAME_GRADE	+ " AND ELEC == 1"

				IF HAND == "LHR" OR HAND == "RH" OR HAND == "LHRA" OR HAND == "RHRA" OR \
				   HAND == "LHR/RHR" OR HAND == "LHA"  OR HAND == "RHA" OR HAND == "LH/RH"
					SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2)
					UDF_DIM	LOCY JOH
					UDF_DIM	LOCZ (JD/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF

						HINGE_INDEX = 1
					FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
						CREATE_UDF udf\frame_hinge FRAME_ASM
						UDF_REF ATTACH refCsys
						UDF_DIM LOCY -LOCY
						UDF_DIM DIMX HINGE_THICKNESS+.03
						UDF_DIM DIMY HINGE_HEIGHT + .02
						UDF_DIM DIMZ RABBET - JAMB_HINGE_SETBACK + .01
						UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
						UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						RETRIEVE_MDL frame_hinge_asm.asm HINGE_ASM
						SEARCH_MDL_REF HINGE_ASM CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE HINGE_ASM FRAME_ASM
							CSYS LOC+itos(HINGE_INDEX) PLACEMENT
						END_ASSEMBLE

						IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
							LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGYES instance_name
							GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
							REPLACE_COMPONENT HINGE_ASM instance
							IF DUST_BOXES == YES
								USE_LIBRARY_MDL dust_box part PRT
								GET_MDL_NAME PRT PRT_NAME
								INSERT_FAMINSTANCE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
								SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
								SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
								SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
								SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
								SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 1
								GET_REF_FAMINSTANCE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
									ASSEMBLE INST FRAME_ASM
										CSYS LOC+itos(HINGE_INDEX) PLACEMENT
									END_ASSEMBLE
							END_IF
						ELSE
							LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGNO instance_name
							GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
							REPLACE_COMPONENT HINGE_ASM instance
							IF DUST_BOXES == YES
								RETRIEVE_MDL DUST_BOX.PRT PRT
								SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE PRT FRAME_ASM
									CSYS LOC+itos(HINGE_INDEX) PLACEMENT
								END_ASSEMBLE
								! USE_LIBRARY_MDL dust_box part PRT
								! GET_MDL_NAME PRT PRT_NAME
								! INSERT_FAMINSTANCE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 0
								! GET_REF_FAMINSTANCE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
								! SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
									! ASSEMBLE INST FRAME_ASM
										! CSYS LOC+itos(HINGE_INDEX) PLACEMENT
									! END_ASSEMBLE
							END_IF
						END_IF
						HINGE_INDEX ++
					END_FOR
				END_IF

				IF HAND == "RHR" OR HAND == "LH" OR HAND == "LHRA" OR HAND == "RHRA" OR \
				   HAND == "LHR/RHR" OR HAND == "LHA"  OR HAND == "RHA" OR HAND == "LH/RH"
					SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX (JOW/2)
					UDF_DIM	LOCY JOH
					UDF_DIM	LOCZ (JD/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF

						HINGE_INDEX = 1
					FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
						CREATE_UDF udf\frame_hinge FRAME_ASM
						UDF_REF ATTACH refCsys
						UDF_DIM LOCY LOCY
						UDF_DIM DIMX HINGE_THICKNESS+.03
						UDF_DIM DIMY HINGE_HEIGHT + .02
						UDF_DIM DIMZ RABBET - JAMB_HINGE_SETBACK + .01
						UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
						UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						RETRIEVE_MDL frame_hinge_asm.asm HINGE_ASM
						SEARCH_MDL_REF HINGE_ASM CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE HINGE_ASM FRAME_ASM
							CSYS LOC+itos(HINGE_INDEX) PLACEMENT
						END_ASSEMBLE

						IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
							LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGYES instance_name
							GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
							REPLACE_COMPONENT HINGE_ASM instance
							IF DUST_BOXES == YES
								USE_LIBRARY_MDL dust_box part PRT
								GET_MDL_NAME PRT PRT_NAME
								INSERT_FAMINSTANCE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
								SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
								SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
								SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
								SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
								SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 1
								GET_REF_FAMINSTANCE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
									ASSEMBLE INST FRAME_ASM
										CSYS LOC+itos(HINGE_INDEX) PLACEMENT
									END_ASSEMBLE
							END_IF
						ELSE
							LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGNO instance_name
							GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
							REPLACE_COMPONENT HINGE_ASM instance
							IF DUST_BOXES == YES
								RETRIEVE_MDL DUST_BOX.PRT PRT
								SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE PRT FRAME_ASM
									CSYS LOC+itos(HINGE_INDEX) PLACEMENT
								END_ASSEMBLE
								! USE_LIBRARY_MDL dust_box part PRT
								! GET_MDL_NAME PRT PRT_NAME
								! INSERT_FAMINSTANCE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
								! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 0
								! GET_REF_FAMINSTANCE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
								! SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
									! ASSEMBLE INST FRAME_ASM
										! CSYS LOC+itos(HINGE_INDEX) PLACEMENT
									! END_ASSEMBLE
							END_IF
						END_IF
						HINGE_INDEX ++
					END_FOR
				END_IF
			END_IF
			! END FRAME BUTT HINGE PREPS

			! BEGIN FRAME PREPS - CONTINUOUS HINGE
			IF HINGE_TYPE == "CONTINUOUS"
				IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
				  HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
						UDF_EXP_REF ASM_CSYS CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL BU_FLAT.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						 CSYS ASM_CSYS PLACEMENT
					END_ASSEMBLE

					INSERT_FAMINSTANCE COMP "COMP_1_"+ ITEM_NUM
					SET_FAMITEM_VALUE COMP "COMP_1_"+ ITEM_NUM "LENGTH" JOH - 2
					SET_FAMITEM_VALUE COMP "COMP_1_"+ ITEM_NUM "WIDTH" RABBET - ((FR_THICKNESS+.03)*2)
					SET_FAMITEM_VALUE COMP "COMP_1_"+ ITEM_NUM "SMT_THICKNESS" .105
					GET_REF_FAMINSTANCE COMP "COMP_1_"+ ITEM_NUM INST
					REPLACE_COMPONENT COMP INST
				END_IF

				IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
				  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 180
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 180
						UDF_DIM	LOCX (JOW/2) + FR_THICKNESS
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
						UDF_EXP_REF ASM_CSYS CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL BU_FLAT.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						 CSYS ASM_CSYS PLACEMENT
					END_ASSEMBLE

					INSERT_FAMINSTANCE COMP "COMP_2_"+ ITEM_NUM
					SET_FAMITEM_VALUE COMP "COMP_2_"+ ITEM_NUM "LENGTH" JOH - 2
					SET_FAMITEM_VALUE COMP "COMP_2_"+ ITEM_NUM "WIDTH" RABBET - ((FR_THICKNESS+.03)*2)
					SET_FAMITEM_VALUE COMP "COMP_2_"+ ITEM_NUM "SMT_THICKNESS" .105
					GET_REF_FAMINSTANCE COMP "COMP_2_"+ ITEM_NUM INST
					REPLACE_COMPONENT COMP INST
				END_IF
			END_IF
			! END FRAME PREPS - CONTINUOUS HINGE

			IF PRIMARY_STRIKE_UDF == "STRIKE T" AND SUB_TYPE == "S"
				IF HAND == "LH" OR HAND == "RHR"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2)
					UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF

					CREATE_UDF udf\strike FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	SETBACK RABBET/2
					UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
					UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
					UDF_DIM	STRIKE_LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
					UDF_DIM	STRIKE_LIP_DEPTH PRIMARY_STRIKE_LIP_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_IF

				IF HAND == "RH" OR HAND == "LHR"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX (JOW/2)
					UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF

					CREATE_UDF udf\strike FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	SETBACK RABBET/2
					UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
					UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
					UDF_DIM	STRIKE_LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
					UDF_DIM	STRIKE_LIP_DEPTH PRIMARY_STRIKE_LIP_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_IF

				RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
				SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE STRIKE FRAME_ASM
					CSYS refCsys PLACEMENT
				END_ASSEMBLE
				LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == PRIMARY_STRIKE_HEIGHT" INST_NAME
				GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
				REPLACE_COMPONENT STRIKE STRIKE_INST
			END_IF

			IF PRIMARY_STRIKE_UDF == "RIM"

				DECLARE_VARIABLE DOUBLE TEMP_VALUE
				IF SOFFIT < 1.875
					TEMP_VALUE = SOFFIT - .375
				ELSE
					TEMP_VALUE = 1.5
				END_IF

				IF HAND == "LH" OR HAND == "RHR"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2) + STOPP - FR_THICKNESS - .125
					UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2) - RABBET - .1875 - (TEMP_VALUE/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF
				END_IF

				IF HAND == "RH" OR HAND == "LHR"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX (JOW/2) - STOPP + FR_THICKNESS + .125
					UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2) - RABBET - .1875 - (TEMP_VALUE/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF
				END_IF

					RETRIEVE_MDL BU_FLAT.PRT BU
					GET_MDL_NAME BU BU_NAME
					INSERT_FAMINSTANCE BU BU_NAME + "_RIM_" + ITEM_NUM
					SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "LENGTH" 6
					SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "WIDTH" 1.5
					SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "SMT_THICKNESS" .105
					GET_REF_FAMINSTANCE BU BU_NAME + "_RIM_" + ITEM_NUM INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT4" PLACEMENT4
					ASSEMBLE INST FRAME_ASM
						CSYS refCsys PLACEMENT4
					END_ASSEMBLE
			END_IF


			IF PRIMARY_LOCK_TYPE == "*EXIT*" AND (SURFACE_VERTICAL_RODS == 1 OR SURFACE_VERTICAL_RODS == 3)
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

				IF HAND == "LHR" OR HAND == "RH"
					CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ((JOW/2) - 5.5)
							UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .06
							UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF
				END_IF

				IF HAND == "RHR" OR HAND == "LH"
					CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - 5.5)
							UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .06
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
				END_IF

				IF SUB_TYPE == "P"
					CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX DOOR_CTR
							UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .06
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
				END_IF

				DECLARE_VARIABLE DOUBLE BU_WIDTH
				IF SOFFIT - FR_THICKNESS - FR_THICKNESS - .12 < 1.5
					BU_WIDTH = SOFFIT - FR_THICKNESS - FR_THICKNESS - .12
				ELSE
					BU_WIDTH = 1.5
				END_IF
					RETRIEVE_MDL BU_FLAT.PRT BU
					GET_MDL_NAME BU BU_NAME
					INSERT_FAMINSTANCE BU BU_NAME + "_SVR_" + ITEM_NUM
					SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "LENGTH" 9
					SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "WIDTH" 1.5
					SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "SMT_THICKNESS" .105
					GET_REF_FAMINSTANCE BU BU_NAME + "_SVR_" + ITEM_NUM INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT2" PLACEMENT2
					ASSEMBLE INST FRAME_ASM
						CSYS refCsys PLACEMENT2
					END_ASSEMBLE
			END_IF

			IF SECONDARY_STRIKE_UDF == "STRIKE D"
				IF HAND == "LH" OR HAND == "RHR"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2)
					UDF_DIM	LOCY SECONDARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF

					CREATE_UDF udf\strike-d FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	SETBACK RABBET/2
					UDF_DIM	STRIKE_WIDTH SECONDARY_STRIKE_WIDTH
					UDF_DIM	STRIKE_HEIGHT SECONDARY_STRIKE_HEIGHT
					UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_IF

				IF HAND == "RH" OR HAND == "LHR"
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX (JOW/2)
					UDF_DIM	LOCY SECONDARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2)
					UDF_EXP_REF refCsys CSYS 0
					END_CREATE_UDF

					CREATE_UDF udf\strike-d FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	SETBACK RABBET/2
					UDF_DIM	STRIKE_WIDTH SECONDARY_STRIKE_WIDTH
					UDF_DIM	STRIKE_HEIGHT SECONDARY_STRIKE_HEIGHT
					UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_IF

				RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
				SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE STRIKE FRAME_ASM
					CSYS refCsys PLACEMENT
				END_ASSEMBLE
				LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == SECONDARY_STRIKE_HEIGHT" INST_NAME
				GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
				REPLACE_COMPONENT STRIKE STRIKE_INST
			END_IF

			! END FRAME PREPS - STRIKES

			! BEGIN FRAME PREPS - FLOOR CLIPS & ANCHORS
			DECLARE_ARRAY ANCHORS_ARRAY
			DECLARE_VARIABLE 	INTEGER 	ANCHOR_INDEX

			ANCHOR_QTY = ceil((JOH+TRANSOM_PANEL_HEIGHT - ANCHOR_JB_DIST - ANCHOR_JT_DIST)/ANCHOR_JMAX)+1
			ANCHOR_SPACING = (JOH+TRANSOM_PANEL_HEIGHT - ANCHOR_JB_DIST - ANCHOR_JT_DIST) / (ANCHOR_QTY-1)
			SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 180
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX ((JOW/2) + FR_THICKNESS + .03)
				UDF_DIM	LOCY ANCHOR_JB_DIST
				UDF_DIM	LOCZ -ANCHOR_CTR
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

			ANCHOR_INDEX = 2
			WHILE ANCHOR_INDEX <= ANCHOR_QTY
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -ANCHOR_SPACING
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

				ANCHOR_INDEX ++
			END_WHILE

			ANCHOR_QTY = ceil((JOH +TRANSOM_PANEL_HEIGHT- ANCHOR_JB_DIST - ANCHOR_JT_DIST)/ANCHOR_JMAX)+1
			ANCHOR_SPACING = (JOH+TRANSOM_PANEL_HEIGHT - ANCHOR_JB_DIST - ANCHOR_JT_DIST) / (ANCHOR_QTY-1)
			SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 180
				UDF_DIM	ROTZ 180
				UDF_DIM	LOCX -((JOW/2) + FR_THICKNESS + .03)
				UDF_DIM	LOCY ANCHOR_JB_DIST
				UDF_DIM	LOCZ -ANCHOR_CTR
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

			ANCHOR_INDEX = 2
			WHILE ANCHOR_INDEX <= ANCHOR_QTY
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY ANCHOR_SPACING
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH
				ANCHOR_INDEX ++
			END_WHILE

			IF ANCHOR_MDL == "*wire*" OR ANCHOR_MDL == "*loose_t*"
				RETRIEVE_MDL ANCHOR_MDL ANCHOR
			END_IF

			IF ANCHOR_MDL == "*stud*"
				RETRIEVE_MDL ANCHOR_MDL GENERIC
				GET_MDL_NAME GENERIC GENERIC_NAME
				INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM
				GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM ANCHOR
				SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM

				IF ANCHOR_DESC == "LOOSE*"
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "LENGTH" JD - (FR_THICKNESS*2) - .06
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "CHAMFER" "Y"
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RABBET" RABBET - FR_THICKNESS - .06
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "XRABBET" XRABBET - FR_THICKNESS - .06
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "OFFSET" FR_THICKNESS + .03
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
				ELSE_IF ANCHOR_DESC == "*WELDED*"
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "LENGTH" JD - RETURN - XRETURN + .1
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "CHAMFER" "N"
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RABBET" RABBET - RETURN +.02
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "XRABBET" XRABBET - XRETURN +.02
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
					IF DW_RTRN == "IN"
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "OFFSET" .5
					ELSE
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "OFFSET" FR_THICKNESS
					END_IF
				END_IF
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "WIDTH" FACEE - (FR_THICKNESS*2) - .06
				IF SECTION == 0 OR SECTION == 2
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" 0
				ELSE_IF SECTION == 1
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" STOPP
				END_IF
				IF ANCHOR_DESC == "*WOOD*"
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "WOOD" "Y"
				ELSE
					SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "WOOD" "N"
				END_IF
			END_IF

			IF ANCHOR_MDL == "*pd*"
				CLEAR_ARRAY ARRAYITEMS
				DECLARE_VARIABLE INTEGER ARRAY_INDEX
				DECLARE_VARIABLE STRING NEW_VALUE
				RETRIEVE_MDL ANCHOR_MDL GENERIC
				GET_MDL_NAME GENERIC GENERIC_NAME
				SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
				INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "JD" JD
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "ANCHOR_CTR" ANCHOR_CTR
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FACEE" FACEE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" STOPP
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
				GET_FAMITEMS GENERIC ARRAYITEMS
				GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
				ARRAY_INDEX = 0

				WHILE ARRAY_INDEX <= ARRAY_SIZE-1
					GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
					IF VALUE == "M*"
						NEW_VALUE = "FID:" + strmid(VALUE,1)
						SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
						GET_REF_GENERIC INST COMP_GENERIC
						GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
						INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_" + ITEM_NUM
					END_IF
					ARRAY_INDEX ++
				END_WHILE

				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	DIA .385
						UDF_DIM	DEPTH STOPP+.25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_FOR

				GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM ANCHOR
			END_IF

			IF ANCHOR_MDL == "*conc*"
				CLEAR_ARRAY ARRAYITEMS
				DECLARE_VARIABLE INTEGER ARRAY_INDEX
				DECLARE_VARIABLE STRING NEW_VALUE
				RETRIEVE_MDL ANCHOR_MDL GENERIC
				GET_MDL_NAME GENERIC GENERIC_NAME
				SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
				INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "JD" JD
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "ANCHOR_CTR" ANCHOR_CTR
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FACEE" FACEE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" STOPP
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "SOFFIT" SOFFIT
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "GRADE"FRAME_GRADE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "TYPE" MAT_TYPE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FINISH" "2B"

				GET_FAMITEMS GENERIC ARRAYITEMS
				GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
				ARRAY_INDEX = 0

				WHILE ARRAY_INDEX <= ARRAY_SIZE-1
					GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
					IF VALUE == "M*"
						NEW_VALUE = "FID:" + strmid(VALUE,1)
						SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
						GET_REF_GENERIC INST COMP_GENERIC
						GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
						INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_" + ITEM_NUM
					END_IF
					ARRAY_INDEX ++
				END_WHILE

				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	DIA 1.015
						UDF_DIM	DEPTH STOPP+.25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_FOR

				GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM ANCHOR
			END_IF

			SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					ASSEMBLE ANCHOR FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				END_FOR

			IF ANCHOR_MDL == "*pd*" AND ANCHOR_BOLTS == "YES"
				RETRIEVE_MDL bolt_pd.prt PRT
				SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
					FOR ATTACH REF ARRAY ANCHORS_ARRAY
						ASSEMBLE PRT FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_FOR
			END_IF

			IF ANCHOR_MDL == "*conc*" AND ANCHOR_BOLTS == "YES"
				RETRIEVE_MDL bolt_ewa.prt PRT
				SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
					FOR ATTACH REF ARRAY ANCHORS_ARRAY
						ASSEMBLE PRT FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_FOR
			END_IF

						RETRIEVE_MDL DRAWING_ANCHOR.ASM SECTION
						GET_MDL_NAME SECTION SECTION_NAME
						INSERT_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM
						GET_REF_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM SECTION
						SET_MDL_PARAM SECTION "ANCHOR_CTR" -ANCHOR_CTR
						SET_MDL_PARAM SECTION "OFFSET" FR_THICKNESS + .03
						SEARCH_MDL_REF SECTION CSYS "PLACEMENT" ATTACH
						GET_MDL_NAME JAMB1 JAMB1_NAME
						INSERT_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM
						GET_REF_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM JAMB
						SEARCH_MDL_REF JAMB CSYS "PLACEMENT" PLACEMENT

						ASSEMBLE JAMB SECTION
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE

						SEARCH_MDL_REF SECTION CSYS "ACS0" ATTACH
						SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT

						ASSEMBLE ANCHOR SECTION
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE

						ASSEMBLE SECTION ASSEM
							PACKAGED
						END_ASSEMBLE

						SET_FEATURE_STATE SECTION SUPPRESSED

			! BEGIN TRANSOM FRAME ANCHORS PREPS
		IF FRAME_ELEVATION == 5
				DECLARE_ARRAY ANCHORS_ARRAY
				CLEAR_ARRAY ANCHORS_ARRAY
				DECLARE_VARIABLE 	INTEGER 	ANCHOR_INDEX
				ANCHOR_QTY = ceil((TRANSOM_HEIGHT + HEAD+ ANCHOR_JT_DIST - ANCHOR_JT_DIST)/ANCHOR_JMAX)
				ANCHOR_SPACING = (TRANSOM_HEIGHT +HEAD+ ANCHOR_JT_DIST - ANCHOR_JT_DIST) / ANCHOR_QTY
				SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 180
					UDF_DIM	ROTY 180
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX ((JOW/2) + FR_THICKNESS + .03)
					UDF_DIM	LOCY JOH - ANCHOR_JT_DIST + ANCHOR_SPACING
					UDF_DIM	LOCZ -TRANSOM_ANCHOR_CENTER
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

				ANCHOR_INDEX = 2
				WHILE ANCHOR_INDEX <= ANCHOR_QTY
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY -ANCHOR_SPACING
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
					ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

					ANCHOR_INDEX ++
				END_WHILE

				SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 180
					UDF_DIM	ROTY 180
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX -((JOW/2) + FR_THICKNESS + .03)
					UDF_DIM	LOCY JOH - ANCHOR_JT_DIST + ANCHOR_SPACING
					UDF_DIM	LOCZ -TRANSOM_ANCHOR_CENTER
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

				ANCHOR_INDEX = 2
				WHILE ANCHOR_INDEX <= ANCHOR_QTY
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY ANCHOR_SPACING
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
					ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH
					ANCHOR_INDEX ++
				END_WHILE

				IF ANCHOR_MDL == "*wire*" OR ANCHOR_MDL == "*loose_t*"
					RETRIEVE_MDL ANCHOR_MDL ANCHOR
				END_IF

				IF ANCHOR_MDL == "*stud*" OR TRANSOM_SECTION == SECTION
					SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							ASSEMBLE ANCHOR FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
						END_FOR
				END_IF

				IF TRANSOM_SECTION == SECTION AND ANCHOR_CTR == TRANSOM_ANCHOR_CENTER
					IF ANCHOR_MDL == "*pd*"
						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							CREATE_UDF udf\hole FRAME_ASM
								UDF_REF ATTACH ATTACH
								UDF_DIM	DIA .385
								UDF_DIM	DEPTH STOPP+.25
								UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF
						END_FOR
					END_IF

					IF ANCHOR_MDL == "*conc*"
						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							CREATE_UDF udf\hole FRAME_ASM
								UDF_REF ATTACH ATTACH
								UDF_DIM	DIA 1.015
								UDF_DIM	DEPTH STOPP+.25
								UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF
						END_FOR
					END_IF

					SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							ASSEMBLE ANCHOR FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
						END_FOR

					IF ANCHOR_MDL == "*pd*" AND ANCHOR_BOLTS == "YES"
						RETRIEVE_MDL bolt_pd.prt PRT
						SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
							FOR ATTACH REF ARRAY ANCHORS_ARRAY
								ASSEMBLE PRT FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
							END_FOR
					END_IF

					IF ANCHOR_MDL == "*conc*" AND ANCHOR_BOLTS == "YES"
						RETRIEVE_MDL bolt_ewa.prt PRT
						SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
							FOR ATTACH REF ARRAY ANCHORS_ARRAY
								ASSEMBLE PRT FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
							END_FOR
					END_IF
				END_IF

				IF TRANSOM_SECTION <> SECTION OR ANCHOR_CTR <> TRANSOM_ANCHOR_CENTER
					IF ANCHOR_MDL == "*pd*"
						CLEAR_ARRAY ARRAYITEMS
						DECLARE_VARIABLE INTEGER ARRAY_INDEX
						DECLARE_VARIABLE STRING NEW_VALUE
						RETRIEVE_MDL ANCHOR_MDL GENERIC
						GET_MDL_NAME GENERIC GENERIC_NAME
						SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
						INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "JD" JD
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "ANCHOR_CTR" TRANSOM_ANCHOR_CENTER
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FACEE" FACEE
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOPP" TRANSOM_STOPP
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
						GET_FAMITEMS GENERIC ARRAYITEMS
						GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
						ARRAY_INDEX = 0

						WHILE ARRAY_INDEX <= ARRAY_SIZE-1
							GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
							IF VALUE == "M*"
								NEW_VALUE = "FID:" + strmid(VALUE,1)
								SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
								GET_REF_GENERIC INST COMP_GENERIC
								GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
								INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_T_" + ITEM_NUM
								SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_T_" + ITEM_NUM
							END_IF
							ARRAY_INDEX ++
						END_WHILE

						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							CREATE_UDF udf\hole FRAME_ASM
								UDF_REF ATTACH ATTACH
								UDF_DIM	DIA .385
								UDF_DIM	DEPTH TRANSOM_STOPP+.25
								UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF
						END_FOR

						GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM ANCHOR
					END_IF

					IF ANCHOR_MDL == "*conc*"
						CLEAR_ARRAY ARRAYITEMS
						DECLARE_VARIABLE INTEGER ARRAY_INDEX
						DECLARE_VARIABLE STRING NEW_VALUE
						RETRIEVE_MDL ANCHOR_MDL GENERIC
						GET_MDL_NAME GENERIC GENERIC_NAME
						SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
						INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "JD" JD
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "ANCHOR_CTR" TRANSOM_ANCHOR_CENTER
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FACEE" FACEE
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOPP" TRANSOM_STOPP
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "SOFFIT" SOFFIT
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "GRADE"FRAME_GRADE
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "TYPE" MAT_TYPE
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FINISH" "2B"

						GET_FAMITEMS GENERIC ARRAYITEMS
						GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
						ARRAY_INDEX = 0

						WHILE ARRAY_INDEX <= ARRAY_SIZE-1
							GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
							IF VALUE == "M*"
								NEW_VALUE = "FID:" + strmid(VALUE,1)
								SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
								GET_REF_GENERIC INST COMP_GENERIC
								GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
								INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_T_" + ITEM_NUM
								SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_T_" + ITEM_NUM
							END_IF
							ARRAY_INDEX ++
						END_WHILE

						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							CREATE_UDF udf\hole FRAME_ASM
								UDF_REF ATTACH ATTACH
								UDF_DIM	DIA 1.015
								UDF_DIM	DEPTH TRANSOM_STOPP+.25
								UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF
						END_FOR

						GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM ANCHOR
					END_IF

					SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
						FOR ATTACH REF ARRAY ANCHORS_ARRAY
							ASSEMBLE ANCHOR FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
						END_FOR

					IF ANCHOR_MDL == "*pd*" AND ANCHOR_BOLTS == "YES"
						RETRIEVE_MDL bolt_pd.prt PRT
						SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
							FOR ATTACH REF ARRAY ANCHORS_ARRAY
								ASSEMBLE PRT FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
							END_FOR
					END_IF

					IF ANCHOR_MDL == "*conc*" AND ANCHOR_BOLTS == "YES"
						RETRIEVE_MDL bolt_ewa.prt PRT
						SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
							FOR ATTACH REF ARRAY ANCHORS_ARRAY
								ASSEMBLE PRT FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
							END_FOR
					END_IF
				END_IF

						! RETRIEVE_MDL DRAWING_ANCHOR.ASM SECTION
						! GET_MDL_NAME SECTION SECTION_NAME
						! INSERT_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM
						! GET_REF_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM SECTION
						! SET_MDL_PARAM SECTION "ANCHOR_CTR" -ANCHOR_CTR
						! SET_MDL_PARAM SECTION "OFFSET" FR_THICKNESS + .03
						! SEARCH_MDL_REF SECTION CSYS "PLACEMENT" ATTACH

						! GET_MDL_NAME JAMB1 JAMB1_NAME
						! INSERT_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM
						! GET_REF_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM JAMB
						! SEARCH_MDL_REF JAMB CSYS "PLACEMENT" PLACEMENT

						! ASSEMBLE JAMB SECTION
							! CSYS ATTACH PLACEMENT
						! END_ASSEMBLE

						! SEARCH_MDL_REF SECTION CSYS "ACS0" ATTACH
						! SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT

						! ASSEMBLE ANCHOR SECTION
							! CSYS ATTACH PLACEMENT
						! END_ASSEMBLE

						! ASSEMBLE SECTION ASSEM
							! PACKAGED
						! END_ASSEMBLE

						! SET_FEATURE_STATE SECTION SUPPRESSED
			END_IF

			! FLOOR CLIPS
			IF FLOOR_CLIPS <> "NONE"
				DECLARE_VARIABLE STRING FLOOR_CLIP_MDL
				FLOOR_CLIP_MDL = "floor_clip_" + mklower(FLOOR_CLIPS)

					USE_LIBRARY_MDL FLOOR_CLIP_MDL part PRT
					GET_MDL_NAME PRT PRT_NAME
					SEARCH_MDL_PARAM PRT "EMJACNUM" EMJACNUM
					INSERT_FAMINSTANCE PRT PRT_NAME +"_" + ITEM_NUM
					SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM

					SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "LENGTH" JD - RETURN - XRETURN + .1
					IF DW_RTRN == "IN"
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "WIDTH" FACEE - FR_THICKNESS - .53
					ELSE
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "WIDTH" FACEE - (FR_THICKNESS*2) - .12
					END_IF

					IF SECTION == 0
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOPP" 0
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RABBET" 1.75 - RETURN +.02
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "XRABBET" 1.75 - XRETURN +.02
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
					ELSE_IF SECTION == 1
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOPP" STOPP
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RABBET" RABBET - RETURN +.02
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "XRABBET" JD - RABBET - RETURN - .5
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
					ELSE_IF SECTION == 2
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOPP" 0
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RABBET" RABBET - RETURN +.02
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "XRABBET" XRABBET - XRETURN +.02
						SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
					END_IF

					GET_REF_FAMINSTANCE PRT PRT_NAME +"_"+ ITEM_NUM INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

						SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" ATTACH
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ((JOW/2) + FR_THICKNESS + .03)
							UDF_DIM	LOCY 0
							UDF_DIM	LOCZ -JD/2
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE

						SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" ATTACH
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 180
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) + FR_THICKNESS + .03)
							UDF_DIM	LOCY 0
							UDF_DIM	LOCZ -JD/2
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
			END_IF
			! END FRAME PREPS - FLOOR CLIPS & ANCHORS

		! FRAME CLOSERS
			DECLARE_VARIABLE INTEGER CLOSER_QTY 10
			DECLARE_VARIABLE INTEGER CLOSER_INDEX
			CLOSER_INDEX = 10

			IF SUB_TYPE == "S"
				CLOSER_QTY = 10
			ELSE_IF SUB_TYPE == "P"
				CLOSER_QTY = 20
			END_IF

			WHILE CLOSER_INDEX <= CLOSER_QTY

				IF (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA")) OR \
				  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
					CLOSER_TYPE_ =	CLOSER_TYPE_2
					CLOSER_SIDE_ =	CLOSER_SIDE_2
					CLOSER_DESC_ =	CLOSER_DESC_2
					SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH_2
					SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH_2
					CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER_2
					CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER_2
					HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER_2
					HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE_2
					HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL_2
				ELSE
					CLOSER_TYPE_ =	CLOSER_TYPE
					CLOSER_SIDE_ =	CLOSER_SIDE
					CLOSER_DESC_ =	CLOSER_DESC
					SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH
					SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH
					CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER
					CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER
					HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER
					HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE
					HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL
				END_IF

					DECLARE_VARIABLE INTEGER CLSR_INDEX
					CLSR_INDEX = CLOSER_INDEX + 1
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" CLSR_REF
					IF CLOSER_TYPE_ == "SURFACE" AND (CLOSER_SIDE_ == "PULL*" OR CLOSER_SIDE_ == "MULTI*")
						IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
						  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "LHA" OR HAND == "RHRA"))
							CREATE_UDF udf\csys FRAME_ASM
								UDF_REF ATTACH CLSR_REF
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
								UDF_DIM	LOCY JOH + (FACEE/2)
								UDF_DIM	LOCZ (JD/2) - .25
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							RETRIEVE_MDL SMCR.PRT SMCR
							GET_MDL_NAME SMCR SMCR_NAME
							INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" FACEE - .375
							GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
							SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
							CLSR_INDEX ++
						END_IF

						IF (SUB_TYPE == "S" AND (HAND <> "LH" AND HAND <> "RHR")) OR \
						  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "RHA" OR HAND == "LHRA"))
							CREATE_UDF udf\csys FRAME_ASM
								UDF_REF ATTACH CLSR_REF
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
								UDF_DIM	LOCY JOH + (FACEE/2)
								UDF_DIM	LOCZ (JD/2) - .25
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							RETRIEVE_MDL SMCR.PRT SMCR
							GET_MDL_NAME SMCR SMCR_NAME
							INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" FACEE - .375
							GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
							SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
							CLSR_INDEX ++
						END_IF
					END_IF
					IF CLOSER_INDEX == 10 AND CLOSER_TYPE_ == "OPERATOR" AND (CLOSER_SIDE_ == "PULL*" OR CLOSER_SIDE_ == "MULTI*")
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX 0
							UDF_DIM	LOCY JOH + (FACEE/2)
							UDF_DIM	LOCZ (JD/2) - .25
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
							GET_MDL_NAME SMCR SMCR_NAME
							INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" FACEE - .375
							GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
							SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
							CLSR_INDEX ++
					END_IF
					IF SECTION == 1
						IF CLOSER_TYPE_ == "SURFACE" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
							IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
									UDF_DIM	LOCY (JOH-HEAD_STOPP) + (XFACEE/2)
									UDF_DIM	LOCZ -((JD/2) - .25)
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++

								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 90
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2) - STOPP)
									UDF_DIM	LOCY JOH-HEAD_STOPP+.25
									UDF_DIM	LOCZ -((JD/2) - (SOFFIT/2))
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++
							END_IF
							IF (SUB_TYPE == "S" AND (HAND <> "LH" AND HAND <> "RHR")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
									UDF_DIM	LOCY (JOH-HEAD_STOPP) + (XFACEE/2)
									UDF_DIM	LOCZ -((JD/2) - .25)
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++

								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 90
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH/_2) - STOPP)
									UDF_DIM	LOCY jOH-HEAD_STOPP+ .25
									UDF_DIM	LOCZ -((JD/2) - (SOFFIT/2))
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++
							END_IF
						END_IF
						IF CLOSER_INDEX == 10 AND CLOSER_TYPE_ == "OPERATOR" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
							CREATE_UDF udf\csys FRAME_ASM
								UDF_REF ATTACH CLSR_REF
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX 0
								UDF_DIM	LOCY (JOH-HEAD_STOPP) + (XFACEE/2)
								UDF_DIM	LOCZ -((JD/2) - .25)
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							RETRIEVE_MDL SMCR.PRT SMCR
							GET_MDL_NAME SMCR SMCR_NAME
							INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW - (2*STOPP)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
							GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
							SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
							CLSR_INDEX ++

							CREATE_UDF udf\csys FRAME_ASM
								UDF_REF ATTACH CLSR_REF
								UDF_DIM	ROTX 90
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX 0
								UDF_DIM	LOCY JOH-STOPP+.25
								UDF_DIM	LOCZ -((JD/2) - (SOFFIT/2))
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							RETRIEVE_MDL SMCR.PRT SMCR
							GET_MDL_NAME SMCR SMCR_NAME
							INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW - (STOPP*2)
							SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
							GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
							SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
							CLSR_INDEX ++
						END_IF
					END_IF
					IF SECTION == 2
						IF CLOSER_TYPE_ == "SURFACE" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
							IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "LHA" OR HAND == "RHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
									UDF_DIM	LOCY JOH + (XFACEE/2)
									UDF_DIM	LOCZ -((JD/2) - .25)
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++

								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 90
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2) - STOPP)
									UDF_DIM	LOCY JOH - HEAD_STOPP + .25
									UDF_DIM	LOCZ -((JD/2) - XRABBET - (SOFFIT/2))
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++
							END_IF
							IF (SUB_TYPE == "S" AND (HAND <> "LH" AND HAND <> "RHR")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "RHA" OR HAND == "LHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
									UDF_DIM	LOCY JOH + (XFACEE/2)
									UDF_DIM	LOCZ -((JD/2) - .25)
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++

								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH CLSR_REF
									UDF_DIM	ROTX 90
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2) - STOPP)
									UDF_DIM	LOCY jOH - HEAD_STOPP + .25
									UDF_DIM	LOCZ -((JD/2) - XRABBET - (SOFFIT/2))
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++
							END_IF
						END_IF

						IF CLOSER_INDEX == 10 AND CLOSER_TYPE_ == "OPERATOR" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
							CREATE_UDF udf\csys FRAME_ASM
								UDF_REF ATTACH CLSR_REF
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX 0
								UDF_DIM	LOCY JOH + (XFACEE/2)
								UDF_DIM	LOCZ -((JD/2) - .25)
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++

							CREATE_UDF udf\csys FRAME_ASM
								UDF_REF ATTACH CLSR_REF
								UDF_DIM	ROTX 90
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX 0
								UDF_DIM	LOCY JOH - HEAD_STOPP + .25
								UDF_DIM	LOCZ -((JD/2) - XRABBET -(SOFFIT/2))
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

								RETRIEVE_MDL SMCR.PRT SMCR
								GET_MDL_NAME SMCR SMCR_NAME
								INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW - (2*STOPP)
								SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
								GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE INST FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
								CLSR_INDEX ++
						END_IF
					END_IF

					IF CLOSER_TYPE_ == "HOLDER" AND HOLDER_STOP_MANUFACTURER_ == "ABH"
						IF HOLDER_STOP_TYPE_ == "SURFACE"
							SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
							SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
							DECLARE_VARIABLE DOUBLE BU_WIDTH

							IF SOFFIT - FR_THICKNESS - FR_THICKNESS - .12 < 1.5
								BU_WIDTH = SOFFIT - FR_THICKNESS - FR_THICKNESS - .12
							ELSE
								BU_WIDTH = 1.5
							END_IF

							IF (SUB_TYPE == "S" AND (HAND <> "RHR" AND HAND <> "LH")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH ASM_CSYS
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -((JOW/2) - STOPP)
									UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
									UDF_DIM	LOCZ (JD/2) - RABBET - (BU_WIDTH/2) - FR_THICKNESS - .06
									UDF_EXP_REF refCsys CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL BU_FLAT.PRT BU
								GET_MDL_NAME BU BU_NAME
								SEARCH_MDL_PARAM BU "EMJACNUM" EMJACNUM
								INSERT_FAMINSTANCE BU BU_NAME +"_HS1_" + ITEM_NUM
								SET_FAMITEM_VALUE BU BU_NAME +"_HS1_" + ITEM_NUM "STOCKTYPE" 1
								SET_FAMITEM_VALUE BU BU_NAME +"_HS1_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-1-" + ITEM_NUM
								SET_FAMITEM_VALUE BU BU_NAME + "_HS1_" + ITEM_NUM "LENGTH" ABH_DIM_B + 4.5
								SET_FAMITEM_VALUE BU BU_NAME + "_HS1_" + ITEM_NUM "WIDTH" 1.5
								SET_FAMITEM_VALUE BU BU_NAME + "_HS1_" + ITEM_NUM "SMT_THICKNESS" .105
								GET_REF_FAMINSTANCE BU BU_NAME + "_HS1_" + ITEM_NUM INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT3" PLACEMENT3
								ASSEMBLE INST FRAME_ASM
									CSYS refCsys PLACEMENT3
								END_ASSEMBLE
							END_IF

							IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH ASM_CSYS
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 180
									UDF_DIM	LOCX ((JOW/2) - STOPP)
									UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
									UDF_DIM	LOCZ (JD/2) - RABBET - (BU_WIDTH/2) - FR_THICKNESS - .06
									UDF_EXP_REF refCsys CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL BU_FLAT.PRT BU
								GET_MDL_NAME BU BU_NAME
								SEARCH_MDL_PARAM BU "EMJACNUM" EMJACNUM
								INSERT_FAMINSTANCE BU BU_NAME + "_HS2_" + ITEM_NUM
								SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "STOCKTYPE" 1
								SET_FAMITEM_VALUE BU BU_NAME +"_HS2_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-2-" + ITEM_NUM
								SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "LENGTH" ABH_DIM_B + 4.5
								SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "WIDTH" 1.5
								SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "SMT_THICKNESS" .105
								GET_REF_FAMINSTANCE BU BU_NAME + "_HS2_" + ITEM_NUM INST
								SEARCH_MDL_REF INST CSYS "PLACEMENT3" PLACEMENT3
								ASSEMBLE INST FRAME_ASM
									CSYS refCsys PLACEMENT3
								END_ASSEMBLE
							END_IF
						END_IF

						IF HOLDER_STOP_TYPE_ == "CONCEALED"
							SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
							SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

							IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH ASM_CSYS
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -(JOW/2)
									UDF_DIM	LOCY JOH + FR_THICKNESS + .1
									UDF_DIM	LOCZ (JD/2) - (RABBET/2)
									UDF_EXP_REF refCsys CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH refCsys
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX ABH_DIM_B + 1.4375 + (HINGE_GAP/2)
									UDF_DIM	LOCY -.1
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\rect_cut FRAME_ASM
									UDF_REF ATTACH ATTACH
									UDF_DIM	DIMY .25
									UDF_DIM	DIMZ .765
									UDF_DIM	DIMX 2.89
									UDF_INTERSECTION * PART_LEVEL
								END_CREATE_UDF

								RETRIEVE_MDL HOLDER_STOP_ASM.ASM BU
								SEARCH_MDL_REF BU CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE BU FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
							END_IF

							IF (SUB_TYPE == "S" AND (HAND <> "RHR" AND HAND <> "LH")) OR \
							  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH ASM_CSYS
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 180
									UDF_DIM	LOCX (JOW/2)
									UDF_DIM	LOCY JOH + FR_THICKNESS + .1
									UDF_DIM	LOCZ (JD/2) - (RABBET/2)
									UDF_EXP_REF refCsys CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys FRAME_ASM
									UDF_REF ATTACH refCsys
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 180
									UDF_DIM	LOCX ABH_DIM_B + 1.4375 + (HINGE_GAP/2)
									UDF_DIM	LOCY .1
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\rect_cut FRAME_ASM
									UDF_REF ATTACH ATTACH
									UDF_DIM	DIMY .25
									UDF_DIM	DIMZ .765
									UDF_DIM	DIMX 2.89
									UDF_INTERSECTION * PART_LEVEL
								END_CREATE_UDF

								RETRIEVE_MDL HOLDER_STOP_ASM.ASM BU
								SEARCH_MDL_REF BU CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE BU FRAME_ASM
									CSYS ATTACH PLACEMENT
								END_ASSEMBLE
							END_IF
						END_IF
					END_IF
				CLOSER_INDEX = CLOSER_INDEX + 10
			END_WHILE
		!END FRAME CLOSERS
		! EXIT
		!FRAME DPS
			! IF DPS_MODEL <> ""
				! SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
				! SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

				! IF DPS_POSITION == "HEAD"
					! IF HAND == "LHR" OR HAND == "RH"
						! CREATE_UDF udf\csys FRAME_ASM
							! UDF_REF ATTACH ASM_CSYS
							! UDF_DIM	ROTX 0
							! UDF_DIM	ROTY 0
							! UDF_DIM	ROTZ 90
							! UDF_DIM	LOCX (JOW/2) - DPS_LOCATION - STRIKE_GAP
							! UDF_DIM	LOCY JOH
							! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
							! UDF_EXP_REF refCsys CSYS 0
						! END_CREATE_UDF

						! CREATE_UDF udf\hole FRAME_ASM
							! UDF_REF ATTACH refCsys
							! UDF_DIM	DIA DPS_HOLE_DIA
							! UDF_DIM	DEPTH 1
							! UDF_INTERSECTION * PART_LEVEL
						! END_CREATE_UDF
					! END_IF

					! IF HAND == "RHR" OR HAND == "LH"
						! CREATE_UDF udf\csys FRAME_ASM
							! UDF_REF ATTACH ASM_CSYS
							! UDF_DIM	ROTX 0
							! UDF_DIM	ROTY 0
							! UDF_DIM	ROTZ 90
							! UDF_DIM	LOCX -((JOW/2) - DPS_LOCATION - STRIKE_GAP)
							! UDF_DIM	LOCY JOH
							! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
							! UDF_EXP_REF refCsys CSYS 0
						! END_CREATE_UDF

						! CREATE_UDF udf\hole FRAME_ASM
							! UDF_REF ATTACH refCsys
							! UDF_DIM	DIA DPS_HOLE_DIA
							! UDF_DIM	DEPTH 1
							! UDF_INTERSECTION * PART_LEVEL
						! END_CREATE_UDF
					! END_IF

					! IF SUB_TYPE == "P"
						! CREATE_UDF udf\csys FRAME_ASM
							! UDF_REF ATTACH DOOR_CTR_CSYS
							! UDF_DIM	ROTX 0
							! UDF_DIM	ROTY 0
							! UDF_DIM	ROTZ 90
							! UDF_DIM	LOCX  -(DPS_LOCATION + (STRIKE_GAP/2))
							! UDF_DIM	LOCY JOH
							! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
							! UDF_EXP_REF refCsys CSYS 0
						! END_CREATE_UDF

						! CREATE_UDF udf\hole FRAME_ASM
							! UDF_REF ATTACH refCsys
							! UDF_DIM	DIA DPS_HOLE_DIA
							! UDF_DIM	DEPTH 1
							! UDF_INTERSECTION * PART_LEVEL
						! END_CREATE_UDF


						! CREATE_UDF udf\csys FRAME_ASM
							! UDF_REF ATTACH ASM_CSYS
							! UDF_DIM	ROTX 0
							! UDF_DIM	ROTY 0
							! UDF_DIM	ROTZ 90
							! UDF_DIM	LOCX (DPS_LOCATION + (STRIKE_GAP/2))
							! UDF_DIM	LOCY JOH
							! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
							! UDF_EXP_REF refCsys CSYS 0
						! END_CREATE_UDF

						! CREATE_UDF udf\hole FRAME_ASM
							! UDF_REF ATTACH refCsys
							! UDF_DIM	DIA DPS_HOLE_DIA
							! UDF_DIM	DEPTH 1
							! UDF_INTERSECTION * PART_LEVEL
						! END_CREATE_UDF
					! END_IF
				! END_IF
			! END_IF

		! BEGIN FRAME PREPS - SPREADER

			USE_LIBRARY_MDL spreader part PRT
			GET_MDL_NAME PRT PRT_NAME
			SEARCH_MDL_PARAM PRT "EMJACNUM" EMJACNUM
			INSERT_FAMINSTANCE PRT PRT_NAME +"_1_"+ ITEM_NUM
			SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "EMJACNUM" EMJACNUM +"-"+ ftos(JOW + (FACEE*2) - .25)

				IF FLOOR_CLIPS == "FIXED" OR FLOOR_CLIPS == "ADJUSTABLE"
					SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "LENGTH" JOW + (FACEE*2) - .25 - (ANCHOR_RECESS*2)
				ELSE_IF FLOOR_CLIPS == "NONE"
					SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "LENGTH" JOW
				END_IF

			GET_REF_FAMINSTANCE PRT PRT_NAME +"_1_"+ ITEM_NUM INST
			SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

				SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 180
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ -JD
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

			IF SECTION == 1 AND HOSPITAL_STOPS == "NO"
				USE_LIBRARY_MDL spreader part PRT
				GET_MDL_NAME PRT PRT_NAME
				INSERT_FAMINSTANCE PRT PRT_NAME +"_2_"+ ITEM_NUM
				SET_FAMITEM_VALUE PRT PRT_NAME +"_2_"+ ITEM_NUM "STOCKTYPE" 1

				IF FLOOR_CLIPS == "FIXED" OR FLOOR_CLIPS == "ADJUSTABLE"
					SET_FAMITEM_VALUE PRT PRT_NAME +"_2_"+ ITEM_NUM "LENGTH" JOW + (FACEE*2) - .25 - (ANCHOR_RECESS*2)
				ELSE_IF FLOOR_CLIPS == "NONE"
					SET_FAMITEM_VALUE PRT PRT_NAME +"_2_"+ ITEM_NUM "LENGTH" JOW - STOPP - STOPP
				END_IF

				GET_REF_FAMINSTANCE PRT PRT_NAME +"_2_"+ ITEM_NUM INST
				SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
			END_IF

				ASSEMBLE INST FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF

		IF DOOR_ITEM_DESC == "DOOR"
			IF DOOR_GAUGE == 18
				SM_THICK = .05
				HINGE_UDF = "STD"
			ELSE_IF DOOR_GAUGE == 16
				SM_THICK = .06
				HINGE_UDF = "STD"
			ELSE_IF DOOR_GAUGE == 14
				SM_THICK = .075
				HINGE_UDF = "STD"
			ELSE_IF DOOR_GAUGE == 12
				SM_THICK = .105
				HINGE_UDF = "12GA"
			END_IF

			DOOR_HEIGHT = JOH - TOP_GAP - UNDERCUT

			IF SUB_TYPE == "S"
				DOOR_QTY = 1
				DOOR_WIDTH = JOW - HINGE_GAP - STRIKE_GAP
				HAND_ = HAND
			ELSE_IF SUB_TYPE == "P"
				DOOR_QTY = 2
			END_IF

			DOOR_INDEX = 1
			WHILE DOOR_INDEX <= DOOR_QTY

				SEARCH_MDL_REF ASSEM CSYS "DOOR" ATTACH

				IF DOOR_QTY == 2 AND DOOR_INDEX == 1
					IF ACTIVE_LEAF < 1 OR ACTIVE_LEAF == JOW/2 OR ACTIVE_LEAF == 99
						DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
					ELSE_IF HAND == "LHA" OR HAND == "LHRA"
						DOOR_WIDTH = (ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2))
					ELSE_IF HAND == "RHA" OR HAND == "RHRA"
						DOOR_WIDTH = JOW - ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2)
					ELSE
						DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
					END_IF

					IF HAND == "LH/RH"
						HAND_ = "LH1"
					ELSE_IF HAND == "LHA"
						HAND_ = "LHA1"
					ELSE_IF HAND == "RHA"
						HAND_ = "LHI1"
					ELSE_IF HAND == "LHR/RHR"
						HAND_ = "LHR1"
					ELSE_IF HAND == "LHRA"
						HAND_ = "LHRA1"
					ELSE_IF HAND == "RHRA"
						HAND_ = "LHRI1"
					END_IF

					CREATE_UDF udf\csys ASSEM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -((JOW/2) - HINGE_GAP - (DOOR_WIDTH/2))
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				ELSE_IF DOOR_QTY == 2 AND DOOR_INDEX == 2
					IF ACTIVE_LEAF < 1 OR ACTIVE_LEAF == JOW/2 OR ACTIVE_LEAF == 99
						DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
					ELSE_IF HAND == "LHA" OR HAND == "LHRA"
						DOOR_WIDTH = JOW - ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2)
					ELSE_IF HAND == "RHA" OR HAND == "RHRA"
						DOOR_WIDTH = (ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2))
					ELSE
						DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
					END_IF

					IF HAND == "LH/RH"
						HAND_ = "RH2"
					ELSE_IF HAND == "LHA"
						HAND_ = "RHI2"
					ELSE_IF HAND == "RHA"
						HAND_ = "RHA2"
					ELSE_IF HAND == "LHR/RHR"
						HAND_ = "RHR2"
					ELSE_IF HAND == "LHRA"
						HAND_ = "RHRI2"
					ELSE_IF HAND == "RHRA"
						HAND_ = "RHRA2"
					END_IF

					CREATE_UDF udf\csys ASSEM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX ((JOW/2) - HINGE_GAP - (DOOR_WIDTH/2))
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				RETRIEVE_MDL DOOR_S.ASM DOOR_ASM

				! SEARCH_MDL_REF ASSEM CSYS "DOOR" ATTACH
				SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
					ASSEMBLE DOOR_ASM ASSEM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				SET_MDL_NAME DOOR_ASM "DOOR_ASM_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*DOOR_ASM_"+itos(DOOR_INDEX)+"_*" DOOR_ASM
				REGEN_MDL ASSEM

				SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
				SET_MDL_NAME BODY "BODY_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "BODY_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM BODY
				SET_MDL_PARAM BODY "FINISH" BODY_SIDE_FINISH
				SET_MDL_PARAM BODY "GRADE" DOOR_GRADE
				SET_MDL_PARAM BODY "EMJACNUM" "BODY_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

				SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
				SET_MDL_NAME COVER "COVER_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM
				SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "COVER_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM COVER
				SET_MDL_PARAM COVER "FINISH" COVER_SIDE_FINISH
				SET_MDL_PARAM COVER "GRADE" DOOR_GRADE
				SET_MDL_PARAM COVER "EMJACNUM" "COVER_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

				SET_MDL_PARAM DOOR_ASM "CUSTOMER_NAME" CUSTOMER_NAME
				SET_MDL_PARAM DOOR_ASM "JOB_NAME" JOB_NAME
				SET_MDL_PARAM DOOR_ASM "SO_NUM" SO_NUM

				SET_MDL_PARAM DOOR_ASM "SUB_JOB_NAME" SUB_JOB_NAME
				SET_MDL_PARAM DOOR_ASM "ITEM_NUM" ITEM_NUM
				SET_MDL_PARAM DOOR_ASM "QTY" QTY
				SET_MDL_PARAM DOOR_ASM "ITEM_DESC" DOOR_ITEM_DESC

				SET_MDL_PARAM DOOR_ASM "DOOR_WIDTH" DOOR_WIDTH
				SET_MDL_PARAM DOOR_ASM "DOOR_HEIGHT" DOOR_HEIGHT
				SET_MDL_PARAM DOOR_ASM "HAND" HAND_
				SET_MDL_PARAM DOOR_ASM "UNDERCUT" UNDERCUT
				SET_MDL_PARAM DOOR_ASM "DR_THICKNESS" DOOR_THICKNESS
				SET_MDL_PARAM DOOR_ASM "SM_THICK" SM_THICK

				IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
					HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
					HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

					IF HINGE_EDGE_SHAPE == "BEVEL"
						SET_MDL_PARAM DOOR_ASM "BEVEL1" 4
					ELSE_IF HINGE_EDGE_SHAPE == "SQUARE"
						SET_MDL_PARAM DOOR_ASM "BEVEL1" 0
					END_IF
					IF STRIKE_EDGE_SHAPE == "BEVEL"
						SET_MDL_PARAM DOOR_ASM "BEVEL2" -4
					ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
						SET_MDL_PARAM DOOR_ASM "BEVEL2" 0
					END_IF
				END_IF

				IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
					HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
					HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

					IF HINGE_EDGE_SHAPE == "BEVEL"
						SET_MDL_PARAM DOOR_ASM "BEVEL2" -4
					ELSE_IF HINGE_EDGE_SHAPE == "SQUARE"
						SET_MDL_PARAM DOOR_ASM "BEVEL2" 0
					END_IF
					IF STRIKE_EDGE_SHAPE == "BEVEL"
						SET_MDL_PARAM DOOR_ASM "BEVEL1" 4
					ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
						SET_MDL_PARAM DOOR_ASM "BEVEL1" 0
					END_IF
				END_IF

				REGEN_MDL ASSEM

				IF DOOR_CONSTRUCTION == "SEAMLESS"
					SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
					SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_2" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
					SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_2" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_1" refFeat
					SET_FEATURE_STATE refFeat RESUMED
				ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
					SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
					SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "LOCKSEAM_1" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "LOCKSEAM_2" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
					SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "LOCKSEAM_1" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "LOCKSEAM_2" refFeat
					SET_FEATURE_STATE refFeat RESUMED
				ELSE_IF DOOR_CONSTRUCTION == "BULLNOSE"
					SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
					SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BULLNOSE_1" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BULLNOSE_2" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
					SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BULLNOSE_1" refFeat
					SET_FEATURE_STATE refFeat RESUMED
					SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BULLNOSE_2" refFeat
					SET_FEATURE_STATE refFeat RESUMED
				END_IF

				REGEN_MDL ASSEM

				! IF DOOR_LITE == 2 OR (HAND_ == "*A*" AND DOOR_LITE == 0) OR (HAND_ == "*I*" AND DOOR_LITE == 1)
					! IF DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "G"
						! SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
						! DECLARE_VARIABLE DOUBLE LOCX
						! IF DOOR_ELEVATION == "N" AND HAND_ == "L*"
							! LOCX = (DOOR_WIDTH/2) - VISION_STRIKE_STILE - (VISION_WIDTH/2)
						! ELSE_IF DOOR_ELEVATION == "N" AND HAND_ == "R*"
							! LOCX = -(DOOR_WIDTH /2) + VISION_STRIKE_STILE + (VISION_WIDTH/2)
						! ELSE_IF DOOR_ELEVATION == "G"
							! LOCX = 0
						! END_IF

						! CREATE_UDF udf\csys DOOR_ASM
							! UDF_REF ATTACH ASM_CSYS
							! UDF_DIM	ROTX 0
							! UDF_DIM	ROTY 0
							! UDF_DIM	ROTZ 0
							! UDF_DIM	LOCX LOCX
							! UDF_DIM	LOCY VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
							! UDF_DIM	LOCZ 0
							! UDF_EXP_REF ATTACH CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF	udf\opening DOOR_ASM
							! UDF_REF ATTACH ATTACH
							! UDF_DIM DEPTH DOOR_THICKNESS + .25
							! UDF_DIM WIDTH VISION_WIDTH + 2
							! UDF_DIM HEIGHT VISION_HEIGHT + 2
							! UDF_INTERSECTION * PART_LEVEL
						! END_CREATE_UDF

						! RETRIEVE_MDL VISION_KIT_TYPE_B.ASM LITE
						! SEARCH_MDL_REF LITE CSYS "PLACEMENT" PLACEMENT
							! ASSEMBLE LITE DOOR_ASM
								! CSYS ATTACH PLACEMENT
							! END_ASSEMBLE

						! SET_MDL_PARAM LITE "VISION_WIDTH" VISION_WIDTH
						! SET_MDL_PARAM LITE "VISION_HEIGHT" VISION_HEIGHT
						! SET_MDL_PARAM LITE "GLASS_THICK" GLASS_THICKNESS
						! SET_MDL_PARAM LITE "TRIM_GA" .05
						! SET_MDL_PARAM LITE "MAX_CTR" 8.0
						! SET_MDL_PARAM LITE "DOOR_THICK" DOOR_THICKNESS
						! SET_MDL_PARAM LITE "GLAZING_SPACE" .09375
						! SET_MDL_PARAM LITE "HOLE_OFFSET" .075

						! IF FIRE_RATING > 0
							! SET_MDL_PARAM LITE "FIXED_TABS" "YES"
						! ELSE
							! SET_MDL_PARAM LITE "FIXED_TABS" "NO"
						! END_IF
					! END_IF
				! END_IF

				IF DOOR_LITE == 2 OR (HAND_ == "*A*" AND DOOR_LITE == 0) OR (HAND_ == "*I*" AND DOOR_LITE == 1)
					IF DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "G"
						SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
						DECLARE_VARIABLE DOUBLE LOCX
						IF DOOR_ELEVATION == "N" AND HAND_ == "L*"
							LOCX = (DOOR_WIDTH/2) - VISION_STRIKE_STILE - (VISION_WIDTH/2)
						ELSE_IF DOOR_ELEVATION == "N" AND HAND_ == "R*"
							LOCX = -(DOOR_WIDTH /2) + VISION_STRIKE_STILE + (VISION_WIDTH/2)
						ELSE_IF DOOR_ELEVATION == "G"
							LOCX = 0
						END_IF

						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX LOCX
							UDF_DIM	LOCY VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
						CREATE_UDF	udf\opening DOOR_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM DEPTH DOOR_THICKNESS + .25
							UDF_DIM WIDTH VISION_WIDTH + 2
							UDF_DIM HEIGHT VISION_HEIGHT + 2
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						RETRIEVE_MDL VISION_KIT_TYPE_B.ASM LITE
						RETRIEVE_MDL VISION_OS.PRT VKO
						RETRIEVE_MDL VISION_IS.PRT VKI
						RETRIEVE_MDL LITE_BLOCK.PRT LB
						INSERT_FAMINSTANCE VKO "VKOH_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						INSERT_FAMINSTANCE VKO "VKOV_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						INSERT_FAMINSTANCE VKI "VKIH_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						INSERT_FAMINSTANCE VKI "VKIV_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						INSERT_FAMINSTANCE LB "LB_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

						INSERT_FAMINSTANCE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "VISION_WIDTH" VISION_WIDTH
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "VISION_HEIGHT" VISION_HEIGHT
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "GLASS_THICK" GLASS_THICKNESS
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "TRIM_GA" .05
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "MAX_CTR" 8.0
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "DOOR_THICK" DOOR_THICKNESS
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "GLAZING_SPACE" .09375
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "HOLE_OFFSET" .075
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "GRADE" DOOR_GRADE
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "FINISH" BODY_SIDE_FINISH
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M39"  "VKOH_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M42"  "VKOH_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M53"  "VKOV_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M68"  "VKOV_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M75"  "VKIH_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M345" "VKIH_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M360" "VKIV_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M367" "VKIV_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
						SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "M490" "LB_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

						IF FIRE_RATING > 0
							SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "FIXED_TABS" "YES"
						ELSE
							SET_FAMITEM_VALUE LITE "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "FIXED_TABS" "NO"
						END_IF


						DECLARE_VARIABLE STRING LITE_INST
						LITE_INST = "VK_B_"+itos(DOOR_INDEX)+"_"+ITEM_NUM+"<VISION_KIT_TYPE_B>"+".ASM"

						RETRIEVE_MDL LITE_INST LITE
						SEARCH_MDL_REF LITE CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE LITE DOOR_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE

						IF FIRE_RATING > 0
							SET_MDL_PARAM LITE "FIXED_TABS" "YES"
						ELSE
							SET_MDL_PARAM LITE "FIXED_TABS" "NO"
						END_IF
					END_IF
				END_IF

				IF SUB_TYPE == "P" AND ASTRAGAL == "YES"	AND (HAND_ == "LHRA1" OR 	HAND_ == "RHRA2")
					IF	HAND_ == "LHRA1"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX .125
							UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2)
							UDF_DIM	LOCZ 1
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
					END_IF

					IF	HAND_ == "RHRA2"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX .125
							UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2)
							UDF_DIM	LOCZ -1
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
					END_IF

					RETRIEVE_MDL ASTRAGAL.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					INSERT_FAMINSTANCE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" DOOR_HEIGHT
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" ASTRAGAL_WIDTH
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FINISH" BODY_SIDE_FINISH
					GET_REF_FAMINSTANCE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
					REPLACE_COMPONENT COMP INST
				END_IF

				IF SUB_TYPE == "P" AND ASTRAGAL == "YES"	AND (HAND_ == "LHA1" OR 	HAND_ == "RHA2")
					IF	HAND_ == "RHA2"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 180
							UDF_DIM	LOCX .125
							UDF_DIM	LOCY UNDERCUT + ((DOOR_HEIGHT-STOPP)/2)
							UDF_DIM	LOCZ -1
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
					END_IF

					IF	HAND_ == "LHA1"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 180
							UDF_DIM	LOCX .125
							UDF_DIM	LOCY UNDERCUT + ((DOOR_HEIGHT-STOPP)/2)
							UDF_DIM	LOCZ 1
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
					END_IF

					RETRIEVE_MDL ASTRAGAL.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					INSERT_FAMINSTANCE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" DOOR_HEIGHT - STOPP
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" ASTRAGAL_WIDTH
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
					SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FINISH" COVER_SIDE_FINISH
					GET_REF_FAMINSTANCE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
					REPLACE_COMPONENT COMP INST
				END_IF

				IF HINGE_TYPE == "BUTT"
					DECLARE_VARIABLE STRING LOOKUPSTRINGNO
									LOOKUPSTRINGNO = "HINGE_HEIGHT == " + ftos(HINGE_HEIGHT,3) + " AND HINGE_THICKNESS == " + ftos(HINGE_THICKNESS,3) + \
									 " AND DR_GA == " + ftos(SM_THICK,3) + " AND GRADE == " + DOOR_GRADE + " AND ELEC == 0"
					DECLARE_VARIABLE STRING LOOKUPSTRINGYES
									LOOKUPSTRINGYES = "HINGE_HEIGHT == " + ftos(HINGE_HEIGHT,3) + " AND HINGE_THICKNESS == " + ftos(HINGE_THICKNESS,3)	 + \
									" AND DR_GA == " + ftos(SM_THICK,3) + " AND GRADE == " + DOOR_GRADE	+ " AND ELEC == 1"

				IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
						HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
						HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS11" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ 0
						UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF

							HINGE_INDEX = 1
						FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
							CREATE_UDF udf\door_hinge DOOR_ASM
							UDF_INSTANCE HINGE_UDF
							UDF_REF ATTACH refCsys
							UDF_DIM LOCY -LOCY
							UDF_DIM DIMY HINGE_HEIGHT + .02
							UDF_DIM DIMZ SM_THICK - .0625 + DOOR_THICKNESS - DOOR_HINGE_SETBACK
							UDF_DIM DIMX -(HINGE_THICKNESS+.03)
							UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
							UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF

							RETRIEVE_MDL door_hinge_asm.asm HINGE_ASM
							SEARCH_MDL_REF HINGE_ASM CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE HINGE_ASM DOOR_ASM
								CSYS LOC+itos(HINGE_INDEX) PLACEMENT
							END_ASSEMBLE

							IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
								LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGYES instance_name
								GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
								REPLACE_COMPONENT HINGE_ASM instance

							ELSE
								LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGNO instance_name
								GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
								REPLACE_COMPONENT HINGE_ASM instance
							END_IF

							REGEN_MDL DOOR_ASM
							COPY_REF LOC+itos(HINGE_INDEX) DIM_REF
							HINGE_INDEX ++
						END_FOR
					END_IF

					IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
						HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
						HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS12" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY -JOH
						UDF_DIM	LOCZ 0
						UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF

							HINGE_INDEX = 1
						FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
							CREATE_UDF udf\door_hinge DOOR_ASM
							UDF_INSTANCE HINGE_UDF
							UDF_REF ATTACH refCsys
							UDF_DIM LOCY LOCY
							UDF_DIM DIMY HINGE_HEIGHT + .02
							UDF_DIM DIMZ SM_THICK - .0625 + DOOR_THICKNESS - DOOR_HINGE_SETBACK
							UDF_DIM DIMX -(HINGE_THICKNESS+.03)
							UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
							UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF

							RETRIEVE_MDL door_hinge_asm.asm HINGE_ASM
							SEARCH_MDL_REF HINGE_ASM CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE HINGE_ASM DOOR_ASM
								CSYS LOC+itos(HINGE_INDEX) PLACEMENT
							END_ASSEMBLE

							IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
								LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGYES instance_name
								GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
								REPLACE_COMPONENT HINGE_ASM instance
							ELSE
								LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGNO instance_name
								GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
								REPLACE_COMPONENT HINGE_ASM instance
							END_IF

							REGEN_MDL DOOR_ASM
							COPY_REF LOC+itos(HINGE_INDEX) DIM_REF
							HINGE_INDEX ++
						END_FOR
					END_IF
				END_IF
			! END DOOR BUTT HINGE PREPS

			! BEGIN DOOR PREPS - CONTINUOUS HINGE
				IF HINGE_TYPE == "CONTINUOUS"

					DECLARE_VARIABLE DOUBLE BU_WIDTH
					DECLARE_VARIABLE DOUBLE BU_LOC

					IF DOOR_CONSTRUCTION == "SEAMLESS"
						BU_WIDTH = DOOR_THICKNESS - .25
						BU_LOC = SM_THICK - .0625 + (DOOR_THICKNESS/2)
					ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
						BU_WIDTH = DOOR_THICKNESS - .4375
						BU_LOC = (SM_THICK - .0625 + (DOOR_THICKNESS/2)) - .09375
					END_IF

					IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
						HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
						HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS11" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -SM_THICK
							UDF_DIM	LOCY JOH - TOP_GAP
							UDF_DIM	LOCZ BU_LOC
							UDF_EXP_REF ASM_CSYS CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL BU_FLAT.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE COMP DOOR_ASM
							 CSYS ASM_CSYS PLACEMENT
						END_ASSEMBLE

						INSERT_FAMINSTANCE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
						SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" JOH - TOP_GAP - UNDERCUT
						SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" BU_WIDTH
						SET_FAMITEM_VALUE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "SMT_THICKNESS" .105
						GET_REF_FAMINSTANCE COMP "COMP_1_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
						REPLACE_COMPONENT COMP INST
					END_IF

					IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
						HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
						HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS12" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -SM_THICK
							UDF_DIM	LOCY -UNDERCUT
							UDF_DIM	LOCZ BU_LOC
							UDF_EXP_REF ASM_CSYS CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL BU_FLAT.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE COMP DOOR_ASM
							 CSYS ASM_CSYS PLACEMENT
						END_ASSEMBLE

						INSERT_FAMINSTANCE COMP "COMP_2_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
						SET_FAMITEM_VALUE COMP "COMP_2_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" JOH - TOP_GAP - UNDERCUT
						SET_FAMITEM_VALUE COMP "COMP_2_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" BU_WIDTH
						SET_FAMITEM_VALUE COMP "COMP_2_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "SMT_THICKNESS" .105
						GET_REF_FAMINSTANCE COMP "COMP_2_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
						REPLACE_COMPONENT COMP INST
						INVALIDATE_REF COMP
					END_IF
				END_IF
			! END DOOR PREPS - CONTINUOUS HINGE

				IF TOP_EDGE == "INVERTED" OR TOP_EDGE == "FLUSH"
					SEARCH_MDL_REF DOOR_ASM CSYS "TOP_CHANNEL" ATTACH
					RETRIEVE_MDL CLOSURE_CHANNEL.PRT COMP

					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE COMP DOOR_ASM
							 CSYS ATTACH PLACEMENT
						END_ASSEMBLE

					SEARCH_MDL_PARAM COMP "EMJACNUM" EMJACNUM
					INSERT_FAMINSTANCE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "EMJACNUM" EMJACNUM+"-"+itos(DOOR_INDEX)+"-"+ITEM_NUM
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" DOOR_WIDTH - CLOSURE_CHANNEL_CLEARANCE
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .125
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" TOP_CHANNEL_DEPTH
					SET_FAMITEM_VALUE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "SMT_THICKNESS"  .05
					GET_REF_FAMINSTANCE COMP "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
					REPLACE_COMPONENT COMP INST

					IF TOP_EDGE == "FLUSH"
						SEARCH_MDL_REF COMP CSYS "ATTACH" ATTACH
						RETRIEVE_MDL FLUSHING_CHANNEL.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH PLACEMENT
							END_ASSEMBLE
						SEARCH_MDL_PARAM COMP "EMJACNUM" EMJACNUM
						INSERT_FAMINSTANCE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "EMJACNUM" EMJACNUM+"-"+itos(DOOR_INDEX)+"-"+ITEM_NUM
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" DOOR_WIDTH - SM_THICK - SM_THICK - .06
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .25
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" TOP_CHANNEL_DEPTH
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL1"  4
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL2"  4
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_A"  "N"
						SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_B"  "N"

						IF DOOR_CONSTRUCTION == "SEAMLESS"
							SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LOCKSEAM"  "N"
						ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
							SET_FAMITEM_VALUE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LOCKSEAM"  "Y"
						END_IF

						GET_REF_FAMINSTANCE COMP "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
						REPLACE_COMPONENT COMP INST
					END_IF
				END_IF

				IF BOTTOM_EDGE == "INVERTED" OR BOTTOM_EDGE == "FLUSH"
					SEARCH_MDL_REF DOOR_ASM CSYS "BOTTOM_CHANNEL" ATTACH
					RETRIEVE_MDL CLOSURE_CHANNEL.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE COMP DOOR_ASM
							 CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					SEARCH_MDL_PARAM COMP "EMJACNUM" EMJACNUM
					INSERT_FAMINSTANCE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "EMJACNUM" EMJACNUM+"-"+itos(DOOR_INDEX)+"-"+ITEM_NUM
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" DOOR_WIDTH - CLOSURE_CHANNEL_CLEARANCE
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .125
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" BOTTOM_CHANNEL_DEPTH
					SET_FAMITEM_VALUE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "SMT_THICKNESS"  .05
					GET_REF_FAMINSTANCE COMP "BOTTOM_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
					REPLACE_COMPONENT COMP INST

					IF BOTTOM_EDGE == "FLUSH"
						SEARCH_MDL_REF COMP CSYS "ATTACH" ATTACH
						RETRIEVE_MDL FLUSHING_CHANNEL.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH PLACEMENT
							END_ASSEMBLE
						SEARCH_MDL_PARAM COMP "EMJACNUM" EMJACNUM
						INSERT_FAMINSTANCE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "EMJACNUM" EMJACNUM+"-"+itos(DOOR_INDEX)+"-"+ITEM_NUM
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" DOOR_WIDTH - SM_THICK - SM_THICK - .06
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .25
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" BOTTOM_CHANNEL_DEPTH
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL1"  4
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL2"  4
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_A"  "N"
						SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_B"  "N"

						IF DOOR_CONSTRUCTION == "SEAMLESS"
							SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LOCKSEAM"  "N"
						ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
							SET_FAMITEM_VALUE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LOCKSEAM"  "Y"
						END_IF

						GET_REF_FAMINSTANCE COMP "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
						REPLACE_COMPONENT COMP INST
					END_IF
					REGEN_MDL ASSEM FORCE
				END_IF

				! IF DPS_MODEL <> ""
					! SEARCH_MDL_REF ASSEM COMPONENT "DOOR_ASM_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ ITEM_NUM DOOR_ASM
					! SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
					! IF DPS_POSITION == "HEAD"
						! IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

							! CREATE_UDF udf\csys DOOR_ASM
								! UDF_REF ATTACH ASM_CSYS
								! UDF_DIM	ROTX 0
								! UDF_DIM	ROTY 0
								! UDF_DIM	ROTZ -90
								! UDF_DIM	LOCX -((DOOR_WIDTH/2) - DPS_LOCATION)
								! UDF_DIM	LOCY UNDERCUT + DOOR_HEIGHT
								! UDF_DIM	LOCZ 0
								! UDF_EXP_REF ATTACH CSYS 0
							! END_CREATE_UDF

							! IF TOP_EDGE == "INVERTED"
								! RETRIEVE_MDL FLUSHING_CHANNEL.PRT COMP
								! SEARCH_MDL_REF COMP CSYS "PLACEMENT2" PLACEMENT
									! ASSEMBLE COMP DOOR_ASM
										 ! CSYS ATTACH PLACEMENT
									! END_ASSEMBLE

								! INSERT_FAMINSTANCE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .25
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" TOP_CHANNEL_DEPTH - .0625
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL1"  0
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL2"  0
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_A"  "Y"
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_B"  "Y"
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LOCKSEAM"  "N"
								! GET_REF_FAMINSTANCE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
								! REPLACE_COMPONENT COMP INST
							! END_IF

							! CREATE_UDF udf\hole DOOR_ASM
								! UDF_REF ATTACH ATTACH
								! UDF_DIM	DIA DPS_HOLE_DIA
								! UDF_DIM	DEPTH .25
								! UDF_INTERSECTION * PART_LEVEL
							! END_CREATE_UDF

							! IF TOP_EDGE <> "SEAMLESS"
								! CREATE_UDF udf\csys DOOR_ASM
									! UDF_REF ATTACH ATTACH
									! UDF_DIM	ROTX 0
									! UDF_DIM	ROTY 0
									! UDF_DIM	ROTZ 0
									! UDF_DIM	LOCX .25
									! UDF_DIM	LOCY 0
									! UDF_DIM	LOCZ 0
									! UDF_EXP_REF ATTACH CSYS 0
								! END_CREATE_UDF

								! CREATE_UDF udf\hole DOOR_ASM
									! UDF_REF ATTACH ATTACH
									! UDF_DIM	DIA DPS_HOLE_DIA +.25
									! UDF_DIM	DEPTH 2
									! UDF_INTERSECTION * PART_LEVEL
								! END_CREATE_UDF
							! END_IF
						! END_IF

						! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

							! CREATE_UDF udf\csys DOOR_ASM
								! UDF_REF ATTACH ASM_CSYS
								! UDF_DIM	ROTX 0
								! UDF_DIM	ROTY 0
								! UDF_DIM	ROTZ -90
								! UDF_DIM	LOCX ((DOOR_WIDTH/2) - DPS_LOCATION)
								! UDF_DIM	LOCY UNDERCUT + DOOR_HEIGHT
								! UDF_DIM	LOCZ 0
								! UDF_EXP_REF ATTACH CSYS 0
							! END_CREATE_UDF

							! IF TOP_EDGE == "INVERTED"
								! RETRIEVE_MDL FLUSHING_CHANNEL.PRT COMP
								! SEARCH_MDL_REF COMP CSYS "PLACEMENT2" PLACEMENT
									! ASSEMBLE COMP DOOR_ASM
										 ! CSYS ATTACH PLACEMENT
									! END_ASSEMBLE

								! INSERT_FAMINSTANCE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "GRADE" DOOR_GRADE
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .25
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" TOP_CHANNEL_DEPTH - .0625
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL1"  0
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "BEVEL2"  0
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_A"  "Y"
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_B"  "Y"
								! SET_FAMITEM_VALUE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "LOCKSEAM"  "N"
								! GET_REF_FAMINSTANCE COMP "DPS_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
								! REPLACE_COMPONENT COMP INST
							! END_IF

							! CREATE_UDF udf\hole DOOR_ASM
								! UDF_REF ATTACH ATTACH
								! UDF_DIM	DIA DPS_HOLE_DIA
								! UDF_DIM	DEPTH .25
								! UDF_INTERSECTION * PART_LEVEL
							! END_CREATE_UDF

							! IF TOP_EDGE <> "SEAMLESS"
								! CREATE_UDF udf\csys DOOR_ASM
									! UDF_REF ATTACH ATTACH
									! UDF_DIM	ROTX 0
									! UDF_DIM	ROTY 0
									! UDF_DIM	ROTZ 0
									! UDF_DIM	LOCX .25
									! UDF_DIM	LOCY 0
									! UDF_DIM	LOCZ 0
									! UDF_EXP_REF ATTACH CSYS 0
								! END_CREATE_UDF

								! CREATE_UDF udf\hole DOOR_ASM
									! UDF_REF ATTACH ATTACH
									! UDF_DIM	DIA DPS_HOLE_DIA +.25
									! UDF_DIM	DEPTH 2
									! UDF_INTERSECTION * PART_LEVEL
								! END_CREATE_UDF
							! END_IF
						! END_IF
					! END_IF
				! END_IF

		!BEGIN DOOR CLOSERS
				! IF HAND_ == "*I*"
					! CLOSER_TYPE_ =	CLOSER_TYPE_2
					! CLOSER_SIDE_ =	CLOSER_SIDE_2
					! CLOSER_DESC_ =	CLOSER_DESC_2
					! SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH_2
					! SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH_2
					! CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER_2
					! CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER_2
					! HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER_2
					! HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE_2
					! HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL_2
				! ELSE
					! CLOSER_TYPE_ =	CLOSER_TYPE
					! CLOSER_SIDE_ =	CLOSER_SIDE
					! CLOSER_DESC_ =	CLOSER_DESC
					! SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH
					! SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH
					! CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER
					! CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER
					! HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER
					! HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE
					! HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL
				! END_IF

				IF DOOR_INDEX == 2
					CLOSER_TYPE_ =	CLOSER_TYPE_2
					CLOSER_SIDE_ =	CLOSER_SIDE_2
					CLOSER_DESC_ =	CLOSER_DESC_2
					SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH_2
					SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH_2
					CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER_2
					CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER_2
					HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER_2
					HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE_2
					HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL_2
				ELSE_IF DOOR_INDEX == 1
					CLOSER_TYPE_ =	CLOSER_TYPE
					CLOSER_SIDE_ =	CLOSER_SIDE
					CLOSER_DESC_ =	CLOSER_DESC
					SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH
					SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH
					CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER
					CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER
					HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER
					HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE
					HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL
				END_IF

				IF CLOSER_TYPE_ == "SURFACE"
					IF DOOR_WIDTH < SURFACE_CLOSER_LENGTH_ + 2
						SURFACE_CLOSER_LENGTH_ = DOOR_WIDTH - 2.25
					END_IF

					IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
						HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
						HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -((SURFACE_CLOSER_LENGTH_/2) + 1)
						UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .25 - (SURFACE_CLOSER_WIDTH_/2)
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
					END_IF

					IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
						HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
						HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -((SURFACE_CLOSER_LENGTH_/2) + 1)
						UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .25 - (SURFACE_CLOSER_WIDTH_/2)
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
					END_IF

					CLEAR_ARRAY ARRAYITEMS
					DECLARE_VARIABLE INTEGER ARRAY_INDEX
					DECLARE_VARIABLE STRING NEW_VALUE
					RETRIEVE_MDL REINFORCEMENT.ASM GENERIC
					GET_MDL_NAME GENERIC GENERIC_NAME
					SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
					INSERT_FAMINSTANCE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM
					SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "STOCKTYPE" 1
					SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
					SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "THICKNESS" DOOR_THICKNESS - .125
					SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" SURFACE_CLOSER_LENGTH_
					SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" SURFACE_CLOSER_WIDTH_
					SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "XX_ORIENT" "H"
					GET_FAMITEMS GENERIC ARRAYITEMS
					GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
					ARRAY_INDEX = 0

					WHILE ARRAY_INDEX <= ARRAY_SIZE-1
						GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
						IF VALUE == "M*"
							NEW_VALUE = "FID:" + strmid(VALUE,1)
							SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
							GET_REF_GENERIC INST COMP_GENERIC
							GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
							INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
							SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_"+ITEM_NUM VALUE COMP_GENERIC_NAME +"_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
							! SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM                 VALUE COMP_GENERIC_NAME +"_" + ITEM_NUM
						END_IF
						ARRAY_INDEX ++
					END_WHILE

					GET_REF_FAMINSTANCE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM COMP

					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

						ASSEMBLE COMP DOOR_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
				END_IF

				IF HOLDER_STOP_MANUFACTURER_ == "ABH"
					SEARCH_MDL_REF ASSEM COMPONENT "DOOR_ASM_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ ITEM_NUM DOOR_ASM
					IF HOLDER_STOP_TYPE_ == "SURFACE"

						DECLARE_VARIABLE DOUBLE BU_LENGTH
						DECLARE_VARIABLE DOUBLE BU_WIDTH
						BU_WIDTH = SURFACE_CLOSER_WIDTH_
						BU_LENGTH = ABH_DIM_A + ABH_DIM_C + 1.0

						IF DOOR_WIDTH < BU_LENGTH + 2
							MESSAGE_BOX "THIS REINFORCEMENT CHANNEL IS TOO LONG FOR THE DOOR"
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

							SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
							CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((BU_LENGTH/2) + 1)
							UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .25 - (BU_WIDTH/2)
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF
						END_IF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

							SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
							CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((BU_LENGTH/2) + 1)
							UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .25 - (BU_WIDTH/2)
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF
						END_IF

						CLEAR_ARRAY ARRAYITEMS
						DECLARE_VARIABLE INTEGER ARRAY_INDEX
						DECLARE_VARIABLE STRING NEW_VALUE
						RETRIEVE_MDL REINF.ASM GENERIC
						GET_MDL_NAME GENERIC GENERIC_NAME
						INSERT_FAMINSTANCE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "THICKNESS" DOOR_THICKNESS - .125
						SET_FAMITEM_VALUE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" BU_LENGTH
						SET_FAMITEM_VALUE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" BU_WIDTH
						SET_FAMITEM_VALUE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "XX_ORIENT" "H"
						GET_FAMITEMS GENERIC ARRAYITEMS
						GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
						ARRAY_INDEX = 0

						WHILE ARRAY_INDEX <= ARRAY_SIZE-1
							GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
							IF VALUE == "M*"
								NEW_VALUE = "FID:" + strmid(VALUE,1)
								SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
								GET_REF_GENERIC INST COMP_GENERIC
								GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
								INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
								SET_FAMITEM_VALUE GENERIC "HSR_"+itos(DOOR_INDEX)+"_"+ITEM_NUM VALUE COMP_GENERIC_NAME +"_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
							END_IF
							ARRAY_INDEX ++
						END_WHILE

						GET_REF_FAMINSTANCE GENERIC "HSR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM COMP

						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

							ASSEMBLE COMP DOOR_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
					END_IF

					IF HOLDER_STOP_TYPE_ == "CONCEALED"
						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

							SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
							CREATE_UDF udf\csys DOOR_ASM
								UDF_REF ATTACH ASM_CSYS
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX -( ABH_DIM_C - HINGE_GAP + (ABH_DIM_E/2))
								UDF_DIM	LOCY JOH - TOP_GAP - .115
								UDF_DIM	LOCZ DOOR_THICKNESS/2
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							CREATE_UDF udf\rect_cut DOOR_ASM
								UDF_REF ATTACH ATTACH
								UDF_DIM	DIMY .27
								UDF_DIM	DIMZ 1.3125
								UDF_DIM	DIMX ABH_DIM_E
								UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF
						END_IF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

							SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
							CREATE_UDF udf\csys DOOR_ASM
								UDF_REF ATTACH ASM_CSYS
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX -(ABH_DIM_C - HINGE_GAP + (ABH_DIM_E/2))
								UDF_DIM	LOCY JOH - TOP_GAP - .115
								UDF_DIM	LOCZ -DOOR_THICKNESS/2
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							CREATE_UDF udf\rect_cut DOOR_ASM
								UDF_REF ATTACH ATTACH
								UDF_DIM	DIMY .27
								UDF_DIM	DIMZ 1.3125
								UDF_DIM	DIMX ABH_DIM_E
								UDF_INTERSECTION * PART_LEVEL
							END_CREATE_UDF
						END_IF
					END_IF

					IF TOP_EDGE == "INVERTED" OR TOP_EDGE == "FLUSH"
						SEARCH_MDL_REF DOOR_ASM COMPONENT "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM TOP_CHAN
						GET_REF_GENERIC TOP_CHAN TOP_CHAN_GENERIC
						SET_FAMITEM_VALUE TOP_CHAN_GENERIC "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "SMT_THICKNESS"  .075
						SET_FAMITEM_VALUE TOP_CHAN_GENERIC "TOP_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH"  .85
					END_IF
					REGEN_MDL ASSEM FORCE
				END_IF

				IF SUB_TYPE == "P" AND HAND_ == "*I*" AND FLUSH_BOLTS > 0
					DECLARE_VARIABLE DOUBLE ARMOR_BEVEL
					DECLARE_VARIABLE STRING ARMOR_INST

					IF	HAND_ == "LHRI1" OR HAND_ == "RHI2"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
						SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1

						IF STRIKE_EDGE_SHAPE == "BEVEL"
							ARMOR_BEVEL = -4
						ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
							ARMOR_BEVEL = 0
						END_IF
					END_IF

					IF	HAND_ == "RHRI2" OR HAND_ == "LHI1"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
						SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1

						IF STRIKE_EDGE_SHAPE == "BEVEL"
							ARMOR_BEVEL = 4
						ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
							ARMOR_BEVEL =  0
						END_IF
					END_IF

					IF ARMOR_WIDTH > DOOR_THICKNESS - 75 AND DOOR_CONSTRUCTION == "LOCKSEAM"
						IF HAND == "LHR"
							ARMOR_INST = "ARMOR_L2"
						ELSE_IF HAND == "RHR"
							ARMOR_INST = "ARMOR_L1"
						ELSE_IF HAND == "LH"
							ARMOR_INST = "ARMOR_L1"
						ELSE_IF HAND == "RH"
							ARMOR_INST = "ARMOR_L2"
						END_IF
					ELSE_IF DOOR_CONSTRUCTION == "SEAMLESS"
						IF SM_THICK > .07
							ARMOR_INST = "ARMOR_S12"
						ELSE
							ARMOR_INST = "ARMOR_S"
						END_IF
					END_IF

					IF FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3
						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR UNDERCUT + DOOR_HEIGHT - FLUSH_BOLT_CENTER_TOP
							UDF_DIM OFFSET 0
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH 1.0
							UDF_DIM ARMOR_HEIGHT 6.75
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "LHI1" OR HAND_ == "RHRI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBTC CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBTC
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -.75
									UDF_DIM	LOCY -(FLUSH_BOLT_CENTER_TOP-.125)
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH3 CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBTC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -4
									UDF_DIM	LOCY -(FLUSH_BOLT_CENTER_TOP/2)-(.1/Scale)
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBTD CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBTC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY -(FLUSH_BOLT_CENTER_TOP)
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBT CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHRI1" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBTC CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBTC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -.75
									UDF_DIM	LOCY FLUSH_BOLT_CENTER_TOP-.125
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH3 CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBTC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -4
									UDF_DIM	LOCY (FLUSH_BOLT_CENTER_TOP/2)+(.1/Scale)
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBTD CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBTC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY FLUSH_BOLT_CENTER_TOP
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBT CSYS 0
								END_CREATE_UDF
							END_IF

						RETRIEVE_MDL FLUSH_BOLT_BOX.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE

						IF TOP_EDGE == "FLUSH"
							SEARCH_MDL_REF DOOR_ASM COMPONENT "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM TOP_CHAN
							GET_REF_GENERIC TOP_CHAN TOP_CHAN_GENERIC

							IF	HAND_ == "LHI1" OR HAND_ == "RHRI2"
								SET_FAMITEM_VALUE TOP_CHAN_GENERIC "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_A"  "Y"
							ELSE_IF HAND_ == "LHRI1" OR HAND_ == "RHI2"
								SET_FAMITEM_VALUE TOP_CHAN_GENERIC "TOP_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_B"  "Y"
							END_IF
						END_IF

						IF TOP_EDGE <> "SEAMLESS"
							RETRIEVE_MDL FB_BRKT.PRT COMP
							SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH3 PLACEMENT
							END_ASSEMBLE

							INSERT_FAMINSTANCE COMP "FB_BRKT_TOP_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
							SET_FAMITEM_VALUE COMP "FB_BRKT_TOP_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
							SET_FAMITEM_VALUE COMP "FB_BRKT_TOP_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .25
							SET_FAMITEM_VALUE COMP "FB_BRKT_TOP_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" TOP_CHANNEL_DEPTH - .1875
							GET_REF_FAMINSTANCE COMP "FB_BRKT_TOP_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
							REPLACE_COMPONENT COMP INST
						END_IF
					END_IF
					IF FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3
						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR UNDERCUT + FLUSH_BOLT_CENTER_BOTTOM
							UDF_DIM OFFSET 0
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH 1.0
							UDF_DIM ARMOR_HEIGHT 6.75
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "LHI1" OR HAND_ == "RHRI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBBC CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBBC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -.75
									UDF_DIM	LOCY FLUSH_BOLT_CENTER_BOTTOM-.125
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH3 CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBBC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -4
									UDF_DIM	LOCY (FLUSH_BOLT_CENTER_BOTTOM/2)-(.1/Scale)
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBBD CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBBC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY FLUSH_BOLT_CENTER_BOTTOM
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBB CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHRI1" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBBC CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBBC
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -.75
									UDF_DIM	LOCY -FLUSH_BOLT_CENTER_BOTTOM - .125
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH3 CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBBC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -4
									UDF_DIM	LOCY -(FLUSH_BOLT_CENTER_BOTTOM/2)+(.1/Scale)
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBBD CSYS 0
								END_CREATE_UDF
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH FBBC
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY -FLUSH_BOLT_CENTER_BOTTOM
									UDF_DIM	LOCZ 0
									UDF_EXP_REF FBB CSYS 0
								END_CREATE_UDF
						END_IF

						RETRIEVE_MDL FLUSH_BOLT_BOX.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE

						IF BOTTOM_EDGE == "FLUSH"
							SEARCH_MDL_REF DOOR_ASM COMPONENT "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM BOT_CHAN
							GET_REF_GENERIC BOT_CHAN BOT_CHAN_GENERIC

							IF	HAND_ == "LHI1" OR HAND_ == "RHRI2"
								SET_FAMITEM_VALUE BOT_CHAN_GENERIC "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_B"  "Y"
							ELSE_IF HAND_ == "LHRI1" OR HAND_ == "RHI2"
								SET_FAMITEM_VALUE BOT_CHAN_GENERIC "BOTTOM_FLUSH_CHAN_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "FLUSH_BOLT_A"  "Y"
							END_IF
						END_IF
						IF BOTTOM_EDGE <> "SEAMLESS"
							RETRIEVE_MDL FB_BRKT.PRT COMP
							SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH3 PLACEMENT
							END_ASSEMBLE

							INSERT_FAMINSTANCE COMP "FB_BRKT_BOT_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM
							SET_FAMITEM_VALUE COMP "FB_BRKT_BOT_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
							SET_FAMITEM_VALUE COMP "FB_BRKT_BOT_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "WIDTH" DOOR_THICKNESS - .25
							SET_FAMITEM_VALUE COMP "FB_BRKT_BOT_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM "DEPTH" TOP_CHANNEL_DEPTH - .1875
							GET_REF_FAMINSTANCE COMP "FB_BRKT_BOT_"+itos(DOOR_INDEX)+"_"+ ITEM_NUM INST
							REPLACE_COMPONENT COMP INST
						END_IF
					END_IF
					REGEN_MDL ASSEM FORCE
				END_IF

				IF (SUB_TYPE == "S" OR HAND_ == "*A*") OR (SUB_TYPE == "P" AND PRIMARY_LOCK_TYPE == "*EXIT*")
					DECLARE_VARIABLE DOUBLE ARMOR_BEVEL
					DECLARE_VARIABLE STRING ARMOR_INST

					IF BACKSET == 99
						PRINT "ENTER BACKSET DIMENSION"
						USER_INPUT_PARAM DOUBLE BACKSET
					END_IF

					IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
						HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
						HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
						SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1

						IF STRIKE_EDGE_SHAPE == "BEVEL"
							ARMOR_BEVEL = -4
						ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
							ARMOR_BEVEL = 0
						END_IF
					END_IF

					IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
						HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
						HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

						SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
						SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1

						IF STRIKE_EDGE_SHAPE == "BEVEL"
							ARMOR_BEVEL = 4
						ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
							ARMOR_BEVEL =  0
						END_IF
					END_IF

					IF PRIMARY_LOCK_ARMOR_WIDTH > DOOR_THICKNESS - 75 AND DOOR_CONSTRUCTION == "LOCKSEAM"
						IF HAND == "LHR"
							ARMOR_INST = "ARMOR_L2"
						ELSE_IF HAND == "RHR"
							ARMOR_INST = "ARMOR_L1"
						ELSE_IF HAND == "LH"
							ARMOR_INST = "ARMOR_L1"
						ELSE_IF HAND == "RH"
							ARMOR_INST = "ARMOR_L2"
						END_IF
					ELSE_IF DOOR_CONSTRUCTION == "SEAMLESS"
						IF SM_THICK > .07
							ARMOR_INST = "ARMOR_S12"
						ELSE
							ARMOR_INST = "ARMOR_S"
						END_IF
					END_IF

					IF PRIMARY_LOCK_TYPE == "*CYLINDER*" OR PRIMARY_LOCK_TYPE == "*DEADBOLT*" OR PRIMARY_LOCK_TYPE == "*HOSPITAL*"
						CREATE_UDF udf\cylinder DOOR_ASM
							UDF_INSTANCE PRIMARY_LOCK_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM BACKSET PRIMARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH PRIMARY_LOCK_ARMOR_WIDTH
							UDF_DIM ARMOR_HEIGHT PRIMARY_LOCK_ARMOR_HEIGHT
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2"

								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF PRIMARY_LOCK_BACKSET == 2.75
							RETRIEVE_MDL CYLINDER_BOX_2750.PRT COMP
							SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE COMP DOOR_ASM
									 CSYS ATTACH2 PLACEMENT
								END_ASSEMBLE
						END_IF
						IF PRIMARY_LOCK_BACKSET == 5
							RETRIEVE_MDL CYLINDER_BOX_5000.PRT COMP
							SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE COMP DOOR_ASM
									 CSYS ATTACH2 PLACEMENT
								END_ASSEMBLE
						END_IF
					END_IF

					! IF PRIMARY_LOCK_TYPE <> "" AND PRIMARY_LOCK_TYPE <> "NONE" AND \
						! ( HAND_ == "LHR" OR HAND_ == "RHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "RHR2" OR HAND_ == "RHRA2")
						! OPERATION = 1
						! EXCEL_GET_VALUE CELL_BY_INDEX 107 EXCEL_COLUMN MANUFACTURER
						! LOCKTAB = MANUFACTURER+".tab"
						! CALL_EX LOCKTAB
							! VAR_IN OPERATION OPERATION
							! VAR_IN SUB_TYPE SUB_TYPE
							! VAR_IN DOOR_CONSTRUCTION DOOR_CONSTRUCTION
							! VAR_IN FIRE_RATING FIRE_RATING
							! VAR_IN HAND_ HAND_
							! VAR_IN DOOR_WIDTH DOOR_WIDTH
							! VAR_IN PRIMARY_LOCK_TYPE LOCK_TYPE
							! VAR_IN PRIMARY_LOCK_SERIES_MODEL LOCK_MODEL
							! VAR_IN PRIMARY_LOCK_FUNCTION LOCK_FUNCTION
							! VAR_IN PRIMARY_LOCK_TRIM TRIM
							! VAR_IN PRIMARY_LOCK_BACKSET BACKSET
							! VAR_IN PRIMARY_STRIKE_CENTER STRIKE_CENTER
							! VAR_IN SURFACE_VERTICAL_RODS SURFACE_VERTICAL_RODS
							! VAR_IN CONCEALED_VERTICAL_RODS CONCEALED_VERTICAL_RODS
							! VAR_IN UNDERCUT UNDERCUT
							! VAR_IN DOOR_WIDTH DOOR_WIDTH
							! VAR_IN DOOR_HEIGHT DOOR_HEIGHT
							! VAR_IN TOP_CHANNEL_DEPTH TOP_CHANNEL_DEPTH
							! VAR_IN BOTTOM_CHANNEL_DEPTH BOTTOM_CHANNEL_DEPTH
							! VAR_INOUT SURFACE_CLOSER_LENGTH SURFACE_CLOSER_LENGTH
							! VAR_IN ATTACH ATTACH
							! VAR_IN ATTACH1 ATTACH1
							! VAR_IN DOOR_ASM DOOR_ASM
						! END_CALL_EX
					! END_IF

					IF PRIMARY_LOCK_TYPE == "MORTISE LOCK" AND PRIMARY_LOCK_MANUFACTURER == "HAGER"
						IF	HAND_ == "RHR" OR HAND_ == "LH" OR HAND_ == "RHRA2" OR HAND_ == "LHA1"
								CREATE_UDF udf\hs3800 DOOR_ASM
									UDF_INSTANCE PRIMARY_LOCK_INST
									UDF_REF ATTACH1 ATTACH1
									UDF_REF ATTACH ATTACH
									UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
									UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
									UDF_DIM BACKSET PRIMARY_LOCK_BACKSET
									UDF_INTERSECTION * PART_LEVEL
								END_CREATE_UDF

								CREATE_UDF udf\armor_plate DOOR_ASM
									UDF_INSTANCE ARMOR_INST
									UDF_REF ATTACH ATTACH
									UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
									UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
									UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
									UDF_DIM ARMOR_WIDTH PRIMARY_LOCK_ARMOR_WIDTH
									UDF_DIM ARMOR_HEIGHT PRIMARY_LOCK_ARMOR_HEIGHT
									UDF_EXP_REF ATTACH2 CSYS 1
									UDF_INTERSECTION * PART_LEVEL
								END_CREATE_UDF

								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL MORTISE_BOX.ASM COMP
								SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
									ASSEMBLE COMP DOOR_ASM
										 CSYS ATTACH2 PLACEMENT
									END_ASSEMBLE
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR HAND_ == "LHRA1" OR HAND_ == "RHA2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH1
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF

								CREATE_UDF udf\hs3800 DOOR_ASM
									UDF_INSTANCE PRIMARY_LOCK_INST
									UDF_REF ATTACH1 ATTACH1
									UDF_REF ATTACH ATTACH
									UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
									UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
									UDF_DIM BACKSET PRIMARY_LOCK_BACKSET
									UDF_INTERSECTION * PART_LEVEL
								END_CREATE_UDF

								CREATE_UDF udf\armor_plate DOOR_ASM
									UDF_INSTANCE ARMOR_INST
									UDF_REF ATTACH ATTACH
									UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
									UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
									UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
									UDF_DIM ARMOR_WIDTH PRIMARY_LOCK_ARMOR_WIDTH
									UDF_DIM ARMOR_HEIGHT PRIMARY_LOCK_ARMOR_HEIGHT
									UDF_EXP_REF ATTACH2 CSYS 1
									UDF_INTERSECTION * PART_LEVEL
								END_CREATE_UDF

								RETRIEVE_MDL MORTISE_BOX.ASM COMP
								SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
									ASSEMBLE COMP DOOR_ASM
										 CSYS ATTACH2 PLACEMENT
									END_ASSEMBLE
						END_IF
					END_IF

					IF SECONDARY_LOCK_TYPE == "MORTISE DEADBOLT" AND SECONDARY_LOCK_MANUFACTURER == "HAGER"
						CREATE_UDF udf\HS3800 DOOR_ASM
							UDF_INSTANCE SECONDARY_LOCK_INST
							UDF_REF ATTACH1 ATTACH1
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR SECONDARY_STRIKE_CENTER
							UDF_DIM OFFSET -SECONDARY_LOCK_OFFSET
							UDF_DIM BACKSET SECONDARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR SECONDARY_STRIKE_CENTER
							UDF_DIM OFFSET -SECONDARY_LOCK_OFFSET
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH SECONDARY_LOCK_ARMOR_WIDTH
							UDF_DIM ARMOR_HEIGHT SECONDARY_LOCK_ARMOR_HEIGHT
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						RETRIEVE_MDL MORTISE_BOX.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE
					END_IF

					IF PRIMARY_LOCK_TYPE == "MORTISE LOCK" AND PRIMARY_LOCK_MANUFACTURER == "SARGENT"
						CREATE_UDF udf\sargent7800 DOOR_ASM
							UDF_INSTANCE PRIMARY_LOCK_INST
							UDF_REF ATTACH1 ATTACH1
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM BACKSET PRIMARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH PRIMARY_LOCK_ARMOR_WIDTH
							UDF_DIM ARMOR_HEIGHT PRIMARY_LOCK_ARMOR_HEIGHT
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						RETRIEVE_MDL MORTISE_BOX.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE
					END_IF

					IF PRIMARY_LOCK_TYPE == "MORTISE EXIT" AND PRIMARY_LOCK_MANUFACTURER == "FALCON"
						CREATE_UDF udf\falcon_25 DOOR_ASM
							UDF_INSTANCE PRIMARY_LOCK_INST
							UDF_REF ATTACH1 ATTACH1
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM BACKSET PRIMARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH PRIMARY_LOCK_ARMOR_WIDTH
							UDF_DIM ARMOR_HEIGHT PRIMARY_LOCK_ARMOR_HEIGHT
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						RETRIEVE_MDL MORTISE_BOX.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE

						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ATTACH2
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -(DOOR_WIDTH - PRIMARY_LOCK_BACKSET - 4)
							UDF_DIM	LOCY 0
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH2 CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL EXIT_REINF_TAIL.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE
					END_IF

					IF (PRIMARY_LOCK_TYPE == "RIM EXIT" OR PRIMARY_LOCK_TYPE == "VR EXIT") AND PRIMARY_LOCK_MANUFACTURER == "FALCON" AND \
						( HAND_ == "LHR" OR HAND_ == "RHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "RHR2" OR HAND_ == "RHRA2")
						DECLARE_VARIABLE DOUBLE FLIP
						CREATE_UDF udf\falcon_25 DOOR_ASM
							UDF_INSTANCE PRIMARY_LOCK_INST
							UDF_REF ATTACH1 ATTACH1
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
							UDF_DIM OFFSET -PRIMARY_LOCK_OFFSET
							UDF_DIM BACKSET PRIMARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -PRIMARY_LOCK_BACKSET
							UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH2 CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL EXIT_BOX_TAP.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE

						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ATTACH2
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -(DOOR_WIDTH - PRIMARY_LOCK_BACKSET - 4)
							UDF_DIM	LOCY 0
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH2 CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL EXIT_REINF_TAIL.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE

						IF SURFACE_VERTICAL_RODS > 0
							IF	HAND_ == "LHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1"
								FLIP = 180
							END_IF
							IF HAND_ == "RHR" OR HAND_ == "RHR2" OR HAND_ == "RHRA2"
								FLIP = 0
							END_IF

							IF SURFACE_VERTICAL_RODS == 1 OR 	SURFACE_VERTICAL_RODS == 3
								IF SURFACE_CLOSER_LENGTH > DOOR_WIDTH - 8
									SURFACE_CLOSER_LENGTH = DOOR_WIDTH - 2.25
								ELSE
									CREATE_UDF udf\csys DOOR_ASM
										UDF_REF ATTACH ATTACH
										UDF_DIM	ROTX FLIP
										UDF_DIM	ROTY 0
										UDF_DIM	ROTZ 0
										UDF_DIM	LOCX -PRIMARY_LOCK_BACKSET
										UDF_DIM	LOCY UNDERCUT + DOOR_HEIGHT - TOP_CHANNEL_DEPTH - 3.5
										UDF_DIM	LOCZ 0
										UDF_EXP_REF ATTACH2 CSYS 0
									END_CREATE_UDF

									RETRIEVE_MDL SVR_BOX.PRT COMP
									SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
										ASSEMBLE COMP DOOR_ASM
											 CSYS ATTACH2 PLACEMENT
										END_ASSEMBLE
								END_IF
							END_IF

							IF SURFACE_VERTICAL_RODS == 2 OR 	SURFACE_VERTICAL_RODS == 3
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH
									UDF_DIM	ROTX FLIP
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX -PRIMARY_LOCK_BACKSET
									UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + 3.5
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF

								RETRIEVE_MDL SVR_BOX.PRT COMP
								SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
									ASSEMBLE COMP DOOR_ASM
										 CSYS ATTACH2 PLACEMENT
									END_ASSEMBLE
							END_IF
						END_IF
					END_IF

					IF SECONDARY_LOCK_TYPE == "*CYLINDER*"
						CREATE_UDF udf\cylinder DOOR_ASM
							UDF_INSTANCE SECONDARY_LOCK_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR SECONDARY_STRIKE_CENTER
							UDF_DIM OFFSET -SECONDARY_LOCK_OFFSET
							UDF_DIM BACKSET SECONDARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR SECONDARY_STRIKE_CENTER
							UDF_DIM OFFSET -SECONDARY_LOCK_OFFSET
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH SECONDARY_LOCK_ARMOR_WIDTH
							UDF_DIM ARMOR_HEIGHT SECONDARY_LOCK_ARMOR_HEIGHT
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						RETRIEVE_MDL CYLINDER_BOX.PRT COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE
					END_IF

					IF SECONDARY_LOCK_TYPE == "MORTISE*" AND SECONDARY_LOCK_MANUFACTURER == "SARGENT"
						CREATE_UDF udf\sargent7800 DOOR_ASM
							UDF_INSTANCE SECONDARY_LOCK_INST
							UDF_REF ATTACH1 ATTACH1
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR SECONDARY_STRIKE_CENTER
							UDF_DIM OFFSET -SECONDARY_LOCK_OFFSET
							UDF_DIM BACKSET SECONDARY_LOCK_BACKSET
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						CREATE_UDF udf\armor_plate DOOR_ASM
							UDF_INSTANCE ARMOR_INST
							UDF_REF ATTACH ATTACH
							UDF_DIM STRIKE_CTR SECONDARY_STRIKE_CENTER
							UDF_DIM OFFSET -SECONDARY_LOCK_OFFSET
							UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
							UDF_DIM ARMOR_WIDTH SECONDARY_LOCK_ARMOR_WIDTH
							UDF_DIM ARMOR_HEIGHT SECONDARY_LOCK_ARMOR_HEIGHT
							UDF_EXP_REF ATTACH2 CSYS 1
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
							HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
							HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 0
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
							HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
							HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
								CREATE_UDF udf\csys DOOR_ASM
									UDF_REF ATTACH ATTACH2
									UDF_DIM	ROTX 180
									UDF_DIM	ROTY 0
									UDF_DIM	ROTZ 0
									UDF_DIM	LOCX 0
									UDF_DIM	LOCY 0
									UDF_DIM	LOCZ 0
									UDF_EXP_REF ATTACH2 CSYS 0
								END_CREATE_UDF
						END_IF

						RETRIEVE_MDL MORTISE_DEADBOLT_BOX.ASM COMP
						SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE COMP DOOR_ASM
								 CSYS ATTACH2 PLACEMENT
							END_ASSEMBLE
					END_IF
				END_IF

				IF (PRIMARY_STRIKE_TYPE == "ASA 4*" OR PRIMARY_STRIKE_TYPE == "ASA 2*") AND \
				  (HAND_ == "LHI1" OR HAND_ == "RHRI2"  OR HAND_ == "RHI2" OR HAND_ == "LHRI1")
					IF HAND_ == "LHI1" OR HAND_ == "RHRI2"
						SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" REF1
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" REF2
						GET_REF_POS REF1 REF2 pos

						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH REF2
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX 0
							UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						CREATE_UDF udf\strike4	DOOR_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM D966 ARMOR_BEVEL
							UDF_DIM D968 0
							UDF_DIM D969 0
							UDF_DIM LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
							UDF_DIM STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
							UDF_DIM STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
							UDF_DIM LIP_DEPTH_X PRIMARY_STRIKE_LIP_THICKNESS
							UDF_DIM LIP_DEPTHX .03
							UDF_EXP_REF ATTACH CSYS 5
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
					END_IF

					IF HAND_ == "RHI2" OR HAND_ == "LHRI1"
						SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" REF1
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" REF2
						GET_REF_POS REF1 REF2 pos

						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH REF2
							UDF_DIM	ROTX 180
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX 0
							UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						CREATE_UDF udf\strike4	DOOR_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM D966 -ARMOR_BEVEL
							UDF_DIM D968 0
							UDF_DIM D969 0
							UDF_DIM LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
							UDF_DIM STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
							UDF_DIM STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
							UDF_DIM LIP_DEPTH_X PRIMARY_STRIKE_LIP_THICKNESS
							UDF_DIM LIP_DEPTHX .03
							UDF_EXP_REF ATTACH CSYS 5
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF
					END_IF

					IF PRIMARY_STRIKE_TYPE == "ASA 4*"
						RETRIEVE_MDL STRIKE_BOX_4875.PRT STRIKE
						SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE STRIKE DOOR_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
					END_IF

					IF PRIMARY_STRIKE_TYPE == "ASA 2*"
						RETRIEVE_MDL STRIKE_BOX_2750.PRT STRIKE
						SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE STRIKE DOOR_ASM
								CSYS ATTACH PLACEMENT
							END_ASSEMBLE
					END_IF
				END_IF

				IF CORE <> "STEEL*"
				SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + CORE_CLEARANCE
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL CORE.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE COMP DOOR_ASM
							 CSYS ATTACH PLACEMENT
						END_ASSEMBLE

					INSERT_FAMINSTANCE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

					IF CLOSER_TYPE == "SURFACE" OR HOLDER_STOP_TYPE == "SURFACE"
						SET_FAMITEM_VALUE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "LENGTH" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2) - SURFACE_CLOSER_WIDTH
					ELSE
						SET_FAMITEM_VALUE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "LENGTH" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2)
					END_IF

					SET_FAMITEM_VALUE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "WIDTH" DOOR_WIDTH - (CORE_EDGE_SPACE*2)
					SET_FAMITEM_VALUE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "TYPE" CORE
					SET_FAMITEM_VALUE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM "THICKNESS" DOOR_THICKNESS - .125
					GET_REF_FAMINSTANCE COMP CORE+"_CORE_"+itos(DOOR_INDEX)+"_"+ITEM_NUM INST
					REPLACE_COMPONENT COMP INST
				END_IF

				IF CORE == "*STEEL*" OR CORE == "*STIFF*"
				SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
					DECLARE_VARIABLE DOUBLE PNTX
					DECLARE_VARIABLE DOUBLE PNTY_BOTTOM
					DECLARE_VARIABLE DOUBLE PNTY_TOP
					DECLARE_VARIABLE DOUBLE PNTY
					DECLARE_VARIABLE DOUBLE PNTZ 0
					DECLARE_VARIABLE INTEGER PNT_QTY
					DECLARE_VARIABLE DOUBLE TEST
					DECLARE_VARIABLE INTEGER QTY
					DECLARE_VARIABLE INTEGER INDEX
					DECLARE_VARIABLE DOUBLE CHANNEL_LENGTH
					DECLARE_VARIABLE DOUBLE CHANNEL_LENGTH_1
					DECLARE_VARIABLE DOUBLE CHANNEL_LENGTH_2
					DECLARE_VARIABLE DOUBLE DIST_UP
					DECLARE_VARIABLE DOUBLE DIST_UP_1
					DECLARE_VARIABLE DOUBLE DIST_UP_2
					DECLARE_VARIABLE DOUBLE DIST_DN
					DECLARE_VARIABLE DOUBLE DIST_DN_1
					DECLARE_VARIABLE DOUBLE DIST_DN_2
					DECLARE_VARIABLE INTEGER CHANNEL_QTY
					DECLARE_VARIABLE DOUBLE CHANNEL_SPACING
					DECLARE_VARIABLE DOUBLE STIFFENER_THICKNESS .03

					CHANNEL_QTY = ceil((DOOR_WIDTH - CORE_EDGE_SPACE - CORE_EDGE_SPACE - STEEL_STIFFENER_WIDTH) / MAXIMUM_STIFFENER_CTR)+ 1
					CHANNEL_SPACING = (DOOR_WIDTH - CORE_EDGE_SPACE - CORE_EDGE_SPACE - (CHANNEL_QTY*STEEL_STIFFENER_WIDTH))/ (CHANNEL_QTY- 1)

					DECLARE_ARRAY arrayIntersections
					DECLARE_STRUCT POINT pnt
					DECLARE_STRUCT VECTOR vec
					PNTY_BOTTOM = UNDERCUT + BOTTOM_CHANNEL_DEPTH + 1
					PNTY_TOP = JOH - TOP_GAP - TOP_CHANNEL_DEPTH - SURFACE_CLOSER_WIDTH - .5

					INDEX = 1
					PNT_QTY = CHANNEL_QTY
					PNTX = -((DOOR_WIDTH - CORE_EDGE_SPACE - CORE_EDGE_SPACE)/2)

					WHILE INDEX <= PNT_QTY

						pnt.x = PNTX
						pnt.y = PNTY_BOTTOM
						pnt.z = 0
						vec.x = 0
						vec.y = 10
						vec.z = 0
						CLEAR_ARRAY arrayIntersections
						CALC_RAY_INTERSECTION DOOR_ASM INNER_INTERSECTIONS POSITIVE pnt vec arrayIntersections
						GET_ARRAY_ELEM arrayIntersections 0 VALUE
						DIST_UP_1 = VALUE.pnt_in.y - pnt.y + 1

						pnt.x = PNTX
						pnt.y = PNTY_TOP
						pnt.z = 0
						vec.x = 0
						vec.y = -10
						vec.z = 0
						CLEAR_ARRAY arrayIntersections
						CALC_RAY_INTERSECTION DOOR_ASM INNER_INTERSECTIONS POSITIVE pnt vec arrayIntersections
						GET_ARRAY_ELEM arrayIntersections 0 VALUE
						DIST_DN_1 = -(VALUE.pnt_in.y - pnt.y)

						PNTX = PNTX+STEEL_STIFFENER_WIDTH
						pnt.x = PNTX
						pnt.y = PNTY_BOTTOM
						pnt.z = 0
						vec.x = 0
						vec.y = 10
						vec.z = 0
						CLEAR_ARRAY arrayIntersections
						CALC_RAY_INTERSECTION DOOR_ASM INNER_INTERSECTIONS POSITIVE pnt vec arrayIntersections
						GET_ARRAY_ELEM arrayIntersections 0 VALUE
						DIST_UP_2 = VALUE.pnt_in.y - pnt.y + 1

						pnt.x = PNTX
						pnt.y = PNTY_TOP
						pnt.z = 0
						vec.x = 0
						vec.y = -10
						vec.z = 0
						CLEAR_ARRAY arrayIntersections
						CALC_RAY_INTERSECTION DOOR_ASM INNER_INTERSECTIONS POSITIVE pnt vec arrayIntersections
						GET_ARRAY_ELEM arrayIntersections 0 VALUE
						DIST_DN_2 = -(VALUE.pnt_in.y - pnt.y)

						IF DIST_UP_1 <= DIST_UP_2
							DIST_UP = DIST_UP_1
						ELSE
							DIST_UP = DIST_UP_2
						END_IF

						IF DIST_UP >= JOH - UNDERCUT - BOTTOM_CHANNEL_DEPTH - TOP_GAP - TOP_CHANNEL_DEPTH - SURFACE_CLOSER_WIDTH - 1.0
							CHANNEL_LENGTH_1 = DIST_UP - (CORE_CLEARANCE*2)
							CHANNEL_LENGTH_2 = 1

						ELSE
							IF DIST_UP >= MAXIMUM_STIFFENER_CTR * 2
								CHANNEL_LENGTH_1 = DIST_UP - (CORE_CLEARANCE*2)
							ELSE
								CHANNEL_LENGTH_1 = 1
							END_IF

							IF DIST_DN_1 <= DIST_DN_2
								DIST_DN = DIST_DN_1
							ELSE
								DIST_DN = DIST_DN_2
							END_IF

							pnt.x = PNTX - STEEL_STIFFENER_WIDTH
							pnt.y = PNTY_TOP
							pnt.z = 0
							vec.x = 0
							vec.y = 10
							vec.z = 0
							CLEAR_ARRAY arrayIntersections
							CALC_RAY_INTERSECTION DOOR_ASM INNER_INTERSECTIONS POSITIVE pnt vec arrayIntersections
							GET_ARRAY_ELEM arrayIntersections 0 VALUE
							DIST_UP_1 = VALUE.pnt_in.y - pnt.y

							pnt.x = PNTX
							pnt.y = PNTY_TOP
							pnt.z = 0
							vec.x = 0
							vec.y = 10
							vec.z = 0
							CLEAR_ARRAY arrayIntersections
							CALC_RAY_INTERSECTION DOOR_ASM INNER_INTERSECTIONS POSITIVE pnt vec arrayIntersections
							GET_ARRAY_ELEM arrayIntersections 0 VALUE
							DIST_UP_2 = VALUE.pnt_in.y - pnt.y

							IF DIST_UP_1 <= DIST_UP_2
								DIST_UP = DIST_UP_1
							ELSE
								DIST_UP = DIST_UP_2
							END_IF
								CHANNEL_LENGTH_2 = DIST_DN + DIST_UP - (CORE_CLEARANCE*2)

						END_IF

						IF CHANNEL_LENGTH_1 > 2

							CREATE_UDF udf\csys DOOR_ASM
								UDF_REF ATTACH ASM_CSYS
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 0
								UDF_DIM	LOCX pnt.x - (STEEL_STIFFENER_WIDTH/2)
								UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + CORE_CLEARANCE
								UDF_DIM	LOCZ 0
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							RETRIEVE_MDL STIFF.PRT COMP
							SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE COMP DOOR_ASM
									 CSYS ATTACH PLACEMENT
								END_ASSEMBLE

							INSERT_FAMINSTANCE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM
							SET_FAMITEM_VALUE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "LENGTH" CHANNEL_LENGTH_1
							SET_FAMITEM_VALUE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "WIDTH" STEEL_STIFFENER_WIDTH
							SET_FAMITEM_VALUE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "DEPTH" DOOR_THICKNESS - .1875
							SET_FAMITEM_VALUE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "TYPE" STEEL_STIFFENER_MATERIAL
							SET_FAMITEM_VALUE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "SMT_THICKNESS" STIFFENER_THICKNESS
							GET_REF_FAMINSTANCE COMP "STIFF_1_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM INST
							REPLACE_COMPONENT COMP INST

						END_IF

						IF CHANNEL_LENGTH_2 >= MAXIMUM_STIFFENER_CTR * 2

							CREATE_UDF udf\csys DOOR_ASM
								UDF_REF ATTACH ASM_CSYS
								UDF_DIM	ROTX 0
								UDF_DIM	ROTY 0
								UDF_DIM	ROTZ 180
								UDF_DIM	LOCX pnt.x - (STEEL_STIFFENER_WIDTH/2)
								UDF_DIM	LOCY PNTY_TOP + DIST_UP - CORE_CLEARANCE
								UDF_DIM	LOCZ 0
								UDF_EXP_REF ATTACH CSYS 0
							END_CREATE_UDF

							RETRIEVE_MDL STIFF.PRT COMP
							SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
								ASSEMBLE COMP DOOR_ASM
									 CSYS ATTACH PLACEMENT
								END_ASSEMBLE

							INSERT_FAMINSTANCE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM
							SET_FAMITEM_VALUE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "LENGTH" CHANNEL_LENGTH_2
							SET_FAMITEM_VALUE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "WIDTH" STEEL_STIFFENER_WIDTH
							SET_FAMITEM_VALUE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "DEPTH" DOOR_THICKNESS - .1875
							SET_FAMITEM_VALUE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "TYPE" STEEL_STIFFENER_MATERIAL
							SET_FAMITEM_VALUE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM "SMT_THICKNESS" STIFFENER_THICKNESS
							GET_REF_FAMINSTANCE COMP "STIFF_2_"+itos(DOOR_INDEX)+"_"+itos(INDEX)+"_"+ITEM_NUM INST
							REPLACE_COMPONENT COMP INST
						END_IF
						PNTX = PNTX + CHANNEL_SPACING
						INDEX++
					END_WHILE
				END_IF
				DOOR_INDEX ++
			END_WHILE
		END_IF

		DECLARE_REFERENCE ASSEM THIS

		DISPLAY_DATUM PLANES FALSE
		DISPLAY_DATUM AXES FALSE
		DISPLAY_DATUM POINTS FALSE
		DISPLAY_DATUM CSYS FALSE

		! REGEN_MDL ASSEM FORCE

		SEARCH_MDL_REF ASSEM CSYS "DEFCSYS" ASM_CSYS
		SEARCH_MDL_REF ASSEM CSYS "ORIENT" ORNT_CSYS

		IF FRAME_DESC == "FRAME"
			SEARCH_MDL_REF ASSEM COMPONENT "FRAME_ASM*" FRAME_ASM
		END_IF
		IF DOOR_ITEM_DESC == "DOOR"
			SEARCH_MDL_REF ASSEM COMPONENT "DOOR_ASM_1*" DOOR_ASM1
		END_IF

		IF DOOR_ITEM_DESC == "DOOR" AND SUB_TYPE == "P"
			SEARCH_MDL_REF ASSEM COMPONENT "DOOR_ASM_2*" DOOR_ASM2
		END_IF

		IF	HAND == "LH" OR HAND == "LHR"
			HAND_ = "L1"
		END_IF

		IF	HAND == "RH" OR HAND == "RHR"
			HAND_ = "R1"
		END_IF

		IF	HAND == "LH/RH" OR HAND == "LHA" OR HAND == "LHRA" OR HAND == "LHR/RHR"
			HAND_ = "L2"
		END_IF

		IF	HAND == "RHA" OR HAND == "RHRA"
			HAND_ = "R2"
		END_IF

		CALC_OUTLINE_PARAM ASM_CSYS X_SIZE XSIZE
		CALC_OUTLINE_PARAM ASM_CSYS Y_SIZE YSIZE
		CALC_OUTLINE_PARAM ASM_CSYS Z_SIZE ZSIZE

		Scale = .5/12
		DR_SCALE = "NO SCALE"

		DECLARE_VARIABLE DOUBLE XCTR
		DECLARE_VARIABLE DOUBLE YCTR
		DECLARE_VARIABLE DOUBLE TBLX 11.0625
		DECLARE_VARIABLE DOUBLE TBLY 10.375
		DECLARE_VARIABLE DOUBLE OA_HEIGHT
		DECLARE_VARIABLE STRING GENERAL_NOTES ""

		IF FRAME_ITEM_DESC == "FRAME"
			IF FRAME_ELEVATION == 3
				OA_HEIGHT = JOH + TRANSOM_PANEL_HEIGHT + FACEE
			ELSE_IF FRAME_ELEVATION == 5
				OA_HEIGHT = JOH+TRANSOM_HEIGHT+HEAD+TRANSOM_HEAD
			END_IF
		ELSE_IF DOOR_ITEM_DESC
			OA_HEIGHT = JOH
		END_IF

		IF 4.75/XSIZE < 6/YSIZE
			SCALE = 4.75/XSIZE
			XCTR = 4.75
			YCTR = ((YSIZE*SCALE)/2)+1.8125
		ELSE
			SCALE = 6/YSIZE
			XCTR = 4.75
			YCTR = 3+1.8125
		END_IF


		IF STD_REV == "STD"
			VIEW_POS = 11-XCTR
		ELSE_IF STD_REV == "REV"
			VIEW_POS = XCTR
		END_IF


		SET_MDL_PARAM ASSEM "DR_SCALE" DR_SCALE

		SET_CONFIG_OPTION "create_fraction_dim" "yes"
		SET_CONFIG_OPTION "dim_fraction_denominator" "64"

		CREATE_DRW	ASSEM sdi_b_template.drw refDrawing

		CREATE_DRW_TABLE refDrawing ASSEM 1 .5625 10.4375 "lib:heading.tbl" HEADING
		SET_DRW_TABLE_TEXT refDrawing heading 2 1 ITEM_NUM
		SET_DRW_TABLE_FORMAT refDrawing HEADING 2 1 HEIGHT .08
		SET_DRW_TABLE_TEXT refDrawing heading 2 2 itos(QTY)
		SET_DRW_TABLE_FORMAT refDrawing HEADING 2 2 HEIGHT .08
		SET_DRW_TABLE_TEXT refDrawing heading 2 3 HAND
		SET_DRW_TABLE_FORMAT refDrawing HEADING 2 3 HEIGHT .08
		SET_DRW_TABLE_TEXT refDrawing heading 2 4 itos(FIRE_RATING)
		SET_DRW_TABLE_FORMAT refDrawing HEADING 2 4 HEIGHT .08

		IF HARDWARE_SCHEDULE_ID <> ""
			ADD_DRW_TABLE_COL refDrawing HEADING 4 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "HDWE"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL HARDWARE_SCHEDULE_ID
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE
		END_IF

		ADD_DRW_TABLE_COL refDrawing HEADING 8 NEWCOL
		SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "MFG LOC'S"
		SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL MANUFACTURERS_LOCATIONS
		SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
		SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

		IF DOOR_ITEM_DESC == "DOOR"

				TEMPD = 1/DENOMENATOR
				TEMPN = ROUND((DOOR_THICKNESS / TEMPD),0)
				NUMBER = FLOOR(TEMPN / DENOMENATOR)
				TEMPN = TEMPN - (NUMBER*DENOMENATOR)
				TEMPD = DENOMENATOR
				WHILE MOD(TEMPN,2) == 0 AND MOD(TEMPD,2) == 0
					TEMPN = TEMPN/2
					TEMPD = TEMPD/2
				END_WHILE

				IF NUMBER > 0
					FRACTION = itos(NUMBER) +" "+ftos(TEMPN,0)+"/"+ftos(TEMPD,0)+"\""
				ELSE
					FRACTION = ftos(TEMPN,0)+"/"+ftos(TEMPD,0)+"\""
				END_IF

			ADD_DRW_TABLE_COL refDrawing HEADING 4 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "THICK"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL FRACTION
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

				DECLARE_VARIABLE STRING FINISH
				IF BODY_SIDE_FINISH == COVER_SIDE_FINISH
					FINISH = "#"+BODY_SIDE_FINISH
				ELSE
					FINISH = "#" + BODY_SIDE_FINISH + " / #" + COVER_SIDE_FINISH
				END_IF

			ADD_DRW_TABLE_COL refDrawing HEADING 12 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "DOOR MATL"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL itos(DOOR_GAUGE) +"GA  " + MAT_TYPE + "  T" + DOOR_GRADE +"  " + FINISH
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 7 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "CONST"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL DOOR_CONSTRUCTION
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 6 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "EDGES"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL STRIKE_EDGE_SHAPE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 6 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "CORE"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL CORE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 6 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "DR TOP"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL TOP_EDGE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 6 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "DR BOT"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL BOTTOM_EDGE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

		END_IF

		IF FRAME_ITEM_DESC == "FRAME"
			ADD_DRW_TABLE_COL refDrawing HEADING 12 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "FRAME MATL"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL itos(FRAME_GAUGE) + "GA  "+MAT_TYPE + "  T" + FRAME_GRADE + " #" + FRAME_FINISH
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 9 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "FR CONST"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL FRAME_CONSTRUCTION
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE

			ADD_DRW_TABLE_COL refDrawing HEADING 8 NEWCOL
			SET_DRW_TABLE_TEXT refDrawing HEADING 1 NEWCOL "HD GRAIN"
			SET_DRW_TABLE_TEXT refDrawing HEADING 2 NEWCOL HEAD_GRAIN
			SET_DRW_TABLE_FORMAT refDrawing HEADING 1 NEWCOL HEIGHT .1 HORIZONTAL CENTER VERTICAL MIDDLE
			SET_DRW_TABLE_FORMAT refDrawing HEADING 2 NEWCOL HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE
		END_IF

		IF SUB_TAGS <> ""
			GET_DRW_TABLE_OUTLINE refDrawing HEADING x1 y1 x2 y2
			CREATE_DRW_TABLE refDrawing NULL 1 x1 y2  "lib:tags.tbl" TAGS
			DECLARE_VARIABLE STRING TEXT
			DECLARE_VARIABLE INTEGER TEXT_LEN
			DECLARE_VARIABLE STRING VALUE1 ""
			DECLARE_VARIABLE STRING VALUE2 ""
			DECLARE_VARIABLE INTEGER TEXT_INDEX
			DECLARE_VARIABLE INTEGER TAG_INDEX
			DECLARE_VARIABLE INTEGER NEW_ROW
			TAG_INDEX = 1
			TEXT_INDEX = 0
			TEXT_LEN = strlen(SUB_TAGS)
			WHILE TEXT_INDEX < TEXT_LEN AND TEXT_INDEX < TEXT_LEN
				VALUE1 = ""
				WHILE strmid(SUB_TAGS, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE1 = VALUE1+strmid(SUB_TAGS, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				SET_DRW_TABLE_TEXT refDrawing TAGS TAG_INDEX 1 VALUE1
				SET_DRW_TABLE_FORMAT refDrawing TAGS TAG_INDEX 1 HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE
				TEXT_INDEX++
				VALUE1 = ""
				WHILE strmid(SUB_TAGS, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE1 = VALUE1+strmid(SUB_TAGS, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				SET_DRW_TABLE_TEXT refDrawing TAGS TAG_INDEX 2 VALUE1
				SET_DRW_TABLE_FORMAT refDrawing TAGS TAG_INDEX 2 HEIGHT .08 HORIZONTAL CENTER VERTICAL MIDDLE
				TEXT_INDEX++
				IF TEXT_LEN > TEXT_INDEX
					ADD_DRW_TABLE_ROW refDrawing TAGS 1 NEWROW
				END_IF
				TAG_INDEX++
			END_WHILE
		END_IF

		CREATE_DRW_NOTE refDrawing 16.2 1.78 itos(SHEET_QTY)
		CREATE_DRW_NOTE refDrawing 15.25 .6875 "SHEET   " + itos(SHEET) + "   OF   " + itos(TOTAL_SHEETS)

		IF FRAME_ITEM_DESC == "FRAME"
			CREATE_DRW_TABLE refDrawing FRAME_ASM 1 TBLX TBLY "lib:subasm.tbl" FRAME
			GET_MDL_NAME FRAME_ASM FR_NAME
			SET_DRW_TABLE_TEXT refDrawing frame 1 1 FR_NAME
			GET_DRW_TABLE_OUTLINE refDrawing FRAME x1 y1 x2 y2
			TBLY = y2 - .0625
		END_IF

		IF DOOR_ITEM_DESC == "DOOR"
			CREATE_DRW_TABLE refDrawing DOOR_ASM1 1 TBLX TBLY "lib:subasm.tbl" DOOR1
			GET_MDL_NAME DOOR_ASM1 DR_NAME1
			SET_DRW_TABLE_TEXT refDrawing door1 1 1 DR_NAME1
			GET_DRW_TABLE_OUTLINE refDrawing DOOR1 x1 y1 x2 y2
			TBLY = y2 - .0625
		END_IF

		IF SUB_TYPE == "P" AND DOOR_ITEM_DESC == "DOOR"
			CREATE_DRW_TABLE refDrawing DOOR_ASM1 1 TBLX TBLY "lib:subasm.tbl" DOOR2
			GET_MDL_NAME DOOR_ASM2 DR_NAME2
			SET_DRW_TABLE_TEXT refDrawing door1 1 1 DR_NAME2
		END_IF

		DECLARE_STRUCT	DRAWING_OPTIONS options
		GET_DRW_OPTIONS refDrawing options
			options.drawing_text_height = .1
		SET_DRW_OPTIONS refDrawing options

		SET_DRW_SCALE refDrawing 1 NULL Scale

		CREATE_DRW_VIEW_GENERAL refDrawing ASSEM "FRONT" 1 VIEW_POS YCTR 0 refView
		SET_DRW_VIEW_TANGENT_EDGE_DISPLAY refView NONE
		SET_DRW_VIEW_DISPLAY refView HIDDEN_LINE
		GET_DRW_VIEW_POS NULL refView x y
		GET_DRW_VIEW_OUTLINE refView outline

		CREATE_DRW_VIEW_NOTE RefView x (y - (((outline.y2 - outline.y1) /2)+.375)) "SECURE SIDE" HORIZONTAL CENTER  HEIGHT .15

		IF HAND == "LH" OR HAND == "RH" OR HAND == "LH/RH" OR HAND == "LHA" OR HAND == "RHA"
			CREATE_DRW_VIEW_NOTE RefView x (y - (((outline.y2 - outline.y1) /2)+.625)) "PUSH SIDE" HORIZONTAL CENTER  HEIGHT .15
		END_IF

		IF HAND == "LHR" OR HAND == "RHR" OR HAND == "LHR/RHR" OR HAND == "LHRA" OR HAND == "RHRA"
			CREATE_DRW_VIEW_NOTE RefView x (y - (((outline.y2 - outline.y1) /2)+.625)) "PULL SIDE" HORIZONTAL CENTER  HEIGHT .15
		END_IF

		CREATE_UDF udf\xycsys ASSEM
			UDF_REF ATTACH ORNT_CSYS
			UDF_DIM	DIMX -JOW/2
			UDF_DIM	DIMY OA_HEIGHT
			UDF_EXP_REF REF1 CSYS 0
		END_CREATE_UDF
		CREATE_UDF udf\xycsys ASSEM
			UDF_REF ATTACH ORNT_CSYS
			UDF_DIM	DIMX JOW/2
			UDF_DIM	DIMY OA_HEIGHT
			UDF_EXP_REF REF2 CSYS 0
		END_CREATE_UDF
		CREATE_UDF udf\xycsys ASSEM
			UDF_REF ATTACH ORNT_CSYS
			UDF_DIM	DIMX 0
			UDF_DIM	DIMY OA_HEIGHT+(.9/Scale)
			UDF_EXP_REF DIM CSYS 0
		END_CREATE_UDF
		GET_DRW_VIEW_REF_POS refView DIM pos
		CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL REFDIM
		SET_DIM_TEXT refDim "@D JOW "+"("+itos(JOW*25.4)+")"

		CREATE_UDF udf\xycsys ASSEM
			UDF_REF ATTACH ORNT_CSYS
			UDF_DIM	DIMX ((JOW/2)+FACEE)
			UDF_DIM	DIMY 0
			UDF_EXP_REF REF1 CSYS 0
		END_CREATE_UDF
		CREATE_UDF udf\xycsys ASSEM
			UDF_REF ATTACH REF1
			UDF_DIM	DIMX 0
			UDF_DIM	DIMY JOH
			UDF_EXP_REF REF2 CSYS 0
		END_CREATE_UDF
		CREATE_UDF udf\xycsys ASSEM
			UDF_REF ATTACH REF1
			UDF_DIM	DIMX .75/Scale
			UDF_DIM	DIMY JOH*.625
			UDF_EXP_REF DIM CSYS 0
		END_CREATE_UDF
		GET_DRW_VIEW_REF_POS refView DIM pos
		CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y REFDIM
		SET_DIM_TEXT REFDIM "@D\n"+"("+itos(JOH*25.4)+")"+"\n"+"JOH"

		IF HINGE_TYPE == "BUTT"
			IF FRAME_ITEM_DESC == "FRAME"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX (JOW/2)
					UDF_DIM	DIMY JOH
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\pnt ASSEM
					UDF_REF ATTACH refCsys
					UDF_EXP_REF pnt1 POINT 0
				END_CREATE_UDF
			ELSE_IF FRAME_ITEM_DESC <> "FRAME" AND DOOR_ITEM_DESC == "DOOR"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX (JOW/2)
					UDF_DIM	DIMY JOH-TOP_GAP
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\pnt ASSEM
					UDF_REF ATTACH refCsys
					UDF_EXP_REF pnt1 POINT 0
				END_CREATE_UDF
			END_IF
				HINGE_INDEX = 1
			FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
				CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH refCsys
				UDF_DIM DIMX 0
				UDF_DIM DIMY -LOCY
				UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH LOC+itos(HINGE_INDEX)
				UDF_DIM DIMX FACEE+(.4375/Scale)
				UDF_DIM DIMY 0
				UDF_EXP_REF DIMREF CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIMREF pos

				GET_DRW_VIEW_REF_POS refView pnt1 pos1
				GET_DRW_VIEW_REF_POS refView LOC+itos(HINGE_INDEX) pos2
				CREATE_DRW_VIEW_DIM refView 2 pnt1 LOC+itos(HINGE_INDEX) pos.x pos1.y-((pos1.y - pos2.y)/2) REFDIM
				SET_DIM_TEXT refDim "@D q"

				CREATE_UDF udf\pnt ASSEM
					UDF_REF ATTACH LOC+itos(HINGE_INDEX)
					UDF_EXP_REF pnt1 POINT 0
				END_CREATE_UDF

				IF HINGE_INDEX == HINGE_QTY
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH LOC+itos(HINGE_INDEX)
						UDF_DIM DIMX -.125/Scale
						UDF_DIM DIMY -.25/Scale
						UDF_EXP_REF HINGE_DESC CSYS 0
					END_CREATE_UDF

					IF SUB_TYPE == "P"
						HINGE_QTY = HINGE_QTY * 2
					END_IF
					GET_DRW_VIEW_REF_POS refView HINGE_DESC desc
					CREATE_DRW_VIEW_NOTE refView desc.x desc.y HINGE_DESC+" ("+ itos(HINGE_QTY) +")" WITH_LEADER PNT1

					IF SUB_TYPE == "P"
						HINGE_QTY = HINGE_QTY * 2
					END_IF

				END_IF

				IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH LOC+itos(HINGE_INDEX)
						UDF_DIM DIMX -.125/Scale
						UDF_DIM DIMY -.25/Scale
						UDF_EXP_REF ELEC_HINGE CSYS 0
					END_CREATE_UDF

					GET_DRW_VIEW_REF_POS refView ELEC_HINGE pos1
					CREATE_DRW_VIEW_NOTE refView pos1.x pos1.y "ELEC HINGE" HEIGHT .08 WITH_LEADER PNT1 REFNOTE
					IF HAND_ == "R2" AND ELECTRIC_HINGE_QTY > 1
						SET_DRW_NOTE_TEXT REFNOTE "ELEC HINGE\nBOTH SIDES"
					END_IF
				END_IF
				HINGE_INDEX ++
			END_FOR

			IF FRAME_ITEM_DESC == "FRAME"
					CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX (JOW/2)
					UDF_DIM	DIMY 0
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
			ELSE_IF FRAME_ITEM_DESC <> "FRAME" AND DOOR_ITEM_DESC == "DOOR"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX (JOW/2)
					UDF_DIM	DIMY UNDERCUT
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
			END_IF
			GET_DRW_VIEW_REF_POS refView pnt1 pos1
			GET_DRW_VIEW_REF_POS refView refCsys pos2
			CREATE_DRW_VIEW_DIM refView 2 pnt1 refCsys pos.x  pos1.y-((pos1.y - pos2.y)/2)REFDIM
				SET_DIM_TEXT refDim "@D q"
		END_IF

		IF FRAME_ITEM_DESC == "FRAME"
			IF PRIMARY_STRIKE_TYPE <> ""
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -((JOW/2) + FACEE)
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY PRIMARY_STRIKE_CENTER
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -.3125/Scale
					UDF_DIM	DIMY PRIMARY_STRIKE_CENTER/2
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y refDim
				SET_DIM_TEXT refDim "@D q\n"+PRIMARY_STRIKE_DESC+"\nSTRIKE"
			END_IF

			IF SECONDARY_STRIKE_TYPE <> ""
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -((JOW/2) + FACEE)
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY SECONDARY_STRIKE_CENTER
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -.625/Scale
					UDF_DIM	DIMY SECONDARY_STRIKE_CENTER/2 + (.25/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y refDim
				SET_DIM_TEXT refDim "@D q\n"+SECONDARY_STRIKE_DESC+"\nSTRIKE"
			END_IF
		END_IF

		IF FRAME_ITEM_DESC == "" AND DOOR_ITEM_DESC <> ""
			IF PRIMARY_STRIKE_TYPE == "NONE"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -((JOW/2) + FACEE)
					UDF_DIM	DIMY UNDERCUT
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY PRIMARY_STRIKE_CENTER - UNDERCUT
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -.3125/Scale
					UDF_DIM	DIMY PRIMARY_STRIKE_CENTER/2
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y refDim
				SET_DIM_TEXT refDim "@D q"+"\nLOCKSET"
			END_IF

			IF SECONDARY_STRIKE_TYPE == "NONE"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -((JOW/2) + FACEE)
					UDF_DIM	DIMY UNDERCUT
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY SECONDARY_STRIKE_CENTER - UNDERCUT
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -.625/Scale
					UDF_DIM	DIMY SECONDARY_STRIKE_CENTER/2 + (.25/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y refDim
				SET_DIM_TEXT refDim "@D q"+"\nLOCKSET"
			END_IF
		END_IF

		IF SUB_TYPE == "S"
			IF CLOSER_DESC <> ""
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX (JOW/2) -1
					UDF_DIM	DIMY JOH-2
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView NOTE pos

				IF strleft(HAND, 1) == "L"
					CREATE_DRW_VIEW_NOTE refView pos.x pos.y  CLOSER_DESC+"\n"+CLOSER_SIDE HEIGHT .08 HORIZONTAL LEFT
				ELSE_IF strleft(HAND, 1) == "R"
					CREATE_DRW_VIEW_NOTE refView pos.x pos.y  CLOSER_DESC+"\n"+CLOSER_SIDE HEIGHT .08 HORIZONTAL RIGHT
				END_IF
			END_IF
		END_IF

		IF SUB_TYPE == "P"
			SEARCH_MDL_REF ASSEM CSYS "DEFCSYS" DEFCSYS
			IF CLOSER_DESC <> ""
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX -(JOW/2)+1
					UDF_DIM	DIMY JOH-2
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView NOTE pos
				CREATE_DRW_VIEW_NOTE refView pos.x pos.y  CLOSER_DESC+"\n"+CLOSER_SIDE HEIGHT .08 HORIZONTAL LEFT
			END_IF
			IF CLOSER_DESC_2 <> ""
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX (JOW/2)-1
					UDF_DIM	DIMY JOH-2
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView NOTE pos
				CREATE_DRW_VIEW_NOTE refView pos.x pos.y  CLOSER_DESC_2+"\n"+CLOSER_SIDE HEIGHT .08 HORIZONTAL RIGHT
			END_IF
		END_IF

		IF FRAME_ITEM_DESC == "FRAME"
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX -JOW/2
				UDF_DIM	DIMY OA_HEIGHT
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -FACEE
				UDF_DIM	DIMY 0
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -.3125/Scale
				UDF_DIM	DIMY .9375/Scale
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL REFDIM
			SET_DIM_TEXT refDim "@D FACE"

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX JOW/2
				UDF_DIM	DIMY OA_HEIGHT
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX FACEE
				UDF_DIM	DIMY 0
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX .3125/Scale
				UDF_DIM	DIMY .9375/Scale
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL REFDIM
			SET_DIM_TEXT refDim "@D FACE"

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX -((JOW/2)+FACEE)
				UDF_DIM	DIMY OA_HEIGHT
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX ((JOW/2)+FACEE)
				UDF_DIM	DIMY OA_HEIGHT
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX 0
				UDF_DIM	DIMY OA_HEIGHT+(1.125/Scale)
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL REFDIM
			SET_DIM_TEXT refDim "@D OA"

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX ((JOW/2)+FACEE)
				UDF_DIM	DIMY JOH+HEAD+TRANSOM_PANEL_HEIGHT
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX ((JOW/2)+FACEE)
				UDF_DIM	DIMY JOH+TRANSOM_PANEL_HEIGHT
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX .75/Scale
				UDF_DIM	DIMY .3125/Scale
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y REFDIM
			SET_DIM_TEXT REFDIM "@D\nHEAD"

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX ((JOW/2)+FACEE)
				UDF_DIM	DIMY 0
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX 0
				UDF_DIM	DIMY OA_HEIGHT
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX 1.0625/Scale
				UDF_DIM	DIMY OA_HEIGHT*.6
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y REFDIM
			SET_DIM_TEXT REFDIM "@D\nOA"

			IF FLOOR_CLIPS == "FIXED"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX (JOW+FACEE)/2
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\pnt ASSEM
					UDF_REF ATTACH REF1
					UDF_EXP_REF PNT POINT 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX .156/Scale
					UDF_DIM	DIMY -.156/Scale
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView NOTE pos
				CREATE_DRW_VIEW_NOTE refView pos.x pos.y  FLOOR_CLIPS + " FLOOR CLIPS" HEIGHT .08 WITH_LEADER PNT
			END_IF
			!BEGIN DOUBLE RABBET JAMB SECTION VIEW

			IF SECTION == 2
				SET_FEATURE_STATE SECTION RESUMED
				GET_DRW_TABLE_POS refDrawing FRAME fx fy
				SECT_SCALE = .25
				IF STD_REV == "STD"
					CREATE_DRW_VIEW_GENERAL refDrawing SECTION "STD" 1 outline.x1/2 3.0 SECT_SCALE sectView
				ELSE_IF STD_REV == "REV"
					CREATE_DRW_VIEW_GENERAL refDrawing SECTION "REV" 1 outline.x2+((fx-outline.x2)/2)+.5 3.0 SECT_SCALE sectView
				END_IF

				SET_DRW_VIEW_TANGENT_EDGE_DISPLAY sectView NONE
				SET_DRW_VIEW_DISPLAY sectView NO_HIDDEN
				GET_DRW_VIEW_POS NULL sectView sx sy
				GET_DRW_VIEW_OUTLINE sectView soutline

				SEARCH_MDL_REF SECTION CSYS "DIM" REF1
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -FACEE
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -(FACEE/2)
					UDF_DIM	DIMY .5/SECT_SCALE
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL REFDIM
				SET_DIM_TEXT refDim "@OHEAD\nFACE"

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY -RETURN
					UDF_EXP_REF REF3 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX -.125/SECT_SCALE
					UDF_DIM	DIMY .25/SECT_SCALE
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF2 REF3 pos.x pos.y

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX STOPP
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX .25/SECT_SCALE
					UDF_DIM	DIMY .25/SECT_SCALE
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX STOPP
					UDF_DIM	DIMY -RABBET
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX .3125/SECT_SCALE
					UDF_DIM	DIMY -RABBET/2
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF1 REF2 pos.x pos.y

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY -JD
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX .625/SECT_SCALE
					UDF_DIM	DIMY -JD/2
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF1 REF2 pos.x pos.y REFDIM
				SET_DIM_TEXT refDim "@D\nJD"

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX STOPP
					UDF_DIM	DIMY XRABBET
					UDF_EXP_REF REF3 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX .3125/SECT_SCALE
					UDF_DIM	DIMY XRABBET/2
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF2 REF3 pos.x pos.y

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX -XFACEE
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF3 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX -XFACEE/2
					UDF_DIM	DIMY -.25/SECT_SCALE
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF3
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY XRETURN
					UDF_EXP_REF REF4 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF3
					UDF_DIM	DIMX -.125/SECT_SCALE
					UDF_DIM	DIMY -.25/SECT_SCALE
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF3 REF4 pos.x pos.y

				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF4
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY THROAT
					UDF_EXP_REF REF5 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys SECTION
					UDF_REF ATTACH REF4
					UDF_DIM	DIMX -.4375/SECT_SCALE
					UDF_DIM	DIMY THROAT/2
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS sectView DIM pos
				CREATE_DRW_VIEW_DIM sectView 2 REF4 REF5 pos.x pos.y REFDIM
				SET_DIM_TEXT refDim "@D\nTHROAT"

				IF ANCHOR_RECESS > 0
					CREATE_UDF udf\xycsys SECTION
						UDF_REF ATTACH REF4
						UDF_DIM	DIMX ANCHOR_RECESS
						UDF_DIM	DIMY .25/SECT_SCALE
						UDF_EXP_REF REF5 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys SECTION
						UDF_REF ATTACH REF3
						UDF_DIM	DIMX -.1875/SECT_SCALE
						UDF_DIM	DIMY .5/SECT_SCALE
						UDF_EXP_REF DIM CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS sectView DIM pos
					CREATE_DRW_VIEW_DIM sectView 2 REF4 REF5 pos.x pos.y ORIENTATION HORIZONTAL

					IF ANCHOR_DESC == "*LOOSE*"
						ANCHOR_DESC = "LOOSE"
					ELSE_IF ANCHOR_DESC == "WELDED"
						ANCHOR_DESC = "WELDED"
					END_IF

					CREATE_UDF udf\xycsys SECTION
						UDF_REF ATTACH REF1
						UDF_DIM	DIMX -1
						UDF_DIM	DIMY -2
						UDF_EXP_REF REF2 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\pnt SECTION
						UDF_REF ATTACH REF2
						UDF_EXP_REF PNT POINT 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys SECTION
						UDF_REF ATTACH REF1
						UDF_DIM	DIMX -((FACEE-1)+1.75+(RETURN/2))
						UDF_DIM	DIMY 0
						UDF_EXP_REF NOTE CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS sectView NOTE pos
					CREATE_DRW_VIEW_NOTE sectView pos.x pos.y "SHIP\n"+ANCHOR_DESC WITH_LEADER PNT
				END_IF
			END_IF
			SET_FEATURE_STATE SECTION SUPPRESSED

			IF FRAME_ELEVATION == 5
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -(JOW/2)-FACEE
					UDF_DIM	DIMY JOH+HEAD
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY TRANSOM_HEIGHT
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -(.5/Scale)
					UDF_DIM	DIMY (TRANSOM_HEIGHT/2)+(.15/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y REFDIM
				SET_DIM_TEXT refDim "@D\nTRANSOM\nHEIGHT"

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY TRANSOM_HEAD
					UDF_EXP_REF REF3 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF3
					UDF_DIM	DIMX -(.5/Scale)
					UDF_DIM	DIMY (.25/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF2 REF3 pos.x pos.y
			END_IF
		END_IF

		IF DOOR_ITEM_DESC == "DOOR"
			IF FRAME_ITEM_DESC == ""
				HEAD = 2
				FACEE = 2
			END_IF

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX -(JOW/2)
				UDF_DIM	DIMY 0
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -(.75/Scale)-FACEE
				UDF_DIM	DIMY UNDERCUT
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -(FACEE+(1.25/Scale))
				UDF_DIM	DIMY -(.25/Scale)
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y REFDIM
			SET_DIM_TEXT refDim "@D\nUNDERCUT"

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX -(JOW/2)
				UDF_DIM	DIMY JOH
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -(.75/Scale)-FACEE
				UDF_DIM	DIMY -TOP_GAP
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -(FACEE+(1.25/Scale))
				UDF_DIM	DIMY .188/Scale
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH ORNT_CSYS
				UDF_DIM	DIMX -(JOW/2)-(.75/Scale)-FACEE
				UDF_DIM	DIMY UNDERCUT
				UDF_EXP_REF REF1 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX 0
				UDF_DIM	DIMY DOOR_HEIGHT
				UDF_EXP_REF REF2 CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH REF1
				UDF_DIM	DIMX -(.5/Scale)
				UDF_DIM	DIMY DOOR_HEIGHT/2
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos
			CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y REFDIM
			SET_DIM_TEXT refDim "@D\nDOOR\nHEIGHT"

			! CREATE_UDF udf\xycsys ASSEM
				! UDF_REF ATTACH ORNT_CSYS
				! UDF_DIM	DIMX (JOW/2)-8
				! UDF_DIM	DIMY UNDERCUT
				! UDF_EXP_REF REF1 CSYS 0
			! END_CREATE_UDF
			! CREATE_UDF udf\pnt ASSEM
				! UDF_REF ATTACH REF1
				! UDF_EXP_REF PNT POINT 0
			! END_CREATE_UDF
			! CREATE_UDF udf\xycsys ASSEM
				! UDF_REF ATTACH REF1
				! UDF_DIM	DIMX .343/Scale
				! UDF_DIM	DIMY -.343/Scale
				! UDF_EXP_REF NOTE CSYS 0
			! END_CREATE_UDF
			! GET_DRW_VIEW_REF_POS refView NOTE pos
			! CREATE_DRW_VIEW_NOTE refView pos.x pos.y  BOTTOM_EDGE +"\nDOOR BOTTOM"  HEIGHT .08 HORIZONTAL CENTER WITH_LEADER PNT

			! IF SUB_TYPE == "P"
				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH ORNT_CSYS
					! UDF_DIM	DIMX -(JOW/2)+8
					! UDF_DIM	DIMY UNDERCUT
					! UDF_EXP_REF REF1 CSYS 0
				! END_CREATE_UDF
				! CREATE_UDF udf\pnt ASSEM
					! UDF_REF ATTACH REF1
					! UDF_EXP_REF PNT POINT 0
				! END_CREATE_UDF
				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH REF1
					! UDF_DIM	DIMX -.343/Scale
					! UDF_DIM	DIMY -.343/Scale
					! UDF_EXP_REF NOTE CSYS 0
				! END_CREATE_UDF
				! GET_DRW_VIEW_REF_POS refView NOTE pos
				! CREATE_DRW_VIEW_NOTE refView pos.x pos.y  BOTTOM_EDGE +"\nDOOR BOTTOM"  HEIGHT .08 HORIZONTAL CENTER WITH_LEADER PNT
			! END_IF

			SEARCH_MDL_REF ASSEM CSYS "DEFCSYS" DEFCSYS
			SEARCH_MDL_REF RECURSIVE ASSEM CSYS "LOCK_NOTE" NOTE
			GET_REF_PARENT NOTE NOTE_PARENT
			GET_MDL_NAME NOTE_PARENT PARENT_NAME
			GET_REF_POS DEFCSYS NOTE pos

			CREATE_UDF udf\pnt ASSEM
				UDF_REF ATTACH NOTE
				UDF_EXP_REF PNT POINT 0
			END_CREATE_UDF

			IF PARENT_NAME == "DOOR_ASM_1*" AND SUB_TYPE == "S" AND HAND_ == "R*"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX pos.x +(.25/Scale)
					UDF_DIM	DIMY pos.y -(.5/Scale)
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
			END_IF

			IF PARENT_NAME == "DOOR_ASM_1*" AND SUB_TYPE == "S" AND HAND_ == "L*"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX pos.x -(.25/Scale)
					UDF_DIM	DIMY pos.y -(.5/Scale)
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
			END_IF

			IF PARENT_NAME == "DOOR_ASM_1*" AND SUB_TYPE == "P"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX pos.x -(.25/Scale)
					UDF_DIM	DIMY pos.y -(.5/Scale)
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
			END_IF

			IF PARENT_NAME == "DOOR_ASM_2*"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX pos.x+(.25/Scale)
					UDF_DIM	DIMY pos.y-(.5/Scale)
					UDF_EXP_REF NOTE CSYS 0
				END_CREATE_UDF
			END_IF

			GET_DRW_VIEW_REF_POS refView NOTE pos
			CREATE_DRW_VIEW_NOTE refView pos.x pos.y  PRIMARY_LOCK_DESC WITH_LEADER PNT

			SEARCH_MDL_REF ASSEM CSYS "DEFCSYS" DEFCSYS
			SEARCH_MDL_REF DOOR_ASM1 CSYS "DIML" DIML
			SEARCH_MDL_REF DOOR_ASM1 CSYS "DIMR" DIMR
			SEARCH_MDL_REF DOOR_ASM1 CSYS "DIM" DIM

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH DIML
				UDF_DIM	DIMX 0
				UDF_DIM	DIMY OA_HEIGHT-JOH
				UDF_EXP_REF DIML CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH DIMR
				UDF_DIM	DIMX 0
				UDF_DIM	DIMY OA_HEIGHT-JOH
				UDF_EXP_REF DIMR CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\xycsys ASSEM
				UDF_REF ATTACH DIM
				UDF_DIM	DIMX 0
				UDF_DIM	DIMY OA_HEIGHT - JOH + TOP_GAP + (.6/Scale)
				UDF_EXP_REF DIM CSYS 0
			END_CREATE_UDF
			GET_DRW_VIEW_REF_POS refView DIM pos

			CREATE_DRW_VIEW_DIM refView 2 DIML DIMR pos.x pos.y ORIENTATION HORIZONTAL REFDIM
			SET_DIM_TEXT refDim "@D DR"

			IF SUB_TYPE == "P"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX -JOW/2
					UDF_DIM	DIMY OA_HEIGHT
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DIML
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX .188/Scale
					UDF_DIM	DIMY .75/Scale
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL

				SEARCH_MDL_REF DOOR_ASM2 CSYS "DIML" DIML

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DIML
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY OA_HEIGHT-JOH
					UDF_EXP_REF DIML CSYS 0
				END_CREATE_UDF

				GET_DRW_VIEW_REF_POS refView DIML posl
				CREATE_DRW_VIEW_DIM refView 2 DIML DIMR posl.x+.188 pos.y ORIENTATION HORIZONTAL
				SEARCH_MDL_REF DOOR_ASM2 CSYS "DIMR" DIMR

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DIMR
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY OA_HEIGHT-JOH
					UDF_EXP_REF DIMR CSYS 0
				END_CREATE_UDF

				SEARCH_MDL_REF DOOR_ASM2 CSYS "DIM" DIM

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DIM
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY OA_HEIGHT-DOOR_HEIGHT-UNDERCUT + TOP_GAP + (.6/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos

				CREATE_DRW_VIEW_DIM refView 2 DIML DIMR pos.x pos.y ORIENTATION HORIZONTAL REFDIM
				SET_DIM_TEXT refDim "@D DR"

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DEFCSYS
					UDF_DIM	DIMX JOW/2
					UDF_DIM	DIMY OA_HEIGHT
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH DIMR
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -.188/Scale
					UDF_DIM	DIMY .75/Scale
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL

				IF FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3
					GET_DRW_VIEW_REF_POS refView FBTD pos
					CREATE_DRW_VIEW_DIM refView 2 FBT FBTC pos.x pos.y REFDIM
					SET_DIM_TEXT refDim "@D\nFB"
				END_IF
				IF FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3
					GET_DRW_VIEW_REF_POS refView FBBD pos
					CREATE_DRW_VIEW_DIM refView 2 FBB FBBC pos.x pos.y REFDIM
					SET_DIM_TEXT refDim "@D\nFB"
				END_IF

				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH ORNT_CSYS
					! UDF_DIM	DIMX 8
					! UDF_DIM	DIMY JOH
					! UDF_EXP_REF REF1 CSYS 0
				! END_CREATE_UDF
				! CREATE_UDF udf\pnt ASSEM
					! UDF_REF ATTACH REF1
					! UDF_EXP_REF PNT POINT 0
				! END_CREATE_UDF
				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH REF1
					! UDF_DIM	DIMX .2/Scale
					! UDF_DIM	DIMY .2/Scale
					! UDF_EXP_REF NOTE CSYS 0
				! END_CREATE_UDF
				! GET_DRW_VIEW_REF_POS refView NOTE pos
				! CREATE_DRW_VIEW_NOTE refView pos.x pos.y  TOP_EDGE +" DOOR TOP" HEIGHT .08 WITH_LEADER PNT

				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH ORNT_CSYS
					! UDF_DIM	DIMX -8
					! UDF_DIM	DIMY JOH
					! UDF_EXP_REF REF1 CSYS 0
				! END_CREATE_UDF
				! CREATE_UDF udf\pnt ASSEM
					! UDF_REF ATTACH REF1
					! UDF_EXP_REF PNT POINT 0
				! END_CREATE_UDF
				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH REF1
					! UDF_DIM	DIMX .2/Scale
					! UDF_DIM	DIMY .2/Scale
					! UDF_EXP_REF NOTE CSYS 0
				! END_CREATE_UDF
				! GET_DRW_VIEW_REF_POS refView NOTE pos
				! CREATE_DRW_VIEW_NOTE refView pos.x pos.y  TOP_EDGE +" DOOR TOP" HEIGHT .08 WITH_LEADER PNT
			END_IF

			IF SUB_TYPE == "S"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -JOW/2
					UDF_DIM	DIMY OA_HEIGHT
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX STRIKE_GAP
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX .188/Scale
					UDF_DIM	DIMY .75/Scale
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX JOW/2
					UDF_DIM	DIMY OA_HEIGHT
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -HINGE_GAP
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -.188/Scale
					UDF_DIM	DIMY .75/Scale
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos
				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL

				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH ORNT_CSYS
					! UDF_DIM	DIMX -((JOW/2)-8)
					! UDF_DIM	DIMY JOH - TOP_GAP
					! UDF_EXP_REF REF1 CSYS 0
				! END_CREATE_UDF
				! CREATE_UDF udf\pnt ASSEM
					! UDF_REF ATTACH REF1
					! UDF_EXP_REF PNT POINT 0
				! END_CREATE_UDF
				! CREATE_UDF udf\xycsys ASSEM
					! UDF_REF ATTACH REF1
					! UDF_DIM	DIMX .1/Scale
					! UDF_DIM	DIMY .1/Scale
					! UDF_EXP_REF NOTE CSYS 0
				! END_CREATE_UDF
				! GET_DRW_VIEW_REF_POS refView NOTE pos
				! CREATE_DRW_VIEW_NOTE refView pos.x pos.y  TOP_EDGE +" DOOR TOP" HEIGHT .08 WITH_LEADER PNT

				IF DOOR_ELEVATION == "N"	OR DOOR_ELEVATION == "G"
					!CREATE VERTICLE DIMS ALOND ISDE OF DOOR
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH ORNT_CSYS
						UDF_DIM	DIMX -(JOW/2)-(.9375/Scale)-FACEE
						UDF_DIM	DIMY UNDERCUT
						UDF_EXP_REF REF1 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF1
						UDF_DIM	DIMX ((.9375/Scale)+FACEE-2)
						UDF_DIM	DIMY VISION_BOTTOM_RAIL
						UDF_EXP_REF REF2 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF2
						UDF_DIM	DIMX 0
						UDF_DIM	DIMY VISION_HEIGHT
						UDF_EXP_REF REF3 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF3
						UDF_DIM	DIMX -((.9375/Scale)+FACEE-2)
						UDF_DIM	DIMY VISION_TOP_RAIL
						UDF_EXP_REF REF4 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF1
						UDF_DIM	DIMX 0
						UDF_DIM	DIMY 0
						UDF_EXP_REF DIMREF CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView DIMREF pos

					GET_DRW_VIEW_REF_POS refView REF1 pos1
					GET_DRW_VIEW_REF_POS refView REF2 pos2
					CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos1.y+(pos2.y-pos1.y)/2)

					GET_DRW_VIEW_REF_POS refView REF3 pos3
					CREATE_DRW_VIEW_DIM refView 2 REF2 REF3 pos.x pos2.y+(pos3.y-pos2.y)/2)

					GET_DRW_VIEW_REF_POS refView REF4 pos4
					CREATE_DRW_VIEW_DIM refView 2 REF3 REF4 pos.x pos3.y+(pos4.y-pos3.y)/2)
					!CREATE DIMS ACROSS TOP OF DOOR
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH ORNT_CSYS
						UDF_DIM	DIMX -((JOW/2)-STRIKE_GAP)
						UDF_DIM	DIMY OA_HEIGHT
						UDF_EXP_REF REF1 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF1
						UDF_DIM	DIMX VISION_STRIKE_STILE
						UDF_DIM	DIMY 0
						UDF_EXP_REF REF2 CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF2
						UDF_DIM	DIMX VISION_WIDTH
						UDF_DIM	DIMY 0
						UDF_EXP_REF REF3 CSYS 0
					END_CREATE_UDF

					!STILE DIM
					IF DOOR_ELEVATION == "N"
						CREATE_UDF udf\xycsys ASSEM
							UDF_REF ATTACH REF1
							UDF_DIM	DIMX -.125/Scale
							UDF_DIM	DIMY .3/Scale
							UDF_EXP_REF DIM CSYS 0
						END_CREATE_UDF
						GET_DRW_VIEW_REF_POS refView DIM pos
						CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL
					END_IF

					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF3
						UDF_DIM	DIMX -VISION_WIDTH/2
						UDF_DIM	DIMY .3/Scale
						UDF_EXP_REF DIM CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView DIM pos
					CREATE_DRW_VIEW_DIM refView 2 REF2 REF3 pos.x pos.y ORIENTATION HORIZONTAL

					! CREATE_UDF udf\xycsys ASSEM
						! UDF_REF ATTACH ORNT_CSYS
						! UDF_DIM	DIMX -((JOW/2)-VISION_STRIKE_STILE-(VISION_WIDTH/2))
						! UDF_DIM	DIMY UNDERCUT+VISION_BOTTOM_RAIL+(VISION_HEIGHT*.75) + (.125/Scale)
						! UDF_EXP_REF REF1 CSYS 0
					! END_CREATE_UDF
					! CREATE_UDF udf\pnt ASSEM
						! UDF_REF ATTACH REF1
						! UDF_EXP_REF PNT POINT 0
					! END_CREATE_UDF
					! CREATE_UDF udf\xycsys ASSEM
						! UDF_REF ATTACH REF1
						! UDF_DIM	DIMX (VISION_WIDTH/2) + .25/Scale
						! UDF_DIM	DIMY .25/Scale
						! UDF_EXP_REF NOTE CSYS 0
					! END_CREATE_UDF


					! GET_DRW_VIEW_REF_POS refView NOTE pos
						! TEMPD = 1/DENOMENATOR
						! TEMPN = ROUND((GLASS_THICKNESS / TEMPD),0)
						! NUMBER = FLOOR(TEMPN / DENOMENATOR)
						! TEMPN = TEMPN - (NUMBER*DENOMENATOR)
						! TEMPD = DENOMENATOR
						! WHILE MOD(TEMPN,2) == 0 AND MOD(TEMPD,2) == 0
							! TEMPN = TEMPN/2
							! TEMPD = TEMPD/2
						! END_WHILE

						! IF NUMBER > 0
							! FRACTION = itos(NUMBER) +" "+ftos(TEMPN,0)+"/"+ftos(TEMPD,0)+"\""
						! ELSE
							! FRACTION = ftos(TEMPN,0)+"/"+ftos(TEMPD,0)+"\""
						! END_IF
					! CREATE_DRW_VIEW_NOTE refView pos.x pos.y FRACTION+" GLASS \n"+"BY"+GLASS_SUPPLIER HEIGHT .08 HORIZONTAL CENTER WITH_LEADER PNT

					! CREATE_UDF udf\xycsys ASSEM
						! UDF_REF ATTACH ORNT_CSYS
						! UDF_DIM	DIMX -((JOW/2)-VISION_STRIKE_STILE-VISION_WIDTH)
						! UDF_DIM	DIMY UNDERCUT+VISION_BOTTOM_RAIL+VISION_HEIGHT/2
						! UDF_EXP_REF REF1 CSYS 0
					! END_CREATE_UDF
					! CREATE_UDF udf\pnt ASSEM
						! UDF_REF ATTACH REF1
						! UDF_EXP_REF PNT POINT 0
					! END_CREATE_UDF
					! CREATE_UDF udf\xycsys ASSEM
						! UDF_REF ATTACH REF1
						! UDF_DIM	DIMX .188/Scale
						! UDF_DIM	DIMY .188/Scale
						! UDF_EXP_REF NOTE CSYS 0
					! END_CREATE_UDF
					! GET_DRW_VIEW_REF_POS refView NOTE pos
						! TEMPD = 1/DENOMENATOR
						! TEMPN = ROUND(((GLASS_THICKNESS+.125)/TEMPD),0)
						! NUMBER = FLOOR(TEMPN / DENOMENATOR)
						! TEMPN = TEMPN - (NUMBER*DENOMENATOR)
						! TEMPD = DENOMENATOR
						! WHILE MOD(TEMPN,2) == 0 AND MOD(TEMPD,2) == 0
							! TEMPN = TEMPN/2
							! TEMPD = TEMPD/2
						! END_WHILE

						! IF NUMBER > 0
							! FRACTION = itos(NUMBER) +" "+ftos(TEMPN,0)+"/"+ftos(TEMPD,0)+"\""
						! ELSE
							! FRACTION = ftos(TEMPN,0)+"/"+ftos(TEMPD,0)+"\""
						! END_IF

					! CREATE_DRW_VIEW_NOTE refView pos.x pos.y FRACTION+" POCKET\n"+VISION_CONSTRUCTION_A+"\n& "+VISION_CONSTRUCTION_B HEIGHT .08 HORIZONTAL CENTER WITH_LEADER PNT

					GENERAL_NOTES = GENERAL_NOTES +"GLAZING - TYPE "+DOOR_LITE_TRIM_TYPE+" TRIM WITH "+FRACTION+" POCKET FOR "+FRACTION+\
									" GLASS BY "+GLASS_SUPPLIER+ ",  TRIM -"+VISION_CONSTRUCTION_A+" & SHIPPED "+VISION_CONSTRUCTION_B+"\n"
				END_IF
			END_IF
		END_IF

		IF (DPS_MODEL <> "NO" OR DPS_MODEL <> "") AND DPS_POSITION == "HEAD"
			IF SUB_TYPE == "S"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX -(JOW/2)
					UDF_DIM	DIMY JOH
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX DPS_LOCATION
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX .125/Scale
					UDF_DIM	DIMY FACEE + (.1875/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos

				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL refDim
				SET_DIM_TEXT refDim "@D q"
					CREATE_UDF udf\pnt ASSEM
						UDF_REF ATTACH REF2
						UDF_EXP_REF pnt1 POINT 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF2
						UDF_DIM	DIMX .0625/Scale
						UDF_DIM	DIMY -.125/Scale
						UDF_EXP_REF NOTEPOS CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView NOTEPOS pos
					CREATE_DRW_VIEW_NOTE refView pos.x pos.y DPS_MODEL+"-DPS" HEIGHT .08 WITH_LEADER PNT1
			END_IF

			IF SUB_TYPE == "P"
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY JOH
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX DPS_LOCATION
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX .125/Scale
					UDF_DIM	DIMY FACEE + (.1875/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos

				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL refDim
				SET_DIM_TEXT refDim "@D q"
					CREATE_UDF udf\pnt ASSEM
						UDF_REF ATTACH REF2
						UDF_EXP_REF pnt1 POINT 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF2
						UDF_DIM	DIMX .0625/Scale
						UDF_DIM	DIMY -.125/Scale
						UDF_EXP_REF NOTEPOS CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView NOTEPOS pos
					CREATE_DRW_VIEW_NOTE refView pos.x pos.y DPS_MODEL+"-DPS" HEIGHT .08 WITH_LEADER PNT1

				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY JOH
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX -DPS_LOCATION
					UDF_DIM	DIMY 0
					UDF_EXP_REF REF2 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF2
					UDF_DIM	DIMX -(.125/Scale)
					UDF_DIM	DIMY FACEE + (.1875/Scale)
					UDF_EXP_REF DIM CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView DIM pos

				CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL refDim
				SET_DIM_TEXT refDim "@D q"
					CREATE_UDF udf\pnt ASSEM
						UDF_REF ATTACH REF2
						UDF_EXP_REF pnt1 POINT 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REF2
						UDF_DIM	DIMX -.0625/Scale
						UDF_DIM	DIMY -.125/Scale
						UDF_EXP_REF NOTEPOS CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView NOTEPOS pos
					CREATE_DRW_VIEW_NOTE refView pos.x pos.y DPS_MODEL+"-DPS" HEIGHT .08 WITH_LEADER PNT1
			END_IF
		END_IF

		IF SUB_TYPE == "P"
			IF DOOR_ELEVATION == "N"	OR DOOR_ELEVATION == "G"
				IF DOOR_LITE == 2 OR (DOOR_LITE == 0 AND HAND == "L*A*")
					SEARCH_MDL_REF DOOR_ASM1 CSYS "DIML" DIML
					SEARCH_MDL_REF DOOR_ASM1 CSYS "DIMR" DIMR
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH DIML
						UDF_DIM	DIMX VISION_HINGE_STILE
						UDF_DIM	DIMY 0
						UDF_EXP_REF REFL CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH DIMR
						UDF_DIM	DIMX -VISION_STRIKE_STILE
						UDF_DIM	DIMY 0
						UDF_EXP_REF REFR CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REFL
						UDF_DIM	DIMX VISION_WIDTH/2
						UDF_DIM	DIMY OA_HEIGHT-JOH+(.3/Scale)
						UDF_EXP_REF DIM CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView DIM pos
					CREATE_DRW_VIEW_DIM refView 2 DIML DIMR pos.x pos.y ORIENTATION HORIZONTAL

					IF DOOR_ELEVATION == "N"
						CREATE_UDF udf\xycsys ASSEM
							UDF_REF ATTACH DIMR
							UDF_DIM	DIMX -VISION_STRIKE_STILE/2
							UDF_DIM	DIMY OA_HEIGHT-JOH+(.3/Scale)
							UDF_EXP_REF DIM CSYS 0
						END_CREATE_UDF
						GET_DRW_VIEW_REF_POS refView DIM pos
						CREATE_DRW_VIEW_DIM refView 2 DIMR REFR pos.x pos.y ORIENTATION HORIZONTAL
					END_IF
				END_IF
				IF DOOR_LITE == 2 OR (DOOR_LITE == 0 AND HAND == "R*A*")
					SEARCH_MDL_REF DOOR_ASM2 CSYS "DIML" DIML
					SEARCH_MDL_REF DOOR_ASM2 CSYS "DIMR" DIMR
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH DIML
						UDF_DIM	DIMX VISION_STRIKE_STILE
						UDF_DIM	DIMY 0
						UDF_EXP_REF REFL CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH DIMR
						UDF_DIM	DIMX -VISION_HINGE_STILE
						UDF_DIM	DIMY 0
						UDF_EXP_REF REFR CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\xycsys ASSEM
						UDF_REF ATTACH REFL
						UDF_DIM	DIMX VISION_WIDTH/2
						UDF_DIM	DIMY OA_HEIGHT-JOH+(.3/Scale)
						UDF_EXP_REF DIM CSYS 0
					END_CREATE_UDF
					GET_DRW_VIEW_REF_POS refView DIM pos
					CREATE_DRW_VIEW_DIM refView 2 REFL REFR pos.x pos.y ORIENTATION HORIZONTAL

					IF DOOR_ELEVATION == "N"
						CREATE_UDF udf\xycsys ASSEM
							UDF_REF ATTACH DIML
							UDF_DIM	DIMX VISION_STRIKE_STILE/2
							UDF_DIM	DIMY OA_HEIGHT-JOH+(.3/Scale)
							UDF_EXP_REF DIM CSYS 0
						END_CREATE_UDF
						GET_DRW_VIEW_REF_POS refView DIM pos
						CREATE_DRW_VIEW_DIM refView 2 DIML REFL pos.x pos.y ORIENTATION HORIZONTAL
					END_IF
				END_IF
			END_IF

						!CREATE VERTICLE DIMS ALOND ISDE OF DOOR
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH ORNT_CSYS
							! UDF_DIM	DIMX -(JOW/2)-(.9375/Scale)-FACEE
							! UDF_DIM	DIMY UNDERCUT
							! UDF_EXP_REF REF1 CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF1
							! UDF_DIM	DIMX ((.9375/Scale)+FACEE-2)
							! UDF_DIM	DIMY VISION_BOTTOM_RAIL
							! UDF_EXP_REF REF2 CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF2
							! UDF_DIM	DIMX 0
							! UDF_DIM	DIMY VISION_HEIGHT
							! UDF_EXP_REF REF3 CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF3
							! UDF_DIM	DIMX -((.9375/Scale)+FACEE-2)
							! UDF_DIM	DIMY VISION_TOP_RAIL
							! UDF_EXP_REF REF4 CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF1
							! UDF_DIM	DIMX 0
							! UDF_DIM	DIMY 0
							! UDF_EXP_REF DIMREF CSYS 0
						! END_CREATE_UDF
						! GET_DRW_VIEW_REF_POS refView DIMREF pos

						! GET_DRW_VIEW_REF_POS refView REF1 pos1
						! GET_DRW_VIEW_REF_POS refView REF2 pos2
						! CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos1.y+(pos2.y-pos1.y)/2)

						! GET_DRW_VIEW_REF_POS refView REF3 pos3
						! CREATE_DRW_VIEW_DIM refView 2 REF2 REF3 pos.x pos2.y+(pos3.y-pos2.y)/2)

						! GET_DRW_VIEW_REF_POS refView REF4 pos4
						! CREATE_DRW_VIEW_DIM refView 2 REF3 REF4 pos.x pos3.y+(pos4.y-pos3.y)/2)
						! !CREATE DIMS ACROSS TOP OF DOOR
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH ORNT_CSYS
							! UDF_DIM	DIMX -((JOW/2)-STRIKE_GAP)
							! UDF_DIM	DIMY OA_HEIGHT
							! UDF_EXP_REF REF1 CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF1
							! UDF_DIM	DIMX VISION_STRIKE_STILE
							! UDF_DIM	DIMY 0
							! UDF_EXP_REF REF2 CSYS 0
						! END_CREATE_UDF
						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF2
							! UDF_DIM	DIMX VISION_WIDTH
							! UDF_DIM	DIMY 0
							! UDF_EXP_REF REF3 CSYS 0
						! END_CREATE_UDF

						! !STILE DIM
						! IF DOOR_ELEVATION == "N"
							! CREATE_UDF udf\xycsys ASSEM
								! UDF_REF ATTACH REF1
								! UDF_DIM	DIMX -.125/Scale
								! UDF_DIM	DIMY .3/Scale
								! UDF_EXP_REF DIM CSYS 0
							! END_CREATE_UDF
							! GET_DRW_VIEW_REF_POS refView DIM pos
							! CREATE_DRW_VIEW_DIM refView 2 REF1 REF2 pos.x pos.y ORIENTATION HORIZONTAL
						! END_IF

						! CREATE_UDF udf\xycsys ASSEM
							! UDF_REF ATTACH REF3
							! UDF_DIM	DIMX -VISION_WIDTH/2
							! UDF_DIM	DIMY .3/Scale
							! UDF_EXP_REF DIM CSYS 0
						! END_CREATE_UDF
						! GET_DRW_VIEW_REF_POS refView DIM pos
						! CREATE_DRW_VIEW_DIM refView 2 REF2 REF3 pos.x pos.y ORIENTATION HORIZONTAL

				GENERAL_NOTES = GENERAL_NOTES +"GLAZING - TYPE "+DOOR_LITE_TRIM_TYPE+" TRIM WITH "+FRACTION+" POCKET FOR "+FRACTION+\
								" GLASS BY "+GLASS_SUPPLIER+ ",  TRIM -"+VISION_CONSTRUCTION_A+" & SHIPPED "+VISION_CONSTRUCTION_B+"\n"
		END_IF

		IF FRAME_ITEM_DESC == "FRAME" AND DOOR_ITEM_DESC <> "DOOR" AND SUB_TYPE == "P" AND (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3)
			IF ACTIVE_LEAF == 99
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH ORNT_CSYS
					UDF_DIM	DIMX 0
					UDF_DIM	DIMY JOH
					UDF_EXP_REF REF1 CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\pnt ASSEM
					UDF_REF ATTACH REF1
					UDF_EXP_REF PNT POINT 0
				END_CREATE_UDF
				CREATE_UDF udf\xycsys ASSEM
					UDF_REF ATTACH REF1
					UDF_DIM	DIMX .25/Scale
					UDF_DIM	DIMY -.25/Scale
					UDF_EXP_REF NOTEPOS CSYS 0
				END_CREATE_UDF
				GET_DRW_VIEW_REF_POS refView NOTEPOS pos
				CREATE_DRW_VIEW_NOTE refView pos.x pos.y "FLUSH BOLT q" HEIGHT .08 WITH_LEADER PNT
			END_IF
		END_IF

		IF GENERAL_NOTES <> ""
			CREATE_DRW_NOTE refDrawing 1.625 9.875 "GENERAL_NOTES:" HEIGHT .11 HORIZONTAL LEFT
			CREATE_DRW_NOTE refDrawing 2.875 9.875 GENERAL_NOTES HEIGHT .1 HORIZONTAL LEFT
		END_IF

		CREATE_DRW_TABLE refDrawing ASSEM 1 13.96875 10.4375 "lib:Drwhistory.tbl" HIST

		HISTORY_INDEX = 2
		TEXT_INDEX = 0
		TEXT_LEN = strlen(DRAWING_HISTORY)
			WHILE TEXT_INDEX < TEXT_LEN
				VALUE1 = ""
				VALUE2 = ""
				VALUE3 = ""
				WHILE strmid(DRAWING_HISTORY, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE1 = VALUE1+strmid(DRAWING_HISTORY, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				TEXT_INDEX++
				WHILE strmid(DRAWING_HISTORY, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE2 = VALUE2+strmid(DRAWING_HISTORY, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				TEXT_INDEX++
				WHILE strmid(DRAWING_HISTORY, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE3 = VALUE3+strmid(DRAWING_HISTORY, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
					TEXT_INDEX++
				INSERT_DRW_TABLE_ROW refDrawing HIST HISTORY_INDEX .465 ROW_ID
				SET_DRW_TABLE_TEXT refDrawing HIST HISTORY_INDEX + 1 1 VALUE1
				SET_DRW_TABLE_FORMAT refDrawing HIST HISTORY_INDEX + 1 1 HEIGHT .09 HORIZONTAL CENTER VERTICAL MIDDLE
				SET_DRW_TABLE_TEXT refDrawing HIST HISTORY_INDEX + 1 2 VALUE2
				SET_DRW_TABLE_FORMAT refDrawing HIST HISTORY_INDEX + 1 2 HEIGHT .09 HORIZONTAL CENTER VERTICAL MIDDLE
				SET_DRW_TABLE_TEXT refDrawing HIST HISTORY_INDEX + 1 3 VALUE3
				SET_DRW_TABLE_FORMAT refDrawing HIST HISTORY_INDEX + 1 3 HEIGHT .09 HORIZONTAL CENTER VERTICAL MIDDLE

				HISTORY_INDEX++
			END_WHILE

		TEXT_INDEX = 0
		TEXT_LEN = strlen(AS_BUILT)
			IF TEXT_LEN > 0
				VALUE1 = ""
				VALUE2 = ""
				VALUE3 = ""
				WHILE strmid(AS_BUILT, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE1 = VALUE1+strmid(AS_BUILT, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				TEXT_INDEX++
				WHILE strmid(AS_BUILT, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE2 = VALUE2+strmid(AS_BUILT, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				TEXT_INDEX++
				WHILE strmid(AS_BUILT, TEXT_INDEX,1) <> "^" AND TEXT_INDEX <= TEXT_LEN
					VALUE3 = VALUE3+strmid(AS_BUILT, TEXT_INDEX,1)
					TEXT_INDEX++
				END_WHILE
				INSERT_DRW_TABLE_ROW refDrawing HIST HISTORY_INDEX .465 ROW_ID
				SET_DRW_TABLE_TEXT refDrawing HIST HISTORY_INDEX + 1 1 VALUE1
				SET_DRW_TABLE_FORMAT refDrawing HIST HISTORY_INDEX + 1 1 HEIGHT .09 HORIZONTAL CENTER VERTICAL MIDDLE
				SET_DRW_TABLE_TEXT refDrawing HIST HISTORY_INDEX + 1 2 VALUE2
				SET_DRW_TABLE_FORMAT refDrawing HIST HISTORY_INDEX + 1 2 HEIGHT .09 HORIZONTAL CENTER VERTICAL MIDDLE
				SET_DRW_TABLE_TEXT refDrawing HIST HISTORY_INDEX + 1 3 VALUE3
				SET_DRW_TABLE_FORMAT refDrawing HIST HISTORY_INDEX + 1 3 HEIGHT .09 HORIZONTAL CENTER VERTICAL MIDDLE
			END_IF

		SET_CONFIG_OPTION "create_fraction_dim" "no"
		SET_CONFIG_OPTION "dim_fraction_denominator" "16"

		SEARCH_MDL_REFS RECURSIVE refDrawing DRAWING_NOTE "*" SCALES
		FOR REMOVE_NOTE REF ARRAY SCALES
				GET_DRW_NOTE_TEXT REMOVE_NOTE REM_TEXT
			IF strleft(REM_TEXT,2) == SC
				DELETE_NOTE REMOVE_NOTE
			END_IF
		END_FOR

		WINDOW_ACTIVATE

		CLEAR_ARRAY STATUS
		ADD_ARRAY_ELEM STATUS "EXPT PDF & CONT"
		ADD_ARRAY_ELEM STATUS "ADD COMMENT, EXPT PDF & CONT"
		ADD_ARRAY_ELEM STATUS "SAVE DWG, EXPT PDF & CONT"
		ADD_ARRAY_ELEM STATUS "ADD COMMENT, SAVE DWG, EXPT PDF & CONT"
		ADD_ARRAY_ELEM STATUS "RE-PROCESS CURRENT  ITEM"
		ADD_ARRAY_ELEM STATUS "FIX SOMETHING IN THE PROGRAM"
		ADD_ARRAY_ELEM STATUS "SAVE DWG, EXPT PDF& EXIT"
		ADD_ARRAY_ELEM STATUS "END PROCESS & EXIT - DO NOT SAVE"

		! MESSAGE_BOX_EX QUESTION "NEXT STEP" "PLEASE SELECT THE NEXT STEP" STATUS CHOICE
CHOICE = 1
		! EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"

		IF CHOICE == 8 OR CHOICE == 0
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "NO"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			STOP
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
			EXCEL_DISCONNECT
			EXIT
		ELSE_IF CHOICE == 7
			SAVE_MDL refDrawing
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "YES"
			! EXCEL_SET_VALUE 223	EXCEL_COLUMN	"YES"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			EXCEL_DISCONNECT
			DECLARE_STRUCT PDF_OPTION option
			option.title = "sample drawing"
			option.author = "DRAFTER"
			option.subject = "detail"
			option.keywords = "SmartAssembly example"
			option.launch_viewer = "FALSE"
			option.color_depth = "Gray"

			IF SHEET > 0 AND SHEET < 10
				EXPORT_DRW_PDF refDrawing option "00"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 9 AND SHEET < 100
				EXPORT_DRW_PDF refDrawing option "0"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 99
				EXPORT_DRW_PDF refDrawing option itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			END_IF
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
			EXIT
		ELSE_IF CHOICE == 6
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "NO"
			! EXCEL_SET_VALUE 223	EXCEL_COLUMN	"NO"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			EXCEL_DISCONNECT
			SLEEP 5.0
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
			SLEEP 5.0
			EXIT
		ELSE_IF CHOICE == 5
			EXCEL_SET_VALUE 3 EXCEL_COLUMN "NO"
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "NO"
			! EXCEL_SET_VALUE 223	EXCEL_COLUMN	"NO"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			EXCEL_DISCONNECT
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
		ELSE_IF CHOICE == 4
			SWITCH_TO_MDL refDrawing
			PRINT " ADD COMMENT"
			USER_INPUT_PARAM STRING DRW_NOTE
			EXCEL_SET_VALUE 244	EXCEL_COLUMN	DRW_NOTE
			CREATE_DRW_NOTE refDrawing 2 9.5 DRW_NOTE HEIGHT .25
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "YES"
			! EXCEL_SET_VALUE 223	EXCEL_COLUMN	"YES"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			EXCEL_DISCONNECT
			SAVE_MDL refDrawing
			DECLARE_STRUCT PDF_OPTION option
			option.title = "sample drawing"
			option.author = "DRAFTER"
			option.subject = "detail"
			option.keywords = "SmartAssembly example"
			option.launch_viewer = "FALSE"
			option.color_depth = "Gray"

			IF SHEET > 0 AND SHEET < 10
				EXPORT_DRW_PDF refDrawing option "00"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 9 AND SHEET < 100
				EXPORT_DRW_PDF refDrawing option "0"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 99
				EXPORT_DRW_PDF refDrawing option itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			END_IF
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
		ELSE_IF CHOICE == 3
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "YES"
			! EXCEL_SET_VALUE 223	EXCEL_COLUMN	"YES"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			SAVE_MDL refDrawing
			DECLARE_STRUCT PDF_OPTION option
			option.title = "sample drawing"
			option.author = "DRAFTER"
			option.subject = "detail"
			option.keywords = "SmartAssembly example"
			option.launch_viewer = "FALSE"
			option.color_depth = "Gray"

			IF SHEET > 0 AND SHEET < 10
				EXPORT_DRW_PDF refDrawing option "00"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 9 AND SHEET < 100
				EXPORT_DRW_PDF refDrawing option "0"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 99
				EXPORT_DRW_PDF refDrawing option itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			END_IF
			SLEEP 5.0
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
			SLEEP 5.0
		ELSE_IF CHOICE == 2
			SWITCH_TO_MDL refDrawing
			PRINT " ADD COMMENT"
			USER_INPUT_PARAM STRING DRW_NOTE
			EXCEL_SET_VALUE 244	EXCEL_COLUMN	DRW_NOTE
			CREATE_DRW_NOTE refDrawing 2 9.5 DRW_NOTE HEIGHT .25
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "YES"
			!EXCEL_SET_VALUE 223	EXCEL_COLUMN	"YES"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			DECLARE_STRUCT PDF_OPTION option
			option.title = "sample drawing"
			option.author = "DRAFTER"
			option.subject = "detail"
			option.keywords = "SmartAssembly example"
			option.launch_viewer = "FALSE"
			option.color_depth = "Gray"

			IF SHEET > 0 AND SHEET < 10
				EXPORT_DRW_PDF refDrawing option "00"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 9 AND SHEET < 100
				EXPORT_DRW_PDF refDrawing option "0"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 99
				EXPORT_DRW_PDF refDrawing option itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			END_IF
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
		ELSE_IF CHOICE == 1
			EXCEL_SET_VALUE 4 EXCEL_COLUMN "YES"
			! EXCEL_SET_VALUE 223	EXCEL_COLUMN	"YES"
			EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
			DECLARE_STRUCT PDF_OPTION option
			option.title = "sample drawing"
			option.author = "DRAFTER"
			option.subject = "detail"
			option.keywords = "SmartAssembly example"
			option.launch_viewer = "FALSE"
			option.color_depth = "Gray"

			IF SHEET > 0 AND SHEET < 10
				EXPORT_DRW_PDF refDrawing option "00"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 9 AND SHEET < 100
				EXPORT_DRW_PDF refDrawing option "0"+itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			ELSE_IF SHEET > 99
				EXPORT_DRW_PDF refDrawing option itos(SHEET)+"_"+SO_NUM+"_"+ ITEM_NUM
			END_IF
			SLEEP 5.0
			WINDOW_ACTIVATE
			WINDOW_CLOSE
			ERASE_NOT_DISPLAYED
			SLEEP 5.0
		END_IF
	END_IF

	EXCEL_COLUMN++
	EXCEL_GET_VALUE 0 EXCEL_COLUMN TEST_EOF

	IF TEST_EOF == ""
		EOF = TRUE
	ELSE
		EOF = FALSE
	END_IF
END_WHILE

	EXCEL_SAVE_DOCUMENT EXCEL_DOCUMENT_NAME
	EXCEL_DISCONNECT

END_ASM_DESCR

