
BEGIN_GUI_DESCR

GLOBAL_PICTURE FRAME_5_20.GIF

SHOW_PARAM STRING ITEM_NUM
SHOW_PARAM DOUBLE STOPP
SHOW_PARAM DOUBLE RABBET
SHOW_PARAM DOUBLE XRABBET
SHOW_PARAM DOUBLE RETURN
SHOW_PARAM DOUBLE XRETURN
SHOW_PARAM DOUBLE XFACEE
SHOW_PARAM DOUBLE XHEAD
SHOW_PARAM DOUBLE HEAD_STOPP
SHOW_PARAM STRING HEAD_GRAIN
SHOW_PARAM DOUBLE JD
SHOW_PARAM DOUBLE SOFFIT
SHOW_PARAM DOUBLE THROAT
SHOW_PARAM STRING DW_RTRN
SHOW_PARAM STRING XDW_RTRN
SHOW_PARAM INTEGER HOSPITAL_STOPS_
SHOW_PARAM DOUBLE ACTIVE_LEAF
SHOW_PARAM DOUBLE TRANSOM_PANEL_HEIGHT


USER_INPUT_PARAM DOUBLE TRANSOM_HEAD	REQUIRED
USER_INPUT_PARAM DOUBLE TRANSOM_HEIGHTMM REQUIRED
USER_INPUT_PARAM INTEGER TRANSOM_SECTION REQUIRED
USER_INPUT_PARAM INTEGER FRAME_GAUGE REQUIRED
USER_INPUT_PARAM STRING  FRAME_GRADE
USER_INPUT_PARAM STRING  FRAME_FINISH
USER_INPUT_PARAM DOUBLE STOPP
USER_INPUT_PARAM DOUBLE RABBET
USER_INPUT_PARAM DOUBLE XRABBET
USER_INPUT_PARAM DOUBLE RETURN
USER_INPUT_PARAM DOUBLE XRETURN
USER_INPUT_PARAM DOUBLE XFACEE
USER_INPUT_PARAM DOUBLE XHEAD
USER_INPUT_PARAM DOUBLE HEAD_STOPP
USER_INPUT_PARAM STRING HEAD_GRAIN
USER_INPUT_PARAM DOUBLE ACTIVE_LEAF 99
USER_INPUT_PARAM DOUBLE TRANSOM_PANEL_HEIGHT


IF TRANSOM_SECTION <> SECTION
	USER_INPUT_PARAM DOUBLE TRANSOM_STOPP REQUIRED
	USER_INPUT_PARAM DOUBLE TRANSOM_ANCHOR_CENTER REQUIRED
END_IF


RADIOBUTTON_PARAM INTEGER CONSTRUCTION  "FACE WELD" "FULLY WELDED" "KNOCK DOWN"
RADIOBUTTON_PARAM INTEGER DW_RTRN_ NO IN OUT
RADIOBUTTON_PARAM INTEGER XDW_RTRN_ NO IN OUT
RADIOBUTTON_PARAM INTEGER HOSPITAL_STOPS_ NO YES
RADIOBUTTON_PARAM INTEGER SILENCERS_ NO YES


IF DW_RTRN_ == 0
	DW_RTRN = "NO"
ELSE_IF DW_RTRN_ == 1
	DW_RTRN = "IN"
ELSE_IF DW_RTRN_ == 2
	DW_RTRN = "OUT"
END_IF

IF XDW_RTRN_ == 0
	XDW_RTRN = "NO"
ELSE_IF XDW_RTRN_ == 1
	XDW_RTRN = "IN"
ELSE_IF XDW_RTRN_ == 2
	XDW_RTRN = "OUT"
END_IF

IF HOSPITAL_STOPS_ == 0
	HOSPITAL_STOPS = "NO"
ELSE_IF HOSPITAL_STOPS_ == 1
	HOSPITAL_STOPS = "YES"
END_IF

IF SILENCERS_ == 0
	SILENCERS = "NO"
ELSE_IF SILENCERS_ == 1
	SILENCERS = "YES"
END_IF


HEAD_STOPP = STOPP

END_GUI_DESCR

BEGIN_ASM_DESCR

DECLARE_VARIABLE INTEGER DW_RTRN_
DECLARE_VARIABLE INTEGER XDW_RTRN_
DECLARE_VARIABLE INTEGER HOSPITAL_STOPS_
DECLARE_VARIABLE DOUBLE MINIMUM_SOFFIT
DECLARE_VARIABLE STRING HOSPITAL_STOPS
DECLARE_VARIABLE STRING SILENCERS
DECLARE_VARIABLE STRING FRAME_CONSTRUCTION
DECLARE_VARIABLE DOUBLE TRANSOM_HEIGHT
DECLARE_VARIABLE INTEGER CONSTRUCTION


FRAME_GAUGE = 16
FRAME_GRADE = "316"
FRAME_FINISH = "6"
IF SECTION == 1
	XFACEE = FACEE + STOPP
	XHEAD = HEAD + HEAD_STOPP
END_IF


IF DW_RTRN == "NO"
	DW_RTRN_ = 0
ELSE_IF DW_RTRN == "IN" 
	DW_RTRN_ = 1
ELSE_IF DW_RTRN == "OUT"
	DW_RTRN_ = 2
END_IF

IF XDW_RTRN == "NO"
	XDW_RTRN_ = 0
ELSE_IF XDW_RTRN == "IN"
	XDW_RTRN_ = 1
ELSE_IF XDW_RTRN == "OUT"
	XDW_RTRN_ = 2
END_IF

!PROCESS FRAME INFORMATION


	THROAT = (JD-RETURN-XRETURN)

	IF XFACEE == "" OR XFACE == 0
		XFACEE = FACEE
	END_IF
	IF XHEAD == "" OR HEAD == 0
		XHEAD = HEAD
	END_IF
	IF HEAD_STOPP == "" OR HEAD_STOPP == 0
		HEAD_STOPP = STOPP
	END_IF

	IF SECTION == 0
		SOFFIT = JD
	ELSE_IF SECTION == 1
		SOFFIT = JD - RABBET
	ELSE_IF SECTION == 2
		SOFFIT = JD - RABBET - XRABBET
	END_IF

	IF SECTION == 2 AND SOFFIT < MINIMUM_SOFFIT
			MESSAGE_BOX "PLEASE ADJUST THE XRABBET BEFORE PROCEEDING"
	END_IF

	!BEGIN VERIFY FRAME STANDARDS

	WHILE SECTION == 2 AND SOFFIT < MINIMUM_SOFFIT
		MESSAGE_BOX "THERE IS A PROBLEM WITH THE CONFIGURATION"
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE SECTION #"
		USER_INPUT_PARAM INTEGER SECTION
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE XRABBET"
		USER_INPUT_PARAM DOUBLE XRABBET
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE MINIMUM SOFFIT SIZE"
		USER_INPUT_PARAM DOUBLE MINIMUM_SOFFIT		
	END_WHILE	

	IF FR_GAUGE == 12
		IF RETURN < .625 OR XRETURN < .625 OR STOPP < .75 OR HEAD_STOPP < .75
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST THROAT"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
	  MESSAGE_BOX_EX QUESTION "12 GAUGE RETURNS OR STOPS ARE TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 4
				EXIT
			END_IF
			IF CHOICE == 2 OR CHOICE == 3
				IF RETURN < .625
					RETURN = .625
				END_IF
				IF XRETURN < .625
					XRETURN = .625
				END_IF
				IF STOPP < .75
					STOPP = .75
				END_IF
				IF HEAD_STOPP < .75
					HEAD_STOPP = .75
				END_IF
				IF CHOICE == 2
					JD = THROAT+RETURN+XRETURN
				END_IF
				IF CHOICE == 3
					THROAT = JD-RETURN-XRETURN
				END_IF
			END_IF
		END_IF
	END_IF

	IF SECTION == 2
		IF JD-RABBET-XRABBET<MINIMUM_SOFFIT
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST XRABBET"
			ADD_ARRAY_ELEM arrayButtons "MAKE SINGLE RABBET"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
		MESSAGE_BOX_EX QUESTION "THE SOFFIT IS TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 5
				EXIT
			END_IF
			IF CHOICE == 2
				JD = RABBET + XRABBET + MIINIMUM_SOFFIT
			END_IF
			IF CHOICE == 3
				XRABBET = JD-MINIMUM_SOFFIT
			END_IF
			IF CHOICE == 4
				SECTION = 1
			END_IF
		END_IF
	END_IF
!END VERIFY FRAME STANDARDS

	IF FRAME_CONSTRUCTION == "FACE  WELDED" 
		CONSTRUCTION = 0
	ELSE_IF FRAME_CONSTRUCTION == "FULLY WELDED"
		CONSTRUCTION = 1
	ELSE_IF FRAME_CONSTRUCTION == "KNOCK DOWN"
		CONSTRUCTION = 2
	END_IF
	
	CONFIG_ELEM
THROAT = (JD-RETURN-XRETURN)
	
IF CONSTRUCTION == 0
	FRAME_CONSTRUCTION = "FACE  WELDED" 
ELSE_IF CONSTRUCTION == 1
	FRAME_CONSTRUCTION = "FULLY WELDED"
ELSE_IF CONSTRUCTION == 2
	FRAME_CONSTRUCTION = "KNOCK DOWN"
END_IF
	
!PROCESS FRAME INFORMATION

	IF THROAT == ""
		THROAT = (JD-RETURN-XRETURN)
	END_IF
	IF XFACEE == ""
		XFACEE = FACEE
	END_IF
	IF XHEAD == ""
		XHEAD = HEAD
	END_IF
	IF HEAD_STOPP == ""
		HEAD_STOPP = STOPP
	END_IF

	IF SECTION == 0
		SOFFIT = JD
	ELSE_IF SECTION == 1
		SOFFIT = JD - RABBET
	ELSE_IF SECTION == 2
		SOFFIT = JD - RABBET - XRABBET
	END_IF

	IF SECTION == 2 AND SOFFIT < MINIMUM_SOFFIT
			MESSAGE_BOX "PLEASE ADJUST THE XRABBET BEFORE PROCEEDING"
	END_IF

	!BEGIN VERIFY FRAME STANDARDS

	WHILE SECTION == 2 AND SOFFIT < MINIMUM_SOFFIT
		MESSAGE_BOX "THERE IS A PROBLEM WITH THE CONFIGURATION"
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE SECTION #"
		USER_INPUT_PARAM INTEGER SECTION
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE XRABBET"
		USER_INPUT_PARAM DOUBLE XRABBET
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE MINIMUM SOFFIT SIZE"
		USER_INPUT_PARAM DOUBLE MINIMUM_SOFFIT		
	END_WHILE	

	IF FR_GAUGE == 12
		IF RETURN < .625 OR XRETURN < .625 OR STOPP < .75 OR HEAD_STOPP < .75
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST THROAT"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
	  MESSAGE_BOX_EX QUESTION "12 GAUGE RETURNS OR STOPS ARE TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 4
				EXIT
			END_IF
			IF CHOICE == 2 OR CHOICE == 3
				IF RETURN < .625
					RETURN = .625
				END_IF
				IF XRETURN < .625
					XRETURN = .625
				END_IF
				IF STOPP < .75
					STOPP = .75
				END_IF
				IF HEAD_STOPP < .75
					HEAD_STOPP = .75
				END_IF
				IF CHOICE == 2
					JD = THROAT+RETURN+XRETURN
				END_IF
				IF CHOICE == 3
					THROAT = JD-RETURN-XRETURN
				END_IF
			END_IF
		END_IF
	END_IF

	IF SECTION == 2
		IF JD-RABBET-XRABBET<MINIMUM_SOFFIT
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST XRABBET"
			ADD_ARRAY_ELEM arrayButtons "MAKE SINGLE RABBET"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
		MESSAGE_BOX_EX QUESTION "THE SOFFIT IS TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 5
				EXIT
			END_IF
			IF CHOICE == 2
				JD = RABBET + XRABBET + MIINIMUM_SOFFIT
			END_IF
			IF CHOICE == 3
				XRABBET = JD-MINIMUM_SOFFIT
			END_IF
			IF CHOICE == 4
				SECTION = 1
			END_IF
		END_IF
	END_IF
!END VERIFY FRAME STANDARDS	
	TRANSOM_HEIGHT = TRANSOM_HEIGHTMM/25.4
	
END_ASM_DESCR

