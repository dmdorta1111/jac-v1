BEGIN_ASM_DESCR
	OPERATION = 1
	DOOR_INDEX = 1
	WHILE DOOR_INDEX <= DOOR_QTY
		SEARCH_MDL_REF ASSEM CSYS "DOOR" ATTACH
	
		IF SUB_TYPE == "S"
			HAND_ = HAND
		END_IF
		
		IF DOOR_INDEX == 2
			CLOSER_DESC						=	CLOSER_DESC_2	
			CLOSER_MODEL					=	CLOSER_MODEL_2
			CLOSER_SIDE						=	CLOSER_SIDE_2
			CLOSER_TYPE						=	CLOSER_TYPE_2
			CONCEALED_CLOSER_MANUFACTURER	=	CONCEALED_CLOSER_MANUFACTURER_2
			CONCEALED_CLOSER_MODEL_NUMBER	=	CONCEALED_CLOSER_MODEL_NUMBER_2
			DOOR_ELEVATION					=	DOOR_ELEVATION_2
			DOOR_WIDTH						=	DOOR_WIDTH_2
			DOOR_LITE_TRIM_TYPE				=	DOOR_LITE_TRIM_TYPE_2
			! DPS_HOLE_DIA					=	DPS_HOLE_DIA_2
			! DPS_CTR						=	DPS_2_CTR
			! DPS_MODEL						=	DPS_MODEL_2
			! DPS_POSITION					=	DPS_POSITION_2
			! DPS_UDF						=	DPS_UDF_2
			! EPT_CTR						=	EPT_2_CTR
			FLUSH_PULL						=	FLUSH_PULL_2
			FLUSH_PULL_CENTER					=	FLUSH_PULL_CENTER_2
			FLUSH_PULL_SIDE					=	FLUSH_PULL_SIDE_2
			HS_MODEL						=	HS_MODEL_2
			HS_TYPE							=	HS_TYPE_2
			HS_DESC							=	HS_DESC_2
			PULL_PLATE						=	PULL_PLATE_2
			PULL_PLATE_CENTER					=	PULL_PLATE_CENTER_2
			PULL_PLATE_HEIGHT					=	PULL_PLATE_HEIGHT_2
			PUSH_BAR						=	PUSH_BAR_2
			PUSH_BAR_CENTER					=	PUSH_BAR_CENTER_2
			PUSH_PLATE						=	PUSH_PLATE_2
			PUSH_PLATE_CENTER				=	PUSH_PLATE_CENTER_2
			PUSH_PULL_CENTER					=	PUSH_PULL_CENTER_2
			PUSH_PULL_HEIGHT					=	PUSH_PULL_HEIGHT_2
			PUSH_PULL_WIDTH					=	PUSH_PULL_WIDTH_2
			SURFACE_CLOSER_LENGTH			=	SURFACE_CLOSER_LENGTH_2
			SURFACE_CLOSER_WIDTH				=	SURFACE_CLOSER_WIDTH_2
			VISION_BOTTOM_RAIL					=	VISION_BOTTOM_RAIL_2
			VISION_CENTER_BOTTOM				=	VISION_CENTER_BOTTOM_2
			VISION_DIAMETER					=	VISION_DIAMETER_2
			VISION_HEIGHT						=	VISION_HEIGHT_2
			VISION_HINGE_STILE					=	VISION_HINGE_STILE_2
			VISION_SHAPE						=	VISION_SHAPE_2
			VISION_STRIKE_STILE					=	VISION_STRIKE_STILE_2
			VISION_TOP_RAIL					=	VISION_TOP_RAIL_2
			VISION_WIDTH						=	VISION_WIDTH_2	
			TOP_CHANNEL_DEPTH 				=	TOP_CHANNEL_DEPTH_2
			TOP_CHANNEL_THICKNESS				=	TOP_CHANNEL_THICKNESS_2
			HS_A							=	HS_A_2
			HS_B							=	HS_B_2
			HS_C							=	HS_C_2
			HS_D							=	HS_D_2
		END_IF
		
		IF DOOR_QTY == 2 AND DOOR_INDEX == 1
			IF ACTIVE_LEAF < 1 OR ACTIVE_LEAF == JOW/2 OR ACTIVE_LEAF == 99
				DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
			ELSE_IF HAND == "LHA" OR HAND == "LHRA"
				DOOR_WIDTH = (ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2))
			ELSE_IF HAND == "RHA" OR HAND == "RHRA"
				DOOR_WIDTH = JOW - ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2)
			ELSE
				DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
			END_IF

			IF HAND == "LH/RH"
				HAND_ = "LH1"
			ELSE_IF HAND == "LHA"
				HAND_ = "LHA1"
			ELSE_IF HAND == "RHA"
				HAND_ = "LHI1"
			ELSE_IF HAND == "LHR/RHR"
				HAND_ = "LHR1"
			ELSE_IF HAND == "LHRA"
				HAND_ = "LHRA1"
			ELSE_IF HAND == "RHRA"
				HAND_ = "LHRI1"
			END_IF

			CREATE_UDF udf\csys ASSEM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -((JOW/2) - HINGE_GAP - (DOOR_WIDTH/2))
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		ELSE_IF DOOR_QTY == 2 AND DOOR_INDEX == 2
			IF ACTIVE_LEAF < 1 OR ACTIVE_LEAF == JOW/2 OR ACTIVE_LEAF == 99
				DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
			ELSE_IF HAND == "LHA" OR HAND == "LHRA"
				DOOR_WIDTH = JOW - ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2)
			ELSE_IF HAND == "RHA" OR HAND == "RHRA"
				DOOR_WIDTH = (ACTIVE_LEAF - HINGE_GAP - (STRIKE_GAP/2))
			ELSE
				DOOR_WIDTH = (JOW - HINGE_GAP - HINGE_GAP - STRIKE_GAP)/2
			END_IF

			IF HAND == "LH/RH"
				HAND_ = "RH2"
			ELSE_IF HAND == "LHA"
				HAND_ = "RHI2"
			ELSE_IF HAND == "RHA"
				HAND_ = "RHA2"
			ELSE_IF HAND == "LHR/RHR"
				HAND_ = "RHR2"
			ELSE_IF HAND == "LHRA"
				HAND_ = "RHRI2"
			ELSE_IF HAND == "RHRA"
				HAND_ = "RHRA2"
			END_IF

			CREATE_UDF udf\csys ASSEM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX ((JOW/2) - HINGE_GAP - (DOOR_WIDTH/2))
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
		
		INVALIDATE_REF DOOR_ASM
		INVALIDATE_REF BODY
		INVALIDATE_REF COVER
		
		USE_LIBRARY_MDL DOOR_S asm DOOR_ASM
		
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
			ASSEMBLE DOOR_ASM ASSEM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
		SET_MDL_NAME DOOR_ASM "DOOR_ASM_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*DOOR_ASM_"+itos(DOOR_INDEX)+"_*" DOOR_ASM
		REGEN_MDL ASSEM

		SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
		SET_MDL_NAME BODY "BODY_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "BODY_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM BODY
		SET_MDL_PARAM BODY "FINISH" BODY_SIDE_FINISH
		SET_MDL_PARAM BODY "GRADE" DOOR_GRADE
		SET_MDL_PARAM BODY "SMT_THICKNESS" SM_THICK
		SET_MDL_PARAM BODY "EMJACNUM" "BODY_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

		SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
		SET_MDL_NAME COVER "COVER_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "COVER_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM COVER
		SET_MDL_PARAM COVER "FINISH" COVER_SIDE_FINISH
		SET_MDL_PARAM COVER "GRADE" DOOR_GRADE
		SET_MDL_PARAM COVER "SMT_THICKNESS" SM_THICK
		SET_MDL_PARAM COVER "EMJACNUM" "COVER_"+itos(DOOR_INDEX)+"_"+ITEM_NUM

		SEARCH_MDL_REF DOOR_ASM COMPONENT "DOOR_TEMPLATE" DOOR_TEMPLATE
		SET_MDL_NAME DOOR_TEMPLATE "DT_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "DT_"+itos(DOOR_INDEX)+"_"+SO_NUM+"_"+ITEM_NUM DOOR_TEMPLATE
		
		SET_MDL_PARAM DOOR_ASM "CUSTOMER_NAME" CUSTOMER_NAME
		SET_MDL_PARAM DOOR_ASM "JOB_NAME" JOB_NAME
		SET_MDL_PARAM DOOR_ASM "SO_NUM" SO_NUM

		SET_MDL_PARAM DOOR_ASM "SUB_JOB_NAME" SUB_JOB_NAME
		SET_MDL_PARAM DOOR_ASM "ITEM_NUM" ITEM_NUM
		SET_MDL_PARAM DOOR_ASM "QTY" QTY
		SET_MDL_PARAM DOOR_ASM "ITEM_DESC" DOOR_ITEM_DESC

		SET_MDL_PARAM DOOR_ASM "DOOR_WIDTH" DOOR_WIDTH
		SET_MDL_PARAM DOOR_ASM "DOOR_HEIGHT" DOOR_HEIGHT
		SET_MDL_PARAM DOOR_ASM "HAND" HAND_
		SET_MDL_PARAM DOOR_ASM "UNDERCUT" UNDERCUT
		SET_MDL_PARAM DOOR_ASM "DR_THICKNESS" DOOR_THICKNESS
		SET_MDL_PARAM DOOR_ASM "SM_THICK" SM_THICK

		IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
			HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

			IF HINGE_EDGE_SHAPE == "BEVEL"
				SET_MDL_PARAM DOOR_ASM "BEVEL1" 4
			ELSE_IF HINGE_EDGE_SHAPE == "SQUARE" OR HINGE_EDGE_SHAPE == "BULLNOSE"
				SET_MDL_PARAM DOOR_ASM "BEVEL1" 0
			END_IF
			IF STRIKE_EDGE_SHAPE == "BEVEL"
				SET_MDL_PARAM DOOR_ASM "BEVEL2" -4
			ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"  OR STRIKE_EDGE_SHAPE == "BULLNOSE"
				SET_MDL_PARAM DOOR_ASM "BEVEL2" 0
			END_IF
		END_IF

		IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
			HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
			HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

			IF HINGE_EDGE_SHAPE == "BEVEL"
				SET_MDL_PARAM DOOR_ASM "BEVEL2" -4
			ELSE_IF HINGE_EDGE_SHAPE == "SQUARE" OR HINGE_EDGE_SHAPE == "BULLNOSE"
				SET_MDL_PARAM DOOR_ASM "BEVEL2" 0
			END_IF
			IF STRIKE_EDGE_SHAPE == "BEVEL"
				SET_MDL_PARAM DOOR_ASM "BEVEL1" 4
			ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"  OR STRIKE_EDGE_SHAPE == "BULLNOSE"
				SET_MDL_PARAM DOOR_ASM "BEVEL1" 0
			END_IF
		END_IF		

		REGEN_MDL ASSEM
		
		IF DOOR_CONSTRUCTION == "SEAMLESS" AND HINGE_EDGE_SHAPE == "SQUARE" AND STRIKE_EDGE_SHAPE == "SQUARE" AND HAND == "NONE"
			SET_MDL_PARAM DOOR_ASM "BEVEL1" 0
			SET_MDL_PARAM DOOR_ASM "BEVEL2" 0
		
			SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			
			SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SET_MDL_PARAM BODY "SEAM1" (DOOR_THICKNESS - .125)/2

			SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_2" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SET_MDL_PARAM BODY "SEAM2" (DOOR_THICKNESS - .125)/2
			
			SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			
			SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_1" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SET_MDL_PARAM COVER "SEAM1" (DOOR_THICKNESS - .125)/2

			SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_2" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SET_MDL_PARAM COVER "SEAM2" (DOOR_THICKNESS - .125)/2
		END_IF

		
!!!!!!!!!!!
		IF DOOR_CONSTRUCTION == "SEAMLESS" AND (HINGE_EDGE_SHAPE == "BEVEL" OR HINGE_EDGE_SHAPE == "SQUARE")
			SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM BODY "SEAM1" ((DOOR_THICKNESS - .125)/2) - .25
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM BODY "SEAM2" ((DOOR_THICKNESS - .125)/2) - .25
			END_IF
			
			SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM COVER "SEAM1" ((DOOR_THICKNESS - .125)/2) + .25
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM COVER "SEAM2" ((DOOR_THICKNESS - .125)/2) + .25
			END_IF
		END_IF

		
		IF DOOR_CONSTRUCTION == "SEAMLESS" AND (STRIKE_EDGE_SHAPE == "BEVEL" OR STRIKE_EDGE_SHAPE == "SQUARE")
			SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM BODY "SEAM2" ((DOOR_THICKNESS - .125)/2) + .25
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM BODY "SEAM1" ((DOOR_THICKNESS - .125)/2) + .25
			END_IF
			
			SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM COVER "SEAM2" ((DOOR_THICKNESS - .125)/2) - .25
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM COVER "SEAM1" ((DOOR_THICKNESS - .125)/2) - .25
			END_IF
		END_IF
		
		IF DOOR_CONSTRUCTION == "SEAMLESS" AND (STRIKE_EDGE_SHAPE == "BEVEL" OR STRIKE_EDGE_SHAPE == "SQUARE") AND (HINGE_EDGE_SHAPE == "BEVEL" OR HINGE_EDGE_SHAPE == "SQUARE")
			IF TOP_EDGE == "TACKED" OR TOP_EDGE == "SEALED" OR TOP_EDGE == "SEAMLESS" OR TOP_EDGE == "POLISHED"
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "TOP_FLANGE" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM BODY "d319" (DOOR_THICKNESS - .125)/2

				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "TOP_FLANGE" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM COVER "d254" (DOOR_THICKNESS - .125)/2

				IF TOP_EDGE == "WELDED"
					MESSAGE_BOX "THE TOP EDGE IS BEING CHANGED FROM WELDED TO SEALED"
					TOP_EDGE = "SEALED"
				END_IF
				
				IF TOP_EDGE == "TACKED"
					SET_MDL_PARAM BODY "TOP_TABS" 1
					SET_MDL_PARAM COVER "TOP_TABS" 1
				END_IF
				IF TOP_EDGE == "SEALED"
					SET_MDL_PARAM BODY "TOP_TABS" 2
					SET_MDL_PARAM COVER "TOP_TABS" 2
				END_IF
				IF TOP_EDGE == "SEAMLESS"
					SET_MDL_PARAM BODY "TOP_TABS" 3
					SET_MDL_PARAM COVER "TOP_TABS" 3
				END_IF
				IF TOP_EDGE == "POLISHED"
					SET_MDL_PARAM BODY "TOP_TABS" 4
					SET_MDL_PARAM COVER "TOP_TABS" 4
				END_IF
			END_IF

			IF (BOTTOM_EDGE == "TACKED" OR BOTTOM_EDGE == "SEALED" OR BOTTOM_EDGE == "SEAMLESS" OR BOTTOM_EDGE == "POLISHED") AND AUTO_BOTTOM <> 2
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BOT_FLANGE" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM BODY "d320" (DOOR_THICKNESS - .125)/2

				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BOT_FLANGE" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SET_MDL_PARAM COVER "d255" (DOOR_THICKNESS - .125)/2

				IF BOTTOM_EDGE == "WELDED"
					MESSAGE_BOX "THE BOTTOM EDGE IS BEING CHANGED FROM WELDED TO SEALED"
					BOTTOM_EDGE = "SEALED"
				END_IF
				
				IF BOTTOM_EDGE == "TACKED"
					SET_MDL_PARAM BODY "BOT_TABS" 1
					SET_MDL_PARAM COVER "BOT_TABS" 1
				END_IF
				IF BOTTOM_EDGE == "SEALED"
					SET_MDL_PARAM BODY "BOT_TABS" 2
					SET_MDL_PARAM COVER "BOT_TABS" 2
				END_IF
				IF BOTTOM_EDGE == "SEAMLESS"
					SET_MDL_PARAM BODY "BOT_TABS" 3
					SET_MDL_PARAM COVER "BOT_TABS" 3
				END_IF
				IF BOTTOM_EDGE == "POLISHED"
					SET_MDL_PARAM BODY "BOT_TABS" 4
					SET_MDL_PARAM COVER "BOT_TABS" 4
				END_IF
			END_IF
						
			IF WEEP_HOLES == 1
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "WEEP" refFeat
				SET_FEATURE_STATE refFeat RESUMED
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "WEEP" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF
		END_IF



!!!!!!!!!!!			
		! IF DOOR_CONSTRUCTION == "SEAMLESS" AND (HINGE_EDGE_SHAPE == "BEVEL" OR HINGE_EDGE_SHAPE == "SQUARE")
			! SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			
			! IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "SEAM1" ((DOOR_THICKNESS - .125)/2) - ((1/64) * BEVEL) - .25
			! END_IF

			! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "SEAM2" ((DOOR_THICKNESS - .125)/2) - ((1/64) * BEVEL) - .25
			! END_IF
			
			! ! IF HAND == "NONE"
				! ! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
				! ! SET_FEATURE_STATE refFeat RESUMED
				! ! SET_MDL_PARAM BODY "SEAM1" DOOR_THICKNESS/2
			! ! END_IF
		! END_IF	

		! IF DOOR_CONSTRUCTION == "SEAMLESS" AND (STRIKE_EDGE_SHAPE == "BEVEL" OR STRIKE_EDGE_SHAPE == "SQUARE")
			! SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			
			! IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "SEAM2" ((DOOR_THICKNESS - .125)/2) - ((1/64) * BEVEL) + .25
			! END_IF

			! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "SEAM1" ((DOOR_THICKNESS - .125)/2) - ((1/64) * BEVEL) + .25
			! END_IF
		! END_IF	

		! IF DOOR_CONSTRUCTION == "SEAMLESS" AND (STRIKE_EDGE_SHAPE == "BEVEL" OR STRIKE_EDGE_SHAPE == "SQUARE") AND (HINGE_EDGE_SHAPE == "BEVEL" OR HINGE_EDGE_SHAPE == "SQUARE")
			! IF TOP_EDGE == "SEAMLESS"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "TOP_1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "d319" (DOOR_THICKNESS - .125)/2
			! END_IF
			! IF BOTTOM_EDGE == "SEAMLESS"
				! IF AUTO_BOTTOM <> 2
					! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BOT_1" refFeat
					! SET_FEATURE_STATE refFeat RESUMED
					! SET_MDL_PARAM BODY "d320" (DOOR_THICKNESS - .125)/2
				! END_IF
			! END_IF
			
			! IF TOP_EDGE == "WELDED"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "TOP_2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "d385" (DOOR_THICKNESS - .125)/2
				! SET_MDL_PARAM BODY "d438" DOOR_WIDTH - 6
			! END_IF
			! IF BOTTOM_EDGE == "WELDED"
				! IF AUTO_BOTTOM <> 2
					! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BOT_2" refFeat
					! SET_FEATURE_STATE refFeat RESUMED
					! SET_MDL_PARAM BODY "d396" DOOR_WIDTH - 6
					! SET_MDL_PARAM BODY "d380" (DOOR_THICKNESS - .125)/2
				! END_IF
			! END_IF
			
			! IF TOP_EDGE == "TACKED"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "TOP_3" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM BODY "d439" DOOR_WIDTH - 6
				! SET_MDL_PARAM BODY "d409" (DOOR_THICKNESS - .125)/2				
			! END_IF
			! IF BOTTOM_EDGE == "TACKED"
				! IF AUTO_BOTTOM <> 2
					! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BOT_3" refFeat
					! SET_FEATURE_STATE refFeat RESUMED
					! SET_MDL_PARAM BODY "d440" DOOR_WIDTH - 6
					! SET_MDL_PARAM BODY "d432" (DOOR_THICKNESS - .125)/2				
				! END_IF
			! END_IF
			
			! IF WEEP_HOLES == 1
				! SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "WEEP" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
			! END_IF
		! END_IF

		! IF DOOR_CONSTRUCTION == "SEAMLESS" AND (HINGE_EDGE_SHAPE == "BEVEL" OR HINGE_EDGE_SHAPE == "SQUARE")		
			! SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			
			! IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "SEAM1" ((DOOR_THICKNESS - .125)/2) + ((1/64) * BEVEL) + .25
			! END_IF

			! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "SEAM2" ((DOOR_THICKNESS - .125)/2) + ((1/64) * BEVEL) + .25
			! END_IF			
		! END_IF

		! IF DOOR_CONSTRUCTION == "SEAMLESS" AND (STRIKE_EDGE_SHAPE == "BEVEL" OR STRIKE_EDGE_SHAPE == "SQUARE")		
			! SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			
			! IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "SEAM2" ((DOOR_THICKNESS - .125)/2) + ((1/64) * BEVEL) - .25
			! END_IF

			! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "SEAM1" ((DOOR_THICKNESS - .125)/2) + ((1/64) * BEVEL) - .25
			! END_IF			
		! END_IF
		
		! IF DOOR_CONSTRUCTION == "SEAMLESS" AND (STRIKE_EDGE_SHAPE == "BEVEL" OR STRIKE_EDGE_SHAPE == "SQUARE") AND (HINGE_EDGE_SHAPE == "BEVEL" OR HINGE_EDGE_SHAPE == "SQUARE")
			! IF TOP_EDGE == "SEAMLESS"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "TOP_1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "d254" (DOOR_THICKNESS - .125)/2
			! END_IF
			! IF BOTTOM_EDGE == "SEAMLESS"
				! IF AUTO_BOTTOM <> 2
					! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BOT_1" refFeat
					! SET_FEATURE_STATE refFeat RESUMED
					! SET_MDL_PARAM COVER "d255" (DOOR_THICKNESS - .125)/2
				! END_IF
			! END_IF
			
			! IF TOP_EDGE == "WELDED"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "TOP_2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "d303" DOOR_WIDTH - 6
				! SET_MDL_PARAM COVER "d294" (DOOR_THICKNESS - .125)/2
			! END_IF
			! IF BOTTOM_EDGE == "WELDED"
				! IF AUTO_BOTTOM <> 2
					! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BOT_2" refFeat
					! SET_FEATURE_STATE refFeat RESUMED
					! SET_MDL_PARAM COVER "d324" DOOR_WIDTH - 6
					! SET_MDL_PARAM COVER "d316" (DOOR_THICKNESS - .125)/2
				! END_IF
			! END_IF
			
			! IF TOP_EDGE == "TACKED"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "TOP_3" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SET_MDL_PARAM COVER "d361" DOOR_WIDTH - 6
				! SET_MDL_PARAM COVER "d337" (DOOR_THICKNESS - .125)/2
			! END_IF
			! IF BOTTOM_EDGE == "TACKED"
				! IF AUTO_BOTTOM <> 2
					! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BOT_3" refFeat
					! SET_FEATURE_STATE refFeat RESUMED
					! SET_MDL_PARAM COVER "d362" DOOR_WIDTH - 6
					! SET_MDL_PARAM COVER "d355" (DOOR_THICKNESS - .125)/2
				! END_IF
			! END_IF
			
			! IF WEEP_HOLES == 1
				! SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "WEEP" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
			! END_IF
		! END_IF

		IF DOOR_CONSTRUCTION == "SEAMLESS" AND HINGE_EDGE_SHAPE == "BULLNOSE"
			SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BULLNOSE_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BULLNOSE_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF
		END_IF	

		IF DOOR_CONSTRUCTION == "SEAMLESS" AND STRIKE_EDGE_SHAPE == "BULLNOSE"
			SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BULLNOSE_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "BULLNOSE_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF
		END_IF	

		IF DOOR_CONSTRUCTION == "SEAMLESS" AND HINGE_EDGE_SHAPE == "BULLNOSE"
			SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BULLNOSE_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BULLNOSE_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF
		END_IF	

		IF DOOR_CONSTRUCTION == "SEAMLESS" AND STRIKE_EDGE_SHAPE == "BULLNOSE"
			SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			
			IF 	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BULLNOSE_2" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"			
				SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "BULLNOSE_1" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF
		END_IF	
		
		IF DOOR_CONSTRUCTION == "LOCKSEAM"
			SEARCH_MDL_REF DOOR_ASM COMPONENT "BODY*" BODY
			SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "LOCKSEAM_1" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "LOCKSEAM_2" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SEARCH_MDL_REF DOOR_ASM COMPONENT "COVER*" COVER
			SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "LOCKSEAM_1" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "LOCKSEAM_2" refFeat
			SET_FEATURE_STATE refFeat RESUMED
		END_IF

		! IF CHOICE == 5
			IF TOP_EDGE == "INVERTED" OR TOP_EDGE == "FLUSH"
				RETRIEVE_MDL CLOSURE_CHANNEL.PRT COMP
				SEARCH_MDL_REF DOOR_ASM CSYS "TOP_CHANNEL" ATTACH			
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					SET_ON_LAYER COMP "COMPONENTS"

					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "SMT_THICKNESS" TOP_CHANNEL_THICKNESS
					SET_MDL_PARAM COMP "WEEP_HOLES" 0
				
					IF SUB_TYPE == "S"
						SET_MDL_PARAM COMP "d41" DOOR_WIDTH - CLOSURE_CHANNEL_CLEARANCE
					ELSE_IF SUB_TYPE == "P"
						SET_MDL_PARAM COMP "d41" DOOR_WIDTH - CLOSURE_CHANNEL_CLEARANCE - .0625
					END_IF
					
					SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
					SET_MDL_PARAM COMP "d40" DOOR_THICKNESS - .125
					SET_MDL_PARAM COMP "d45" TOP_CHANNEL_DEPTH + TOP_CHANNEL_THICKNESS
					
					IF SUB_TYPE == "P" AND (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3)
						SET_MDL_PARAM COMP "FLUSH_BOLTS" 1
					ELSE
						SET_MDL_PARAM COMP "FLUSH_BOLTS" 0
					END_IF

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
				IF TOP_EDGE == "FLUSH" OR (SUB_TYPE == "S" AND DPS == 1 AND DPS_POSITION == 0)  !HEAD
					SEARCH_MDL_REF COMP CSYS "ATTACH" ATTACH
					
					RETRIEVE_MDL FLUSHING_CHANNEL.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE COMP DOOR_ASM
							 CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						
						SET_MDL_PARAM COMP "STOCKTYPE" 1
						SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
						SET_MDL_PARAM COMP "SMT_THICKNESS" .05
						
						IF SUB_TYPE == "S"
							SET_MDL_PARAM COMP "d41" DOOR_WIDTH - SM_THICK - SM_THICK - .06
						ELSE_IF SUB_TYPE == "P"
							SET_MDL_PARAM COMP "d41" DOOR_WIDTH - SM_THICK - SM_THICK - .06 - .0625
						END_IF
						
						SET_MDL_PARAM COMP "d40" DOOR_THICKNESS - .125 - (2*TOP_CHANNEL_THICKNESS) - .0625
						SET_MDL_PARAM COMP "d45" TOP_CHANNEL_DEPTH -.06
						SET_MDL_PARAM COMP "TOP_CHANNEL_THICKNESS" TOP_CHANNEL_THICKNESS
						SET_MDL_PARAM COMP	 "d69" BEVEL
						SET_MDL_PARAM COMP	 "d71" BEVEL
						
						IF DOOR_CONSTRUCTION == "LOCKSEAM"
							SET_MDL_PARAM COMP "LOCKSEAM"  1
						ELSE
							SET_MDL_PARAM COMP "LOCKSEAM"  0
						END_IF

						IF HAND_ == "LHI1" AND (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) 
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 1
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 0
						ELSE_IF HAND_ == "LHRI1" AND (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) 
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 0
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 1
						ELSE_IF HAND_ == "RHI2" AND (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) 
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 0
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 1
						ELSE_IF HAND_ == "RHRI2" AND (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) 
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 1
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 0
						ELSE_IF HAND_ <> "*I*"
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 0
							SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 0
						END_IF

					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
					
				END_IF
			END_IF
		! END_IF
		
		IF DOOR_INDEX == 1 AND HOLDER_STOP == 1 AND HS_TYPE == 2
			CALL holder_stop.tab
		END_IF

		IF DOOR_INDEX == 2 AND HOLDER_STOP == 1 AND HS_TYPE_2 == 2
			CALL holder_stop.tab
		END_IF
		
		IF BOTTOM_EDGE == "INVERTED" OR BOTTOM_EDGE == "FLUSH" OR ADD_BOTTOM_CHANNEL == 1
			SEARCH_MDL_REF DOOR_ASM CSYS "BOTTOM_CHANNEL" ATTACH
			RETRIEVE_MDL CLOSURE_CHANNEL.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				
				IF ADD_BOTTOM_CHANNEL == 0
					SET_ON_LAYER COMP "COMPONENTS"
				END_IF

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "SMT_THICKNESS" BOTTOM_CHANNEL_THICKNESS
				
				IF SUB_TYPE == "S"
					SET_MDL_PARAM COMP "d41" DOOR_WIDTH - CLOSURE_CHANNEL_CLEARANCE
				ELSE_IF SUB_TYPE == "P"
					SET_MDL_PARAM COMP "d41" DOOR_WIDTH - CLOSURE_CHANNEL_CLEARANCE - .0625
				END_IF
								
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "d40" DOOR_THICKNESS - .125
				SET_MDL_PARAM COMP "WEEP_HOLES" WEEP_HOLES
				
				IF AUTO_BOTTOM == 2
					SET_MDL_PARAM COMP "d45" BOTTOM_CHANNEL_DEPTH
					CALL auto_bottom.tab
				ELSE
					SET_MDL_PARAM COMP "d45" BOTTOM_CHANNEL_DEPTH + BOTTOM_CHANNEL_THICKNESS
				END_IF
						
				IF SUB_TYPE == "P" AND (FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3)
					SET_MDL_PARAM COMP "FLUSH_BOLTS" 1
				ELSE
					SET_MDL_PARAM COMP "FLUSH_BOLTS" 0
				END_IF

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX

			IF BOTTOM_EDGE == "FLUSH"
				SEARCH_MDL_REF COMP CSYS "ATTACH" ATTACH
				
				RETRIEVE_MDL FLUSHING_CHANNEL.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					
					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
					SET_MDL_PARAM COMP "SMT_THICKNESS" .05
					
					IF SUB_TYPE == "S"
						SET_MDL_PARAM COMP "d41" DOOR_WIDTH - SM_THICK - SM_THICK - .06
					ELSE_IF SUB_TYPE == "P"
						SET_MDL_PARAM COMP "d41" DOOR_WIDTH - SM_THICK - SM_THICK - .06 - .0625
					END_IF
					
					SET_MDL_PARAM COMP "d40" DOOR_THICKNESS - .125 - .15
					SET_MDL_PARAM COMP "d45" TOP_CHANNEL_DEPTH
					SET_MDL_PARAM COMP	 "d69" BEVEL
					SET_MDL_PARAM COMP	 "d71" BEVEL
					
					IF DOOR_CONSTRUCTION == "LOCKSEAM"
						SET_MDL_PARAM COMP "LOCKSEAM"  1
					ELSE
						SET_MDL_PARAM COMP "LOCKSEAM"  0
					END_IF
					
					IF HAND_ == "LHI1" AND (FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3) 
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 0
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 1
					ELSE_IF HAND_ == "LHRI1" AND (FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3) 
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 1
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 0
					ELSE_IF HAND_ == "RHI2" AND (FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3) 
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 1
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 0
					ELSE_IF HAND_ == "RHRI2" AND (FLUSH_BOLTS == 2 OR FLUSH_BOLTS == 3) 
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 0
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 1
					ELSE_IF HAND_ <> "*I*"
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_A" 0
						SET_MDL_PARAM COMP	 "FLUSH_BOLT_B" 0
					END_IF					

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
			END_IF
		END_IF

		IF (BOTTOM_EDGE == "SEAMLESS" OR BOTTOM_EDGE == "WELDED" OR BOTTOM_EDGE == "TACKED") AND AUTO_BOTTOM == 2
			SEARCH_MDL_REF ALLOW_SUPPRESSED BODY FEATURE "SEAMLESS_AUTO_BOTTOM" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SET_MDL_PARAM BODY "d318" (DOOR_THICKNESS - .125 - AUTO_BOTT_WIDTH- BOTTOM_CHANNEL_THICKNESS- BOTTOM_CHANNEL_THICKNESS)/2
			
			SEARCH_MDL_REF ALLOW_SUPPRESSED COVER FEATURE "SEAMLESS_AUTO_BOTTOM" refFeat
			SET_FEATURE_STATE refFeat RESUMED
			SET_MDL_PARAM COVER "d247" (DOOR_THICKNESS - .125 - AUTO_BOTT_WIDTH-BOTTOM_CHANNEL_THICKNESS-BOTTOM_CHANNEL_THICKNESS)/2
		
			SEARCH_MDL_REF DOOR_ASM CSYS "BOTTOM_CHANNEL" ATTACH

			RETRIEVE_MDL SEAMLESS_AUTO_BOTTOM.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" 1
			SET_MDL_PARAM COMP "d41" DOOR_WIDTH - .25 - (2*SM_THICK)
			SET_MDL_PARAM COMP "d40" AUTO_BOTT_DEPTH
			SET_MDL_PARAM COMP "D95" AUTO_BOTT_WIDTH +.02
			SET_MDL_PARAM COMP "D112" (DOOR_THICKNESS - .125 - AUTO_BOTT_WIDTH-BOTTOM_CHANNEL_THICKNESS-BOTTOM_CHANNEL_THICKNESS)/2
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			
			IF PLUNGER_HOLE == 1
				CALL auto_bottom.tab
			END_IF
			
		END_IF
		
		IF SUB_TYPE == "P" AND ASTRAGAL == 1 
			IF HAND_ == "*A*" AND ASTRAGAL_DOOR == "ACTIVE"
				IF	HAND_ == "LHRA1"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
					SEARCH_MDL_REF BODY SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2)
						UDF_DIM	LOCZ 1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				IF	HAND_ == "RHRA2"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
					SEARCH_MDL_REF BODY SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2)
						UDF_DIM	LOCZ -1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				IF	HAND_ == "RHA2"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
					SEARCH_MDL_REF COVER SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 180
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + ((DOOR_HEIGHT-STOPP)/2)
						UDF_DIM	LOCZ -1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				IF	HAND_ == "LHA1"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
					SEARCH_MDL_REF COVER SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 180
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + ((DOOR_HEIGHT-STOPP)/2)
						UDF_DIM	LOCZ 1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				
				RETRIEVE_MDL ASTRAGAL.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					
					SET_MDL_PARAM COMP	 "d40" ASTRAGAL_WIDTH
					SET_MDL_PARAM COMP	 "GRADE" DOOR_GRADE	
					
					IF (HAND_ == "LHRA1" OR HAND_ == "RHRA2") AND ASTRAGAL_DOOR == "ACTIVE"
						SET_MDL_PARAM COMP "d41" DOOR_HEIGHT
						SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH
					ELSE_IF (HAND_ == "LHA1" OR HAND_ == "RHA2") AND ASTRAGAL_DOOR == "ACTIVE"
						SET_MDL_PARAM COMP "d41" DOOR_HEIGHT + TOP_GAP - STOPP - .0625
						SET_MDL_PARAM COMP "FINISH" COVER_SIDE_FINISH
					END_IF			
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
			END_IF

			IF HAND_ == "*I*" AND ASTRAGAL_DOOR == "INACTIVE"
				IF	HAND_ == "LHRI1"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
					SEARCH_MDL_REF COVER SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2) - (STOPP/2) +.03125
						UDF_DIM	LOCZ -1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				IF	HAND_ == "RHRI2"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
					SEARCH_MDL_REF COVER SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 180
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2) - (STOPP/2) + .03125
						UDF_DIM	LOCZ 1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				IF	HAND_ == "RHI2"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
					SEARCH_MDL_REF BODY SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2)
						UDF_DIM	LOCZ 1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				IF	HAND_ == "LHI1"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
					SEARCH_MDL_REF BODY SURFACE "FIXED" FIXED
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX .125
						UDF_DIM	LOCY UNDERCUT + (DOOR_HEIGHT/2)
						UDF_DIM	LOCZ -1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				
				RETRIEVE_MDL ASTRAGAL.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					
					SET_MDL_PARAM COMP	 "d40" ASTRAGAL_WIDTH
					SET_MDL_PARAM COMP	 "GRADE" DOOR_GRADE	
					
					IF (HAND_ == "LHRI1" OR HAND_ == "RHRI2") AND ASTRAGAL_DOOR == "INACTIVE"
						SET_MDL_PARAM COMP "d41" DOOR_HEIGHT + TOP_GAP - STOPP - .0625
						SET_MDL_PARAM COMP "FINISH" COVER_SIDE_FINISH
					ELSE_IF (HAND_ == "LHI1" OR HAND_ == "RHI2") AND ASTRAGAL_DOOR == "INACTIVE"
						SET_MDL_PARAM COMP "d41" DOOR_HEIGHT
						SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH
					END_IF			
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
				IF ASTRAGAL_INSTALLED == 1
					SEARCH_MDL_REF COMP AXIS "HOLE_AXIS" HOLE_AXIS
					CREATE_UDF udf\astragal_hole COVER ASTRAGAL_HOLE
						UDF_REF SURF FIXED
						UDF_REF AX HOLE_AXIS
						UDF_INTERSECTION * PART_LEVEL		
						UDF_EXP_REF HOLE FEATURE 0
					END_CREATE_UDF
					
					UNGROUP_FEATURES ASTRAGAL_HOLE
					CREATE_REF_PATTERN  HOLE
				END_IF
			END_IF

			
		END_IF

		IF DOOR_LITE == 2 OR (HAND_ == "*A*" AND DOOR_LITE == 0) OR (HAND_ == "*I*" AND DOOR_LITE == 1)
			IF DOOR_ELEVATION <> "F"
				IF DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "M1-3" OR DOOR_ELEVATION == "M1-2" OR DOOR_ELEVATION == "NB"
					VISION_HINGE_STILE = (JOW - STRIKE_GAP - HINGE_GAP - VISION_WIDTH)/2
				END_IF

				IF VISION_CENTER_BOTTOM > 1
					VISION_BOTTOM_RAIL = VISION_CENTER_BOTTOM - UNDERCUT - (VISION_HEIGHT/2)
				END_IF
				
				IF VISION_SHAPE == 1 AND VISION_TOP_RAIL < 1
					VISION_TOP_RAIL = JOH - TOP_GAP - VISION_BOTTOM_RAIL - VISION_HEIGHT - UNDERCUT
				END_IF

				IF VISION_SHAPE == 1 AND VISION_BOTTOM_RAIL < 1
					VISION_BOTTOM_RAIL = JOH - TOP_GAP - VISION_TOP_RAIL - VISION_HEIGHT - UNDERCUT
				END_IF

				IF VISION_SHAPE == 1 AND VISION_HEIGHT < 1
					VISION_HEIGHT = JOH - TOP_GAP - VISION_TOP_RAIL - VISION_BOTTOM_RAIL - UNDERCUT
				END_IF

				IF VISION_SHAPE == 1 AND VISION_WIDTH < 1
					VISION_WIDTH = JOW - HINGE_GAP - STRIKE_GAP - VISION_STRIKE_STILE - VISION_HINGE_STILE
				END_IF

				IF VISION_SHAPE == 1 AND DOOR_LITE_TRIM_TYPE == "A"
					CALL vision_a.tab
				END_IF
				
				IF VISION_SHAPE == 1 AND DOOR_LITE_TRIM_TYPE == "B"
					CALL vision_b.tab
				END_IF

				IF VISION_SHAPE == 1 AND DOOR_LITE_TRIM_TYPE == "C"
					CALL vision_c.tab
				END_IF
				
				IF VISION_SHAPE == 1 AND DOOR_LITE_TRIM_TYPE == "D" AND DOOR_ELEVATION <> "M*"
					CALL vision_d.tab
				END_IF
											
				IF VISION_SHAPE == 1 AND DOOR_LITE_TRIM_TYPE == "E"
					CALL vision_e.tab
				END_IF
				
				IF VISION_SHAPE == 1 AND DOOR_LITE_TRIM_TYPE == "F" AND DOOR_ELEVATION <> "M*"
					CALL vision_f.tab
				END_IF
				
				IF VISION_SHAPE == 0
					CALL vision_round.tab
				END_IF
				
			END_IF
			
			IF DOOR_ELEVATION == "M1-1"
				CALL m1_1.tab
			END_IF

			IF DOOR_ELEVATION == "M1-3"
				CALL m1_3.tab
			END_IF

			IF DOOR_ELEVATION == "M2"
				CALL M2.tab
			END_IF

			IF DOOR_ELEVATION == "NB"
				CALL vision_nb.tab
			END_IF
		END_IF
		
		IF DOOR_ELEVATION == "*L*"
			CALL door_louver.tab
		END_IF

		IF HINGE_TYPE == "BUTT" OR HINGE_TYPE == "DBL_ACTING" OR HINGE_TYPE == "HALF_MORTISE"
			CALL hinge_butt_door.tab
		END_IF
		
		IF (CLOSER == 1 AND CLOSER_TYPE == 1) OR AUTO_OPERATOR == 1 OR HS_TYPE == 1
			CALL closers.tab
		END_IF

		PRINT "%" PRIMARY_LOCK
		PRINT "%" PRIMARY_LOCK_TYPE
		PRINT "%" SUB_TYPE
		PRINT "%" HAND_
		
		IF PRIMARY_LOCK_TYPE > 0 AND (SUB_TYPE == "S" OR HAND_ == "*A*" OR HAND_ == "LHR1" OR HAND_ == "RHR2") 
			OPERATION 				=	1
			LOCK_INDEX				= 	1
			STRIKE_CENTER			=	PRIMARY_STRIKE_CENTER
			CALL LOCK_OPTIONS.TAB
		END_IF

		IF SECONDARY_LOCK_TYPE > 0 AND (SUB_TYPE == "S" OR HAND_ == "*A*")
			OPERATION 				=	1
			LOCK_INDEX				= 	2
			STRIKE_CENTER			=	SECONDARY_STRIKE_CENTER		
			CALL LOCK_OPTIONS.TAB			
		END_IF

		IF DUMMY_TRIM == 1 AND SUB_TYPE == "P" AND HAND_ == "*I*" 
			OPERATION 				=	1
			STRIKE_CENTER			=	PRIMARY_STRIKE_CENTER		
			CALL DUMMY_TRIM.TAB
		END_IF
		
		IF PUSH_PULL == 1
			CALL push_pull.tab
		END_IF

		IF HASP == 1
			CALL hasp.tab
		END_IF

		IF TUFLOCK == 1
			CALL tuflock.tab
		END_IF		

		IF (HAND_ == "*I*" OR HAND_ == "LHR1" OR HAND_ == "RHR2" ) AND PRIMARY_STRIKE_TYPE > 0 AND PRIMARY_STRIKE_TYPE < 80
			CALL strikes.tab
		END_IF

		IF (HAND_ == "LHR" OR HAND_ == "RHR" OR HAND_ == "LHR1" OR HAND_ == "RHR2" ) AND PRIMARY_STRIKE_TYPE > 80
			CALL strikes.tab
		END_IF
		
		CALL core.tab
		
		IF SUB_TYPE == "S" AND DPS > 0
			CALL dps.tab
		END_IF

		IF SUB_TYPE == "P" AND (DPS == 1 OR DPS == 3) AND DOOR_INDEX == 1
			CALL dps.tab
		END_IF

		IF SUB_TYPE == "P" AND (DPS == 2 OR DPS == 3) AND DOOR_INDEX == 2
			CALL dps.tab
		END_IF
		
		
		IF FLUSH_BOLTS > 0 AND HAND_ == "*I*"
			CALL flush_bolts.tab
		END_IF
		
		IF SURFACE_BOLTS > 0 AND HAND_ == "*I*"
			IF	HAND_ == "RHI*"
				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
				FLIP = 0
			END_IF
			IF	HAND_ == "LHRI*"
				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
				FLIP = 180
			END_IF
			IF HAND_ == "LHI*"
				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
				FLIP = 0
			END_IF
			IF HAND_ == "RHRI*"
				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
				FLIP = 180
			END_IF

			IF SURFACE_BOLTS == 1 OR 	SURFACE_BOLTS == 3
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX FLIP
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -1.75
					UDF_DIM	LOCY UNDERCUT + DOOR_HEIGHT - TOP_CHANNEL_DEPTH - 3.5
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL SURF_BOLT_BOX.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH2 PLACEMENT
					END_ASSEMBLE

				IF DOOR_CONSTRUCTION == LOCKSEAM AND STD_REV == "STD"
					SET_MDL_PARAM COMP "d52" 1.375
				ELSE
					SET_MDL_PARAM COMP "d52" 1.6
				END_IF
					
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

			END_IF

			IF SURFACE_BOLTS == 2 OR 	SURFACE_BOLTS == 3
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX FLIP
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -1.75
					UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + 3.5
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL SURF_BOLT_BOX.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH2 PLACEMENT
					END_ASSEMBLE
					
				IF DOOR_CONSTRUCTION == LOCKSEAM AND STD_REV == "STD"
					SET_MDL_PARAM COMP "d52" 1.375
				ELSE
					SET_MDL_PARAM COMP "d52" 1.6
				END_IF

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
			END_IF
		END_IF
		
		! BEGIN DOOR PREPS - CONTINUOUS HINGE
		IF HINGE_TYPE == "CONTINUOUS" AND THRU_BOLT == 0
			DECLARE_VARIABLE DOUBLE BU_WIDTH
			DECLARE_VARIABLE DOUBLE BU_LOC

			IF DOOR_CONSTRUCTION == "SEAMLESS"
				BU_WIDTH = 1.5625
				BU_LOC = SM_THICK - .0625 + (DOOR_THICKNESS/2)
			ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
				BU_WIDTH = 1.3125
				BU_LOC = (SM_THICK - .0625 + (DOOR_THICKNESS/2)) - .09375
			END_IF

			IF SUB_TYPE == "S"			
				IF	HAND_ == "LHR" OR HAND_ == "RH"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS11" ASM_CSYS
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -SM_THICK
						UDF_DIM	LOCY JOH - TOP_GAP -.25
						UDF_DIM	LOCZ BU_LOC
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				
				IF	HAND_ == "RHR" OR HAND_ == "LH"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS12" ASM_CSYS
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 180
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -SM_THICK
						UDF_DIM	LOCY -(JOH - TOP_GAP -.25)
						UDF_DIM	LOCZ BU_LOC
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
					
				RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					SET_ON_LAYER COMP "COMPONENTS"
				
				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" "999"
				SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
				
				IF EPT == 1
					SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) - .5
				ELSE
					SET_MDL_PARAM COMP "d41" JOH - TOP_GAP - TOP_CHANNEL_DEPTH - UNDERCUT - BOTTOM_CHANNEL_DEPTH
				END_IF
								
				! SET_MDL_PARAM COMP "d41" JOH - 1
				SET_MDL_PARAM COMP "d40" BU_WIDTH
				SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
				SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
				IF DOOR_CONSTRUCTION == "SEAMLESS"
					SET_FEATURE_STATE refFeat RESUMED
				ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
					SET_FEATURE_STATE refFeat SUPPRESSED
				END_IF
				
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX			
						
				IF EPT == 1
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY -(EPT_CTR + (EPT_LENGTH/2)-.25)
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

						ASSEMBLE COMP DOOR_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						SET_ON_LAYER COMP "COMPONENTS"
					
					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "EMJACNUM" "999"
					SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
					
					SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) - .5
									
					SET_MDL_PARAM COMP "d41" JOH - TOP_GAP - TOP_CHANNEL_DEPTH - UNDERCUT - EPT_CTR - (EPT_LENGTH/2) - BOTTOM_CHANNEL_DEPTH
					SET_MDL_PARAM COMP "d40" 1.5625
					SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
					SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
					IF DOOR_CONSTRUCTION == "SEAMLESS"
						SET_FEATURE_STATE refFeat RESUMED
					ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
						SET_FEATURE_STATE refFeat SUPPRESSED
					END_IF
					
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
				END_IF
			END_IF

			IF SUB_TYPE == "P"
				IF 	HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS11" ASM_CSYS
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -SM_THICK
						UDF_DIM	LOCY JOH - TOP_GAP -.25
						UDF_DIM	LOCZ BU_LOC
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
					
				IF 	HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS12" ASM_CSYS
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 180
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -SM_THICK
						UDF_DIM	LOCY -(JOH - TOP_GAP -.25)
						UDF_DIM	LOCZ BU_LOC
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				
				IF	HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
						SEARCH_MDL_REF DOOR_ASM CSYS "ACS11" ASM_CSYS
						CREATE_UDF udf\csys DOOR_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -SM_THICK
							UDF_DIM	LOCY JOH - TOP_GAP -.25
							UDF_DIM	LOCZ BU_LOC
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
				END_IF
				
				IF	HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2"
					SEARCH_MDL_REF DOOR_ASM CSYS "ACS12" ASM_CSYS
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 180
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -SM_THICK
						UDF_DIM	LOCY -(JOH - TOP_GAP -.25)
						UDF_DIM	LOCZ BU_LOC
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF

				RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					SET_ON_LAYER COMP "COMPONENTS"
				
				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" "999"
				SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
				
				IF ((EPT == 1 OR EPT == 3) AND DOOR_INDEX == 1) OR ((EPT == 2 OR EPT == 3) AND DOOR_INDEX == 2)
					SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) - .5
				ELSE
					SET_MDL_PARAM COMP "d41" JOH - TOP_GAP - TOP_CHANNEL_DEPTH - UNDERCUT - BOTTOM_CHANNEL_DEPTH
				END_IF

				SET_MDL_PARAM COMP "d40" 1.5625
				SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
				SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
				IF DOOR_CONSTRUCTION == "SEAMLESS"
					SET_FEATURE_STATE refFeat RESUMED
				ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
					SET_FEATURE_STATE refFeat SUPPRESSED
				END_IF
				
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX			
					
				IF ((EPT == 1 OR EPT == 3) AND DOOR_INDEX == 1) OR ((EPT == 2 OR EPT == 3) AND DOOR_INDEX == 2)
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY -(EPT_CTR + (EPT_LENGTH/2)-.25)
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

						ASSEMBLE COMP DOOR_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						SET_ON_LAYER COMP "COMPONENTS"
				
					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "EMJACNUM" "999"
					SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
					
					SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) - .5
									
					SET_MDL_PARAM COMP "d41" JOH - TOP_GAP - TOP_CHANNEL_DEPTH - UNDERCUT - EPT_CTR - (EPT_LENGTH/2) - BOTTOM_CHANNEL_DEPTH
					SET_MDL_PARAM COMP "d40" 1.5625
					SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
					SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
					IF DOOR_CONSTRUCTION == "SEAMLESS"
						SET_FEATURE_STATE refFeat RESUMED
					ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
						SET_FEATURE_STATE refFeat SUPPRESSED
					END_IF
					
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
				END_IF
			END_IF
		END_IF
		
		
		IF HINGE_TYPE == "CONTINUOUS" AND THRU_BOLT == 1
			DECLARE_VARIABLE DOUBLE 	BU_OFFSET
			IF DOOR_CONSTRUCTION == "SEAMLESS"
				BU_OFFSET = .200
			ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
				BU_OFFSET = .600
			END_IF
		
			IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+1.5)
				UDF_DIM	LOCY ((DOOR_HEIGHT - BOTTOM_CHANNEL_DEPTH - TOP_CHANNEL_DEPTH - SURFACE_CLOSER_WIDTH)/2)+UNDERCUT+BOTTOM_CHANNEL_DEPTH
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

				SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(BU_OFFSET+1.5)
				UDF_DIM	LOCY ((DOOR_HEIGHT - BOTTOM_CHANNEL_DEPTH - TOP_CHANNEL_DEPTH - SURFACE_CLOSER_WIDTH)/2)+UNDERCUT+BOTTOM_CHANNEL_DEPTH
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			RETRIEVE_MDL REINFORCEMENT.ASM COMP							
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					 CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			
				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "EMJACDESC" "Cont Hinge Reinf"
				SET_MDL_PARAM COMP "DOOR_THICKNESS" DOOR_THICKNESS
				SET_MDL_PARAM COMP "LENGTH" DOOR_HEIGHT - BOTTOM_CHANNEL_DEPTH - SURFACE_CLOSER_WIDTH - 1.5
				SET_MDL_PARAM COMP "WIDTH" 3
				
				SET_MDL_PARAM COMP "XX_ORIENT" "V"
				
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX	
						
			REGEN_MDL COMP FORCE	
		END_IF

		IF KICK_PLATE == 1
			CALL kick_plate.tab
		END_IF
		
		IF (DOOR_INDEX == 1 AND (EPT == 1 OR EPT == 3)) OR (DOOR_INDEX == 2 AND (EPT == 2 OR EPT == 3))
			CALL ept.tab
		END_IF
		
		IF PEEP == 1
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY PEEP_CL
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			SET_REF_NAME ATTACH "PEEP_REF"

			CREATE_UDF udf\peep DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM DIA PEEP_DIA
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF
		END_IF
		
		CLEAR_CATCH_ERROR
		BEGIN_CATCH_ERROR
			SEARCH_MDL_REF RECURSIVE DOOR_ASM CSYS "ELEC1D" ELEC1
			SEARCH_MDL_REF RECURSIVE DOOR_ASM CSYS "ELEC2D" ELEC2
		
			IF ERROR
				END_CATCH_ERROR
				CLEAR_CATCH_ERROR
			ELSE
				IF PRIMARY_LOCK_ELECTRIFIED == 1
					GET_REF_POS ELEC2 ELEC1 pos
					PRINT "%" pos.x
					PRINT "%" pos.y				
					PRINT "%" pos.z
					CREATE_UDF udf\elec1 DOOR_ASM
						UDF_REF ATTACH ELEC2					
						UDF_DIM	d1298 pos.x + 2
						UDF_DIM	d1301 pos.x + 2
						UDF_DIM	d1302 pos.y
					END_CREATE_UDF	
				END_IF
				IF PRIMARY_LOCK_ELECTRIFIED == 2
					CREATE_UDF udf\elec2 DOOR_ASM
						UDF_REF ELEC2D ELEC2
						UDF_REF ELEC1D ELEC1
					END_CREATE_UDF	
				END_IF
			END_IF
			
		REGEN_MDL DOOR_ASM
		DOOR_INDEX ++
	END_WHILE
END_ASM_DESCR
