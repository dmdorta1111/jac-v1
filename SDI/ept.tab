BEGIN_GUI_DESCR

	SHOW_PARAM STRING 	ITEM_NUM
	SHOW_PARAM STRING 	SUB_TYPE
	SHOW_PARAM INTEGER	OPENING_TYPE
	SHOW_PARAM STRING 	DOOR_ITEM_DESC
	SHOW_PARAM STRING 	FRAME_ITEM_DESC
	! SHOW_PARAM INTEGER 	WELDED_PREPS


	SHOW_PARAM STRING 	EPT_SHEET_NAME
	SHOW_PARAM INTEGER	EPT_ROW
	SHOW_PARAM STRING 	EPT_DESC
	SHOW_PARAM DOUBLE		EPT_CTR
	
	IF EPT == 3
		SHOW_PARAM STRING 	EPT_2_SHEET_NAME
		SHOW_PARAM INTEGER	EPT_2_ROW
		SHOW_PARAM STRING 	EPT_2_DESC
		SHOW_PARAM DOUBLE		EPT_2_CTR
	END_IF
	
IF EPT > 0 AND FRAME_PROCESSED <> "PROCESSED"
	USER_INPUT_PARAM DOUBLE EPT_CTR
END_IF
CHECKBOX_PARAM INTEGER EPT "YES/NO"
CHECKBOX_PARAM INTEGER SELECT_EPT "YES/NO"
CHECKBOX_PARAM INTEGER EPT_BLANK "YES/NO"

IF EPT == 3	
	CHECKBOX_PARAM INTEGER EQUAL_EPT "YES/NO"
	IF EQUAL_EPT == 0
		USER_INPUT_PARAM DOUBLE EPT_2_CTR
		CHECKBOX_PARAM INTEGER SELECT_EPT_2 "YES/NO"
	ELSE
		EPT_2_SHEET_NAME = EPT_SHEET_NAME
		EPT_2_ROW = EPT_ROW
		EPT_2_DESC = EPT_DESC	
		EPT_2_CTR = EPT_CTR
	END_IF
	CHECKBOX_PARAM INTEGER EPT_2_BLANK "YES/NO"
END_IF

END_GUI_DESCR

BEGIN_ASM_DESCR

	DECLARE_VARIABLE 	INTEGER	OPERATION
	DECLARE_VARIABLE 	STRING 	ITEM_NUM
	DECLARE_VARIABLE 	STRING 	SUB_TYPE
	DECLARE_VARIABLE 	INTEGER	OPENING_TYPE
	DECLARE_VARIABLE 	STRING 	DOOR_ITEM_DESC
	DECLARE_VARIABLE 	STRING 	FRAME_ITEM_DESC
	! DECLARE_VARIABLE 	INTEGER	WELDED_PREPS
	DECLARE_VARIABLE 	STRING 	FRAME_PROCESSED
	DECLARE_VARIABLE 	STRING 	PREP					

	DECLARE_ARRAY 			EPT_INFO
	DECLARE_ARRAY			EPT_CELLS
	DECLARE_ARRAY			SELCELLS
	DECLARE_ARRAY			EPT_2_INFO
	DECLARE_ARRAY			EPT_2_CELLS

	DECLARE_REFERENCE 	LOCREF

	DECLARE_VARIABLE	INTEGER		EPT	
	DECLARE_VARIABLE	INTEGER		EQUAL_EPT	
	DECLARE_VARIABLE	STRING 		EPT_SHEET_NAME
	DECLARE_VARIABLE	INTEGER		EPT_ROW
	DECLARE_VARIABLE	STRING		EPT_DESC
	DECLARE_VARIABLE 	DOUBLE		EPT_CTR
	DECLARE_VARIABLE 	DOUBLE		EPT_LENGTH
	DECLARE_VARIABLE 	INTEGER		EPT_BLANK
	DECLARE_VARIABLE	STRING 		EPT_2_SHEET_NAME
	DECLARE_VARIABLE	INTEGER		EPT_2_ROW
	DECLARE_VARIABLE	STRING 		EPT_2_DESC
	DECLARE_VARIABLE 	DOUBLE		EPT_2_CTR
	DECLARE_VARIABLE 	DOUBLE		EPT_2_LENGTH
	DECLARE_VARIABLE 	INTEGER		EPT_2_BLANK

	DECLARE_VARIABLE 	INTEGER 	COLSHAPE
	DECLARE_VARIABLE 	DOUBLE 	COLDIA
	DECLARE_VARIABLE 	DOUBLE 	COLLENGTH
	DECLARE_VARIABLE 	DOUBLE 	COLWIDTH
	DECLARE_VARIABLE 	DOUBLE 	COLLENGTH

	DECLARE_VARIABLE	STRING		TABS
	DECLARE_VARIABLE	STRING		BOX
	DECLARE_VARIABLE	STRING		BLANK

	DECLARE_VARIABLE 	INTEGER 	HINDEX
	DECLARE_VARIABLE 	INTEGER 	HTP
	DECLARE_VARIABLE 	STRING 		SHAPE
	DECLARE_VARIABLE	STRING		SHAPE_UDF

IF OPERATION == 0
	CONFIG_ELEM
	
	IF SUB_TYPE == "P" AND EPT == 2
		EPT_2_SHEET_NAME = ""
		EPT_2_ROW = ""
		EPT_2_DESC = ""	
		EPT_2_CTR = ""
		EPT_2_BLANK = ""
	ELSE_IF SUB_TYPE == "S"
		EPT_2_SHEET_NAME = ""
		EPT_2_ROW = ""
		EPT_2_DESC = ""		
		EPT_2_CTR = ""
		EPT_2_BLANK = ""
	END_IF
	
	IF SELECT_EPT == 1
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "DPS-EPT"
		PRINT "SELECT ONE CELL IN THE ROW YOU WANT"
		WAIT
		EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
		EXCEL_GET_SHEET_NAME EXCEL_INDEX EPT_SHEET_NAME
		
		CLEAR_ARRAY EPT_CELLS
		EXCEL_GET_SELECTION EPT_CELLS
		FOR CELL REF ARRAY EPT_CELLS
			GET_ARRAY_ELEM CELL 0 EPT_ROW
			BREAK
		END_FOR
		
		EXCEL_GET_VALUE EPT_ROW 10 EPT_LENGTH
		EXCEL_GET_VALUE EPT_ROW 2 EPT_MANUFACTURER
		EXCEL_GET_VALUE EPT_ROW 3 EPT_MODEL
		EPT_DESC = EPT_MANUFACTURER + "\nMDL " + EPT_MODEL + "\nEPT"
		
		PRINT "EPT SHEET NAME  %" EPT_SHEET_NAME
		PRINT "EPT ROW  %" EPT_ROW			
		PRINT "EPT DESC  %" EPT_DESC
		
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
	END_IF
	
	IF SELECT_EPT_2 == 1
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "DPS-EPT"
		PRINT "SELECT ONE CELL IN THE ROW YOU WANT"
		WAIT
		EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
		EXCEL_GET_SHEET_NAME EXCEL_INDEX EPT_SHEET_NAME
		
		CLEAR_ARRAY EPT_2_CELLS
		EXCEL_GET_SELECTION EPT_2_CELLS
		FOR CELL REF ARRAY EPT_2_CELLS
			GET_ARRAY_ELEM CELL 0 EPT_2_ROW
			BREAK
		END_FOR

		EXCEL_GET_VALUE EPT_2_ROW 10 EPT_2_LENGTH
		EXCEL_GET_VALUE EPT_2_ROW 2 EPT_2_MANUFACTURER
		EXCEL_GET_VALUE EPT_2_ROW 3 EPT_2_MODEL
		EPT_DESC = EPT_2_MANUFACTURER + "\nMDL " + EPT_2_MODEL + "\nEPT"
		
		PRINT "EPT SHEET NAME  %" EPT_2_SHEET_NAME
		PRINT "EPT ROW  %" EPT_2_ROW			
		PRINT "EPT DESC  %" EPT_2_DESC
		
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
	END_IF

		IF SUB_TYPE == "P" AND EPT == 3 AND EQUAL_EPT == 1
			EPT_2_SHEET_NAME = EPT_SHEET_NAME
			EPT_2_ROW = EPT_ROW
			EPT_2_DESC = EPT_DESC	
			EPT_2_CTR = EPT_CTR
			EPT_2_LENGTH = EPT_LENGTH
			EPT_2_BLANK = EPT_BLANK
		ELSE
			EPT_2_SHEET_NAME = EPT_SHEET_NAME
			EPT_2_ROW = ""
			EPT_2_DESC = ""	
			EPT_2_CTR = ""
			EPT_2_LENGTH = ""
			EPT_2_BLANK = ""
		END_IF
END_IF

IF OPERATION == 1

	EXCEL_ACTIVATE_SHEET SHEET_BY_NAME EPT_SHEET_NAME
	CLEAR_ARRAY SELCELLS
	EXCEL_GET_VALUES CELL_BY_INDEX EPT_ROW 0 CELL_BY_INDEX EPT_ROW 19 SELCELLS
	EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"

	CLEAR_ARRAY EPT_INFO
	FOR CELL REF ARRAY SELCELLS
		GET_ARRAY_ELEM CELL 2 content
		ADD_ARRAY_ELEM EPT_INFO content
		PRINT "CONTENT - %  " content
	END_FOR

	DECLARE_VARIABLE STRING EPT_TABS
	
	GET_ARRAY_ELEM EPT_INFO 16 EPT_LENGTH
	GET_ARRAY_ELEM EPT_INFO 17 EPT_WIDTH

	IF WELDED_PREPS == 1
		EPT_LENGTH = EPT_LENGTH + .15
		EPT_WIDTH = EPT_WIDTH +.15
	ELSE
		EPT_WIDTH = EPT_WIDTH
		EPT_LENGTH = EPT_LENGTH
	END_IF	

	IF	HAND_ == "LHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
		HAND_ == "RH" OR HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_S1" BODY_ARMOR
			SEARCH_MDL_REF COVER SURFACE "SURFACE_S1" COVER_ARMOR
		END_IF
		IF DOOR_CONSTRUCTION == "LOCKSEAM"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_L1" BODY_ARMOR
		END_IF
	END_IF
	
	IF	HAND_ == "RHR" OR HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
		HAND_ == "LH" OR HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
		IF DOOR_CONSTRUCTION == "SEAMLESS"  
			SEARCH_MDL_REF BODY SURFACE "SURFACE_S2" BODY_ARMOR
			SEARCH_MDL_REF COVER SURFACE "SURFACE_S2" COVER_ARMOR
		END_IF
		IF DOOR_CONSTRUCTION == "LOCKSEAM"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_L2" BODY_ARMOR
		END_IF
	END_IF

	IF DOOR_CONSTRUCTION == "SEAMLESS" 
		IF DOOR_GAUGE == 18 AND EPT_WIDTH <= 1.265
			ARMOR_INST = "NO_TAB"
		ELSE_IF DOOR_GAUGE == 18 AND EPT_WIDTH > 1.265
			ARMOR_INST = "WITH_TAB"
		ELSE_IF DOOR_GAUGE == 16 AND EPT_WIDTH <= 1.265
			ARMOR_INST = "NO_TAB"
		ELSE_IF DOOR_GAUGE == 16 AND EPT_WIDTH > 1.265
			ARMOR_INST = "WITH_TAB"
		ELSE_IF DOOR_GAUGE == 14 AND EPT_WIDTH <= 1.140
			ARMOR_INST = "NO_TAB"
		ELSE_IF DOOR_GAUGE == 14 AND EPT_WIDTH > 1.140
			ARMOR_INST = "WITH_TAB"
		ELSE_IF DOOR_GAUGE == 12
			ARMOR_INST = "WITH_TAB"
		END_IF
	END_IF

	IF DOOR_CONSTRUCTION == "LOCKSEAM"
		IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
			HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"
		   
			ARMOR_INST = "ARMOR_L2"
		ELSE_IF HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"
				
				ARMOR_INST = "ARMOR_L1"				
		END_IF
	END_IF	
	
	IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
		HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
		HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

		IF WELDED_PREPS == 1 AND HINGE_EDGE_SHAPE == "BEVEL"
			PREP = "EPT_L4.ASM"
			ROT = 0
		ELSE_IF WELDED_PREPS == 1 AND HINGE_EDGE_SHAPE == "SQUARE"
			PREP = "EPT_SQ_EDGE.ASM"
			ROT = 0
		ELSE
			PREP = "EPT_TABS.ASM"
		END_IF

		SEARCH_MDL_REF DOOR_ASM CSYS "ARMOR1" ATTACH
		CREATE_UDF udf\csys DOOR_ASM
		UDF_REF ATTACH ATTACH
		UDF_DIM	ROTX 0
		UDF_DIM	ROTY 0
		UDF_DIM	ROTZ 0
		UDF_DIM	LOCX 0
		UDF_DIM	LOCY JOH - EPT_CTR
		UDF_DIM	LOCZ 0
		UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
	END_IF

	IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
		HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
		HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

		IF WELDED_PREPS == 1 AND HINGE_EDGE_SHAPE == "BEVEL"
			PREP = "EPT_R4.ASM"
			ROT = 0
		ELSE_IF WELDED_PREPS == 1 AND HINGE_EDGE_SHAPE == "SQUARE"
			PREP = "EPT_SQ_EDGE.ASM"
			ROT = 180
		ELSE
			PREP = "EPT_TABS.ASM"
		END_IF

		SEARCH_MDL_REF DOOR_ASM CSYS "ARMOR2" ATTACH
		CREATE_UDF udf\csys DOOR_ASM
		UDF_REF ATTACH ATTACH
		UDF_DIM	ROTX 180
		UDF_DIM	ROTY 0
		UDF_DIM	ROTZ 0
		UDF_DIM	LOCX 0
		UDF_DIM	LOCY JOH - EPT_CTR
		UDF_DIM	LOCZ 0
		UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
	END_IF
	
	IF DOOR_CONSTRUCTION == "SEAMLESS"
		CREATE_UDF udf\armor BODY
			UDF_INSTANCE ARMOR_INST
			UDF_REF ATTACH ATTACH
			UDF_REF ARMOR_SURFACE BODY_ARMOR
			UDF_DIM STRIKE_CTR 0
			UDF_DIM OFFSET 0
			UDF_DIM ARMOR_WIDTH EPT_WIDTH
			UDF_DIM ARMOR_HEIGHT EPT_LENGTH
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
		
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 180
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		CREATE_UDF udf\armor COVER
			UDF_INSTANCE ARMOR_INST
			UDF_REF ATTACH ATTACH
			UDF_REF ARMOR_SURFACE COVER_ARMOR		
			UDF_DIM STRIKE_CTR 0
			UDF_DIM OFFSET 0
			UDF_DIM ARMOR_WIDTH EPT_WIDTH
			UDF_DIM ARMOR_HEIGHT EPT_LENGTH
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF	
	END_IF

	IF DOOR_CONSTRUCTION == "LOCKSEAM"
		CREATE_UDF udf\armor_plate BODY
			UDF_INSTANCE ARMOR_INST
			UDF_REF ATTACH ATTACH
			UDF_REF ARMOR_SURFACE BODY_ARMOR		
			UDF_DIM STRIKE_CTR 0
			UDF_DIM OFFSET 0
			UDF_DIM ARMOR_WIDTH EPT_WIDTH
			UDF_DIM ARMOR_HEIGHT EPT_LENGTH
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF			
	END_IF
	
		RETRIEVE_MDL &PREP COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
		
			ASSEMBLE COMP DOOR_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
		IF EPT_BLANK == 1
			RETRIEVE_MDL EPT_BLANK.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF
			SET_REF_NAME ATTACH "ELEC1D"
END_IF

IF OPERATION == 2
	IF SUB_TYPE == "S" AND EPT == 1
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY JOH-EPT_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 270
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY JOH-EPT_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
	END_IF

	IF SUB_TYPE == "P"
		IF (EPT == 1 OR EPT == 3) AND STD_REV == "STD"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY JOH-EPT_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		IF (EPT == 1 OR EPT == 3) AND STD_REV == "REV"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 270
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY JOH-EPT_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
		
		IF EPT == 2 AND STD_REV == "STD"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 270
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY JOH-EPT_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
	
		IF EPT == 2 AND STD_REV == "REV"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY JOH-EPT_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
	END_IF
			
	IF EPT_ROW <> 0 AND EPT_ROW <> ""
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME EPT_SHEET_NAME
		CLEAR_ARRAY SELCELLS
		EXCEL_GET_VALUES CELL_BY_INDEX EPT_ROW 0 CELL_BY_INDEX EPT_ROW 13 SELCELLS
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
	
		CLEAR_ARRAY EPT_INFO
		FOR CELL REF ARRAY SELCELLS
			GET_ARRAY_ELEM CELL 2 content
			ADD_ARRAY_ELEM EPT_INFO content
			PRINT "CONTENT - %  " content
		END_FOR

		DECLARE_VARIABLE STRING EPT_TABS
		GET_ARRAY_ELEM EPT_INFO 2  MANUFACTURER
		GET_ARRAY_ELEM EPT_INFO 5  EPT_TABS
		GET_ARRAY_ELEM EPT_INFO 6  BOX
		GET_ARRAY_ELEM EPT_INFO 7  BLANK
		GET_ARRAY_ELEM EPT_INFO 8  SHAPE
		GET_ARRAY_ELEM EPT_INFO 9  DIA
		GET_ARRAY_ELEM EPT_INFO 10  LENGTH
		GET_ARRAY_ELEM EPT_INFO 11 WIDTH
		GET_ARRAY_ELEM EPT_INFO 12 RADIUS
		GET_ARRAY_ELEM EPT_INFO 13 THICKNESS

		
		IF SHAPE == 1
			CREATE_UDF udf\rnd FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM DIA DIA
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF			
		ELSE_IF SHAPE == 2 AND FR_THICKNESS < .1
			CREATE_UDF udf\rect FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM LENGTH LENGTH +.015
				UDF_DIM WIDTH WIDTH +.015
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF	
		ELSE_IF SHAPE == 2 AND FR_THICKNESS > .1
			CREATE_UDF udf\rect_12 FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM WIDTH WIDTH +.015
				UDF_DIM LENGTH LENGTH +.015
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF	
		ELSE_IF SHAPE == 3
			CREATE_UDF udf\obrnd FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM LENGTH LENGTH +.015
				UDF_DIM WIDTH WIDTH +.015
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF			
		ELSE_IF SHAPE == 4
			CREATE_UDF udf\rectrad FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM LENGTH LENGTH +.015
				UDF_DIM WIDTH WIDTH +.015
				UDF_DIM RAD RAD
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF			
		END_IF
		
		IF EPT_TABS <> "" AND EPT_TABS <> "NO-VALUE"
			RETRIEVE_MDL &EPT_TABS COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF
				
		RETRIEVE_MDL &BOX COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
		
		IF EPT_BLANK == 1
			RETRIEVE_MDL &BLANK COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT_F" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF
	END_IF

	IF SUB_TYPE == "P"
		IF EPT == 3 AND STD_REV == "REV"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY JOH-EPT_2_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
	
		IF EPT == 3 AND STD_REV == "STD"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 270
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY JOH-EPT_2_CTR
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
	END_IF
	
	IF EPT_2_ROW <> 0 AND EPT_2_ROW <> ""
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME EPT_2_SHEET_NAME
		CLEAR_ARRAY SELCELLS
		EXCEL_GET_VALUES CELL_BY_INDEX EPT_2_ROW 0 CELL_BY_INDEX EPT_2_ROW 13 SELCELLS
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
	
		CLEAR_ARRAY EPT_INFO
		FOR CELL REF ARRAY SELCELLS
			GET_ARRAY_ELEM CELL 2 content
			ADD_ARRAY_ELEM EPT_INFO content
			PRINT "CONTENT - %  " content
		END_FOR

		GET_ARRAY_ELEM EPT_INFO 2  MANUFACTURER
		GET_ARRAY_ELEM EPT_INFO 5  EPT_TABS
		GET_ARRAY_ELEM EPT_INFO 6  BOX
		GET_ARRAY_ELEM EPT_INFO 7  BLANK
		GET_ARRAY_ELEM EPT_INFO 8  SHAPE
		GET_ARRAY_ELEM EPT_INFO 9  DIA
		GET_ARRAY_ELEM EPT_INFO 10  LENGTH
		GET_ARRAY_ELEM EPT_INFO 11 WIDTH
		GET_ARRAY_ELEM EPT_INFO 12 RADIUS
		GET_ARRAY_ELEM EPT_INFO 13 THICKNESS
		
		IF SHAPE == 1
			CREATE_UDF udf\rnd FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM DIA DIA
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF			
		ELSE_IF SHAPE == 2 AND FR_THICKNESS < .1
			CREATE_UDF udf\rect FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM LENGTH LENGTH +.015
				UDF_DIM WIDTH WIDTH +.015
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF	
		ELSE_IF SHAPE == 2 AND FR_THICKNESS > .1
			CREATE_UDF udf\rect_12 FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM WIDTH WIDTH +.015
				UDF_DIM LENGTH LENGTH +.015
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF	
		ELSE_IF SHAPE == 3
			CREATE_UDF udf\obrnd FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM LENGTH LENGTH +.015
				UDF_DIM WIDTH WIDTH +.015
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF			
		ELSE_IF SHAPE == 4
			CREATE_UDF udf\rectrad FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM LENGTH LENGTH +.015
				UDF_DIM WIDTH WIDTH +.015
				UDF_DIM RAD RAD
				UDF_INTERSECTION * PART_LEVEL		
			END_CREATE_UDF			
		END_IF

		IF EPT_TABS <> "" AND EPT_TABS <> "NO-VALUE"
			RETRIEVE_MDL &EPT_TABS COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF
				
		RETRIEVE_MDL &BOX COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE			
		
		IF EPT_2_BLANK == 1
			RETRIEVE_MDL &BLANK COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT_F" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF
	END_IF
END_IF
	
END_ASM_DESCR
