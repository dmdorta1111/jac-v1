BEGIN_GUI_DESCR

SHOW_PARAM	STRING	ITEM_NUM
SHOW_PARAM	DOUBLE	JOW
SHOW_PARAM	DOUBLE	JOH
SHOW_PARAM	STRING	SUB_TYPE
SHOW_PARAM	STRING	HAND
SHOW_PARAM	STRING	DOOR_ELEVATION
SHOW_PARAM	DOUBLE	ACTIVE_LEAF
SHOW_PARAM	DOUBLE	FIRE_RATING

IF VISION_SHAPE == 0
	USER_INPUT_PARAM	DOUBLE	VISION_DIAMETER
END_IF

IF VISION_DIMENSION_METHOD == 1
	USER_INPUT_PARAM 	DOUBLE 	VISION_CENTER_TOP
END_IF

IF VISION_DIMENSION_METHOD == 2
	USER_INPUT_PARAM 	DOUBLE 	VISION_CENTER_BOTTOM
END_IF

IF VISION_SHAPE == 1
	USER_INPUT_PARAM	DOUBLE	VISION_WIDTH
	IF VISION_DIMENSION_METHOD == 1 OR VISION_DIMENSION_METHOD == 2 OR VISION_DIMENSION_METHOD == 3 OR VISION_DIMENSION_METHOD == 4 OR VISION_DIMENSION_METHOD == 7
		USER_INPUT_PARAM	DOUBLE	VISION_HEIGHT
		IF VISION_DIMENSION_METHOD == 7
			USER_INPUT_PARAM	DOUBLE	VISION_HEIGHT2
		END_IF
	END_IF
	IF VISION_DIMENSION_METHOD == 3 OR VISION_DIMENSION_METHOD == 5 OR VISION_DIMENSION_METHOD == 7
		USER_INPUT_PARAM	DOUBLE	VISION_TOP_RAIL
	END_IF
	IF VISION_DIMENSION_METHOD == 5 OR VISION_DIMENSION_METHOD == 7
		USER_INPUT_PARAM	DOUBLE	VISION_BOTTOM_RAIL
	END_IF

	IF VISION_DIMENSION_METHOD == 4
		USER_INPUT_PARAM	DOUBLE	VISION_FLOOR_TO_BOTTOM
	END_IF
	
	IF VISION_DIMENSION_METHOD == 1 !TOP TO CENTER
		VISION_TOP_RAIL = VISION_CENTER_TOP - (VISION_HEIGHT/2)
		VISION_BOTTOM_RAIL = JOH - TOP_GAP - VISION_CENTER_TOP - (VISION_HEIGHT/2)
	END_IF
	
	IF VISION_DIMENSION_METHOD == 2 !FLOOR TO CENTER
		VISION_BOTTOM_RAIL = VISION_CENTER_BOTTOM - (VISION_HEIGHT/2) - UNDERCUT
		VISION_TOP_RAIL = JOH - TOP_GAP - VISION_CENTER_BOTTOM - (VISION_HEIGHT/2)
	END_IF

	IF VISION_DIMENSION_METHOD == 3 !TOP RAIL AND HEIGHT
		VISION_BOTTOM_RAIL = JOH - VISION_TOP_RAIL - VISION_HEIGHT - TOP_GAP - UNDERCUT
		VISION_CENTER_BOTTOM = 0
	END_IF

	IF VISION_DIMENSION_METHOD == 4 !FLOOR TO BOTTOM AND HEIGHT
		VISION_TOP_RAIL = JOH - VISION_FLOOR_TO_BOTTOM - VISION_HEIGHT - TOP_GAP
		VISION_BOTTOM_RAIL = VISION_FLOOR_TO_BOTTOM - UNDERCUT
	END_IF
END_IF

IF VISION_SHAPE == 0
	IF VISION_DIMENSION_METHOD == 1 !TOP TO CENTER
		VISION_CENTER_BOTTOM = JOH-VISION_CENTER_TOP-TOP_GAP
	END_IF
END_IF


IF DOOR_ELEVATION == "N"
	! USER_INPUT_PARAM	DOUBLE	VISION_HINGE_STILE
	USER_INPUT_PARAM	DOUBLE	VISION_STRIKE_STILE
END_IF

IF DOOR_LITE_TRIM_TYPE_ <> 0
	USER_INPUT_PARAM	DOUBLE	GLASS_THICKNESS REQUIRED
END_IF

IF GLASS_SUPPLIER_ == 1 AND GLASS_TYPE_ == 4
	USER_INPUT_PARAM	STRING	GLASS_TYPE
END_IF

IF DOOR_LITE_TRIM_TYPE_ == 4 !GLASS OFFSET FOR STOPLESS TRIM OPTION - +/- OFFSET FROM CENTER - NEEDS DEVELPOMENT
	USER_INPUT_PARAM	DOUBLE	GLASS_POSITION_OFFSET
END_IF

IF DOOR_LITE_TRIM_TYPE_ <> 0 AND DOOR_LITE_TRIM_TYPE_ <> 2
	USER_INPUT_PARAM	DOUBLE MAX_GLAZING_HOLE_SPACE
END_IF

	CHECKBOX_PARAM INTEGER CORNERS_ "SEAMED" "WELDED"
	CHECKBOX_PARAM INTEGER INSTALATION_ "LOOSE" "WELDED"
	CHECKBOX_PARAM INTEGER GLASS_SUPPLIER_ "OTHERS" "SDI"
	CHECKBOX_PARAM INTEGER GLASS_INSTALLER_ "OTHERS" "SDI"

IF SUB_TYPE == "P"
	RADIOBUTTON_PARAM INTEGER	DOOR_LITE	"ACTIVE" "INACTIVE" "BOTH"
END_IF

	RADIOBUTTON_PARAM INTEGER VISION_DIMENSION_METHOD 	" 0 - NOT SELECTED" \
														" 1 - TOP TO CENTER" \
														" 2 - FLOOR TO CENTER" \
														" 3 - TOP RAIL AND HEIGHT" \
														" 4 - FLOOR TO BOTTOM AND HEIGHT" \
														" 5 - TOP AND BOTTOM RAIL CALC HEIGHT" \
														" 6 - BOTTOM RAIL " \
														" 7 - FG2, FL2 OR GL"
														
	IF DOOR_ELEVATION == "2G"
		VISION_DIMENSION_METHOD = 7
	END_IF

	! RADIOBUTTON_PARAM INTEGER VISION_SHAPE "ROUND" "SQUARE"
	RADIOBUTTON_PARAM INTEGER DOOR_LITE_TRIM_TYPE_ "A (CUTOUT)" "B (SLOPED)" "C (DUAL FLUSH GLAZING)" ! "C (SQUARE)" "D (STOPS)" "E (STOPLESS)" "F (STANDING SEAM)" "G (BULLET)" 


IF DOOR_LITE_TRIM_TYPE_ == 1 OR DOOR_LITE_TRIM_TYPE_ == 2 OR DOOR_LITE_TRIM_TYPE_ == 4 OR DOOR_LITE_TRIM_TYPE_ == 5
	RADIOBUTTON_PARAM INTEGER REMOVABLE_SIDE "INSIDE (UNSECURE - STD)" "OUTSIDE (SECURE)"
ELSE_IF 	DOOR_LITE_TRIM_TYPE_ == 3
	REMOVABLE_SIDE = 0
END_IF

IF DOOR_LITE_TRIM_TYPE_ == 1 AND CORNERS_ == 0
	USER_INPUT_PARAM INTEGER DOOR_LITE_TRIM_GAUGE
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 1 AND CORNERS_ == 1
	DOOR_LITE_TRIM_GAUGE = 16
END_IF

IF GLASS_SUPPLIER_ == 1
	RADIOBUTTON_PARAM INTEGER	GLASS_TYPE_ "CLEAR" "WIRED" "INSULATED" "LEXAN" "OTHER"
END_IF

IF SUB_TYPE == "S"
	DOOR_LITE = 2
END_IF


IF DOOR_LITE_TRIM_TYPE_ == 0
	DOOR_LITE_TRIM_TYPE = "A"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 1
	DOOR_LITE_TRIM_TYPE = "B"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 2
	DOOR_LITE_TRIM_TYPE = "C"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 3
	DOOR_LITE_TRIM_TYPE = "D"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 4
	DOOR_LITE_TRIM_TYPE = "E"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 5
	DOOR_LITE_TRIM_TYPE = "F"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 6
	DOOR_LITE_TRIM_TYPE = "G"
ELSE_IF DOOR_LITE_TRIM_TYPE_ == 7
	DOOR_LITE_TRIM_TYPE = "H"
END_IF


IF GLASS_SUPPLIER_ == 0
	GLASS_SUPPLIER = "OTHERS"
	GLASS_TYPE = "GLASS"
ELSE_IF GLASS_SUPPLIER_ == 1
	GLASS_SUPPLIER = "SDI"
	IF GLASS_TYPE_ == 0
		GLASS_TYPE = "CLEAR TEMPERED GLASS"
	ELSE_IF GLASS_TYPE_ == 1
		GLASS_TYPE = "WIRED GLASS"
	ELSE_IF GLASS_TYPE_ == 2
		GLASS_TYPE = "INSULATED GLASS"
	ELSE_IF GLASS_TYPE_ == 3
		GLASS_TYPE = "CLEAR LEXAN"
	END_IF
END_IF

IF GLASS_INSTALLER_ == 0
	GLASS_INSTALLER = "OTHERS"
ELSE_IF GLASS_INSTALLER_ == 1
	GLASS_INSTALLER = "SDI"
END_IF

IF CORNERS_ == 0
	VISION_CONSTRUCTION_A = "SEAMED"
ELSE_IF CORNERS_ == 1
	VISION_CONSTRUCTION_A = "WELDED"
END_IF

IF INSTALATION_ == 0
	VISION_CONSTRUCTION_B = "LOOSE"
ELSE_IF INSTALATION_ == 1
	VISION_CONSTRUCTION_B = "WELDED"
END_IF

IF VISION_DIMENSION_METHOD == 1
   IF VISION_CENTER_TOP == 0
		USER_INPUT_PARAM INTEGER INPUT_COMPLETE REQUIRED
	END_IF
END_IF


END_GUI_DESCR

BEGIN_ASM_DESCR

!FIXED INPUT PARAMATERS
DECLARE_VARIABLE	STRING	ITEM_NUM
DECLARE_VARIABLE	STRING	SUB_JOB_NAME
DECLARE_VARIABLE	DOUBLE	JOW
DECLARE_VARIABLE	DOUBLE	JOH
DECLARE_VARIABLE	STRING	SUB_TYPE
DECLARE_VARIABLE	STRING	HAND
DECLARE_VARIABLE	STRING	DOOR_ELEVATION
DECLARE_VARIABLE	DOUBLE	ACTIVE_LEAF
DECLARE_VARIABLE	DOUBLE	UNDERCUT
DECLARE_VARIABLE	DOUBLE	TOP_GAP
DECLARE_VARIABLE	DOUBLE	STIKE_GAP
DECLARE_VARIABLE	DOUBLE	HINGE_GAP
DECLARE_VARIABLE	DOUBLE	FIRE_RATING

!OUTPUT PARAMETERS
DECLARE_VARIABLE	INTEGER	DOOR_LITE
DECLARE_VARIABLE 	STRING 	DOOR_LITE_TRIM_TYPE
DECLARE_VARIABLE 	STRING	VISION_SHAPE
DECLARE_VARIABLE	DOUBLE VISION_CENTER_TOP
DECLARE_VARIABLE	DOUBLE VISION_CENTER_BOTTOM
DECLARE_VARIABLE	DOUBLE	VISION_WIDTH
DECLARE_VARIABLE	DOUBLE	VISION_HEIGHT
DECLARE_VARIABLE	DOUBLE	VISION_HEIGHT2
DECLARE_VARIABLE	DOUBLE	VISION_TOP_RAIL
DECLARE_VARIABLE	DOUBLE	VISION_BOTTOM_RAIL
DECLARE_VARIABLE	DOUBLE	VISION_FLOOR_TO_BOTTOM
DECLARE_VARIABLE	DOUBLE	VISION_HINGE_STILE
DECLARE_VARIABLE	DOUBLE	VISION_STRIKE_STILE
DECLARE_VARIABLE	STRING	GLASS_SUPPLIER
DECLARE_VARIABLE	STRING	GLASS_INSTALLER
DECLARE_VARIABLE	DOUBLE	GLASS_THICKNESS
DECLARE_VARIABLE	STRING	GLASS_TYPE
DECLARE_VARIABLE	DOUBLE	GLASS_POSITION_OFFSET
DECLARE_VARIABLE	INTEGER REMOVABLE_SIDE
DECLARE_VARIABLE	STRING	VISION_CONSTRUCTION_A
DECLARE_VARIABLE	STRING	VISION_CONSTRUCTION_B
DECLARE_VARIABLE	DOUBLE	VISION_DIAMETER
DECLARE_VARIABLE	DOUBLE	MAX_GLAZING_HOLE_SPACE
DECLARE_VARIABLE	INTEGER	VISION_DIMENSION_METHOD
DECLARE_VARIABLE	INTEGER	CORNERS_
DECLARE_VARIABLE	INTEGER	INSTALATION_
DECLARE_VARIABLE	INTEGER DOOR_LITE_TRIM_GAUGE
!TAB FILE PARAMETERS
! DECLARE_VARIABLE 	INTEGER VISION_SHAPE_
DECLARE_VARIABLE 	INTEGER GLASS_SUPPLIER_
DECLARE_VARIABLE 	INTEGER GLASS_INSTALLER_
DECLARE_VARIABLE 	INTEGER DOOR_LITE_TRIM_TYPE_
DECLARE_VARIABLE	INTEGER	GLASS_TYPE_
DECLARE_VARIABLE	INTEGER	CORNERS_
DECLARE_VARIABLE	INTEGER	INSTALATION_


IF GLASS_SUPPLIER == "OTHERS"
	GLASS_SUPPLIER_ = 0
	GLASS_TYPE_ = 99	
ELSE_IF GLASS_SUPPLIER == "SDI"
	GLASS_SUPPLIER_ = 1
END_IF

IF GLASS_TYPE == "CLEAR TEMPERED GLASS"
	GLASS_TYPE_ = 0
ELSE_IF GLASS_TYPE == "WIRED GLASS" 
	GLASS_TYPE_ = 1
ELSE_IF GLASS_TYPE == "INSULATED GLASS" 
	GLASS_TYPE_ = 2
ELSE_IF GLASS_TYPE == "CLEAR LEXAN" 
	GLASS_TYPE_ = 3
ELSE_IF GLASS_TYPE <> "" 
	GLASS_TYPE_ = 4
END_IF

IF GLASS_INSTALLER == "OTHERS"
	GLASS_INSTALLER_ = 0
ELSE_IF GLASS_INSTALLER == "SDI"
	GLASS_INSTALLER_ = 1
END_IF

IF DOOR_LITE_TRIM_TYPE == "A"
	DOOR_LITE_TRIM_TYPE_ = 0
ELSE_IF DOOR_LITE_TRIM_TYPE == "B"
	DOOR_LITE_TRIM_TYPE_ = 1
ELSE_IF DOOR_LITE_TRIM_TYPE == "C"
	DOOR_LITE_TRIM_TYPE_ = 2
ELSE_IF DOOR_LITE_TRIM_TYPE == "D"
	DOOR_LITE_TRIM_TYPE_ = 3
ELSE_IF DOOR_LITE_TRIM_TYPE == "E"
	DOOR_LITE_TRIM_TYPE_ = 4
ELSE_IF DOOR_LITE_TRIM_TYPE == "F"
	DOOR_LITE_TRIM_TYPE_ = 5
ELSE_IF DOOR_LITE_TRIM_TYPE == "G"
	DOOR_LITE_TRIM_TYPE_ = 6
ELSE_IF DOOR_LITE_TRIM_TYPE == "H"
	DOOR_LITE_TRIM_TYPE_ = 7
END_IF

IF GLASS_THICKNESS == 0 AND DOOR_LITE_TRIM_TYPE <> "A"
	INVALIDATE_PARAM GLASS_THICKNESS
END_IF

IF FIRE_RATING > 0 OR DOOR_LITE_TRIM_TYPE_ == 6
	VISION_CONSTRUCTION_B = "WELDED"
END_IF

IF VISION_CONSTRUCTION_B == "WELDED"
	INSTALATION_ = 1
ELSE_IF VISION_CONSTRUCTION_B == "LOOSE"
	INSTALATION_ = 0
END_IF

IF VISION_CONSTRUCTION_A == "WELDED"
	CORNERS_ = 1
ELSE_IF VISION_CONSTRUCTION_A == "SEAMED"
	CORNERS_ = 0
END_IF

CONFIG_ELEM

END_ASM_DESCR
