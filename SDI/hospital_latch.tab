BEGIN_GUI_DESCR
	SHOW_PARAM STRING LOCK_MANUFACTURER
	SHOW_PARAM STRING LOCK_TYPE
	SHOW_PARAM STRING LOCK_MODEL
	SHOW_PARAM DOUBLE LOCK_BACKSET
	SHOW_PARAM STRING LOCK_UDF
	SHOW_PARAM STRING LOCK_INST
	SHOW_PARAM DOUBLE LOCK_ARMOR_WIDTH
	SHOW_PARAM DOUBLE LOCK_ARMOR_HEIGHT
	SHOW_PARAM DOUBLE LOCK_ARMOR_THICKNESS
	SHOW_PARAM DOUBLE LOCK_OFFSET
	RADIOBUTTON_PARAM INTEGER ORIENTATION "VERTICAL" "HORIZONTAL"
END_GUI_DESCR

BEGIN_TAB_DESCR
BEGIN_TABLE	LOCK_MANUFACTURER	"MANUFACTURER"
TABLE_OPTION 	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	S_TABLE	LOCK_MANUFACTURER	LOCK_TYPE
STRING	SUBTABLE	STRING	STRING
ABH	ABH	ABH	HOSPITAL LATCH
END_TABLE

BEGIN_TABLE	ABH	"ABH MORTISE LOCKS"
TABLE_OPTION	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	S_TABLE
STRING	SUBTABLE
HOSPITAL LATCH	ABH_HOSP_LATCH
END_TABLE

BEGIN_TABLE	ABH_HOSP_LATCH	"ABH HOSPITAL LATCH"
TABLE_OPTION	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	LOCK_MODEL	LOCK_UDF	LOCK_INST	LOCK_OFFSET	LOCK_BACKSET	LOCK_ARMOR_HEIGHT	LOCK_REINFORCEMENT	LOCK_ARMOR_WIDTH
STRING	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	DOUBLE
6200	6200	abh_6200	abh_6200	0	2.75	2.25	CYLINDER_BOX.ASM	1.125
6610	6610	abh_6600	abh_6610	-.375	2.75	8.0	MORTISE_BOX.ASM	1.25
END_TABLE

END_TAB_DESCR

BEGIN_ASM_DESCR


IF OPERATION == 0
	DECLARE_VARIABLE STRING LOCK_MANUFACTURER
	DECLARE_VARIABLE STRING LOCK_TYPE
	DECLARE_VARIABLE STRING LOCK_MODEL
	DECLARE_VARIABLE DOUBLE LOCK_BACKSET
	DECLARE_VARIABLE DOUBLE LOCK_OFFSET
	DECLARE_VARIABLE STRING LOCK_UDF
	DECLARE_VARIABLE STRING LOCK_INST
	DECLARE_VARIABLE DOUBLE LOCK_ARMOR_HEIGHT
	DECLARE_VARIABLE DOUBLE LOCK_ARMOR_WIDTH
	DECLARE_VARIABLE DOUBLE LOCK_ARMOR_THICKNESS
	DECLARE_VARIABLE STRING LOCK_DESC
	DECLARE_VARIABLE STRING LOCK_REINFORCEMENT

	CONFIG_ELEM
END_IF	
	
IF OPERATION == 1
	IF LOCK_INDEX == 1
		LOCK_MANUFACTURER = PRIMARY_LOCK_MANUFACTURER
		LOCK_TYPE = PRIMARY_LOCK_TYPE
		LOCK_MODEL = PRIMARY_LOCK_MODEL
		LOCK_BACKSET = PRIMARY_LOCK_BACKSET
		LOCK_OFFSET = PRIMARY_LOCK_OFFSET
		! TRIM = PRIMARY_LOCK_TRIM
		LOCK_UDF = PRIMARY_LOCK_UDF
		LOCK_INST = PRIMARY_LOCK_INST
		LOCK_ARMOR_HEIGHT = PRIMARY_LOCK_ARMOR_HEIGHT
		LOCK_ARMOR_WIDTH = PRIMARY_LOCK_ARMOR_WIDTH
		! LOCK_ARMOR_THICKNESS = PRIMARY_LOCK_ARMOR_THICKNESS
	ELSE_IF LOCK_INDEX == 2
		LOCK_MANUFACTURER = SECONDARY_LOCK_MANUFACTURER
		LOCK_TYPE = SECONDARY_LOCK_TYPE
		LOCK_MODEL = SECONDARY_LOCK_MODEL
		LOCK_BACKSET = SECONDARY_LOCK_BACKSET
		LOCK_OFFSET = SECONDARY_LOCK_OFFSET
		! TRIM = SECONDARY_LOCK_TRIM
		LOCK_UDF = SECONDARY_LOCK_UDF
		LOCK_INST = SECONDARY_LOCK_INST
		LOCK_ARMOR_HEIGHT = SECONDARY_LOCK_ARMOR_HEIGHT
		LOCK_ARMOR_WIDTH = SECONDARY_LOCK_ARMOR_WIDTH
		! LOCK_ARMOR_THICKNESS = SECONDARY_LOCK_ARMOR_THICKNESS
	 END_IF
	 
	IF LOCK_MANUFACTURER == "ABH" AND WELDED_PREPS == 1 AND LOCK_MODEL == "66*"
		LOCK_INST = LOCK_INST+"_"+itos(WELDED_PREPS)+"_"+HAND
		LOCK_DESC = "ABH " + LOCK_MODEL + "\n" + "HOSPITAL\n" + "LATCH"
	ELSE_IF LOCK_MANUFACTURER == "ABH" AND WELDED_PREPS == 1 AND LOCK_MODEL == "62*"
		IF ORIENTATION == 0
			LOCK_INST = LOCK_INST+"_V_1"
			LOCK_DESC = "ABH - MODEL " + LOCK_MODEL + " - VERTICAL HOSP LATCH"
			LOCK_REINFORCEMENT = "ABH_"+LOCK_MODEL+"_V"
		ELSE_IF ORIENTATION == 1
			LOCK_INST = LOCK_INST+"_H_1"
			LOCK_DESC = "ABH - MODEL " + LOCK_MODEL + " - HORZONTAL HOSP LATCH"
			LOCK_REINFORCEMENT = "ABH_"+LOCK_MODEL+"_H"
		END_IF
	ELSE_IF LOCK_MANUFACTURER == "ABH" AND WELDED_PREPS == 0 AND LOCK_MODEL == "62*"
		IF ORIENTATION == 0
			LOCK_INST = LOCK_INST+"_V"
			LOCK_DESC = "ABH - MODEL " + LOCK_MODEL + " - VERTICAL HOSP LATCH"
			LOCK_REINFORCEMENT = "ABH_"+LOCK_MODEL+"_V.ASM"
		ELSE_IF ORIENTATION == 1
			LOCK_INST = LOCK_INST+"_H"
			LOCK_DESC = "ABH - MODEL " + LOCK_MODEL + " - HORZONTAL HOSP LATCH"
			LOCK_REINFORCEMENT = "ABH_"+LOCK_MODEL+"_H.ASM"
		END_IF
	END_IF

	! IF PRIMARY_LOCK_TYPE == "HOSPITAL LATCH" AND ( HAND_ == "LHR" OR HAND_ == "RHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "RHR2" OR \
		 ! HAND_ == "RHRA2" OR  HAND_ == "LH" OR HAND_ == "RH" OR HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "RH2" OR HAND_ == "RHA2")
	LOCK_UDF = "udf\\"+ PRIMARY_LOCK_UDF

	IF PRIMARY_LOCK_ARMOR_WIDTH > DOOR_THICKNESS - 75 AND DOOR_CONSTRUCTION == "LOCKSEAM"
		IF HAND == "LHR"
			ARMOR_INST = "ARMOR_L2"
		ELSE_IF HAND == "RHR"
			ARMOR_INST = "ARMOR_L1"
		ELSE_IF HAND == "LH"
			ARMOR_INST = "ARMOR_L1"
		ELSE_IF HAND == "RH"
			ARMOR_INST = "ARMOR_L2"
		END_IF
	ELSE_IF DOOR_CONSTRUCTION == "SEAMLESS"
		IF SM_THICK > .08
			ARMOR_INST = "ARMOR_S12"
		ELSE
			ARMOR_INST = "ARMOR_S"
		END_IF
	END_IF

	IF WELDED_PREPS == 1
		PRIMARY_LOCK_ARMOR_HEIGHT = PRIMARY_LOCK_ARMOR_HEIGHT + .17
		PRIMARY_LOCK_ARMOR_WIDTH = PRIMARY_LOCK_ARMOR_WIDTH +.17
		PRIMARY_LOCK_REINFORCEMENT = PRIMARY_LOCK_INST+ ".ASM"
	END_IF

	PRIMARY_LOCK_REINFORCEMENT = PRIMARY_LOCK_INST +".ASM"
	
	CREATE_UDF &LOCK_UDF DOOR_ASM
		UDF_INSTANCE PRIMARY_LOCK_INST
		UDF_REF ATTACH1 ATTACH
		UDF_REF ATTACH2 ATTACH1
		UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
		UDF_DIM LOCK_OFFSET -PRIMARY_LOCK_OFFSET
		UDF_DIM LOCK_BACKSET PRIMARY_LOCK_BACKSET
		UDF_INTERSECTION * PART_LEVEL
	END_CREATE_UDF

	CREATE_UDF udf\armor_plate DOOR_ASM
		UDF_INSTANCE ARMOR_INST
		UDF_REF ATTACH ATTACH
		UDF_DIM STRIKE_CTR PRIMARY_STRIKE_CENTER
		UDF_DIM LOCK_OFFSET -PRIMARY_LOCK_OFFSET
		UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
		UDF_DIM LOCK_ARMOR_WIDTH PRIMARY_LOCK_ARMOR_WIDTH
		UDF_DIM LOCK_ARMOR_HEIGHT PRIMARY_LOCK_ARMOR_HEIGHT
		UDF_EXP_REF ATTACH2 CSYS 1
		UDF_INTERSECTION * PART_LEVEL
	END_CREATE_UDF

	IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
		HAND_ == "RHR2" OR HAND_ == "RHRA2" OR \
		HAND_ == "LH1" OR HAND_ == "LHA1"
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH2
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH2 CSYS 0
			END_CREATE_UDF
	END_IF

	IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
		HAND_ == "LHR1" OR HAND_ == "LHRA1" OR \
		HAND_ == "RH2" OR HAND_ == "RHA2"

			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH2
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH2 CSYS 0
			END_CREATE_UDF
	END_IF

	RETRIEVE_MDL &PRIMARY_LOCK_REINFORCEMENT COMP
	IF OPERATION == 4
		SET_MDL_PARAM COMP "CUSTOMER_NAME" CUSTOMER_NAME
		SET_MDL_PARAM COMP "JOB_NAME" JOB_NAME
		SET_MDL_PARAM COMP "SUB_JOB_NAME" SUB_JOB_NAME
		GET_MDL_NAME COMP CompName
		! DRW = CompName + ".DRW"
		! RETRIEVE_MDL &DRW COMPD
		! SAVE_MDL COMPD
	END_IF

	SEARCH_MDL_REF COMP CSYS "ATTACH" ATTACH

	ASSEMBLE COMP DOOR_ASM
		 CSYS ATTACH2 ATTACH
	END_ASSEMBLE
	! END_IF
END_IF

END_ASM_DESCR
