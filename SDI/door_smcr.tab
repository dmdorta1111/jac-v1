
BEGIN_ASM_DESCR

	!BEGIN DOOR CLOSERS
	IF DOOR_INDEX == 2
		CLOSER_TYPE_ =	CLOSER_TYPE_2
		CLOSER_SIDE_ =	CLOSER_SIDE_2
		CLOSER_DESC_ =	CLOSER_DESC_2
		SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH_2
		SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH_2
		HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER_2
		HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE_2
		HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL_2
	ELSE_IF DOOR_INDEX == 1
		CLOSER_TYPE_ =	CLOSER_TYPE
		CLOSER_SIDE_ =	CLOSER_SIDE
		CLOSER_DESC_ =	CLOSER_DESC
		SURFACE_CLOSER_LENGTH_ = SURFACE_CLOSER_LENGTH
		SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH
		HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER
		HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE
		HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL
	END_IF

	IF CLOSER_TYPE_ == "SURFACE" OR MAG_LOCK == 1 OR HOLDER_STOP_TYPE_ == "SURF*" OR AUTO_OPERATOR == 1
		
		IF DOOR_ELEVATION == "M1*" AND JOH <= 86
			SURFACE_CLOSER_LENGTH_ = 18
		ELSE						
			IF CLOSER_TYPE_ == "SURFACE" AND DOOR_WIDTH - 10 >= 18
				SURFACE_CLOSER_LENGTH_ = 18
			ELSE
				SURFACE_CLOSER_LENGTH_ = DOOR_WIDTH - 3
			END_IF
			
			IF HOLDER_STOP_TYPE_ == "SURF*" AND HOLDER_STOP_MANUFACTURER_ == "ABH"
				IF ABH_DIM_A + ABH_DIM_C + 2 > DOOR_WIDTH - 10 AND DPS == 1
					SURFACE_CLOSER_LENGTH_ =  DOOR_WIDTH - 3
				ELSE 
					SURFACE_CLOSER_LENGTH_ = ABH_DIM_A + ABH_DIM_C
				END_IF
			END_IF
			
			IF AUTO_OPERATOR == 1
				CLOSER_TYPE_ = "SURFACE"
				SURFACE_CLOSER_LENGTH_ = DOOR_WIDTH - 3
				SURFACE_CLOSER_WIDTH_ = 5.25
			END_IF
										
			IF MAG_LOCK == 1
				SURFACE_CLOSER_LENGTH_ = DOOR_WIDTH - 3
			END_IF
		END_IF
		
		IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
			HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

			SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 180
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX ((DOOR_WIDTH/2) - (SURFACE_CLOSER_LENGTH_/2) - 1.5)
			UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - (SURFACE_CLOSER_WIDTH_/2)
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
			HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
			HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

			SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -((DOOR_WIDTH/2) - (SURFACE_CLOSER_LENGTH_/2) - 1.5)
			UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - (SURFACE_CLOSER_WIDTH_/2)
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
		
		RETRIEVE_MDL REINFORCEMENT.ASM GENERIC
		INSERT_FAMINSTANCE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "STOCKTYPE" 1
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "THICKNESS" DOOR_THICKNESS - .175
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" SURFACE_CLOSER_LENGTH_
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" SURFACE_CLOSER_WIDTH_
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "XX_ORIENT" "H"
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "M49" "SMCR__"+itos(DOOR_INDEX)+"_"+ITEM_NUM
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "M50" "SMCR__"+itos(DOOR_INDEX)+"_"+ITEM_NUM
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F51" "N"
		SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACDESC" "Surface Closer Reinf"					
		! SET_FAMITEM_VALUE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACNUM" "SMCR_"+ITEM_NUM					
		GET_REF_FAMINSTANCE GENERIC "SMCR_"+itos(DOOR_INDEX)+"_" + ITEM_NUM INST
		SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

		RETRIEVE_MDL REINFORCEMENT_CHANNEL.PRT GENERIC
		INSERT_FAMINSTANCE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM
		SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "USED" 0
		SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" SURFACE_CLOSER_LENGTH_
		SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" SURFACE_CLOSER_WIDTH_
		SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "d45" DOOR_THICKNESS - .235
		SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F1033" "N"
		SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "COMMENTS" "SHEAR"

		IF DPS_MODEL <> "" AND SURFACE_CLOSER_LENGTH_ > DOOR_WIDTH - 10
			SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F1033" "Y"
			SET_FAMITEM_VALUE GENERIC "SMCR__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "COMMENTS" "LASER"
		END_IF
		
			ASSEMBLE INST DOOR_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			REGEN_MDL INST
	END_IF

	IF CLOSER_TYPE_ == "SURFACE" AND HOLDER_STOP_TYPE_ == "SURF*" AND DOOR_ELEVATION == "M1*" AND JOH <= 86
		SURFACE_CLOSER_LENGTH_ = DOOR_WIDTH - 21
		SURFACE_CLOSER_WIDTH_ = 4
			
			IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
				HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
				HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

				SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -((DOOR_WIDTH/2) - (SURFACE_CLOSER_LENGTH_/2) - 1.5)
				UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - (SURFACE_CLOSER_WIDTH_/2)
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
				HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
				HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

				SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
				CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX ((DOOR_WIDTH/2) - (SURFACE_CLOSER_LENGTH_/2) - 1.5)
				UDF_DIM	LOCY JOH - TOP_GAP - TOP_CHANNEL_DEPTH - (SURFACE_CLOSER_WIDTH_/2)
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF
			
			RETRIEVE_MDL REINFORCEMENT.ASM GENERIC
			INSERT_FAMINSTANCE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "THICKNESS" DOOR_THICKNESS - .175
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" SURFACE_CLOSER_LENGTH_
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" SURFACE_CLOSER_WIDTH_
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "XX_ORIENT" "H"
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "M49" "SMCR2__"+itos(DOOR_INDEX)+"_"+ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "M50" "SMCR2__"+itos(DOOR_INDEX)+"_"+ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F51" "N"
			SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACDESC" "Surface Closer Reinf"					
			! SET_FAMITEM_VALUE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM "EMJACNUM" "SMCR2_"+ITEM_NUM					
			GET_REF_FAMINSTANCE GENERIC "SMCR2_"+itos(DOOR_INDEX)+"_" + ITEM_NUM INST
			SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

			RETRIEVE_MDL REINFORCEMENT_CHANNEL.PRT GENERIC
			INSERT_FAMINSTANCE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM
			SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "USED" 0
			SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "LENGTH" SURFACE_CLOSER_LENGTH_
			SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "WIDTH" SURFACE_CLOSER_WIDTH_
			SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "d45" DOOR_THICKNESS - .235
			SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F1033" "N"
			SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "COMMENTS" "SHEAR"

			IF DPS_MODEL <> "" AND SURFACE_CLOSER_LENGTH_ > DOOR_WIDTH - 10
				SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "F1033" "Y"
				SET_FAMITEM_VALUE GENERIC "SMCR2__"+itos(DOOR_INDEX)+"_" + ITEM_NUM "COMMENTS" "LASER"
			END_IF
			
				ASSEMBLE INST DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				REGEN_MDL INST
	END_IF
END_ASM_DESCR
