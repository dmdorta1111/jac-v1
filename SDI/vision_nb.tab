BEGIN_ASM_DESCR

! END_ASM_DESCR
DECLARE_VARIABLE INTEGER INDEX
DECLARE_ARRAY NAMES

	SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
	DECLARE_VARIABLE DOUBLE LOCX
	IF DOOR_ELEVATION == "NB" AND HAND_ == "L*"
		LOCX = (DOOR_WIDTH/2) - VISION_STRIKE_STILE - (VISION_WIDTH/2)
	ELSE_IF DOOR_ELEVATION == "NB" AND HAND_ == "R*"
		LOCX = -(DOOR_WIDTH /2) + VISION_STRIKE_STILE + (VISION_WIDTH/2)
	END_IF

	CREATE_UDF udf\csys DOOR_ASM
		UDF_REF ATTACH ASM_CSYS
		UDF_DIM	ROTX 0
		UDF_DIM	ROTY 0
		UDF_DIM	ROTZ 0
		UDF_DIM	LOCX LOCX
		UDF_DIM	LOCY VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
		UDF_DIM	LOCZ 0
		UDF_EXP_REF ATTACH CSYS 0
	END_CREATE_UDF
	
	
	IF  STD_REV == "STD" AND REMOVABLE_SIDE == 0 !REMOVABLE SIDE SECURE, 0 = INSIDE (STD), 1 = OUTSIDE
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		! CREATE_UDF	udf\opening DOOR_ASM
			! UDF_REF ATTACH ATTACH
			! UDF_DIM DEPTH DOOR_THICKNESS + .25
			! UDF_DIM WIDTH VISION_WIDTH + 2
			! UDF_DIM HEIGHT VISION_HEIGHT + 2
			! UDF_INTERSECTION * PART_LEVEL
		! END_CREATE_UDF

		SEARCH_MDL_REF COVER SURFACE "FIXED" FIXED
		CREATE_UDF udf\nb_secure COVER
			UDF_REF ATTACH ATTACH
			UDF_REF FIXED FIXED
			UDF_DIM	d395 VISION_WIDTH
			UDF_DIM	d396 VISION_HEIGHT
		END_CREATE_UDF

		SEARCH_MDL_REF BODY SURFACE "FIXED" FIXED
		CREATE_UDF udf\nb_unsecure BODY
			UDF_REF ATTACH ATTACH
			UDF_REF FIXED FIXED
			UDF_DIM	d332 VISION_WIDTH
			UDF_DIM	d333 VISION_HEIGHT
		END_CREATE_UDF
	END_IF

	IF STD_REV == "REV" AND REMOVABLE_SIDE == 0 !REMOVABLE SIDE SECURE, 0 = INSIDE (STD), 1 = OUTSIDE
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		SEARCH_MDL_REF BODY SURFACE "FIXED" FIXED
		CREATE_UDF udf\nb_secure BODY
			UDF_REF ATTACH ATTACH
			UDF_REF FIXED FIXED
			UDF_DIM	d395 VISION_WIDTH
			UDF_DIM	d396 VISION_HEIGHT
		END_CREATE_UDF

		SEARCH_MDL_REF COVER SURFACE "FIXED" FIXED
		CREATE_UDF udf\nb_unsecure COVER
			UDF_REF ATTACH ATTACH
			UDF_REF FIXED FIXED
			UDF_DIM	d332 VISION_WIDTH
			UDF_DIM	d333 VISION_HEIGHT
		END_CREATE_UDF
	END_IF
	
	RETRIEVE_MDL NB_SKEL.PRT SKEL
	SET_MDL_NAME SKEL "NB_"+itos(DOOR_INDEX)+"_"+ITEM_NUM
		SET_MDL_PARAM SKEL "d38" -((DOOR_THICKNESS)/2) +.0625-SM_THICK
		SET_MDL_PARAM SKEL "d19" VISION_WIDTH
		SET_MDL_PARAM SKEL "d20" VISION_HEIGHT
		
	SEARCH_MDL_REF SKEL CSYS "ATTACH" PLACE
		ASSEMBLE SKEL DOOR_ASM
			CSYS ATTACH PLACE
		END_ASSEMBLE
	
	SEARCH_MDL_REF SKEL CSYS "CS0" ASMREF
	
	RETRIEVE_MDL NB_FILLER.PRT COMP
	SEARCH_MDL_REF COMP CSYS "ATTACH" COMPREF
		ASSEMBLE COMP DOOR_ASM
			CSYS ASMREF COMPREF
		END_ASSEMBLE
	
	GET_MDL_NAME COMP MDL_NAME
	CLEAR_ARRAY NAMES
	GET_FAMINSTANCE_NAMES COMP NAMES
	GET_FAMITEMS COMP ITEMS
	INDEX = 0
	FOR NAME REF ARRAY NAMES
		GET_FAMITEM_VALUE COMP NAME INDEX TEMP_INDEX
		IF TEMP_INDEX > INDEX
			INDEX = TEMP_INDEX
		END_IF
	END_FOR
	INDEX++
	INSERT_FAMINSTANCE COMP &MDL_NAME + "_" + itos(INDEX)
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "INDEX"  INDEX
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "STOCKTYPE" 1
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "SMT_THICKNESS" .075
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "LENGTH" VISION_WIDTH + 1.75
	GET_REF_FAMINSTANCE COMP &MDL_NAME + "_" + itos(INDEX) INST
	REPLACE_COMPONENT COMP INST
	
	
	SEARCH_MDL_REF SKEL CSYS "CS1" ASMREF
		ASSEMBLE INST DOOR_ASM
			CSYS ASMREF COMPREF
		END_ASSEMBLE

		
	SEARCH_MDL_REF SKEL CSYS "CS2" ASMREF
	RETRIEVE_MDL NB_TRIM.PRT COMP
	SEARCH_MDL_REF COMP CSYS "ATTACH" COMPREF
		ASSEMBLE COMP DOOR_ASM
			CSYS ASMREF COMPREF
		END_ASSEMBLE
	
	GET_MDL_NAME COMP MDL_NAME
	CLEAR_ARRAY NAMES
	GET_FAMINSTANCE_NAMES COMP NAMES
	GET_FAMITEMS COMP ITEMS
	INDEX = 0
	FOR NAME REF ARRAY NAMES
		GET_FAMITEM_VALUE COMP NAME INDEX TEMP_INDEX
		IF TEMP_INDEX > INDEX
			INDEX = TEMP_INDEX
		END_IF
	END_FOR
	INDEX++
	INSERT_FAMINSTANCE COMP &MDL_NAME + "_" + itos(INDEX)
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "INDEX"  INDEX
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "STOCKTYPE" 1
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "GRAIN" 2
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "LENGTH" VISION_WIDTH + 3.75
	GET_REF_FAMINSTANCE COMP &MDL_NAME + "_" + itos(INDEX) INST
	REPLACE_COMPONENT COMP INST
	
	SEARCH_MDL_REF SKEL CSYS "CS3" ASMREF
		ASSEMBLE INST DOOR_ASM
			CSYS ASMREF COMPREF
		END_ASSEMBLE

	SEARCH_MDL_REF SKEL CSYS "CS4" ASMREF
	RETRIEVE_MDL NB_TRIM.PRT COMP
	SEARCH_MDL_REF COMP CSYS "ATTACH" COMPREF
		ASSEMBLE COMP DOOR_ASM
			CSYS ASMREF COMPREF
		END_ASSEMBLE
	
	GET_MDL_NAME COMP MDL_NAME
	CLEAR_ARRAY NAMES
	GET_FAMINSTANCE_NAMES COMP NAMES
	GET_FAMITEMS COMP ITEMS
	INDEX = 0
	FOR NAME REF ARRAY NAMES
		GET_FAMITEM_VALUE COMP NAME INDEX TEMP_INDEX
		IF TEMP_INDEX > INDEX
			INDEX = TEMP_INDEX
		END_IF
	END_FOR
	INDEX++
	INSERT_FAMINSTANCE COMP &MDL_NAME + "_" + itos(INDEX)
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "INDEX"  INDEX
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "STOCKTYPE" 1
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "GRAIN" 1
	SET_FAMITEM_VALUE COMP &MDL_NAME + "_" + itos(INDEX) "LENGTH" VISION_HEIGHT + 3.75
	GET_REF_FAMINSTANCE COMP &MDL_NAME + "_" + itos(INDEX) INST
	REPLACE_COMPONENT COMP INST
	
	SEARCH_MDL_REF SKEL CSYS "CS5" ASMREF
		ASSEMBLE INST DOOR_ASM
			CSYS ASMREF COMPREF
		END_ASSEMBLE
		
END_ASM_DESCR
