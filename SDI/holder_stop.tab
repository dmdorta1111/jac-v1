BEGIN_GUI_DESCR

	SHOW_PARAM STRING 	PROCESS_MESSAGE
	SHOW_PARAM STRING 	ITEM_NUM
	SHOW_PARAM STRING 	SUB_TYPE
	SHOW_PARAM INTEGER	OPENING_TYPE
	SHOW_PARAM STRING 	DOOR_ITEM_DESC
	SHOW_PARAM STRING 	FRAME_ITEM_DESC
	SHOW_PARAM STRING 	HS_DESC
	SHOW_PARAM STRING 	HS_MODEL
	SHOW_PARAM DOUBLE 	HS_DEGREE
		
	IF HS_TYPE == 1
		! USER_INPUT_PARAM	STRING		HS_MODEL
		USER_INPUT_PARAM	DOUBLE		HS_LENGTH
	END_IF
	
	IF HS_TYPE == 2
		IF OPENING_TYPE == 2 OR OPENING_TYPE == 3
			USER_INPUT_PARAM DOUBLE HS_OFFSET REQUIRED
			USER_INPUT_PARAM DOUBLE HS_DEGREE REQUIRED
		END_IF

		IF OPENING_TYPE == 1 OR OPENING_TYPE == 3
			USER_INPUT_PARAM DOUBLE HS_A REQUIRED
			USER_INPUT_PARAM DOUBLE HS_B REQUIRED
			USER_INPUT_PARAM DOUBLE HS_C REQUIRED
			USER_INPUT_PARAM DOUBLE HS_D REQUIRED
		END_IF
	END_IF

	CHECKBOX_PARAM INTEGER SELECT_DEVICE "YES/NO"

	IF SUB_TYPE == "P"
		CHECKBOX_PARAM INTEGER EQUAL_HOLDERS "YES/NO"
	END_IF
	
	RADIOBUTTON_PARAM	INTEGER		HS_TYPE "NONE" "SURFACE" "CONCEALED"
		
END_GUI_DESCR

BEGIN_ASM_DESCR

DECLARE_VARIABLE INTEGER 	OPERATION
DECLARE_VARIABLE STRING 	PROCESS_MESSAGE
DECLARE_VARIABLE STRING 	ITEM_NUM
DECLARE_VARIABLE STRING 	SUB_TYPE
DECLARE_VARIABLE INTEGER 	OPENING_TYPE
DECLARE_VARIABLE STRING 	DOOR_ITEM_DESC
DECLARE_VARIABLE STRING 	FRAME_ITEM_DESC
DECLARE_VARIABLE INTEGER	EQUAL_HOLDERS
DECLARE_VARIABLE INTEGER	HS_ROW
DECLARE_VARIABLE INTEGER	HS_COL
DECLARE_VARIABLE DOUBLE 	HS_DEGREE
DECLARE_VARIABLE STRING 	TOP_EDGE
DECLARE_VARIABLE DOUBLE 	TOP_CHANNEL_DEPTH
DECLARE_VARIABLE DOUBLE	TOP_CHANNEL_THICKNESS
DECLARE_VARIABLE DOUBLE	HS_LENGTH
DECLARE_VARIABLE STRING 	OHDEVICE_SHEET
DECLARE_VARIABLE DOUBLE 	HINGE_CTR_OFFSET
DECLARE_VARIABLE STRING 	HS_MANUFACTURER
DECLARE_VARIABLE INTEGER	HS_TYPE
DECLARE_VARIABLE STRING	HS_MODEL
DECLARE_VARIABLE STRING	HS_DESC
DECLARE_VARIABLE DOUBLE	HS_A
DECLARE_VARIABLE DOUBLE	HS_B
DECLARE_VARIABLE DOUBLE	HS_C
DECLARE_VARIABLE DOUBLE	HS_D

DECLARE_ARRAY HS_ROWS
DECLARE_ARRAY HS_COLS
DECLARE_ARRAY HS_INFO

	IF OPERATION == 0
		! CONFIG_ELEM

		IF HS_TYPE == 1
			HS_DESC = "SURFACE HOLDER/STOP"
		END_IF

		IF HS_TYPE == 2 AND SELECT_DEVICE == 1
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "STOPS - HOLDERS"
			PRINT "SELECT THE MODEL"
			WAIT
			
			EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
			EXCEL_GET_SHEET_NAME EXCEL_INDEX OHDEVICE_SHEET
		
			CLEAR_ARRAY HS_ROWS
			EXCEL_GET_SELECTION HS_ROWS
			FOR CELL REF ARRAY HS_ROWS
				GET_ARRAY_ELEM CELL 0 HS_ROW
				BREAK
			END_FOR
			
			EXCEL_GET_VALUE HS_ROW 1 HS_MANUFACTURER
			EXCEL_GET_VALUE HS_ROW 2 HS_MODEL
			EXCEL_GET_VALUE HS_ROW 5 HS_UDF
			
			HS_DESC = HS_MANUFACTURER + " - CONCEALED MODEL# " + HS_MODEL + " - " + itos(HS_DEGREE) +" DEGREE" + " - HOLDER/STOP"
			TOP_EDGE = "INVERTED"
			TOP_CHANNEL_DEPTH = HS_D
			TOP_CHANNEL_THICKNESS = .075
			
			PRINT "MANUFACTURER %" HS_MANUFACTURER
			PRINT "HS_MODEL %" HS_MODEL
			PRINT "HS_DEGREE %" HS_DEGREE
			PRINT "HS_UDF %" HS_UDF
			PRINT "HS_OFFSET %" HS_OFFSET
			PRINT "HS_DESC %" HS_DESC
			
			PRINT "HS_A %" HS_A
			PRINT "HS_B %" HS_B
			PRINT "HS_C %" HS_C
			PRINT "HS_D %" HS_D
		END_IF
		
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"	
	END_IF

	IF OPERATION == 1
		IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
			HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

			SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (DOOR_WIDTH/2)
			UDF_DIM	LOCY JOH - TOP_GAP
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\hs_door DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	HS_C HS_C*2
			UDF_DIM	HS_B HS_B
			UDF_DIM	HS_A HS_A
			UDF_INTERSECTION * PART_LEVEL			
			END_CREATE_UDF
		END_IF
		
		IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
			HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
			HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

			SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (-DOOR_WIDTH/2)
			UDF_DIM	LOCY JOH - TOP_GAP
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\hs_door DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	HS_C HS_C*2
			UDF_DIM	HS_B HS_B
			UDF_DIM	HS_A HS_A
			UDF_INTERSECTION * PART_LEVEL			
			END_CREATE_UDF
		END_IF
	END_IF

	IF OPERATION == 2
	! FRAME HOLDERS
		IF HS_TYPE == 1 OR HS_TYPE_2 == 1
			IF SUB_TYPE == "S"
				IF AUTO_OPERATOR == 1 OR MAG_LOCK == 1 OR HS_LENGTH > JOW - 1.55
					HS_LENGTH = JOW - 1.5
				END_IF
			END_IF
			
			IF SUB_TYPE == "P"			
				IF HS_LENGTH > DOOR_WIDTH - 1.55
					HS_LENGTH = DOOR_WIDTH - 1.5
				END_IF
				IF HS_LENGTH_2 > DOOR_WIDTH_2 - 1.55
					HS_LENGTH_2 = DOOR_WIDTH_2 - 1.5
				END_IF
				IF AUTO_OPERATOR == 1 OR MAG_LOCK == 1 OR COORDINATOR == 1
						HS_LENGTH = JOW - 1.5
				END_IF				
			END_IF
			
			SEARCH_MDL_REF FRAME_ASM CSYS "CLSR" CLSR_REF
			IF SUB_TYPE == "S" AND CLOSER_TYPE == 0
				IF HAND == "LHR" OR HAND == "RH"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX  -((JOW/2) - (HS_LENGTH/2) - STOPP)
						UDF_DIM	LOCY FR_THICKNESS + .03
						UDF_DIM	LOCZ FR_THICKNESS + .03
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				IF HAND == "RHR" OR HAND == "LH"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (JOW/2) - (HS_LENGTH/2) - STOPP
						UDF_DIM	LOCY FR_THICKNESS + .03
						UDF_DIM	LOCZ FR_THICKNESS + .03
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
		
				RETRIEVE_MDL SMCR.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
						SET_MDL_PARAM COMP "d41" HS_LENGTH
						IF HEAD < 2
							SET_MDL_PARAM COMP "d40" HEAD - .375
						ELSE
							SET_MDL_PARAM COMP "d40" 1.625
						END_IF
						
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
						
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX -90
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -STOPP
					UDF_DIM	LOCZ -RABBET
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
						
				RETRIEVE_MDL SMCR.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
						SET_MDL_PARAM COMP "d41" HS_LENGTH
						IF SOFFIT < 1.870
							SET_MDL_PARAM COMP "d40" SOFFIT - .25
						ELSE
							SET_MDL_PARAM COMP "d40" 1.625
						END_IF
							
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
						SET_ON_LAYER COMP "COMPONENTS"					
			END_IF

			IF SUB_TYPE == "P" AND HS_TYPE == 1 AND CLOSER_TYPE == 0
				SEARCH_MDL_REF FRAME_ASM CSYS "CLSR" CLSR_REF		
				IF STD_REV == "REV"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX  -((JOW/2) - (HS_LENGTH/2) -STOPP)
						UDF_DIM	LOCY FR_THICKNESS + .03
						UDF_DIM	LOCZ FR_THICKNESS + .03
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				IF STD_REV == "STD"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (JOW/2) - (HS_LENGTH/2) - STOPP
						UDF_DIM	LOCY FR_THICKNESS + .03
						UDF_DIM	LOCZ FR_THICKNESS + .03
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				
				RETRIEVE_MDL SMCR.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
						SET_MDL_PARAM COMP "d41" HS_LENGTH
						IF HEAD < 2
							SET_MDL_PARAM COMP "d40" HEAD - .375
						ELSE
							SET_MDL_PARAM COMP "d40" 1.625
						END_IF
				
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
						
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX -90
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -STOPP
					UDF_DIM	LOCZ -RABBET
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
						
				RETRIEVE_MDL SMCR.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
						SET_MDL_PARAM COMP "d41" HS_LENGTH
						IF SOFFIT < 1.870
							SET_MDL_PARAM COMP "d40" SOFFIT - .25
						ELSE
							SET_MDL_PARAM COMP "d40" 1.625
						END_IF
				
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
						SET_ON_LAYER COMP "COMPONENTS"
			END_IF
			
			IF SUB_TYPE == "P" AND HS_TYPE_2 == 1 AND CLOSER_TYPE_2 == 0
				IF STD_REV == "STD"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX  -((JOW/2) - (HS_LENGTH_2/2) - STOPP)
						UDF_DIM	LOCY FR_THICKNESS + .03
						UDF_DIM	LOCZ FR_THICKNESS + .03
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				IF STD_REV == "REV"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (JOW/2) - (HS_LENGTH_2/2) - STOPP
						UDF_DIM	LOCY FR_THICKNESS + .03
						UDF_DIM	LOCZ FR_THICKNESS + .03
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
				RETRIEVE_MDL SMCR.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
						SET_MDL_PARAM COMP "d41" HS_LENGTH_2
						IF HEAD < 2
							SET_MDL_PARAM COMP "d40" HEAD - .375
						ELSE
							SET_MDL_PARAM COMP "d40" 1.625
						END_IF
				
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
						
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX -90
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -STOPP
					UDF_DIM	LOCZ -RABBET
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
						
				RETRIEVE_MDL SMCR.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
						SET_MDL_PARAM COMP "d41" HS_LENGTH_2
						IF SOFFIT < 1.870
							SET_MDL_PARAM COMP "d40" SOFFIT - .25
						ELSE
							SET_MDL_PARAM COMP "d40" 1.625
						END_IF
				
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
						SET_ON_LAYER COMP "COMPONENTS"				
			END_IF
		END_IF
		
		IF HS_TYPE == 2 OR HS_TYPE_2 == 2
			IF SUB_TYPE == "S"
			
				EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "STOPS - HOLDERS"
				EXCEL_GET_VALUE HS_ROW 5 HS_UDF
				EXCEL_GET_VALUE HS_ROW 7 FRAME_CUT_WIDTH
				EXCEL_GET_VALUE HS_ROW 8 FRAME_CUT_LENGTH
				EXCEL_GET_VALUE HS_ROW 9 FRAME_REINFORCEMENT_MODEL
			
				IF HAND == "LHR" OR HAND == "RH"
					SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (-JOW/2)+HS_OFFSET+(FRAME_CUT_LENGTH/2)+(FRAME_WELD_ALLOWANCE/2)
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2)-RABBET+1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF	
				END_IF

				IF HAND == "RHR" OR HAND == "LH"
					SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 180
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (JOW/2)-HS_OFFSET-(FRAME_CUT_LENGTH/2)-(FRAME_WELD_ALLOWANCE/2)
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2)-RABBET+1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 180
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
				END_IF
								
				CREATE_UDF udf\hs_frame FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM FCW FRAME_CUT_WIDTH+.015
					UDF_DIM FCL FRAME_CUT_LENGTH+.015
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				
				RETRIEVE_MDL &FRAME_REINFORCEMENT_MODEL COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "FR_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM COMP "FACEE" FACEE
					SET_MDL_PARAM COMP "RABBET" RABBET
					SET_MDL_PARAM COMP "RETURN" RETURN
					
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
			END_IF
			
			IF SUB_TYPE == "P" AND HS_TYPE == 2
			
				EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "STOPS - HOLDERS"
				EXCEL_GET_VALUE HS_ROW 5 HS_UDF
				EXCEL_GET_VALUE HS_ROW 7 FRAME_CUT_WIDTH
				EXCEL_GET_VALUE HS_ROW 8 FRAME_CUT_LENGTH
				EXCEL_GET_VALUE HS_ROW 9 FRAME_REINFORCEMENT_MODEL
			
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
				IF STD_REV == "REV"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (-JOW/2)+HS_OFFSET+(FRAME_CUT_LENGTH/2)+(FRAME_WELD_ALLOWANCE/2)
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2)-RABBET+1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF	
				END_IF
				IF STD_REV == "STD"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 180
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (JOW/2)-HS_OFFSET-(FRAME_CUT_LENGTH/2)-(FRAME_WELD_ALLOWANCE/2)
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2)-RABBET+1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 180
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF					
				END_IF

				SET_REF_NAME ATTACH "HS_TYPE_2"
				
				CREATE_UDF udf\hs_frame FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM FCW FRAME_CUT_WIDTH+.015
					UDF_DIM FCL FRAME_CUT_LENGTH+.015
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF

				RETRIEVE_MDL &FRAME_REINFORCEMENT_MODEL COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "FR_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM COMP "FACEE" FACEE
					SET_MDL_PARAM COMP "RABBET" RABBET
					SET_MDL_PARAM COMP "RETURN" RETURN
					
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
			END_IF
			
			IF SUB_TYPE == "P" AND HS_TYPE_2 == 2
			
				EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "STOPS - HOLDERS"
				EXCEL_GET_VALUE HS_ROW_2 5 HS_UDF
				EXCEL_GET_VALUE HS_ROW_2 7 FRAME_CUT_WIDTH
				EXCEL_GET_VALUE HS_ROW_2 8 FRAME_CUT_LENGTH
				EXCEL_GET_VALUE HS_ROW_2 9 FRAME_REINFORCEMENT_MODEL
			
				SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
				IF STD_REV == "STD"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (-JOW/2)+HS_OFFSET_2+(FRAME_CUT_LENGTH/2)+(FRAME_WELD_ALLOWANCE/2)
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2)-RABBET+1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF	
				END_IF
				IF STD_REV == "REV"
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ASM_CSYS
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 180
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (JOW/2)-HS_OFFSET_2-(FRAME_CUT_LENGTH/2)-(FRAME_WELD_ALLOWANCE/2)
						UDF_DIM	LOCY JOH
						UDF_DIM	LOCZ (JD/2)-RABBET+1
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 180
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF					
				END_IF
				
				SET_REF_NAME ATTACH "HS_TYPE_2_2"
			
				CREATE_UDF udf\hs_frame FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM FCW FRAME_CUT_WIDTH+.015
					UDF_DIM FCL FRAME_CUT_LENGTH+.015
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF

				RETRIEVE_MDL &FRAME_REINFORCEMENT_MODEL COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					SET_MDL_PARAM COMP "STOCKTYPE" 1
					SET_MDL_PARAM COMP "FR_THICKNESS" FR_THICKNESS
					SET_MDL_PARAM COMP "FACEE" FACEE
					SET_MDL_PARAM COMP "RABBET" RABBET
					SET_MDL_PARAM COMP "RETURN" RETURN
					
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX				
			END_IF
		END_IF		
	END_IF
END_ASM_DESCR
