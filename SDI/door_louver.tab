BEGIN_GUI_DESCR

SHOW_PARAM	STRING	ITEM_NUM
SHOW_PARAM	DOUBLE	JOW
SHOW_PARAM	DOUBLE	JOH
SHOW_PARAM	STRING	SUB_TYPE
SHOW_PARAM	STRING	HAND
SHOW_PARAM	STRING	DOOR_ELEVATION
SHOW_PARAM	DOUBLE	ACTIVE_LEAF
SHOW_PARAM	DOUBLE	FIRE_RATING

USER_INPUT_PARAM	DOUBLE	LOUVER_WIDTH
USER_INPUT_PARAM	DOUBLE	LOUVER_HEIGHT
USER_INPUT_PARAM	DOUBLE	LOUVER_BOTTOM_RAIL
	
	
IF SUB_TYPE == "P"
	RADIOBUTTON_PARAM INTEGER	DOOR_LOUVER	"ACTIVE" "INACTIVE" "BOTH"
END_IF

	! RADIOBUTTON_PARAM INTEGER LOUVER_DIMENSION_METHOD 	" 0 - NOT SELECTED" \
														! " 1 - TOP TO CENTER" \
														! " 2 - FLOOR TO CENTER" \
														! " 3 - TOP RAIL AND HEIGHT" \
														! " 4 - FLOOR TO BOTTOM AND HEIGHT" \
														! " 5 - TOP AND BOTTOM RAIL CALC HEIGHT" \
														! " 6 - BOTTOM RAIL " \
														! " 7 - FG2, FL2 OR GL"
		
IF SUB_TYPE == "S"
	DOOR_LOUVER = 2
END_IF

END_GUI_DESCR

BEGIN_ASM_DESCR

	!FIXED INPUT PARAMATERS
	DECLARE_VARIABLE	STRING	ITEM_NUM
	DECLARE_VARIABLE	STRING	SUB_JOB_NAME
	DECLARE_VARIABLE	DOUBLE	JOW
	DECLARE_VARIABLE	DOUBLE	JOH
	DECLARE_VARIABLE	STRING	SUB_TYPE
	DECLARE_VARIABLE	STRING	HAND
	DECLARE_VARIABLE	STRING	DOOR_ELEVATION
	DECLARE_VARIABLE	DOUBLE	ACTIVE_LEAF
	DECLARE_VARIABLE	DOUBLE	UNDERCUT
	DECLARE_VARIABLE	DOUBLE	TOP_GAP
	DECLARE_VARIABLE	DOUBLE	STIKE_GAP
	DECLARE_VARIABLE	DOUBLE	HINGE_GAP
	DECLARE_VARIABLE	DOUBLE	FIRE_RATING
	DECLARE_VARIABLE	INTEGER	OPERATION

	!OUTPUT PARAMETERS
	DECLARE_VARIABLE	INTEGER	DOOR_LOUVER
	DECLARE_VARIABLE	INTEGER	LOUVER_DIMENSION_METHOD
	DECLARE_VARIABLE	DOUBLE	LOUVER_WIDTH
	DECLARE_VARIABLE	DOUBLE	LOUVER_HEIGHT
	DECLARE_VARIABLE	DOUBLE	LOUVER_BOTTOM_RAIL

	IF OPERATION == 0
		CONFIG_ELEM
	END_IF

	IF OPERATION > 0
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
		DECLARE_VARIABLE DOUBLE LOCX
		LOCX = 0
				
		DECLARE_VARIABLE DOUBLE TEMP
		TEMP = LOUVER_BOTTOM_RAIL + (LOUVER_HEIGHT/2) + UNDERCUT
		PRINT "%" TEMP
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY TEMP
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		SET_REF_NAME ATTACH "LOUVER_REF"
		
		CREATE_UDF	udf\opening DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM DEPTH DOOR_THICKNESS + .25
			UDF_DIM WIDTH LOUVER_WIDTH
			UDF_DIM HEIGHT LOUVER_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
		
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 270
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY -LOUVER_HEIGHT/2
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" LOUVER_WIDTH
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOUVER_WIDTH/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ LOUVER_HEIGHT/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" LOUVER_HEIGHT
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOUVER_HEIGHT/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ LOUVER_WIDTH/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" LOUVER_WIDTH
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOUVER_WIDTH/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ LOUVER_HEIGHT/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" LOUVER_HEIGHT
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
	END_IF
END_ASM_DESCR
