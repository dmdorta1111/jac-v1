BEGIN_GUI_DESCR

SHOW_PARAM STRING OHDEVICE_SHEET
SHOW_PARAM STRING HS_MODEL
SHOW_PARAM DOUBLE DEGREE

USER_INPUT_PARAM DOUBLE HS_OFFSET REQUIRED
USER_INPUT_PARAM DOUBLE HS_DEGREE REQUIRED

CHECKBOX_PARAM INTEGER SELECT_DEVICE "YES/NO"

END_GUI_DESCR

BEGIN_ASM_DESCR

	DECLARE_VARIABLE INTEGER OPERATION
	DECLARE_VARIABLE INTEGER HS_ROW
	DECLARE_VARIABLE INTEGER HS_COL
	DECLARE_VARIABLE DOUBLE HS_DEGREE
	DECLARE_VARIABLE STRING HS_MODEL
	DECLARE_VARIABLE STRING TOP_EDGE
	DECLARE_VARIABLE DOUBLE TOP_CHANNEL_DEPTH
	DECLARE_VARIABLE DOUBLE TOP_CHANNEL_THICKNESS
	DECLARE_VARIABLE STRING OHDEVICE_SHEET
	DECLARE_VARIABLE DOUBLE HINGE_CTR_OFFSET

	TOP_EDGE = "INVERTED"
	! TOP_CHANNEL_DEPTH = 1.7
	TOP_CHANNEL_THICKNESS = .075
	
	DECLARE_ARRAY HS_ROWS
	DECLARE_ARRAY HS_COLS
	DECLARE_ARRAY HS_INFO
	
	IF OPERATION == 0
	
		DEGREE = HS_DEGREE
		
		! CONFIG_ELEM
	
		IF SELECT_DEVICE == 1
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "STOPS - HOLDERS"
			PRINT "SELECT THE MODEL"
			WAIT
			
			EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
			EXCEL_GET_SHEET_NAME EXCEL_INDEX OHDEVICE_SHEET
		
			CLEAR_ARRAY HS_ROWS
			EXCEL_GET_SELECTION HS_ROWS
			FOR CELL REF ARRAY HS_ROWS
				GET_ARRAY_ELEM CELL 0 HS_ROW
				GET_ARRAY_ELEM CELL 2 HS_MODEL
				BREAK
			END_FOR
			
			EXCEL_GET_VALUE HS_ROW 1 HS_MANUFACTURER
			EXCEL_GET_VALUE HS_ROW 5 HS_UDF
			
			PRINT "SELECT THE DEGREE"
			WAIT
			
			CLEAR_ARRAY HS_COLS
			EXCEL_GET_SELECTION HS_COLS
			FOR CELL REF ARRAY HS_COLS
				GET_ARRAY_ELEM CELL 1 HS_COL
				BREAK
			END_FOR
			
			EXCEL_GET_VALUE 1 HS_COL HS_DEGREE	
			
			PRINT "MANUFACTURER %" HS_MANUFACTURER
			PRINT "HS_MODEL %" HS_MODEL
			PRINT "HS_DEGREE %" HS_DEGREE
			PRINT "HS_UDF %" HS_UDF
			PRINT "HS_OFFSET %" HS_OFFSET
		END_IF
		
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
	END_IF

	IF OPERATION == 1
			! EXCEL_ACTIVATE_SHEET SHEET_BY_NAME OHDEVICE_SHEET
									
			! EXCEL_GET_VALUES CELL_BY_INDEX HS_ROW HS_COL CELL_BY_INDEX HS_ROW HS_COL+3 SELCELLS
			
			! CLEAR_ARRAY HS_INFO
			! FOR CELL REF ARRAY SELCELLS
				! GET_ARRAY_ELEM CELL 2 content
				
				! IF content == ""
					! BREAK
				! ELSE
					! ADD_ARRAY_ELEM HS_INFO content
					! PRINT "CONTENT - %  " content
				! END_IF
			! END_FOR

			! GET_ARRAY_ELEM HS_INFO 0 HS_A
			! GET_ARRAY_ELEM HS_INFO 1 HS_B
			! GET_ARRAY_ELEM HS_INFO 2 HS_C
			! GET_ARRAY_ELEM HS_INFO 3 HS_E
			
			! EXCEL_GET_VALUE HS_ROW 29 HS_F	
			
			! PRINT "HS_A %" HS_A
			! PRINT "HS_B %" HS_B
			! PRINT "HS_C %" HS_C
			! PRINT "HS_E %" HS_E
			! PRINT "HS_F %" HS_F
	
		! IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			! HAND_ == "LHR1" OR HAND_ == "LHRA1" OR HAND_ == "LHRI1" OR \
			! HAND_ == "RH2" OR HAND_ == "RHA2" OR HAND_ == "RHI2"

			! SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
			! CREATE_UDF udf\csys DOOR_ASM
			! UDF_REF ATTACH ASM_CSYS
			! UDF_DIM	ROTX 0
			! UDF_DIM	ROTY 0
			! UDF_DIM	ROTZ 180
			! UDF_DIM	LOCX (DOOR_WIDTH/2) + HINGE_CTR_OFFSET
			! UDF_DIM	LOCY JOH - TOP_GAP
			! UDF_DIM	LOCZ 0
			! UDF_EXP_REF ATTACH CSYS 0
			! END_CREATE_UDF
	
			! CREATE_UDF udf\HS_door DOOR_ASM
			! UDF_REF ATTACH ATTACH
			! UDF_DIM	HS_E HS_E
			! UDF_DIM	HS_C HS_C
			! UDF_INTERSECTION * PART_LEVEL			
			! END_CREATE_UDF
		! END_IF
		
		! IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
			! HAND_ == "RHR2" OR HAND_ == "RHRA2" OR HAND_ == "RHRI2" OR \
			! HAND_ == "LH1" OR HAND_ == "LHA1" OR HAND_ == "LHI1"

			! SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ASM_CSYS
			! CREATE_UDF udf\csys DOOR_ASM
			! UDF_REF ATTACH ASM_CSYS
			! UDF_DIM	ROTX 0
			! UDF_DIM	ROTY 0
			! UDF_DIM	ROTZ 0
			! UDF_DIM	LOCX (-DOOR_WIDTH/2) - HINGE_CTR_OFFSET
			! UDF_DIM	LOCY JOH - TOP_GAP
			! UDF_DIM	LOCZ 0
			! UDF_EXP_REF ATTACH CSYS 0
			! END_CREATE_UDF
	
			! CREATE_UDF udf\HS_door DOOR_ASM
			! UDF_REF ATTACH ATTACH
			! UDF_DIM	HS_E HS_E
			! UDF_DIM	HS_C HS_C
			! UDF_INTERSECTION * PART_LEVEL			
			! END_CREATE_UDF
		! END_IF
	END_IF
	
	IF OPERATION == 2
	
		IF HAND == "LHR" OR HAND == "RH" OR HAND == "LHRA" OR HAND == "RHRA" OR \
		   HAND == "LHR/RHR" OR HAND == "LHA"  OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF &HS_UDF FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (-JOW/2)+HS_OFFSET
			UDF_DIM	LOCY JOH + FR_THICKNESS
			UDF_DIM	LOCZ (JD/2)-RABBET+1
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF	
		END_IF

		IF HAND == "RHR" OR HAND == "LH" OR HAND == "LHRA" OR HAND == "RHRA" OR \
		   HAND == "LHR/RHR" OR HAND == "LHA"  OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF &HS_UDF FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 180
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (JOW/2)-HS_OFFSET
			UDF_DIM	LOCY JOH + FR_THICKNESS
			UDF_DIM	LOCZ (JD/2)-RABBET+1
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF
		
		EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		
	END_IF	
END_ASM_DESCR

