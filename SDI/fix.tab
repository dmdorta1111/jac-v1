BEGIN_GUI_DESCR

USER_SELECT CSYS PRT_CSYS_DEF
USER_SELECT PLANE FRONT
USER_SELECT PLANE TOP
USER_SELECT PLANE RIGHT

IF FIXED_SURF == ""
	USER_SELECT SURFACE FIXED_
END_IF

END_GUI_DESCR


BEGIN_ASM_DESCR


DISPLAY_DATUM PLANES TRUE
DISPLAY_DATUM AXES TRUE
DISPLAY_DATUM POINTS TRUE
DISPLAY_DATUM CSYS TRUE	

DECLARE_VARIABLE STRING FIXED_SURF
! DECLARE_REFERENCE FIXED_

SEARCH_MDL_REFS THIS SURFACE "*" RefSurfaces

FOR RefSurf REF ARRAY RefSurfaces
	GET_REF_NAME RefSurf RefSurfName
		IF RefSurfName == "FIXED"
			FIXED_SURF = "FOUND"
			HIGHLIGHT_REF RefSurf
			BREAK
		ELSE
			FIXED_SURF = ""
		END_IF
END_FOR
		
SEARCH_MDL_REF THIS CSYS "*" PRT_CSYS_DEF
SEARCH_MDL_REF THIS PLANE "FRONT" FRONT
SEARCH_MDL_REF THIS PLANE "TOP" TOP
SEARCH_MDL_REF THIS PLANE "*" RIGHT
		
		
		
CONFIG_ELEM

IF FIXED_SURF == ""
	SET_REF_NAME FIXED_ "FIXED"
END_IF

CREATE_ORIENTATION THIS FRONT FRONT TOP TOP "0"
CREATE_ORIENTATION THIS FRONT FRONT TOP TOP "1"
CREATE_ORIENTATION THIS FRONT FRONT RIGHT TOP "2"

CREATE_UDF udf\csys THIS
	UDF_REF ATTACH PRT_CSYS_DEF
	UDF_DIM	ROTX 0
	UDF_DIM	ROTY 0
	UDF_DIM	ROTZ 0
	UDF_DIM	LOCX 0
	UDF_DIM	LOCY 0
	UDF_DIM	LOCZ 0
	UDF_EXP_REF DIM_CSYS CSYS 0
END_CREATE_UDF

REORDER_FEATURES DIM_CSYS AFTER PRT_CSYS_DEF

UNGROUP_FEATURES DIM_CSYS

SET_REF_NAME DIM_CSYS "DIM"

SAVE_MDL THIS

WINDOW_CLOSE
ERASE_NOT_DISPLAYED
END_ASM_DESCR

