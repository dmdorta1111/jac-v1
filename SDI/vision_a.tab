BEGIN_ASM_DESCR

	DECLARE_VARIABLE DOUBLE VISION_A_ALLOWANCE
	DECLARE_VARIABLE DOUBLE VBR
	DECLARE_VARIABLE INTEGER LITE_QTY
	DECLARE_VARIABLE INTEGER LITE_INDEX

	IF DOOR_LITE_TRIM_TYPE == "A"
		VISION_A_ALLOWANCE = 0
	ELSE_IF DOOR_LITE_TRIM_TYPE == "C"
		VISION_A_ALLOWANCE = 1.25
	END_IF
	

		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
		DECLARE_VARIABLE DOUBLE LOCX
		IF (DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "NL") AND HAND_ == "L*"
			LOCX = (DOOR_WIDTH/2) - VISION_STRIKE_STILE - (VISION_WIDTH/2)
			LITE_QTY = 1
		ELSE_IF (DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "NL") AND HAND_ == "R*"
			LOCX = -(DOOR_WIDTH /2) + VISION_STRIKE_STILE + (VISION_WIDTH/2)
			LITE_QTY = 1
		ELSE_IF DOOR_ELEVATION == "G" OR DOOR_ELEVATION == "GL" OR DOOR_ELEVATION == "V" OR DOOR_ELEVATION == "VL"
			LOCX = 0
			LITE_QTY = 1
		ELSE_IF DOOR_ELEVATION == "2G"
			LOCX = 0
			LITE_QTY = 2
		END_IF
		
	LITE_INDEX = 1

	WHILE LITE_INDEX <= LITE_QTY
		IF LITE_INDEX == 1
			VBR = JOH - VISION_TOP_RAIL - VISION_HEIGHT - TOP_GAP
		ELSE_IF LITE_INDEX == 2
			VBR = VISION_BOTTOM_RAIL
			VISION_HEIGHT = VISION_HEIGHT2
		END_IF
		
		DECLARE_VARIABLE DOUBLE TEMP
		TEMP = VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
		PRINT "%" TEMP
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY VBR + (VISION_HEIGHT/2)
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		CREATE_UDF	udf\opening DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM DEPTH DOOR_THICKNESS + .25
			UDF_DIM WIDTH VISION_WIDTH + VISION_A_ALLOWANCE
			UDF_DIM HEIGHT VISION_HEIGHT + VISION_A_ALLOWANCE
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
		
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 270
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY -(VISION_HEIGHT+VISION_A_ALLOWANCE)/2
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_WIDTH+VISION_A_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (VISION_WIDTH+VISION_A_ALLOWANCE)/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ (VISION_HEIGHT+VISION_A_ALLOWANCE)/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_HEIGHT+VISION_A_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (VISION_HEIGHT+VISION_A_ALLOWANCE)/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ (VISION_WIDTH+VISION_A_ALLOWANCE)/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_WIDTH+VISION_A_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (VISION_WIDTH+VISION_A_ALLOWANCE)/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ (VISION_HEIGHT+VISION_A_ALLOWANCE)/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_HEIGHT+VISION_A_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX		

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY VBR + (VISION_HEIGHT/2)
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		
		RETRIEVE_MDL VISION_A.ASM VISION_KIT
		SET_MDL_NAME VISION_KIT "VISION_KIT_"+itos(DOOR_INDEX)+itos(LITE_INDEX)+"_"+SO_NUM+"_"+ ITEM_NUM
		
		SEARCH_MDL_REF VISION_KIT CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE VISION_KIT DOOR_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			
			SET_MDL_PARAM VISION_KIT "STOCKTYPE" 0
			SET_MDL_PARAM VISION_KIT "EMJACNUM" "999"
			SET_MDL_PARAM VISION_KIT "VISION_WIDTH" VISION_WIDTH
			SET_MDL_PARAM VISION_KIT "VISION_HEIGHT" VISION_HEIGHT
			SET_MDL_PARAM VISION_KIT "DOOR_THICK" DOOR_THICKNESS
			REGEN_MDL VISION_KIT
		LITE_INDEX++
	END_WHILE
	
END_ASM_DESCR
