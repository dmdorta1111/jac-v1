
BEGIN_GUI_DESCR

	IF SUB_TYPE == "S" OR EQUAL_ELEVATIONS == 1
		GLOBAL_PICTURE door_elevations2.GIF
	END_IF

	SHOW_PARAM STRING	ITEM_NUM
	SHOW_PARAM DOUBLE	JOW
	SHOW_PARAM DOUBLE	JOH
	SHOW_PARAM STRING	SUB_TYPE
	SHOW_PARAM STRING	HAND
	SHOW_PARAM STRING	TOP_GAP
	SHOW_PARAM STRING	HINGE_GAP

	IF SUB_TYPE == "P"	
		SHOW_PARAM DOUBLE ACTIVE_LEAF
		SHOW_PARAM INTEGER ASTRAGAL
	END_IF

	IF SUB_TYPE == "S" OR EQUAL_ELEVATIONS == 1
		USER_INPUT_PARAM STRING	DOOR_ELEVATION REQUIRED
	END_IF

	USER_INPUT_PARAM DOUBLE	UNDERCUT REQUIRED
	USER_INPUT_PARAM INTEGER	DOOR_GAUGE REQUIRED
	USER_INPUT_PARAM STRING	DOOR_GRADE REQUIRED
	USER_INPUT_PARAM STRING	BODY_SIDE_FINISH REQUIRED
	USER_INPUT_PARAM STRING	COVER_SIDE_FINISH REQUIRED
	USER_INPUT_PARAM DOUBLE	DOOR_THICKNESS REQUIRED
	USER_INPUT_PARAM DOUBLE	TOP_CHANNEL_DEPTH REQUIRED
	USER_INPUT_PARAM DOUBLE	BOTTOM_CHANNEL_DEPTH REQUIRED
	USER_INPUT_PARAM DOUBLE	STRIKE_GAP REQUIRED
	USER_INPUT_PARAM DOUBLE	HINGE_GAP REQUIRED
	USER_INPUT_PARAM DOUBLE	DOOR_WIDTH_ADJUSTMENT REQUIRED

	IF BOTTOM_EDGE_ == 0 OR TOP_EDGE_ == 0
		USER_INPUT_PARAM DOUBLE	CLOSURE_CHANNEL_CLEARANCE REQUIRED
	END_IF

	IF SUB_TYPE == "P"
		USER_INPUT_PARAM DOUBLE ACTIVE_LEAF REQUIRED
	END_IF

	RADIOBUTTON_PARAM INTEGER DOOR_CONSTRUCTION_ "LOCKSEAM" "SEAMLESS"

	IF FIRE_RATING <= 90
		RADIOBUTTON_PARAM INTEGER CORE 	"STYRENE" 				\ ! 0
											"URETHANE" 				\ ! 1
											"STEEL STIFFENED" 		\ ! 2
											"450 TEMPERATURE RISE" 	\ ! 3
											"250 TEMPERATURE RISE" 	\ ! 4
											"HONECOMB" 				\ ! 5
											"BULLET" 				\ ! 6
											"STEEL STIFF/BULLET" 		\ ! 7
											"3 HOUR"					\ !8
											"STC 45"					 !9
	ELSE_IF FIRE_RATING == 180
		CORE = 8
	END_IF							

	RADIOBUTTON_PARAM INTEGER HINGE_EDGE_ "BEVEL" "SQUARE" "BULLNOSE"
	RADIOBUTTON_PARAM INTEGER STRIKE_EDGE_ "BEVEL" "SQUARE" "BULLNOSE"
	
!!!!!!!!!	
	RADIOBUTTON_PARAM INTEGER TOP_EDGE_ "INVERTED" "FLUSH" "TACKED" "SEALED" "SEAMLESS" "POLISHED"
	RADIOBUTTON_PARAM INTEGER BOTTOM_EDGE_ "INVERTED" "FLUSH" "TACKED" "SEALED" "SEAMLESS" "POLISHED"

	IF DOOR_CONSTRUCTION_ == 1 AND ( BOTTOM_EDGE_ == 2)
		CHECKBOX_PARAM INTEGER WEEP_HOLES "YES/NO"
	END_IF

	! RADIOBUTTON_PARAM INTEGER TOP_EDGE_ "INVERTED" "FLUSH" "SEAMLESS" "WELDED" "TACKED"	
	! RADIOBUTTON_PARAM INTEGER BOTTOM_EDGE_ "INVERTED" "FLUSH" "SEAMLESS" "WELDED" "TACKED"

	! IF DOOR_CONSTRUCTION_ == 1 AND ( BOTTOM_EDGE_ == 4)
		! CHECKBOX_PARAM INTEGER WEEP_HOLES "YES/NO"
	! END_IF
	
!!!!!!!!!	
	
	

	IF SUB_TYPE == "P"	
		CHECKBOX_PARAM INTEGER EQUAL_ELEVATIONS "YES/NO"
		CHECKBOX_PARAM INTEGER ASTRAGAL "YES/NO"
		IF ASTRAGAL == 1
			CHECKBOX_PARAM INTEGER ASTRAGAL_INSTALLED "YES/NO"
			IF SUB_TYPE == "P" AND ASTRAGAL == 1
				RADIOBUTTON_PARAM INTEGER ASTRAGAL_DOOR_ "ACTIVE" "INACTIVE"
			END_IF
		END_IF		
	END_IF

	IF DOOR_CONSTRUCTION_ == 0
		DOOR_CONSTRUCTION = "LOCKSEAM" 
	ELSE_IF DOOR_CONSTRUCTION_ == 1
		DOOR_CONSTRUCTION = "SEAMLESS"
	END_IF	

	IF DOOR_CONSTRUCTION_ == 1 AND (BOTTOM_EDGE_ <> 0 AND BOTTOM_EDGE_ <> 1)
		CHECKBOX_PARAM INTEGER ADD_BOTTOM_CHANNEL "YES/NO"
	ELSE
		ADD_BOTTOM_CHANNEL = 0
	END_IF
	
	IF HINGE_EDGE_ == 0
		HINGE_EDGE_SHAPE = "BEVEL"
	ELSE_IF HINGE_EDGE_ == 1
		HINGE_EDGE_SHAPE = "SQUARE"
	ELSE_IF HINGE_EDGE_ == 2
		HINGE_EDGE_SHAPE = "BULLNOSE"
	END_IF
	
	IF STRIKE_EDGE_ == 0
		STRIKE_EDGE_SHAPE = "BEVEL"
	ELSE_IF STRIKE_EDGE_ == 1
		STRIKE_EDGE_SHAPE = "SQUARE"
	ELSE_IF STRIKE_EDGE_ == 2
		STRIKE_EDGE_SHAPE = "BULLNOSE"
	END_IF	

!!!!!!!	
	IF TOP_EDGE_ == 0
		TOP_EDGE = "INVERTED"
	ELSE_IF TOP_EDGE_ == 1
		TOP_EDGE = "FLUSH"
	ELSE_IF TOP_EDGE_ == 2
		TOP_EDGE = "TACKED"
	ELSE_IF TOP_EDGE_ == 3
		TOP_EDGE = "SEALED"
	ELSE_IF TOP_EDGE_ == 4
		TOP_EDGE = "SEAMLESS"
	ELSE_IF TOP_EDGE_ == 5
		TOP_EDGE = "POLISHED"
	END_IF
	
	IF BOTTOM_EDGE_ == 0
		BOTTOM_EDGE = "INVERTED"
		WEEP_HOLES = 0
	ELSE_IF BOTTOM_EDGE_ == 1
		BOTTOM_EDGE = "FLUSH"
		WEEP_HOLES = 0
	ELSE_IF BOTTOM_EDGE_ == 2
		BOTTOM_EDGE = "TACKED"
	ELSE_IF BOTTOM_EDGE_ == 3
		BOTTOM_EDGE = "SEALED"
		WEEP_HOLES = 0
	ELSE_IF BOTTOM_EDGE_ == 4
		BOTTOM_EDGE = "SEAMLESS"
		WEEP_HOLES = 0
	ELSE_IF BOTTOM_EDGE_ == 5
		BOTTOM_EDGE = "POLISHED"
		WEEP_HOLES = 0
	END_IF
		
	! IF TOP_EDGE_ == 0
		! TOP_EDGE = "INVERTED"
	! ELSE_IF TOP_EDGE_ == 1
		! TOP_EDGE = "FLUSH"
	! ELSE_IF TOP_EDGE_ == 2
		! TOP_EDGE = "SEAMLESS"
	! ELSE_IF TOP_EDGE_ == 3
		! TOP_EDGE = "WELDED"
	! ELSE_IF TOP_EDGE_ == 4
		! TOP_EDGE = "TACKED"
	! END_IF
	
	! IF BOTTOM_EDGE_ == 0
		! BOTTOM_EDGE = "INVERTED"
		! WEEP_HOLES = 0
	! ELSE_IF BOTTOM_EDGE_ == 1
		! BOTTOM_EDGE = "FLUSH"
		! WEEP_HOLES = 0
	! ELSE_IF BOTTOM_EDGE_ == 2
		! BOTTOM_EDGE = "SEAMLESS"
		! WEEP_HOLES = 0
	! ELSE_IF BOTTOM_EDGE_ == 3
		! BOTTOM_EDGE = "WELDED"
		! WEEP_HOLES = 0
	! ELSE_IF BOTTOM_EDGE_ == 4
		! BOTTOM_EDGE = "TACKED"
	! END_IF
!!!!!!!!!

	
END_GUI_DESCR

BEGIN_ASM_DESCR
	DECLARE_VARIABLE STRING  ITEM_NUM
	DECLARE_VARIABLE DOUBLE JOW
	DECLARE_VARIABLE DOUBLE JOH	
	DECLARE_VARIABLE STRING  SUB_TYPE
	DECLARE_VARIABLE STRING  HAND	
	DECLARE_VARIABLE STRING  DOOR_ELEVATION
	DECLARE_VARIABLE INTEGER DOOR_GAUGE
	DECLARE_VARIABLE STRING  DOOR_GRADE
	DECLARE_VARIABLE STRING  BODY_SIDE_FINISH
	DECLARE_VARIABLE STRING  COVER_SIDE_FINISH
	DECLARE_VARIABLE STRING  DOOR_CONSTRUCTION
	DECLARE_VARIABLE INTEGER CORE
	DECLARE_VARIABLE STRING  CORE_DESC
	DECLARE_VARIABLE DOUBLE UNDERCUT
	DECLARE_VARIABLE STRING  HINGE_EDGE_SHAPE 	
	DECLARE_VARIABLE STRING  STRIKE_EDGE_SHAPE 	
	DECLARE_VARIABLE STRING  TOP_EDGE TOP_EDGE
	DECLARE_VARIABLE STRING  BOTTOM_EDGE 	
	DECLARE_VARIABLE DOUBLE DOOR_THICKNESS 	
	DECLARE_VARIABLE DOUBLE STRIKE_GAP
	DECLARE_VARIABLE DOUBLE HINGE_GAP
	DECLARE_VARIABLE DOUBLE TOP_GAP 	 	
	DECLARE_VARIABLE DOUBLE ACTIVE_LEAF 		
	DECLARE_VARIABLE DOUBLE TOP_CHANNEL_DEPTH 	
	DECLARE_VARIABLE DOUBLE BOTTOM_CHANNEL_DEPTH
	DECLARE_VARIABLE INTEGER  ASTRAGAL
	DECLARE_VARIABLE INTEGER  ASTRAGAL_INSTALLED
	DECLARE_VARIABLE INTEGER  ASTRAGAL_DOOR_
	DECLARE_VARIABLE STRING  ASTRAGAL_DOOR	
	DECLARE_VARIABLE INTEGER EXCEL_COLUMN
	DECLARE_VARIABLE INTEGER EQUAL_ELEVATIONS
	DECLARE_VARIABLE STRING  PROCESS_MESSAGE
	DECLARE_VARIABLE INTEGER FIRE_RATING
	DECLARE_VARIABLE INTEGER AUTO_BOTTOM
	DECLARE_VARIABLE INTEGER WEEP_HOLES
	DECLARE_VARIABLE DOUBLE CLOSURE_CHANNEL_CLEARANCE
	DECLARE_VARIABLE DOUBLE DOOR_WIDTH_ADJUSTMENT
	DECLARE_VARIABLE INTEGER ADD_BOTTOM_CHANNEL
	DECLARE_VARIABLE INTEGER TOP_EDGE_
	DECLARE_VARIABLE INTEGER BOTTOM_EDGE_	
	DECLARE_VARIABLE INTEGER DOOR_CONSTRUCTION_	
	DECLARE_VARIABLE INTEGER HINGE_EDGE_	
	DECLARE_VARIABLE INTEGER STRIKE_EDGE_

	IF DOOR_CONSTRUCTION == "LOCKSEAM" 
		DOOR_CONSTRUCTION_ = 0
	ELSE_IF DOOR_CONSTRUCTION == "SEAMLESS"
		DOOR_CONSTRUCTION_ = 1
	END_IF

	IF HINGE_EDGE_SHAPE == "BEVEL"
		HINGE_EDGE_ = 0
	ELSE_IF HINGE_EDGE_SHAPE == "SQUARE"
		HINGE_EDGE_ = 1
	ELSE_IF HINGE_EDGE_SHAPE == "BULLNOSE"
		HINGE_EDGE_ = 2
	END_IF

	IF STRIKE_EDGE_SHAPE == "BEVEL"
		STRIKE_EDGE_ = 0
	ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
		STRIKE_EDGE_ = 1
	ELSE_IF STRIKE_EDGE_SHAPE == "BULLNOSE"
		STRIKE_EDGE_ = 2
	END_IF

!!!!!!!
	IF TOP_EDGE == "WELDED"
		MESSAGE_BOX "THE TOP EDGE IS BEING CHANGED FROM WELDED TO SEALED"
		TOP_EDGE = "SEALED"
	END_IF

	IF TOP_EDGE == "INVERTED"
		TOP_EDGE_ = 0
	ELSE_IF TOP_EDGE == "FLUSH"
		TOP_EDGE_ = 1 
	ELSE_IF TOP_EDGE == "TACKED"
		TOP_EDGE_ = 2
	ELSE_IF TOP_EDGE == "SEALED"
		TOP_EDGE_ = 3
	ELSE_IF TOP_EDGE == "SEAMLESS"
		TOP_EDGE_ = 4
	ELSE_IF TOP_EDGE == "POLISHED"
		TOP_EDGE_ = 5
	END_IF	
	
	IF BOTTOM_EDGE == "WELDED"
		MESSAGE_BOX "THE BOTTOM EDGE IS BEING CHANGED FROM WELDED TO SEALED"
		BOTTOM_EDGE = "SEALED"
	END_IF
	
	IF BOTTOM_EDGE == "INVERTED"
		BOTTOM_EDGE_ = 0
	ELSE_IF BOTTOM_EDGE == "FLUSH"
		BOTTOM_EDGE_ = 1 
	ELSE_IF BOTTOM_EDGE == "TACKED"
		BOTTOM_EDGE_ = 2
	ELSE_IF BOTTOM_EDGE == "SEALED"
		BOTTOM_EDGE_ = 3
	ELSE_IF BOTTOM_EDGE == "SEAMLESS"
		BOTTOM_EDGE_ = 4
	ELSE_IF BOTTOM_EDGE == "POLISHED"
		BOTTOM_EDGE_ = 5
	END_IF
	
	! IF TOP_EDGE == "INVERTED"
		! TOP_EDGE_ = 0
	! ELSE_IF TOP_EDGE == "FLUSH"
		! TOP_EDGE_ = 1 
	! ELSE_IF TOP_EDGE == "SEAMLESS"
		! TOP_EDGE_ = 2
	! ELSE_IF TOP_EDGE == "WELDED"
		! TOP_EDGE_ = 3
	! ELSE_IF TOP_EDGE == "TACKED"
		! TOP_EDGE_ = 4
	! END_IF	

	! IF BOTTOM_EDGE == "INVERTED"
		! BOTTOM_EDGE_ = 0
	! ELSE_IF BOTTOM_EDGE == "FLUSH"
		! BOTTOM_EDGE_ = 1 
	! ELSE_IF BOTTOM_EDGE == "SEAMLESS"
		! BOTTOM_EDGE_ = 2
	! ELSE_IF BOTTOM_EDGE == "WELDED"
		! BOTTOM_EDGE_ = 3
	! ELSE_IF BOTTOM_EDGE == "TACKED"
		! BOTTOM_EDGE_ = 4
	! END_IF		
!!!!!!!

	IF UNDERCUT < 0
		INVALIDATE_PARAM UNDERCUT
	END_IF

	IF SUB_TYPE == "P" AND ASTRAGAL == 1
		IF ASTRAGAL_DOOR == "ACTIVE"
			ASTRAGAL_DOOR_ = 0
		ELSE_IF ASTRAGAL_DOOR == "INACTIVE"
			ASTRAGAL_DOOR_ = 1
		END_IF
	END_IF

! CONFIG_ELEM

	IF SUB_TYPE == "P" AND ASTRAGAL == 1
		IF ASTRAGAL_DOOR_ == 0
			ASTRAGAL_DOOR = "ACTIVE"
		ELSE_IF ASTRAGAL_DOOR_ == 1
			ASTRAGAL_DOOR = "INACTIVE"
		END_IF
	END_IF

	IF CORE == 0
			CORE_DESC = "STYRENE"
	ELSE_IF	CORE == 1 
			CORE_DESC = "URETHANE"
	ELSE_IF	CORE == 2
			CORE_DESC = "STEEL STIFFENED"
	ELSE_IF 	CORE == 3
			CORE_DESC = "450 DEGREE"
	ELSE_IF	CORE == 4
			CORE_DESC = "250 DEGREE"
	ELSE_IF 	CORE == 5
			CORE_DESC = "HONEYCOMB"
	ELSE_IF 	CORE == 6
			CORE_DESC = "BULLET"
	ELSE_IF 	CORE == 7
			CORE_DESC = "STEEL STIFF/BULLET"
	ELSE_IF 	CORE == 8
			CORE_DESC = "3 HOUR"
	ELSE_IF 	CORE == 9
			CORE_DESC = "STC 45"
	ELSE
			CORE_DESC = "NOT DEFINED"
	END_IF

END_ASM_DESCR
