BEGIN_GUI_DESCR

	SHOW_PARAM	STRING		LOCK_MANUFACTURER
	SHOW_PARAM	INTEGER		LOCK_TYPE
	SHOW_PARAM	STRING		LOCK_SERIES_MODEL
	SHOW_PARAM	DOUBLE		LOCK_BACKSET
	SHOW_PARAM	STRING		LOCK_UDF
	SHOW_PARAM	STRING		LOCK_INST
	SHOW_PARAM	DOUBLE		LOCK_ARMOR_WIDTH
	SHOW_PARAM	DOUBLE		LOCK_ARMOR_HEIGHT
	SHOW_PARAM	DOUBLE		LOCK_ARMOR_THICKNESS
	SHOW_PARAM	DOUBLE		LOCK_OFFSET

END_GUI_DESCR

BEGIN_TAB_DESCR
BEGIN_TABLE	MANUFACTURER	"MANUFACTURER"
TABLE_OPTION 	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	S_TABLE	LOCK_MANUFACTURER
STRING	SUBTABLE	STRING
! CORBIN	CORBIN	CORBIN RUSSWIN
SARGENT	SARGENT	SARGENT
! SCHLAGE	SCHLAGE	SCHLAGE
GENERIC	GENERIC	GENERIC
END_TABLE

BEGIN_TABLE	SARGENT	"SARGENT"
TABLE_OPTION	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	LOCK_MODEL	LOCK_UDF	LOCK_INST	LOCK_ARMOR_HEIGHT	LOCK_ARMOR_WIDTH	LOCK_ARMOR_THICKNESS	LOCK_OFFSET	LOCK_TRIM	LOCK_BACKSET	LOCK_REINFORCEMENT
STRING	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	DOUBLE	STRING                  DOUBLE	STRING 	 
480	480	cylinder	CYLINDER_AB	2.25	1.125	0.105	0		2.750	CYLINDER_BOX_2750
! ASA-2-3/4-B		cylinder	CYLINDER_ABC	2.25	1.125	0.105	0		2.75	CYLINDER_BOX_2750.PRT
END_TABLE

BEGIN_TABLE	CORBIN	"CORBIN RUSSWIN"
TABLE_OPTION	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	LOCK_MODEL	LOCK_UDF	LOCK_INST	LOCK_ARMOR_HEIGHT	LOCK_ARMOR_WIDTH	LOCK_ARMOR_THICKNESS	LOCK_OFFSET	LOCK_TRIM	S_TABLE
STRING	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	DOUBLE	STRING                  SUBTABLE	 
				! cylinder	CYLINDER_AB	2.25	1.125	0.105	0	NO_VALUE	BACK_SET
				! cylinder	CYLINDER_ABC	2.25	1.125	0.105	0	NO_VALUE	BACK_SET
				! cylinder	CYLINDER_AB	2.25	1.125	0.105	0	NO_VALUE	BACK_SET
				! cylinder	CYLINDER_ABC	2.25	1.125	0.105	0	NO_VALUE	BACK_SET
END_TABLE

BEGIN_TABLE	GENERIC	"GENERIC"
TABLE_OPTION	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	LOCK_MODEL	LOCK_UDF	LOCK_INST	LOCK_ARMOR_HEIGHT	LOCK_ARMOR_WIDTH	LOCK_ARMOR_THICKNESS	LOCK_OFFSET	LOCK_TRIM	LOCK_BACKSET	LOCK_REINFORCEMENT
STRING	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	DOUBLE	STRING                  DOUBLE	STRING 	 
ASA-2-3/4-A	GENERIC	cylinder	CYLINDER_AB	2.25	1.125	0.105	0		2.750	CYLINDER_BOX_2750
! ASA-2-3/4-B		cylinder	CYLINDER_ABC	2.25	1.125	0.105	0		2.75	CYLINDER_BOX_2750.PRT
END_TABLE

BEGIN_TABLE	BACK_SET	"BACKSET"
TABLE_OPTION	DEPEND_ON_INPUT NO_FILTER
SEL_STRING	LOCK_BACKSET	LOCK_REINFORCEMENT
STRING	DOUBLE	STRING
2-3/4	2.750	CYLINDER_BOX_2750
3-3/4	3.750	CYLINDER_BOX_3750
5	5.000	CYLINDER_BOX_5000
2-3/8	2.375	CYLINDER_BOX_2375
OTHER	99
END_TABLE
END_TAB_DESCR

BEGIN_ASM_DESCR

	DECLARE_VARIABLE	INTEGER		OPERATION
	DECLARE_VARIABLE	STRING		ITEM_NUM
	DECLARE_VARIABLE	STRING		SUB_TYPE
	DECLARE_VARIABLE	INTEGER		OPENING_TYPE
	DECLARE_VARIABLE	STRING		DOOR_ITEM_DESC
	DECLARE_VARIABLE	STRING		FRAME_ITEM_DESC

	DECLARE_VARIABLE	INTEGER		LOCK
	DECLARE_VARIABLE	DOUBLE		LOCK_ARMOR_HEIGHT
	DECLARE_VARIABLE	DOUBLE		LOCK_ARMOR_THICKNESS
	DECLARE_VARIABLE	DOUBLE		LOCK_ARMOR_WIDTH
	DECLARE_VARIABLE	DOUBLE		LOCK_BACKSET
	DECLARE_VARIABLE	STRING		LOCK_DESC
	DECLARE_VARIABLE	STRING		LOCK_FUNCTION
	DECLARE_VARIABLE	STRING		LOCK_INST
	DECLARE_VARIABLE	STRING		LOCK_MANUFACTURER
	DECLARE_VARIABLE	DOUBLE		LOCK_OFFSET
	DECLARE_VARIABLE	STRING		LOCK_REINFORCEMENT
	DECLARE_VARIABLE	STRING		LOCK_MODEL
	DECLARE_VARIABLE	STRING		LOCK_TRIM
	DECLARE_VARIABLE	STRING		LOCK_TRIM_INST
	DECLARE_VARIABLE	DOUBLE		LOCK_TRIM_OFFSET
	DECLARE_VARIABLE	STRING		LOCK_TRIM_UDF
	DECLARE_VARIABLE	INTEGER		LOCK_TYPE
	DECLARE_VARIABLE	STRING		LOCK_UDF
	DECLARE_VARIABLE	INTEGER		STRIKE
	DECLARE_VARIABLE	DOUBLE		STRIKE_CENTER

IF OPERATION == 0
	! CONFIG_ELEM
	LOCK_DESC = LOCK_MANUFACTURER + " - " + LOCK_MODEL + " " + LOCK_TRIM + " - DEADBOLT"
END_IF
	
IF OPERATION == 1
	IF	HAND_ == "LHR" OR HAND_ == "LHRA1"
		SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_S2" BODY_ARMOR
			SEARCH_MDL_REF COVER SURFACE "SURFACE_S2" COVER_ARMOR
			BODY_ROTATION = 180
			COVER_ROTATION = 0
		END_IF
		IF STRIKE_EDGE_SHAPE == "BEVEL"
			ARMOR_BEVEL = -4
		ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
			ARMOR_BEVEL = 0
		END_IF
	END_IF
	
	IF	HAND_ == "RH" OR HAND_ == "RHA2"
		SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_S2" BODY_ARMOR
			SEARCH_MDL_REF COVER SURFACE "SURFACE_S2" COVER_ARMOR
			BODY_ROTATION = 180
			COVER_ROTATION = 0
		END_IF
		IF STRIKE_EDGE_SHAPE == "BEVEL"
			ARMOR_BEVEL = -4
		ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
			ARMOR_BEVEL = 0
		END_IF
	END_IF
	
	IF	HAND_ == "RHR" OR HAND_ == "RHRA2"
		SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_S1" BODY_ARMOR
			SEARCH_MDL_REF COVER SURFACE "SURFACE_S1" COVER_ARMOR
			BODY_ROTATION = 0
			COVER_ROTATION = 180
		END_IF
		IF STRIKE_EDGE_SHAPE == "BEVEL"
			ARMOR_BEVEL = 4
		ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
			ARMOR_BEVEL = 0
		END_IF
	END_IF

	IF	HAND_ == "LH" OR HAND_ == "LHA1"
		SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
		IF DOOR_CONSTRUCTION == "SEAMLESS"
			SEARCH_MDL_REF BODY SURFACE "SURFACE_S1" BODY_ARMOR
			SEARCH_MDL_REF COVER SURFACE "SURFACE_S1" COVER_ARMOR
			BODY_ROTATION = 0
			COVER_ROTATION = 180
		END_IF
		IF STRIKE_EDGE_SHAPE == "BEVEL"
			ARMOR_BEVEL = 4
		ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
			ARMOR_BEVEL =  0
		END_IF
	END_IF

	IF WELDED_PREPS == 1
		ARMOR_HEIGHT = LOCK_ARMOR_HEIGHT + .18
		ARMOR_WIDTH = LOCK_ARMOR_WIDTH +.18
		LOCK_REINFORCEMENT = LOCK_INST + ".ASM"
	ELSE
		ARMOR_HEIGHT = LOCK_ARMOR_HEIGHT +.03
		ARMOR_WIDTH = LOCK_ARMOR_WIDTH +.03
		LOCK_REINFORCEMENT = LOCK_REINFORCEMENT + ".PRT"
	END_IF

	IF DOOR_CONSTRUCTION == "SEAMLESS" AND DOOR_THICKNESS - .125 - ARMOR_WIDTH <= .4
			ARMOR_INST = "WITH_TAB"
	ELSE_IF DOOR_CONSTRUCTION == "SEAMLESS" AND DOOR_THICKNESS - .125 - ARMOR_WIDTH > .4
			ARMOR_INST = "NO_TAB"
	END_IF
	
	IF LOCK_ARMOR_WIDTH > DOOR_THICKNESS - 75 AND DOOR_CONSTRUCTION == "LOCKSEAM"
		IF HAND == "LHR" OR HAND == "LHRA"
			ARMOR_INST = "ARMOR_L2"
		ELSE_IF HAND == "RHR" OR HAND == "RHRA"
			ARMOR_INST = "ARMOR_L1"
		ELSE_IF HAND == "LH" OR HAND == "LHA"
			ARMOR_INST = "ARMOR_L1"
		ELSE_IF HAND == "RH" OR HAND == "RHA"
			ARMOR_INST = "ARMOR_L2"
		END_IF
	END_IF
													 
	CREATE_UDF &LOCK_UDF DOOR_ASM
		UDF_INSTANCE LOCK_INST
		UDF_REF ATTACH ATTACH
		UDF_DIM STRIKE_CTR STRIKE_CENTER
		UDF_DIM OFFSET -LOCK_OFFSET
		UDF_DIM BACKSET LOCK_BACKSET
		UDF_INTERSECTION * PART_LEVEL
	END_CREATE_UDF
	
	IF DOOR_CONSTRUCTION == "LOCKSEAM"
		CREATE_UDF udf\armor_plate DOOR_ASM
			UDF_INSTANCE ARMOR_INST
			UDF_REF ATTACH ATTACH
			UDF_DIM STRIKE_CTR STRIKE_CENTER
			UDF_DIM OFFSET -LOCK_OFFSET
			UDF_DIM ARMOR_BEVEL ARMOR_BEVEL
			UDF_DIM ARMOR_WIDTH LOCK_ARMOR_WIDTH
			UDF_DIM ARMOR_HEIGHT LOCK_ARMOR_HEIGHT
			UDF_EXP_REF ATTACH2 CSYS 1
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
	END_IF
	
	IF DOOR_CONSTRUCTION == "SEAMLESS"
		CREATE_UDF udf\face_plate BODY
			UDF_INSTANCE ARMOR_INST
			UDF_REF ATTACH ATTACH
			UDF_REF ARMOR_SURFACE BODY_ARMOR		
			UDF_DIM STRIKE_CTR STRIKE_CENTER
			UDF_DIM OFFSET -LOCK_OFFSET
			UDF_DIM ROTATION BODY_ROTATION
			UDF_DIM BEVEL ARMOR_BEVEL
			UDF_DIM ARMOR_WIDTH ARMOR_WIDTH
			UDF_DIM ARMOR_HEIGHT ARMOR_HEIGHT
			UDF_EXP_REF ATTACH2 CSYS 1
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF

		CREATE_UDF udf\face_plate COVER
			UDF_INSTANCE ARMOR_INST
			UDF_REF ATTACH ATTACH
			UDF_REF ARMOR_SURFACE COVER_ARMOR		
			UDF_DIM STRIKE_CTR STRIKE_CENTER
			UDF_DIM OFFSET -LOCK_OFFSET
			UDF_DIM ROTATION COVER_ROTATION
			UDF_DIM BEVEL ARMOR_BEVEL
			UDF_DIM ARMOR_WIDTH ARMOR_WIDTH
			UDF_DIM ARMOR_HEIGHT ARMOR_HEIGHT
			UDF_EXP_REF ATTACH2 CSYS 1
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
	END_IF
	
	IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
		HAND_ == "RHR2" OR HAND_ == "RHRA2" OR \
		HAND_ == "LH1" OR HAND_ == "LHA1"
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH2
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH2 CSYS 0
			END_CREATE_UDF
	END_IF

	IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
		HAND_ == "LHR1" OR HAND_ == "LHRA1" OR \
		HAND_ == "RH2" OR HAND_ == "RHA2"

			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH2
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH2 CSYS 0
			END_CREATE_UDF
	END_IF

PRINT "%" LOCK_REINFORCEMENT
	RETRIEVE_MDL &LOCK_REINFORCEMENT COMP

	SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE COMP DOOR_ASM
			 CSYS ATTACH2 PLACEMENT
		END_ASSEMBLE
END_IF

END_ASM_DESCR
