BEGIN_ASM_DESCR

	DECLARE_VARIABLE DOUBLE VISION_B_ALLOWANCE
	DECLARE_VARIABLE DOUBLE TRIM_THICKNESS
	DECLARE_VARIABLE DOUBLE VBR
	DECLARE_VARIABLE INTEGER LITE_QTY
	DECLARE_VARIABLE INTEGER LITE_INDEX

	VISION_B_ALLOWANCE = 2.0
	
	IF DOOR_LITE_TRIM_GAUGE == 18
		TRIM_THICKNESS = .050
	ELSE_IF DOOR_LITE_TRIM_GAUGE == 16
		TRIM_THICKNESS = .060
	END_IF

		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
		DECLARE_VARIABLE DOUBLE LOCX
		IF (DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "NL") AND HAND_ == "L*"
			LOCX = (DOOR_WIDTH/2) - VISION_STRIKE_STILE - (VISION_WIDTH/2)
			LITE_QTY = 1
		ELSE_IF (DOOR_ELEVATION == "N" OR DOOR_ELEVATION == "NL") AND HAND_ == "R*"
			LOCX = -(DOOR_WIDTH /2) + VISION_STRIKE_STILE + (VISION_WIDTH/2)
			LITE_QTY = 1
		ELSE_IF DOOR_ELEVATION == "G" OR DOOR_ELEVATION == "GL" OR DOOR_ELEVATION == "V" OR DOOR_ELEVATION == "VL"
			LOCX = 0
			LITE_QTY = 1
		ELSE_IF DOOR_ELEVATION == "2G"
			LOCX = 0
			LITE_QTY = 2
		END_IF
		
	LITE_INDEX = 1

	WHILE LITE_INDEX <= LITE_QTY
		IF LITE_INDEX == 1
			VBR = JOH - VISION_TOP_RAIL - VISION_HEIGHT - TOP_GAP
		ELSE_IF LITE_INDEX == 2
			VBR = VISION_BOTTOM_RAIL
			VISION_HEIGHT = VISION_HEIGHT2
		END_IF
		
		DECLARE_VARIABLE DOUBLE TEMP
		TEMP = VISION_BOTTOM_RAIL + (VISION_HEIGHT/2) + UNDERCUT
		PRINT "%" TEMP
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY VBR + (VISION_HEIGHT/2)
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		CREATE_UDF	udf\opening DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM DEPTH DOOR_THICKNESS + .25
			UDF_DIM WIDTH VISION_WIDTH + VISION_B_ALLOWANCE
			UDF_DIM HEIGHT VISION_HEIGHT + VISION_B_ALLOWANCE
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
		
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 270
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY -(VISION_HEIGHT+VISION_B_ALLOWANCE)/2
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_WIDTH+VISION_B_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (VISION_WIDTH+VISION_B_ALLOWANCE)/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ (VISION_HEIGHT+VISION_B_ALLOWANCE)/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_HEIGHT+VISION_B_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (VISION_HEIGHT+VISION_B_ALLOWANCE)/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ (VISION_WIDTH+VISION_B_ALLOWANCE)/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_WIDTH+VISION_B_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 270
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (VISION_WIDTH+VISION_B_ALLOWANCE)/2
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ (VISION_HEIGHT+VISION_B_ALLOWANCE)/2
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

			RETRIEVE_MDL STRAP.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "d41" VISION_HEIGHT+VISION_B_ALLOWANCE
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		
		DECLARE_VARIABLE DOUBLE POCKET_DEPTH
		DECLARE_VARIABLE DOUBLE FACE_OFFSET
		DECLARE_VARIABLE DOUBLE SCREW_FLANGE

		IF GLASS_THICKNESS >= .75
			POCKET_DEPTH = .5
			FACE_OFFSET = .25
			SCREW_FLANGE = 1.0 - POCKET_DEPTH
		ELSE
			POCKET_DEPTH = .625
			FACE_OFFSET = .125
			SCREW_FLANGE = 1.0 - POCKET_DEPTH
		END_IF

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX LOCX
			UDF_DIM	LOCY VBR + (VISION_HEIGHT/2)
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		
		RETRIEVE_MDL VISION_B.ASM VISION_KIT
		SET_MDL_NAME VISION_KIT "VISION_KIT_"+itos(DOOR_INDEX)+itos(LITE_INDEX)+"_"+SO_NUM+"_"+ ITEM_NUM
		
		SEARCH_MDL_REF VISION_KIT CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE VISION_KIT DOOR_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			
			SET_MDL_PARAM VISION_KIT "STOCKTYPE" 0
			SET_MDL_PARAM VISION_KIT "EMJACNUM" "999"
			SET_MDL_PARAM VISION_KIT "VISION_WIDTH" VISION_WIDTH
			SET_MDL_PARAM VISION_KIT "VISION_HEIGHT" VISION_HEIGHT
			SET_MDL_PARAM VISION_KIT "DOOR_THICK" DOOR_THICKNESS
			REGEN_MDL VISION_KIT
			
		SEARCH_MDL_REF VISION_KIT CSYS "ACS0" ATTACH
			RETRIEVE_MDL VISION_OS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 1
				SET_MDL_PARAM COMP "LENGTH" VISION_HEIGHT
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH
				SET_MDL_PARAM COMP "SCREW_FLANGE" SCREW_FLANGE

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		SEARCH_MDL_REF VISION_KIT CSYS "ACS2" ATTACH
			RETRIEVE_MDL VISION_OS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 1
				SET_MDL_PARAM COMP "LENGTH" VISION_HEIGHT
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH
				SET_MDL_PARAM COMP "SCREW_FLANGE" SCREW_FLANGE

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		SEARCH_MDL_REF VISION_KIT CSYS "ACS1" ATTACH
			RETRIEVE_MDL VISION_OS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 2
				SET_MDL_PARAM COMP "LENGTH" VISION_WIDTH
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH
				SET_MDL_PARAM COMP "SCREW_FLANGE" SCREW_FLANGE

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		SEARCH_MDL_REF VISION_KIT CSYS "ACS3" ATTACH
			RETRIEVE_MDL VISION_OS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 2
				SET_MDL_PARAM COMP "LENGTH" VISION_WIDTH
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH
				SET_MDL_PARAM COMP "SCREW_FLANGE" SCREW_FLANGE

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		SEARCH_MDL_REF VISION_KIT CSYS "ACS0" ATTACH
			RETRIEVE_MDL VISION_IS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 1
				SET_MDL_PARAM COMP "LENGTH" VISION_HEIGHT
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		SEARCH_MDL_REF VISION_KIT CSYS "ACS2" ATTACH
			RETRIEVE_MDL VISION_IS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 1
				SET_MDL_PARAM COMP "LENGTH" VISION_HEIGHT
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		SEARCH_MDL_REF VISION_KIT CSYS "ACS1" ATTACH
			RETRIEVE_MDL VISION_IS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 2
				SET_MDL_PARAM COMP "LENGTH" VISION_WIDTH
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
				
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		SEARCH_MDL_REF VISION_KIT CSYS "ACS3" ATTACH
			RETRIEVE_MDL VISION_IS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" ""
				SET_MDL_PARAM COMP "GRAIN" 2
				SET_MDL_PARAM COMP "LENGTH" VISION_WIDTH
				SET_MDL_PARAM COMP "GLASS_THICK" GLASS_THICKNESS
				SET_MDL_PARAM COMP "FACE_OFFSET" FACE_OFFSET
				SET_MDL_PARAM COMP "POCKET_DEPTH" POCKET_DEPTH
				SET_MDL_PARAM COMP "HMAX_CTR" 10.0
				SET_MDL_PARAM COMP "DOOR_THICK" DOOR_THICKNESS
				SET_MDL_PARAM COMP "GLAZING_SPACE" .125
				SET_MDL_PARAM COMP "HOLE_OFFSET" 1.0
				SET_MDL_PARAM COMP "SMT_THICKNESS" TRIM_THICKNESS
				SET_MDL_PARAM COMP "GRADE" DOOR_GRADE
				SET_MDL_PARAM COMP "FINISH" BODY_SIDE_FINISH

			IF FIRE_RATING > 0 OR VISION_CONSTRUCTION_B == "WELDED"
				SET_MDL_PARAM COMP "FIXED_TABS" "YES"
			ELSE
				SET_MDL_PARAM COMP "FIXED_TABS" "NO"
			END_IF
										
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

		IF GLASS_SUPPLIER == "SDI"
			SEARCH_MDL_REF VISION_KIT CSYS "PLACEMENT" ATTACH
			RETRIEVE_MDL GLASS.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP DOOR_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 3
				SET_MDL_PARAM COMP "EMJACNUM" "9"
				SET_MDL_PARAM COMP "LENGTH" VISION_HEIGHT+.75
				SET_MDL_PARAM COMP "WIDTH" VISION_WIDTH+.75
				SET_MDL_PARAM COMP "THICKNESS" GLASS_THICKNESS
				
				CALC_FRACTION REDUCE TRUE VISION_HEIGHT+.75 16 Lfraction
				CALC_FRACTION REDUCE TRUE VISION_WIDTH+.75 16 Wfraction
				CALC_FRACTION REDUCE TRUE GLASS_THICKNESS 16 Tfraction

				IF Tfraction.integer <> 0
					SET_MDL_PARAM COMP "EMJACDESC" GLASS_TYPE + ", " + Lfraction.fraction_string + " x " + Wfraction.fraction_string + " x " + Tfraction.fraction_string + " THICK "
					SET_MDL_PARAM COMP "DESC" GLASS_TYPE + ", " + Lfraction.fraction_string + " x " + Wfraction.fraction_string + " x " + Tfraction.fraction_string + " THICK "
				ELSE
					SET_MDL_PARAM COMP "EMJACDESC" GLASS_TYPE + ", " + Lfraction.fraction_string + " x " + Wfraction.fraction_string + " x " + itos(Tfraction.remainder)+"/"+itos(Tfraction.denominator) + " THICK "
					SET_MDL_PARAM COMP "DESC" GLASS_TYPE + ", " + Lfraction.fraction_string + " x " + Wfraction.fraction_string + " x " + itos(Tfraction.remainder)+"/"+itos(Tfraction.denominator) + " THICK "
				END_IF
				
				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		END_IF
		
		LITE_INDEX++
	END_WHILE
	
	IF CHOICE == 5
		RETRIEVE_MDL vision_os.drw DRAW
		SAVE_MDL DRAW
		
		RETRIEVE_MDL vision_is.drw DRAW
		SAVE_MDL DRAW
	END_IF
END_ASM_DESCR
