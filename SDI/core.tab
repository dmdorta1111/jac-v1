
BEGIN_ASM_DESCR
	! 	CORE
	! 0 	"STYRENE" 
	! 1 	"URETHANE" 
	! 2 	"STEEL STIFFENED" 
	! 3 	"450 TEMPERATURE RISE" 
	! 4 	"250 TEMPERATURE RISE"
	! 5 	"HONECOMB"
	! 6 	"BULLET" 
	! 7 	"STEEL STIFF/BULLET" 
	!8	"3 HOUR"
	!9	"STC 45"
	
	! 	CLOSER_TYPE 
	!0 	"NONE"
	!1 	"SURFACE"
	!2  	"CONCEALED"
	!3	"SURFACE HOLDER/STOP"
	
	! 	STEEL_STIFFENER_INSULATION 
	!0	"STYRENE"
	!1	"URETHANE"
	!2	"MINERAL WOOL"
	!3	"FIBERGLASS"
	!4	"BULLET"

	
DECLARE_VARIABLE DOUBLE LEAD_ALLOWANCE

	IF LEAD_LINED == 0
		LEAD_ALLOWANCE = 0
	ELSE_IF LEAD_LINED == 1
		LEAD_ALLOWANCE = .0625
	ELSE_IF LEAD_LINED == 2
		LEAD_ALLOWANCE = .125
	ELSE_IF LEAD_LINED == 3
		LEAD_ALLOWANCE = .25
	END_IF
	
	IF CORE <> 2 AND CORE <> 7 AND CORE <> 8 AND CORE <> 9
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + CORE_CLEARANCE
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		INVALIDATE_REF COMP
		RETRIEVE_MDL CORE.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
		
			ASSEMBLE COMP DOOR_ASM
				CSYS ATTACH PLACE
			END_ASSEMBLE
			
			SET_MDL_PARAM COMP "d18" DOOR_WIDTH - (CORE_EDGE_SPACE*2)
			SET_MDL_PARAM COMP "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
			
			IF CLOSER_TYPE == 1 OR HOLDER_STOP_TYPE == 1 OR MAG_LOCK == 1
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2) - SURFACE_CLOSER_WIDTH
			ELSE
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2)
			END_IF
			
			IF CORE == 0
				SET_MDL_PARAM COMP "TYPE" "STY"
			ELSE_IF CORE == 1
				SET_MDL_PARAM COMP "TYPE" "URE"
			ELSE_IF CORE == 3
				SET_MDL_PARAM COMP "TYPE" "450"
			ELSE_IF CORE == 4
				SET_MDL_PARAM COMP "TYPE" "250"
			ELSE_IF CORE == 5
				SET_MDL_PARAM COMP "TYPE" "HCOMB"
			END_IF
			
			CALL_EX instantiate.tab
				VAR_INOUT	COMP	COMP
			END_CALL_EX
			INVALIDATE_REF COMP
	END_IF

	IF CORE == 2 OR CORE == 9
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
		DECLARE_VARIABLE DOUBLE PNTX
		DECLARE_VARIABLE DOUBLE PNTY_BOTTOM
		DECLARE_VARIABLE DOUBLE PNTY_TOP
		DECLARE_VARIABLE DOUBLE PNTY
		DECLARE_VARIABLE DOUBLE PNTZ 0
		DECLARE_VARIABLE DOUBLE TEST
		DECLARE_VARIABLE INTEGER QTY
		DECLARE_VARIABLE INTEGER PNT_INDEX
		DECLARE_VARIABLE DOUBLE CHANNEL_LENGTH
		DECLARE_VARIABLE DOUBLE CHANNEL_LENGTH_1
		DECLARE_VARIABLE DOUBLE CHANNEL_LENGTH_2
		DECLARE_VARIABLE DOUBLE DIST_UP
		DECLARE_VARIABLE DOUBLE DIST_UP_1
		DECLARE_VARIABLE DOUBLE DIST_UP_2
		DECLARE_VARIABLE DOUBLE DIST_DN
		DECLARE_VARIABLE DOUBLE DIST_DN_1
		DECLARE_VARIABLE DOUBLE DIST_DN_2
		DECLARE_VARIABLE INTEGER CHANNEL_QTY
		DECLARE_VARIABLE DOUBLE CHANNEL_SPACING
		DECLARE_VARIABLE DOUBLE STIFFENER_THICKNESS .03

		CHANNEL_QTY = ceil((DOOR_WIDTH - CORE_EDGE_SPACE - CORE_EDGE_SPACE - STEEL_STIFFENER_WIDTH) / MAXIMUM_STIFFENER_CTR)+ 1
		CHANNEL_SPACING = (DOOR_WIDTH - CORE_EDGE_SPACE - CORE_EDGE_SPACE - (CHANNEL_QTY*STEEL_STIFFENER_WIDTH))/ (CHANNEL_QTY- 1)

		DECLARE_ARRAY arrayIntersections
		DECLARE_STRUCT POINT pnt
		DECLARE_STRUCT VECTOR vec
		PNTY_BOTTOM = UNDERCUT + BOTTOM_CHANNEL_DEPTH + .5
		! PNTY_TOP = JOH - TOP_GAP - TOP_CHANNEL_DEPTH - SURFACE_CLOSER_WIDTH - .25
		PNTY_TOP = JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .5

		PNT_INDEX = 1
		PNTX = -((DOOR_WIDTH - CORE_EDGE_SPACE - CORE_EDGE_SPACE)/2)

		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH
		
			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX PNTX - (CORE_EDGE_SPACE/4) - .03125
				UDF_DIM	LOCY PNTY_BOTTOM
				UDF_DIM	LOCZ 0
				UDF_EXP_REF COREA CSYS 0
			END_CREATE_UDF

				INVALIDATE_REF COMP
				RETRIEVE_MDL CORE.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
				
					ASSEMBLE COMP DOOR_ASM
						CSYS COREA PLACE
					END_ASSEMBLE
					
					SET_MDL_PARAM COMP  "d19" PNTY_TOP - PNTY_BOTTOM - .25
					SET_MDL_PARAM COMP  "d18" CORE_EDGE_SPACE/2
					SET_MDL_PARAM COMP  "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
					
					IF STEEL_STIFFENER_INSULATION == 0
						SET_MDL_PARAM COMP  "TYPE" "STY"
					ELSE_IF STEEL_STIFFENER_INSULATION == 1
						SET_MDL_PARAM COMP  "TYPE" "URE"
					ELSE_IF STEEL_STIFFENER_INSULATION == 2
						SET_MDL_PARAM COMP  "TYPE" "MINERAL WOOL"
					ELSE_IF STEEL_STIFFENER_INSULATION == 3
						SET_MDL_PARAM COMP  "TYPE" "FBRGL"
					END_IF
					
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

			CREATE_UDF udf\csys DOOR_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(PNTX - (CORE_EDGE_SPACE/4)) + .03125
				UDF_DIM	LOCY PNTY_BOTTOM
				UDF_DIM	LOCZ 0
				UDF_EXP_REF COREA CSYS 0
			END_CREATE_UDF

				INVALIDATE_REF COMP
				RETRIEVE_MDL CORE.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
				
					ASSEMBLE COMP DOOR_ASM
						CSYS COREA PLACE
					END_ASSEMBLE
					
					SET_MDL_PARAM COMP  "d19" PNTY_TOP - PNTY_BOTTOM - .25
					SET_MDL_PARAM COMP  "d18" CORE_EDGE_SPACE/2
					SET_MDL_PARAM COMP  "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
					
					IF STEEL_STIFFENER_INSULATION == 0
						SET_MDL_PARAM COMP  "TYPE" "STY"
					ELSE_IF STEEL_STIFFENER_INSULATION == 1
						SET_MDL_PARAM COMP  "TYPE" "URE"
					ELSE_IF STEEL_STIFFENER_INSULATION == 2
						SET_MDL_PARAM COMP  "TYPE" "MINERAL WOOL"
					ELSE_IF STEEL_STIFFENER_INSULATION == 3
						SET_MDL_PARAM COMP  "TYPE" "FBRGL"
					END_IF
			
				ASSEMBLE COMP DOOR_ASM
					CSYS COREA PLACE
				END_ASSEMBLE

				CALL_EX instantiate.tab	
					VAR_IN	COMP	COMP
				END_CALL_EX
				
		WHILE PNT_INDEX <= CHANNEL_QTY
		
			PNTY_TOP = JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .5
		
			pnt.x = PNTX
			pnt.y = PNTY_BOTTOM
			pnt.z = 0
			vec.x = 0
			vec.y = 10
			vec.z = 0
			CLEAR_ARRAY arrayIntersections
			CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
			GET_ARRAY_ELEM arrayIntersections 0 VALUE
			DIST_UP_1 = VALUE.pnt_in.y - pnt.y

			pnt.x = PNTX
			pnt.y = PNTY_TOP
			pnt.z = 0
			vec.x = 0
			vec.y = -10
			vec.z = 0
			CLEAR_ARRAY arrayIntersections
			CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
			GET_ARRAY_ELEM arrayIntersections 0 VALUE
			DIST_DN_1 = -(VALUE.pnt_in.y - pnt.y)

			PNTX = PNTX + STEEL_STIFFENER_WIDTH
			pnt.x = PNTX
			pnt.y = PNTY_BOTTOM
			pnt.z = 0
			vec.x = 0
			vec.y = 10
			vec.z = 0
			CLEAR_ARRAY arrayIntersections
			CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
			GET_ARRAY_ELEM arrayIntersections 0 VALUE
			DIST_UP_2 = VALUE.pnt_in.y - pnt.y

			pnt.x = PNTX
			pnt.y = PNTY_TOP
			pnt.z = 0
			vec.x = 0
			vec.y = -10
			vec.z = 0
			CLEAR_ARRAY arrayIntersections
			CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
			GET_ARRAY_ELEM arrayIntersections 0 VALUE
			DIST_DN_2 = -(VALUE.pnt_in.y - pnt.y)

			IF DIST_DN_1 < SURFACE_CLOSER_WIDTH OR DIST_DN_2 < SURFACE_CLOSER_WIDTH
				PNTY_TOP = JOH - TOP_GAP - TOP_CHANNEL_DEPTH - .5 - SURFACE_CLOSER_WIDTH

				PNTX = PNTX - STEEL_STIFFENER_WIDTH
				pnt.x = PNTX
				pnt.y = PNTY_TOP
				pnt.z = 0
				vec.x = 0
				vec.y = -10
				vec.z = 0
				CLEAR_ARRAY arrayIntersections
				CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
				GET_ARRAY_ELEM arrayIntersections 0 VALUE
				DIST_DN_1 = -(VALUE.pnt_in.y - pnt.y)
				
				PNTX = PNTX + STEEL_STIFFENER_WIDTH
				pnt.x = PNTX
				pnt.y = PNTY_TOP
				pnt.z = 0
				vec.x = 0
				vec.y = -10
				vec.z = 0
				CLEAR_ARRAY arrayIntersections
				CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
				GET_ARRAY_ELEM arrayIntersections 0 VALUE
				DIST_DN_2 = -(VALUE.pnt_in.y - pnt.y)
				
			END_IF
			
			IF DIST_UP_1 <= DIST_UP_2
				DIST_UP = DIST_UP_1
			ELSE
				DIST_UP = DIST_UP_2
			END_IF

			IF DIST_UP >= PNTY_TOP - PNTY_BOTTOM
				CHANNEL_LENGTH_1 = PNTY_TOP - PNTY_BOTTOM - .25
				CHANNEL_LENGTH_2 = 1
			ELSE
				IF DIST_UP >= MAXIMUM_STIFFENER_CTR ! * 2
					CHANNEL_LENGTH_1 = DIST_UP - CORE_CLEARANCE
				ELSE
					CHANNEL_LENGTH_1 = 1
				END_IF				

				IF DIST_DN_1 <= DIST_DN_2
					DIST_DN = DIST_DN_1
				ELSE
					DIST_DN = DIST_DN_2
				END_IF
				
				pnt.x = PNTX - STEEL_STIFFENER_WIDTH
				pnt.y = PNTY_TOP
				pnt.z = 0
				vec.x = 0
				vec.y = 10
				vec.z = 0
				CLEAR_ARRAY arrayIntersections
				CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
				GET_ARRAY_ELEM arrayIntersections 0 VALUE
				DIST_UP_1 = VALUE.pnt_in.y - pnt.y

				pnt.x = PNTX
				pnt.y = PNTY_TOP
				pnt.z = 0
				vec.x = 0
				vec.y = 10
				vec.z = 0
				CLEAR_ARRAY arrayIntersections
				CALC_RAY_INTERSECTION DOOR_ASM EXTREMUM POSITIVE pnt vec arrayIntersections
				GET_ARRAY_ELEM arrayIntersections 0 VALUE
				DIST_UP_2 = VALUE.pnt_in.y - pnt.y

				IF DIST_UP_1 <= DIST_UP_2
					DIST_UP = DIST_UP_1
				ELSE
					DIST_UP = DIST_UP_2
				END_IF
					CHANNEL_LENGTH_2 = DIST_DN - CORE_CLEARANCE -.5
			END_IF

			IF CHANNEL_LENGTH_1 > 1
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX pnt.x - (STEEL_STIFFENER_WIDTH/2)
					UDF_DIM	LOCY PNTY_BOTTOM
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				
				INVALIDATE_REF COMP
				RETRIEVE_MDL DOOR_STIFF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
					SET_MDL_PARAM COMP "d41" CHANNEL_LENGTH_1
					SET_MDL_PARAM COMP "d40" STEEL_STIFFENER_WIDTH
					SET_MDL_PARAM COMP "d45" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
					
					IF STEEL_STIFFENER_MATERIAL == 0
						SET_MDL_PARAM COMP "TYPE" "SS"
						SET_MDL_PARAM COMP "GRADE" "304"
						SET_MDL_PARAM COMP "FINISH" "X"
					ELSE_IF STEEL_STIFFENER_MATERIAL == 1
						SET_MDL_PARAM COMP "TYPE" "GALV"
						SET_MDL_PARAM COMP "GRADE" ""
						SET_MDL_PARAM COMP "FINISH" ""
					END_IF
					
					SET_MDL_PARAM COMP "SMT_THICKNESS" STIFFENER_THICKNESS
				
					IF CHANNEL_LENGTH_1 > 40 AND (PRIMARY_LOCK_ELECTRIFIED == 1 OR PRIMARY_STRIKE_ELECTRIFIED == 1)
						SET_MDL_PARAM COMP "HOLE" 1
						SET_MDL_PARAM COMP "COMMENTS" "SHEAR AND PUNCH"
						SET_MDL_PARAM COMP "d86" PRIMARY_STRIKE_CENTER - PNTY_BOTTOM - 6
						SET_MDL_PARAM COMP "EMJACDESC" "STIFF_ELEC_"+ftos(CHANNEL_LENGTH_1)
					ELSE
						SET_MDL_PARAM COMP "HOLE" 0
						SET_MDL_PARAM COMP "COMMENTS" "SHEAR"
					END_IF
				
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
				
				IF PNT_INDEX < CHANNEL_QTY									
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX (STEEL_STIFFENER_WIDTH+CHANNEL_SPACING)/2
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					INVALIDATE_REF COMP
					RETRIEVE_MDL CORE.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
					
						ASSEMBLE COMP DOOR_ASM
							CSYS ATTACH PLACE
						END_ASSEMBLE
						
						SET_MDL_PARAM COMP  "d19" CHANNEL_LENGTH_1
						SET_MDL_PARAM COMP  "d18" CHANNEL_SPACING -.0625
						SET_MDL_PARAM COMP  "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
						
						IF STEEL_STIFFENER_INSULATION == 0
							SET_MDL_PARAM COMP  "TYPE" "STY"
						ELSE_IF STEEL_STIFFENER_INSULATION == 1
							SET_MDL_PARAM COMP  "TYPE" "URE"
						ELSE_IF STEEL_STIFFENER_INSULATION == 2
							SET_MDL_PARAM COMP  "TYPE" "MINERAL WOOL"
						ELSE_IF STEEL_STIFFENER_INSULATION == 3
							SET_MDL_PARAM COMP  "TYPE" "FBRGL"
						END_IF
						
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
				END_IF
			END_IF

			IF CHANNEL_LENGTH_2 >= 14
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX pnt.x - (STEEL_STIFFENER_WIDTH/2)
					UDF_DIM	LOCY PNTY_TOP - .25
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				
				INVALIDATE_REF COMP
				RETRIEVE_MDL DOOR_STIFF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				
					SET_MDL_PARAM COMP "d41" CHANNEL_LENGTH_2
					SET_MDL_PARAM COMP "d40" STEEL_STIFFENER_WIDTH
					SET_MDL_PARAM COMP "d45" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
					
					IF STEEL_STIFFENER_MATERIAL == 0
						SET_MDL_PARAM COMP "TYPE" "SS"
						SET_MDL_PARAM COMP "GRADE" "304"
						SET_MDL_PARAM COMP "FINISH" "X"
					ELSE_IF STEEL_STIFFENER_MATERIAL == 1
						SET_MDL_PARAM COMP "TYPE" "GALV"
						SET_MDL_PARAM COMP "GRADE" ""
						SET_MDL_PARAM COMP "FINISH" ""
					END_IF
					
					SET_MDL_PARAM COMP "SMT_THICKNESS" STIFFENER_THICKNESS
				
					IF CHANNEL_LENGTH_1 > 40 AND (PRIMARY_LOCK_ELECTRIFIED == 1 OR (SUB_TYPE == "P" AND PRIMARY_STRIKE_ELECTRIFIED == 1))
						SET_MDL_PARAM COMP "HOLE" 1
						SET_MDL_PARAM COMP "COMMENTS" "SHEAR AND PUNCH"
						SET_MDL_PARAM COMP "d86" PRIMARY_STRIKE_CENTER - PNTY_BOTTOM - 6
						SET_MDL_PARAM COMP "EMJACDESC" "STIFF_ELEC_"+ftos(CHANNEL_LENGTH_1)
					ELSE
						SET_MDL_PARAM COMP "HOLE" 0
						SET_MDL_PARAM COMP "COMMENTS" "SHEAR"
					END_IF
				
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
				
				IF PNT_INDEX < CHANNEL_QTY
					CREATE_UDF udf\csys DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX - (STEEL_STIFFENER_WIDTH+CHANNEL_SPACING)/2
						UDF_DIM	LOCY 0
						UDF_DIM	LOCZ 0
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					INVALIDATE_REF COMP
					RETRIEVE_MDL CORE.PRT COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
					
						ASSEMBLE COMP DOOR_ASM
							CSYS ATTACH PLACE
						END_ASSEMBLE
						
						SET_MDL_PARAM COMP  "d19" CHANNEL_LENGTH_2
						SET_MDL_PARAM COMP  "d18" CHANNEL_SPACING - .03125
						SET_MDL_PARAM COMP  "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
						
						IF STEEL_STIFFENER_INSULATION == 0
							SET_MDL_PARAM COMP  "TYPE" "STY"
						ELSE_IF STEEL_STIFFENER_INSULATION == 1
							SET_MDL_PARAM COMP  "TYPE" "URE"
						ELSE_IF STEEL_STIFFENER_INSULATION == 2
							SET_MDL_PARAM COMP  "TYPE" "MINERAL WOOL"
						ELSE_IF STEEL_STIFFENER_INSULATION == 3
							SET_MDL_PARAM COMP  "TYPE" "FBRGL"
						END_IF
						
						CALL_EX instantiate.tab
							VAR_IN	COMP	COMP
						END_CALL_EX
				END_IF				
			END_IF
			PNTX = PNTX + CHANNEL_SPACING
			PNT_INDEX++
		END_WHILE
	END_IF

	IF CORE == 8
		SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ASM_CSYS
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + CORE_CLEARANCE
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
				
		INVALIDATE_REF COMP
		RETRIEVE_MDL CORE.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
		
			ASSEMBLE COMP DOOR_ASM
				CSYS ATTACH PLACE
			END_ASSEMBLE
			
			SET_MDL_PARAM COMP "d18" DOOR_WIDTH - 12
			SET_MDL_PARAM COMP "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
			
			IF CLOSER_TYPE == 1 OR HOLDER_STOP_TYPE == 1 OR MAG_LOCK == 1
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2) - SURFACE_CLOSER_WIDTH
			ELSE
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2)
			END_IF
			
			SET_MDL_PARAM COMP "TYPE" "HCOMB"
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			INVALIDATE_REF COMP
	

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX ((DOOR_WIDTH - 12)/2) + 3
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH1 CSYS 0
		END_CREATE_UDF
				
		RETRIEVE_MDL CORE.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
		
			ASSEMBLE COMP DOOR_ASM
				CSYS ATTACH1 PLACE
			END_ASSEMBLE
			
			SET_MDL_PARAM COMP "d18" 6
			SET_MDL_PARAM COMP "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
			
			IF CLOSER_TYPE == 1 OR HOLDER_STOP_TYPE == 1 OR MAG_LOCK == 1
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2) - SURFACE_CLOSER_WIDTH
			ELSE
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2)
			END_IF
			
			SET_MDL_PARAM COMP  "TYPE" "FBRGL"
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			INVALIDATE_REF COMP

		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -((DOOR_WIDTH - 12)/2) - 3
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH1 CSYS 0
		END_CREATE_UDF
				
		RETRIEVE_MDL CORE.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACE
		
			ASSEMBLE COMP DOOR_ASM
				CSYS ATTACH1 PLACE
			END_ASSEMBLE
			
			SET_MDL_PARAM COMP "d18" 6
			SET_MDL_PARAM COMP "THICKNESS" DOOR_THICKNESS - .125 - LEAD_ALLOWANCE
			
			IF CLOSER_TYPE == 1 OR HOLDER_STOP_TYPE == 1 OR MAG_LOCK == 1
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2) - SURFACE_CLOSER_WIDTH
			ELSE
				SET_MDL_PARAM COMP "d19" JOH-TOP_GAP-TOP_CHANNEL_DEPTH-UNDERCUT-BOTTOM_CHANNEL_DEPTH-(CORE_CLEARANCE*2)
			END_IF
			
			SET_MDL_PARAM COMP  "TYPE" "FBRGL"
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			INVALIDATE_REF COMP	
	END_IF
	
END_ASM_DESCR

