BEGIN_GUI_DESCR

SHOW_PARAM STRING MANUFACTURER
SHOW_PARAM STRING LOCK_TYPE
SHOW_PARAM STRING LOCK_MODEL
SHOW_PARAM DOUBLE BACKSET
SHOW_PARAM STRING LOCK_UDF
SHOW_PARAM STRING LOCK_INST
SHOW_PARAM DOUBLE ARMOR_WIDTH
SHOW_PARAM DOUBLE ARMOR_HEIGHT
SHOW_PARAM DOUBLE OFFSET

END_GUI_DESCR

BEGIN_TAB_DESCR

BEGIN_TABLE	MFG	"DEVICE"
TABLE_OPTION	NO_FILTER
SEL_STRING	LOCK_TYPE	S_TABLE	
STRING	STRING	SUBTABLE	
CYLINDER LOCK	CYLINDER_LOCK	CL	
CYLINDER DEADBOLT	CYLINDER_DEADBOLT	DB	
MORTISE LOCK	MORTISE_LOCK	ML	
MORTISE DEADBOLT	MORTISE_DEADBOLT	MDB	
RIM EXITT	RIM_EXIT	RIM	
MORTISE EXITT	MORTISE_EXIT	ME	
HOSPITAL LATCH	HOSPITAL_LATCH	HL	
END_TABLE
BEGIN_TABLE	CL	"CYLINDER LOCKS"
TABLE_OPTION NO_FILTER
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
CL3100	BACK_SET	CYLINDER LOCK	cylinder	CYLINDER_AB	2.25	1.125	0	CL3100
CL3300	BACK_SET	CYLINDER LOCK	cylinder	CYLINDER_ABC	2.25	1.125	0	CL3300
CL3700	BACK_SET	CYLINDER LOCK	cylinder	CYLINDER_AB	2.25	1.125	0	CL3700
CL3800	BACK_SET	CYLINDER LOCK	cylinder	CYLINDER_ABC	2.25	1.125	0	CL3800
END_TABLE
BEGIN_TABLE	DB	"DEADBOLTS"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
END_TABLE
BEGIN_TABLE	ML	"MORTISE LOCKS"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
END_TABLE
BEGIN_TABLE	MDB	"MORTISE DEADBOLTS"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
END_TABLE
BEGIN_TABLE	RIM	"RIM EXITS"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
END_TABLE
BEGIN_TABLE	ME	"MORTISE EXITS"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
END_TABLE
BEGIN_TABLE	HL	"HOSPITAL LATCHES"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT
SEL_STRING	S_TABLE	LOCK_TYPE	LOCK_UDF	LOCK_INST	ARMOR_HEIGHT	ARMOR_WIDTH	OFFSET	LOCK_MODEL	LOCK_DESC
STRING	SUBTABLE	STRING	STRING	STRING	DOUBLE	DOUBLE	DOUBLE	STRING	STRING
END_TABLE

BEGIN_TABLE	BACK_SET	"BACK SET DIMENSION"
TABLE_OPTION NO_FILTER DEPEND_ON_INPUT INVALIDATE_ON_UNSELECT
SEL_STRING	BACKSET
STRING	DOUBLE
2-3/4	2.75
3-3/4	3.75
5	5
2-3/8	2.375
OTHER	99
END_TABLE


END_TAB_DESCR

BEGIN_ASM_DESCR


DECLARE_VARIABLE STRING SUB_TYPE
DECLARE_VARIABLE STRING DOOR_CONSTRUCTION
DECLARE_VARIABLE STRING HAND

DECLARE_VARIABLE STRING LOCK_TYPE
DECLARE_VARIABLE STRING LOCK_MODEL
DECLARE_VARIABLE STRING LOCK_DESC
DECLARE_VARIABLE STRING LOCK_UDF
DECLARE_VARIABLE STRING LOCK_INST
DECLARE_VARIABLE DOUBLE ARMOR_HEIGHT
DECLARE_VARIABLE DOUBLE ARMOR_WIDTH
DECLARE_VARIABLE DOUBLE ARMOR_THICKNESS
DECLARE_VARIABLE DOUBLE BACKSET
DECLARE_VARIABLE STRING STRIKE_MODEL
DECLARE_VARIABLE INTEGER ID_ROW


ID_ROW = size

IF LOCK_INDEX == 1
 STRIKE_MODEL = PRIMARY_STRIKE_MODEL
 LOCK_TYPE = PRIMARY_LOCK_TYPE
 LOCK_MODEL = PRIMARY_LOCK_SERIES_MODEL
 BACKSET = PRIMARY_LOCK_BACKSET
ELSE_IF LOCK_INDEX == 2
 STRIKE_MODEL = SECONDARY_STRIKE_MODEL
 LOCK_TYPE = SECONDARY_LOCK_TYPE
 LOCK_MODEL = SECONDARY_LOCK_SERIES_MODEL
 BACKSET = SECONDARY_LOCK_BACKSET
 END_IF


CONFIG_ELEM

IF LOCK_TYPE == "*EXIT*"
	LOCK_DESC = LOCK_MODEL+TRIM
END_IF

	
IF LOCK_INDEX == 1
	IF STRIKE_DESC == "NONE"
		STRIKE_MODEL = "NONE"
		STRIKE_UDF = "NONE"
		STRIKE_UDF = "NONE"
		PRIMARY_STRIKE = "NONE"
		STRIKE_DESC = "NONE"
	END_IF

	EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
	EXCEL_SET_VALUE CELL_BY_INDEX 107 EXCEL_COLUMN  MANUFACTURER	
	EXCEL_SET_VALUE CELL_BY_INDEX 106 EXCEL_COLUMN  LOCK_TYPE
	EXCEL_SET_VALUE CELL_BY_INDEX 108 EXCEL_COLUMN  LOCK_MODEL
	EXCEL_SET_VALUE CELL_BY_INDEX 109 EXCEL_COLUMN  LOCK_FUNCTION
	EXCEL_SET_VALUE CELL_BY_INDEX 110 EXCEL_COLUMN  BACKSET
	EXCEL_SET_VALUE CELL_BY_INDEX 111 EXCEL_COLUMN  OFFSET
	EXCEL_SET_VALUE CELL_BY_INDEX 112 EXCEL_COLUMN  TRIM 
	EXCEL_SET_VALUE CELL_BY_INDEX 113 EXCEL_COLUMN  LOCK_UDF
	EXCEL_SET_VALUE CELL_BY_INDEX 114 EXCEL_COLUMN  LOCK_INST
	EXCEL_SET_VALUE CELL_BY_INDEX 115 EXCEL_COLUMN  ARMOR_HEIGHT
	EXCEL_SET_VALUE CELL_BY_INDEX 116 EXCEL_COLUMN  ARMOR_WIDTH
	EXCEL_SET_VALUE CELL_BY_INDEX 183  EXCEL_COLUMN BACKSET
	EXCEL_SET_VALUE CELL_BY_INDEX 214  EXCEL_COLUMN LOCK_DESC	
	EXCEL_SET_VALUE CELL_BY_INDEX 192  EXCEL_COLUMN SURFACE_VERTICAL_RODS
	EXCEL_SET_VALUE CELL_BY_INDEX 193  EXCEL_COLUMN CONCEALED_VERTICAL_RODS	
	
	! EXCEL_SET_VALUE CELL_BY_INDEX 32  EXCEL_COLUMN PRIMARY_STRIKE_CENTER
	! EXCEL_SET_VALUE CELL_BY_INDEX 33  EXCEL_COLUMN PRIMARY_STRIKE
	! EXCEL_SET_VALUE CELL_BY_INDEX 34  EXCEL_COLUMN STRIKE_UDF
	! EXCEL_SET_VALUE CELL_BY_INDEX 164  EXCEL_COLUMN STRIKE_MODEL
	! EXCEL_SET_VALUE CELL_BY_INDEX 165  EXCEL_COLUMN STRIKE_HEIGHT
	! EXCEL_SET_VALUE CELL_BY_INDEX 166  EXCEL_COLUMN STRIKE_WIDTH
	! EXCEL_SET_VALUE CELL_BY_INDEX 167  EXCEL_COLUMN LIP_HEIGHT
	! EXCEL_SET_VALUE CELL_BY_INDEX 35  EXCEL_COLUMN LIP_THICKNESS
	! EXCEL_SET_VALUE CELL_BY_INDEX 212  EXCEL_COLUMN STRIKE_DESC
	
END_IF

IF LOCK_INDEX == 2
	IF STRIKE_DESC == "NONE"
		STRIKE_MODEL = "NONE"
		STRIKE_UDF = "NONE"
		STRIKE_UDF = "NONE"
		SECONDARY_STRIKE = "NONE"
		STRIKE_DESC = "NONE"
	END_IF

	EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"	
	EXCEL_SET_VALUE CELL_BY_INDEX 118 EXCEL_COLUMN  MANUFACTURER
	EXCEL_SET_VALUE CELL_BY_INDEX 117 EXCEL_COLUMN  LOCK_TYPE
	EXCEL_SET_VALUE CELL_BY_INDEX 119 EXCEL_COLUMN  LOCK_MODEL
	EXCEL_SET_VALUE CELL_BY_INDEX 120 EXCEL_COLUMN  LOCK_FUNCTION
	EXCEL_SET_VALUE CELL_BY_INDEX 121 EXCEL_COLUMN  BACKSET
	EXCEL_SET_VALUE CELL_BY_INDEX 122 EXCEL_COLUMN  OFFSET
	EXCEL_SET_VALUE CELL_BY_INDEX 123 EXCEL_COLUMN  TRIM 
	EXCEL_SET_VALUE CELL_BY_INDEX 124 EXCEL_COLUMN  LOCK_UDF
	EXCEL_SET_VALUE CELL_BY_INDEX 125 EXCEL_COLUMN  LOCK_INST
	EXCEL_SET_VALUE CELL_BY_INDEX 162 EXCEL_COLUMN  ARMOR_HEIGHT
	EXCEL_SET_VALUE CELL_BY_INDEX 163 EXCEL_COLUMN  ARMOR_WIDTH
	EXCEL_SET_VALUE CELL_BY_INDEX 184  EXCEL_COLUMN BACKSET
	EXCEL_SET_VALUE CELL_BY_INDEX 215  EXCEL_COLUMN LOCK_DESC	
	! EXCEL_SET_VALUE CELL_BY_INDEX 213  EXCEL_COLUMN STRIKE_DESC
 	! EXCEL_SET_VALUE CELL_BY_INDEX 36  EXCEL_COLUMN STRIKE_CENTER
 	! EXCEL_SET_VALUE CELL_BY_INDEX 37  EXCEL_COLUMN SECONDARY_STRIKE
 	! EXCEL_SET_VALUE CELL_BY_INDEX 38  EXCEL_COLUMN STRIKE_UDF
 	! EXCEL_SET_VALUE CELL_BY_INDEX 168  EXCEL_COLUMN STRIKE_MODEL
 	! EXCEL_SET_VALUE CELL_BY_INDEX 169  EXCEL_COLUMN STRIKE_HEIGHT
 	! EXCEL_SET_VALUE CELL_BY_INDEX 170  EXCEL_COLUMN STRIKE_WIDTH
 	! EXCEL_SET_VALUE CELL_BY_INDEX 171  EXCEL_COLUMN LIP_HEIGHT
 	! EXCEL_SET_VALUE CELL_BY_INDEX 39  EXCEL_COLUMN LIP_THICKNESS
END_IF
	EXCEL_SET_VALUE CELL_BY_INDEX 52  EXCEL_COLUMN FLUSH_BOLTS

END_ASM_DESCR
