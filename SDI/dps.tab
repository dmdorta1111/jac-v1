BEGIN_GUI_DESCR

	SHOW_PARAM STRING 	ITEM_NUM
	SHOW_PARAM STRING 	SUB_TYPE
	SHOW_PARAM INTEGER	OPENING_TYPE
	SHOW_PARAM STRING 	DOOR_ITEM_DESC
	SHOW_PARAM STRING 	FRAME_ITEM_DESC

	SHOW_PARAM STRING 	DPS_SHEET_NAME
	SHOW_PARAM INTEGER	DPS_ROW
	SHOW_PARAM STRING 	DPS_DESC
	SHOW_PARAM DOUBLE		DPS_CTR
	SHOW_PARAM STRING 	DPS_LOCATION
	
	IF DPS == 2 OR DPS == 3
		SHOW_PARAM STRING 	DPS_2_SHEET_NAME
		SHOW_PARAM INTEGER	DPS_2_ROW
		SHOW_PARAM STRING 	DPS_2_DESC
		SHOW_PARAM DOUBLE		DPS_2_CTR
		SHOW_PARAM STRING 	DPS_2_LOCATION
	END_IF
	
IF DPS == 1 OR DPS == 3
	USER_INPUT_PARAM DOUBLE DPS_CTR
END_IF

IF SUB_TYPE == "P"
	RADIOBUTTON_PARAM INTEGER DPS "NONE" "LEFT - PAIR OR YES - SINGLE" "RIGHT - FOR PAIRS ONLY" "BOTH - FOR PAIRS ONLY"
END_IF

IF SUB_TYPE == "S"
	CHECKBOX_PARAM INTEGER DPS
	RADIOBUTTON_PARAM INTEGER DPS_POSITION "HEAD" "JAMB"
	IF DPS_POSITION == 0
		DPS_LOCATION = "HEAD"
	END_IF
	IF DPS_POSITION == 2
		DPS_LOCATION = "JAMB"
	END_IF
END_IF	

IF DPS == 1 OR DPS == 3
	CHECKBOX_PARAM INTEGER SELECT_DPS "YES/NO"
	CHECKBOX_PARAM INTEGER DPS_BLANK "YES/NO"
END_IF

IF DPS == 3
	CHECKBOX_PARAM INTEGER EQUAL_DPS "YES/NO"
END_IF

IF (EQUAL_DPS == 0 AND DPS == 3) OR DPS == 2
	USER_INPUT_PARAM DOUBLE DPS_2_CTR
	CHECKBOX_PARAM INTEGER SELECT_DPS_2 "YES/NO"
	CHECKBOX_PARAM INTEGER DPS_2_BLANK "YES/NO"
END_IF

IF SUB_TYPE == "P"
	DPS_POSITION = 0
	DPS_LOCATION = "HEAD"
	DPS_2_POSITION = 0
	DPS_2_LOCATION = "HEAD"
END_IF	

END_GUI_DESCR

BEGIN_ASM_DESCR

	DECLARE_VARIABLE	STRING	DPS_LOCATION
	DECLARE_VARIABLE	STRING	DPS_2_LOCATION


	DECLARE_VARIABLE 	INTEGER	OPERATION
	DECLARE_VARIABLE 	STRING 	ITEM_NUM
	DECLARE_VARIABLE 	STRING 	SUB_TYPE
	DECLARE_VARIABLE 	INTEGER	OPENING_TYPE
	DECLARE_VARIABLE 	STRING 	DOOR_ITEM_DESC
	DECLARE_VARIABLE 	STRING 	FRAME_ITEM_DESC
	! DECLARE_VARIABLE 	INTEGER	WELDED_PREPS

	DECLARE_VARIABLE	INTEGER		DPS
	DECLARE_VARIABLE	INTEGER		EQUAL_DPS
	DECLARE_VARIABLE	STRING 		DPS_SHEET_NAME
	DECLARE_VARIABLE	INTEGER		DPS_ROW
	DECLARE_VARIABLE	STRING		DPS_DESC
	DECLARE_VARIABLE 	DOUBLE		DPS_CTR
	DECLARE_VARIABLE 	INTEGER		DPS_BLANK
	DECLARE_VARIABLE	INTEGER		DPS_POSITION
	DECLARE_VARIABLE	STRING 		DPS_2_SHEET_NAME
	DECLARE_VARIABLE	INTEGER		DPS_2_ROW
	DECLARE_VARIABLE	STRING 		DPS_2_DESC
	DECLARE_VARIABLE 	DOUBLE		DPS_2_CTR	
	DECLARE_VARIABLE 	INTEGER		DPS_2_BLANK
	DECLARE_VARIABLE	INTEGER		DPS_2_POSITION

	DECLARE_ARRAY 			DPS_INFO
	DECLARE_ARRAY			DPS_CELLS
	DECLARE_ARRAY			SELCELLS
	DECLARE_ARRAY			DPS_2_INFO
	DECLARE_ARRAY			DPS_2_CELLS

	DECLARE_REFERENCE 	LOCREF

	DECLARE_VARIABLE 	INTEGER 	COLSHAPE
	DECLARE_VARIABLE 	DOUBLE 	COLDIA
	DECLARE_VARIABLE 	DOUBLE 	COLLENGTH
	DECLARE_VARIABLE 	DOUBLE 	COLWIDTH
	DECLARE_VARIABLE 	DOUBLE 	COLLENGTH

	DECLARE_VARIABLE	STRING		DPS_TABS
	DECLARE_VARIABLE	STRING		BOX
	DECLARE_VARIABLE	STRING		BLANK

	DECLARE_VARIABLE 	INTEGER 	HINDEX
	DECLARE_VARIABLE 	INTEGER 	HTP
	DECLARE_VARIABLE 	STRING 		SHAPE
	DECLARE_VARIABLE	STRING		SHAPE_UDF
	DECLARE_VARIABLE	STRING		UDFF
	DECLARE_VARIABLE DOUBLE LOCX
	DECLARE_VARIABLE DOUBLE LOCY
	DECLARE_VARIABLE DOUBLE ROTY
		
	IF OPERATION == 0
		IF DPS_POSITION == 0
			DPS_LOCATION = "HEAD"
		END_IF
		IF DPS_POSITION == 1
			DPS_LOCATION = "JAMB"
		END_IF

		IF DPS_2_POSITION == 0
			DPS_2_LOCATION = "HEAD"
		END_IF
		IF DPS_2_POSITION == 1
			DPS_2_LOCATION = "JAMB"
		END_IF
		
		CONFIG_ELEM
		
		IF SELECT_DPS == 1
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "DPS-EPT"
			PRINT "SELECT ONE CELL IN THE ROW YOU WANT"
			WAIT
			EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
			EXCEL_GET_SHEET_NAME EXCEL_INDEX DPS_SHEET_NAME
			
			CLEAR_ARRAY DPS_CELLS
			EXCEL_GET_SELECTION DPS_CELLS
			FOR CELL REF ARRAY DPS_CELLS
				GET_ARRAY_ELEM CELL 0 DPS_ROW
				BREAK
			END_FOR
			EXCEL_GET_VALUE DPS_ROW 2 DPS_MANUFACTURER
			EXCEL_GET_VALUE DPS_ROW 3 DPS_MODEL
			DPS_DESC = DPS_MANUFACTURER + "\nMDL " + DPS_MODEL + "  DPS"
			
			PRINT "DPS SHEET NAME  %" DPS_SHEET_NAME
			PRINT "DPS ROW  %" DPS_ROW			
			PRINT "DPS DESC  %" DPS_DESC
			
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		END_IF
		
		IF SELECT_DPS_2 == 1
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "DPS-EPT"
			PRINT "SELECT ONE CELL IN THE ROW YOU WANT"
			WAIT
			EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
			EXCEL_GET_SHEET_NAME EXCEL_INDEX DPS_2_SHEET_NAME
			
			CLEAR_ARRAY DPS_2_CELLS
			EXCEL_GET_SELECTION DPS_2_CELLS
			FOR CELL REF ARRAY DPS_2_CELLS
				GET_ARRAY_ELEM CELL 0 DPS_2_ROW
				BREAK
			END_FOR
			EXCEL_GET_VALUE DPS_2_ROW 2 DPS_2_MANUFACTURER
			EXCEL_GET_VALUE DPS_2_ROW 3 DPS_2_MODEL
			DPS_2_DESC = DPS_2_MANUFACTURER + "\n MDL " + DPS_2_MODEL + "  DPS"
			
			PRINT "DPS SHEET NAME  %" DPS_2_SHEET_NAME
			PRINT "DPS ROW  %" DPS_2_ROW			
			PRINT "DPS DESC  %" DPS_2_DESC
			
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		END_IF

		IF SUB_TYPE == "P" AND DPS == 3 AND EQUAL_DPS == 1
			DPS_2_SHEET_NAME = DPS_SHEET_NAME
			DPS_2_ROW = DPS_ROW
			DPS_2_DESC = DPS_DES
			DPS_2_CTR = DPS_CTR
		END_IF
		
		IF SUB_TYPE == "P" AND DPS == 2
			DPS_SHEET_NAME = ""
			DPS_ROW = ""
			DPS_DESC = ""
			DPS_CTR = ""
		END_IF
		
		! ELSE_IF SUB_TYPE == "P" AND DPS == 2
			! DPS_2_SHEET_NAME = ""
			! DPS_2_ROW = ""
			! DPS_2_DESC = ""	
			! DPS_2_CTR = ""
			! DPS_2_BLANK = ""
			! DPS_2_POSITION = ""
		! ELSE_IF SUB_TYPE == "S"
			! DPS_2_SHEET_NAME = ""
			! DPS_2_ROW = ""
			! DPS_2_DESC = ""		
			! DPS_2_CTR = ""
			! DPS_2_BLANK = ""
			! DPS_2_POSITION = ""
		! END_IF

	END_IF

	IF OPERATION == 1	
		IF SUB_TYPE == "S"
			IF DPS == 1 AND DPS_POSITION == 0 !HEAD
				LOCY = JOH-TOP_GAP
				IF HAND == "RHR" OR HAND == "LH"
					LOCX = (JOW/2) - DPS_CTR - ((HINGE_GAP-STRIKE_GAP)/2)
				END_IF
				IF HAND == "LHR" OR HAND == "RH"
					LOCX = -(JOW/2) + DPS_CTR
				END_IF

				SEARCH_MDL_REF DOOR_ASM CSYS "ORIENT" ATTACH
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY LOCY
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF
			
			IF DPS == 1 AND DPS_POSITION == 1 !JAMB
				MESSAGE_BOX "THIS OPTION FOR A DPS IN THE JAMB IS NOT COMPETE"
			END_IF
		END_IF
				
		IF SUB_TYPE == "P" AND DOOR_INDEX == 1
			IF (DPS == 1 OR DPS == 3) AND DPS_POSITION == 0
				IF STD_REV == "STD"
					SEARCH_MDL_REF DOOR_ASM CSYS "DIMR" ATTACH
					LOCX = - DPS_CTR + (STRIKE_GAP/2)
				ELSE_IF STD_REV == "REV"
					SEARCH_MDL_REF DOOR_ASM CSYS "DIML" ATTACH
					LOCX = DPS_CTR - (STRIKE_GAP/2)
				END_IF
				
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF
		END_IF

		IF SUB_TYPE == "P" AND DOOR_INDEX == 2
			IF (DPS == 2 OR DPS == 3) AND DPS_POSITION == 0
				IF STD_REV == "REV"
					SEARCH_MDL_REF DOOR_ASM CSYS "DIMR" ATTACH
					LOCX = - DPS_2_CTR + (STRIKE_GAP/2)
				ELSE_IF STD_REV == "STD"
					SEARCH_MDL_REF DOOR_ASM CSYS "DIML" ATTACH
					LOCX = DPS_2_CTR - (STRIKE_GAP/2)
				END_IF
				
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				DPS_SHEET_NAME	= DPS_2_SHEET_NAME	
				DPS_ROW			= DPS_2_ROW		
				DPS_DESC		= DPS_2_DESC		
				DPS_CTR			= DPS_2_CTR		
				DPS_BLANK		= DPS_2_BLANK				
				DPS_POSITION		= DPS_2_POSITION
			END_IF
		END_IF
		
		IF DPS_ROW <> 0 AND DPS_ROW <> ""
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME DPS_SHEET_NAME
			CLEAR_ARRAY SELCELLS
			EXCEL_GET_VALUES CELL_BY_INDEX DPS_ROW 0 CELL_BY_INDEX DPS_ROW 20 SELCELLS
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		
			CLEAR_ARRAY DPS_INFO
			FOR CELL REF ARRAY SELCELLS
				GET_ARRAY_ELEM CELL 2 content
				ADD_ARRAY_ELEM DPS_INFO content
				PRINT "CONTENT - %  " content
			END_FOR

			GET_ARRAY_ELEM DPS_INFO 2  MANUFACTURER
			! GET_ARRAY_ELEM DPS_INFO 3  
			! GET_ARRAY_ELEM DPS_INFO 4  
			GET_ARRAY_ELEM DPS_INFO 20  DPS_TABS
			GET_ARRAY_ELEM DPS_INFO 6  BOXX
			GET_ARRAY_ELEM DPS_INFO 7  BLANK
			GET_ARRAY_ELEM DPS_INFO 14 SHAPE
			GET_ARRAY_ELEM DPS_INFO 15 DIA
			GET_ARRAY_ELEM DPS_INFO 16 LENGTH
			GET_ARRAY_ELEM DPS_INFO 17 WIDTH
			GET_ARRAY_ELEM DPS_INFO 18 RADIUS
			GET_ARRAY_ELEM DPS_INFO 19 THICKNESS
			
			IF SHAPE == 1
				CREATE_UDF udf\rnd DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM DIA DIA
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF	
				
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -.75
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				
				CREATE_UDF udf\rnd DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM DIA DIA + .25
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF	
			ELSE_IF SHAPE == 2
				IF DOOR_CONSTRUCTION == "SEAMLESS" 
					IF DOOR_GAUGE == 18 AND WIDTH <= 1.265
						UDFF = "udf\\rect"
					ELSE_IF DOOR_GAUGE == 18 AND WIDTH > 1.265
						UDFF = "udf\\rect_tab"
					ELSE_IF DOOR_GAUGE == 16 AND WIDTH <= 1.265
						UDFF = "udf\\rect"
					ELSE_IF DOOR_GAUGE == 16 AND WIDTH > 1.265
						UDFF = "udf\\rect_tab"
					ELSE_IF DOOR_GAUGE == 14 AND WIDTH <= 1.140
						UDFF = "udf\\rect"
					ELSE_IF DOOR_GAUGE == 14 AND WIDTH > 1.140
						UDFF = "udf\\rect_tab"
					ELSE_IF DOOR_GAUGE == 12
						UDFF = "udf\\rect_tab"
					END_IF
				ELSE_IF DOOR_CONSTRUCTION == "LOCKSEAM"
					UDFF = "udf\\rect"
				END_IF
			
				CREATE_UDF &UDFF DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM LENGTH LENGTH +.015
					UDF_DIM WIDTH WIDTH +.015
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			ELSE_IF SHAPE == 3
				CREATE_UDF udf\obrnd DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM LENGTH LENGTH +.015
					UDF_DIM WIDTH WIDTH +.015
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			ELSE_IF SHAPE == 4
				CREATE_UDF udf\rectrad DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM LENGTH LENGTH +.015
					UDF_DIM WIDTH WIDTH +.015
					UDF_DIM RAD RAD
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			END_IF

			IF DPS_TABS <> "" AND DPS_TABS <> "NO-VALUE"
				RETRIEVE_MDL &DPS_TABS COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
			END_IF
			
			IF DPS_BLANK == 1
				RETRIEVE_MDL &BLANK COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT_F" PLACEMENT

					ASSEMBLE COMP DOOR_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
			END_IF
			
			IF TOP_EDGE == "INVERTED" OR TOP_EDGE == "FLUSH"
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY TOP_CHANNEL_DEPTH
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			
				IF SHAPE == 1
					CREATE_UDF udf\rnd DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM DIA 1.25
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				ELSE_IF SHAPE == 2
					CREATE_UDF udf\rect DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM LENGTH LENGTH +.015+25
						UDF_DIM WIDTH 1.25
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				ELSE_IF SHAPE == 3
					CREATE_UDF udf\obrnd DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM LENGTH LENGTH +.015+.25
						UDF_DIM WIDTH 1.25
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				ELSE_IF SHAPE == 4
					CREATE_UDF udf\rectrad DOOR_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM LENGTH LENGTH +.015+.25
						UDF_DIM WIDTH 1.25
						UDF_DIM RAD RAD
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				END_IF
			END_IF
		END_IF
	END_IF

	IF OPERATION == 2		
		IF SUB_TYPE == "S"
			IF DPS == 1 AND DPS_POSITION == 0 !HEAD
				LOCY = JOH
				IF HAND == "RHR" OR HAND == "LH"
					LOCX = -(JOW/2) + DPS_CTR + (FRAME_WELD_ALLOWANCE/2)
				END_IF
				IF HAND == "LHR" OR HAND == "RH"
					LOCX = (JOW/2) - DPS_CTR - (FRAME_WELD_ALLOWANCE/2)
				END_IF

				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY LOCY
					UDF_DIM	LOCZ (JD/2)-(RABBET/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				SET_REF_NAME ATTACH "DPS_REF"
			END_IF
			
			IF DPS == 1 AND DPS_POSITION == 1 !JAMB
				MESSAGE_BOX "THIS OPTION IS NOT COMPETE"
			END_IF
		END_IF
				
		IF SUB_TYPE == "P"
			IF (DPS == 1 OR DPS == 3) AND DPS_POSITION == 0
				LOCY = JOH
				LOCX = - DPS_CTR
				IF STD_REV == "STD"
					ROTY = 180
				ELSE_IF STD_REV == "REV"
					ROTY = 0
				END_IF
			
				! SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH DOOR_CTR_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY ROTY
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY LOCY
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				SET_REF_NAME ATTACH "DPS_REF"
			END_IF
			
			IF DPS == 2 AND DPS_POSITION == 0
				LOCY = JOH
				LOCX = DPS_2_CTR
				IF STD_REV == "STD"
					ROTY = 180
				ELSE_IF STD_REV == "REV"
					ROTY = 0
				END_IF
			
				SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH DOOR_CTR_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY ROTY
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY LOCY
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				SET_REF_NAME ATTACH "DPS_REF"
			END_IF
		END_IF		
				
		IF DPS_ROW <> 0 AND DPS_ROW <> ""
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME DPS_SHEET_NAME
			CLEAR_ARRAY SELCELLS
			EXCEL_GET_VALUES CELL_BY_INDEX DPS_ROW 0 CELL_BY_INDEX DPS_ROW 13 SELCELLS
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		
			CLEAR_ARRAY DPS_INFO
			FOR CELL REF ARRAY SELCELLS
				GET_ARRAY_ELEM CELL 2 content
				ADD_ARRAY_ELEM DPS_INFO content
				PRINT "CONTENT - %  " content
			END_FOR

			GET_ARRAY_ELEM DPS_INFO 2  MANUFACTURER
			! GET_ARRAY_ELEM DPS_INFO 3  
			! GET_ARRAY_ELEM DPS_INFO 4  
			GET_ARRAY_ELEM DPS_INFO 5  DPS_TABS
			GET_ARRAY_ELEM DPS_INFO 6  BOXX
			GET_ARRAY_ELEM DPS_INFO 7  BLANK
			GET_ARRAY_ELEM DPS_INFO 8  SHAPE
			GET_ARRAY_ELEM DPS_INFO 9  DIA
			GET_ARRAY_ELEM DPS_INFO 10 LENGTH
			GET_ARRAY_ELEM DPS_INFO 11 WIDTH
			GET_ARRAY_ELEM DPS_INFO 12 RADIUS
			GET_ARRAY_ELEM DPS_INFO 13 THICKNESS
			
			IF SHAPE == 1
				CREATE_UDF udf\rnd FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM DIA DIA
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			ELSE_IF SHAPE == 2
				CREATE_UDF udf\rect FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM LENGTH LENGTH +.015
					UDF_DIM WIDTH WIDTH +.015
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			ELSE_IF SHAPE == 3
				CREATE_UDF udf\obrnd FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM LENGTH LENGTH +.015
					UDF_DIM WIDTH WIDTH +.015
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			ELSE_IF SHAPE == 4
				CREATE_UDF udf\rectrad FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM LENGTH LENGTH +.015
					UDF_DIM WIDTH WIDTH +.015
					UDF_DIM RAD RAD
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF			
			END_IF
			
			IF DPS_TABS <> "" AND DPS_TABS <> "NO-VALUE"
				RETRIEVE_MDL &DPS_TABS COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
			END_IF

			RETRIEVE_MDL &BOXX COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE			
			
			IF DPS_BLANK == 1
				RETRIEVE_MDL &BLANK COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT_F" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
			END_IF
		END_IF

		IF SUB_TYPE == "P"			
			IF DPS == 3 AND DPS_POSITION == 0
				LOCY = JOH
				LOCX = DPS_CTR
				IF STD_REV == "STD"
					ROTY = 180
				ELSE_IF STD_REV == "REV"
					ROTY = 0
				END_IF
			
				! SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH DOOR_CTR_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY ROTY
					UDF_DIM	ROTZ 180
					UDF_DIM	LOCX LOCX
					UDF_DIM	LOCY LOCY
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
				SET_REF_NAME ATTACH "DPS_REF_2"
			END_IF
			
			IF DPS_2_ROW <> 0 AND DPS_2_ROW <> ""
				EXCEL_ACTIVATE_SHEET SHEET_BY_NAME DPS_2_SHEET_NAME
				CLEAR_ARRAY SELCELLS
				EXCEL_GET_VALUES CELL_BY_INDEX DPS_2_ROW 0 CELL_BY_INDEX DPS_2_ROW 13 SELCELLS
				EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
			
				CLEAR_ARRAY DPS_INFO
				FOR CELL REF ARRAY SELCELLS
					GET_ARRAY_ELEM CELL 2 content
					ADD_ARRAY_ELEM DPS_INFO content
					PRINT "CONTENT - %  " content
				END_FOR

				GET_ARRAY_ELEM DPS_INFO 2  MANUFACTURER
				! GET_ARRAY_ELEM DPS_INFO 3  
				! GET_ARRAY_ELEM DPS_INFO 4  
				GET_ARRAY_ELEM DPS_INFO 5  DPS_TABS
				GET_ARRAY_ELEM DPS_INFO 6  BOXX
				GET_ARRAY_ELEM DPS_INFO 7  BLANK
				GET_ARRAY_ELEM DPS_INFO 8  SHAPE
				GET_ARRAY_ELEM DPS_INFO 9  DIA
				GET_ARRAY_ELEM DPS_INFO 10 LENGTH
				GET_ARRAY_ELEM DPS_INFO 11 WIDTH
				GET_ARRAY_ELEM DPS_INFO 12 RADIUS
				GET_ARRAY_ELEM DPS_INFO 13 THICKNESS
				
				IF SHAPE == 1
					CREATE_UDF udf\rnd FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM DIA DIA
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				ELSE_IF SHAPE == 2
					CREATE_UDF udf\rect FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM LENGTH LENGTH +.015
						UDF_DIM WIDTH WIDTH +.015
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				ELSE_IF SHAPE == 3
					CREATE_UDF udf\obrnd FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM LENGTH LENGTH +.015
						UDF_DIM WIDTH WIDTH +.015
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				ELSE_IF SHAPE == 4
					CREATE_UDF udf\rectrad FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM LENGTH LENGTH +.015
						UDF_DIM WIDTH WIDTH +.015
						UDF_DIM RAD RAD
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF			
				END_IF
				
				IF DPS_TABS <> "" AND DPS_TABS <> "NO-VALUE"
					RETRIEVE_MDL &DPS_TABS COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

						ASSEMBLE COMP FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE

						ASSEMBLE COMP FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
				END_IF
				
				RETRIEVE_MDL &BOXX COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE			
				
				IF DPS_2_BLANK == 1
					RETRIEVE_MDL &BLANK COMP
					SEARCH_MDL_REF COMP CSYS "PLACEMENT_F" PLACEMENT

						ASSEMBLE COMP FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
				END_IF
			END_IF
		END_IF		
	END_IF
END_ASM_DESCR


