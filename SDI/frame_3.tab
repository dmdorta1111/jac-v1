BEGIN_ASM_DESCR

DECLARE_VARIABLE DOUBLE FRAME_WELD_ALLOWANCE
DECLARE_VARIABLE DOUBLE FRAME_WELD_ALLOWANCE_FULLY
DECLARE_VARIABLE DOUBLE FRAME_WELD_ALLOWANCE_FACE

IF FR_THICKNESS == .06
	FRAME_WELD_ALLOWANCE_FULLY = .12
ELSE_IF FR_THICKNESS == .075
	FRAME_WELD_ALLOWANCE_FULLY = .09
ELSE_IF FR_THICKNESS == .105
	FRAME_WELD_ALLOWANCE_FULLY = .06
END_IF

FRAME_WELD_ALLOWANCE_FACE = .045


	IF FRAME_CONSTRUCTION == "FULLY WELDED"
		JOW = JOW+FRAME_WELD_ALLOWANCE_FULLY
		FRAME_WELD_ALLOWANCE = FRAME_WELD_ALLOWANCE_FULLY
	ELSE_IF FRAME_CONSTRUCTION == "FACE WELDED"
		JOW = JOW+FRAME_WELD_ALLOWANCE_FACE
		FRAME_WELD_ALLOWANCE = FRAME_WELD_ALLOWANCE_FACE
	ELSE_IF FRAME_CONSTRUCTION == "KNOCK DOWN"
		FRAME_WELD_ALLOWANCE = 0
	END_IF

	DECLARE_VARIABLE INTEGER OPERATION
	DECLARE_REFERENCE JAMB1
	DECLARE_REFERENCE JAMB2
	DECLARE_REFERENCE HEAD
	DECLARE_REFERENCE SILLL
	DECLARE_REFERENCE COMP

	INVALIDATE_REF JAMB1
	INVALIDATE_REF JAMB2
	INVALIDATE_REF HEAD
	INVALIDATE_REF SILLL

	OPERATION = 2

	IF FRAME_ELEVATION == 3 AND SECTION == 0
		RETRIEVE_MDL frame_3_0.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 1
		RETRIEVE_MDL frame_3_1.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 2
		RETRIEVE_MDL frame_3_2.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 21
		RETRIEVE_MDL frame_3_2tb.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 31 AND SECTION == 2 AND STD_REV == "STD" AND SIDE_LITE_SIDE == 2 AND SIDE_LITE_QTY == 1
		RETRIEVE_MDL frame_31r_2.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 31 AND SECTION == 2 AND STD_REV == "REV" AND SIDE_LITE_SIDE == 1 AND SIDE_LITE_QTY == 1
		RETRIEVE_MDL frame_31r_2.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 31 AND SECTION == 2 AND STD_REV == "STD" AND SIDE_LITE_SIDE == 1 AND SIDE_LITE_QTY == 1
		RETRIEVE_MDL frame_31l_2.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 31 AND SECTION == 2 AND STD_REV == "REV" AND SIDE_LITE_SIDE == 2 AND SIDE_LITE_QTY == 1
		RETRIEVE_MDL frame_31l_2.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 32 AND SECTION == 2
		RETRIEVE_MDL frame_32_2.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 4 AND SECTION == 0
		RETRIEVE_MDL frame_4_0.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 4 AND SECTION == 1
		RETRIEVE_MDL frame_4_1.asm FRAME_ASM
	ELSE_IF FRAME_ELEVATION == 4 AND SECTION == 2
		RETRIEVE_MDL frame_4_2.asm FRAME_ASM
	END_IF

	SET_MDL_PARAM FRAME_ASM "CUSTOMER_NAME" CUSTOMER_NAME
	SET_MDL_PARAM FRAME_ASM "JOB_NAME" JOB_NAME
	SET_MDL_PARAM FRAME_ASM "SO_NUM" SO_NUM

	SET_MDL_PARAM FRAME_ASM "SUB_JOB_NAME" SUB_JOB_NAME
	SET_MDL_PARAM FRAME_ASM "ITEM_NUM" ITEM_NUM
	SET_MDL_PARAM FRAME_ASM "QTY" QTY
	SET_MDL_PARAM FRAME_ASM "ITEM_DESC" FRAME_ITEM_DESC

	SET_MDL_PARAM FRAME_ASM "RABBET" RABBET
	SET_MDL_PARAM FRAME_ASM "XRABBET" XRABBET
	SET_MDL_PARAM FRAME_ASM "STOPP" STOPP
	SET_MDL_PARAM FRAME_ASM "HEAD_STOPP" HEAD_STOPP
	SET_MDL_PARAM FRAME_ASM "JD" JD
	SET_MDL_PARAM FRAME_ASM "JOW" JOW
	SET_MDL_PARAM FRAME_ASM "JOH" JOH   !+TRANSOM_PANEL_HEIGHT
	SET_MDL_PARAM FRAME_ASM "FACEE" FACEE
	SET_MDL_PARAM FRAME_ASM "XFACEE" XFACEE
	SET_MDL_PARAM FRAME_ASM "HEAD" HEAD
	SET_MDL_PARAM FRAME_ASM "XHEAD" XHEAD
	SET_MDL_PARAM FRAME_ASM "RETURN" RETURN
	SET_MDL_PARAM FRAME_ASM "XRETURN" XRETURN
	SET_MDL_PARAM FRAME_ASM "HAND" HAND
	SET_MDL_PARAM FRAME_ASM "ANCHOR_CTR" -ANCHOR_CTR
	SET_MDL_PARAM FRAME_ASM "STD_REV" STD_REV
	REGEN_MDL FRAME_ASM
	
	SEARCH_MDL_REF ASSEM CSYS "FRAME" ATTACH
	SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
		ASSEMBLE FRAME_ASM ASSEM
			CSYS ATTACH PLACEMENT
		END_ASSEMBLE
		
	SET_MDL_NAME FRAME_ASM "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM
	SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM

	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB*L*" JAMB1
	SET_MDL_NAME JAMB1 "JB_LEFT_"+SO_NUM+"_"+ ITEM_NUM
	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JB_LEFT_"+SO_NUM+"_"+ ITEM_NUM JAMB1

	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB*R*" JAMB2
	SET_MDL_NAME JAMB2 "JB_RIGHT_"+SO_NUM+"_"+ ITEM_NUM
	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JB_RIGHT_"+SO_NUM+"_"+ ITEM_NUM JAMB2

	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD*" HEAD
	SET_MDL_NAME HEAD "JB_HEAD_"+SO_NUM+"_"+ ITEM_NUM
	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JB_HEAD_"+SO_NUM+"_"+ ITEM_NUM HEAD

	SEARCH_MDL_REF RECURSIVE FRAME_ASM COMPONENT "*TEMPLATE*" FRAME_TEMPLATE
	SET_MDL_NAME FRAME_TEMPLATE "FT_"+SO_NUM+"_"+ ITEM_NUM
	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "FT_"+SO_NUM+"_"+ ITEM_NUM FRAME_TEMPLATE

	IF FRAME_ELEVATION == 31
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*SILL*" SILL1
		SET_MDL_NAME SILL1 "S1_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "S1_"+SO_NUM+"_"+ ITEM_NUM SILL1

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*MULL*" MULL1
		SET_MDL_NAME MULL1 "M1_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "M1_"+SO_NUM+"_"+ ITEM_NUM MULL1

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*MULL*" MULL2
		SET_MDL_NAME MULL2 "M2_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "M2_"+SO_NUM+"_"+ ITEM_NUM MULL2

		BEGIN_CATCH_ERROR
			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*SILL*" SILL2
			SET_MDL_NAME SILL2 "S2_"+SO_NUM+"_"+ ITEM_NUM
			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "S1_"+SO_NUM+"_"+ ITEM_NUM SILL2

			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*MULL*" MULL3
			SET_MDL_NAME MULL3 "M3_"+SO_NUM+"_"+ ITEM_NUM
			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "M1_"+SO_NUM+"_"+ ITEM_NUM MULL3

			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*MULL*" MULL4
			SET_MDL_NAME MULL4 "M4_"+SO_NUM+"_"+ ITEM_NUM
			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "M2_"+SO_NUM+"_"+ ITEM_NUM MULL4
		END_CATCH_ERROR
		CLEAR_CATCH_ERROR
	END_IF

	IF SECTION == 21
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB_TB_0" JAMBTB0
		SET_MDL_NAME JAMBTB0 "JTB0_"+SO_NUM+"_"+ ITEM_NUM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB_TB_1" JAMBTB1
		SET_MDL_NAME JAMBTB1 "JBTB1_"+SO_NUM+"_"+ ITEM_NUM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB_TB_2" JAMBTB2
		SET_MDL_NAME JAMBTB2 "JBTB2_"+SO_NUM+"_"+ ITEM_NUM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB_TB_3" JAMBTB3
		SET_MDL_NAME JAMBTB3 "JBTB3_"+SO_NUM+"_"+ ITEM_NUM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HAED_TB_0" JAMBTB4
		SET_MDL_NAME JAMBTB4 "HDTB0_"+SO_NUM+"_"+ ITEM_NUM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HAED_TB_1" JAMBTB5
		SET_MDL_NAME JAMBTB5 "HDTB1_"+SO_NUM+"_"+ ITEM_NUM
	END_IF

	IF FRAME_ELEVATION == 4
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "SILL*" SILLL
		SET_MDL_NAME SILLL "JB_SILL_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JB_SILL_"+SO_NUM+"_"+ ITEM_NUM SILLL
	END_IF

	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*SECTION*" SECT_SKETCH
	SET_MDL_NAME SECT_SKETCH "SECTION_"+SO_NUM+"_"+ ITEM_NUM
	SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "SECTION_"+SO_NUM+"_"+ ITEM_NUM SECT_SKETCH

		DECLARE_ARRAY SECTNAMES
		DECLARE_ARRAY SECTS
		DECLARE_VARIABLE INTEGER IDX			
		IDX = 1
		SEARCH_MDL_REFS RECURSIVE SECT_SKETCH COMPONENT "SECT*" SECTS

		FOR SECT REF ARRAY SECTS
			FIND_ARRAY_ELEM SECTS SECT SECTINDX
			GET_REF_NAME SECT SECTNAME
			FIND_ARRAY_ELEM SECTNAMES SECTNAME INDX
			IF INDX > -1
				DELETE_ARRAY_ELEM SECTS SECTINDX
			ELSE
				ADD_ARRAY_ELEM SECTNAMES SECTNAME				
			END_IF
		END_FOR
		
		FOR SECT REF ARRAY SECTS
			SET_MDL_NAME SECT "S_"+ITEM_NUM+"_"+ itos(IDX)
			IDX++
		END_FOR
	
	IF FRAME_ELEVATION > 30
		SET_MDL_PARAM FRAME_ASM "SIDE_LITE" SIDE_LITE_JOW
		SET_MDL_PARAM FRAME_ASM "MULLION" SIDE_LITE_MULLION
		! SET_MDL_PARAM FRAME_ASM "SIDE_LITE_GLASS_THICKNESS" SIDE_LITE_GLASS_THICKNESS
	END_IF

	IF FRAME_ELEVATION == 4
		SET_MDL_PARAM FRAME_ASM "SILL" SILL
		SET_MDL_PARAM FRAME_ASM "XSILL" XSILL
	END_IF

	SET_MDL_PARAM JAMB1 "SMT_THICKNESS" FR_THICKNESS
	SET_MDL_PARAM JAMB1 "TYPE" MAT_TYPE
	SET_MDL_PARAM JAMB1 "GRADE" FRAME_GRADE
	SET_MDL_PARAM JAMB1 "FINISH" FRAME_FINISH
	SET_MDL_PARAM JAMB1 "GRAIN" 1
	SET_MDL_PARAM JAMB1 "EMJACNUM" "JAMB1-"+ITEM_NUM
	SET_MDL_PARAM JAMB1 "ANCHOR_QTY" ANCHOR_QTY
	SET_MDL_PARAM JAMB1 "ANCHOR_SPACING" ANCHOR_SPACING
	SET_MDL_PARAM JAMB1 "ANCHOR_JB_DIST" ANCHOR_JB_DIST

	SET_MDL_PARAM JAMB2 "SMT_THICKNESS" FR_THICKNESS
	SET_MDL_PARAM JAMB2 "TYPE" MAT_TYPE
	SET_MDL_PARAM JAMB2 "GRADE" FRAME_GRADE
	SET_MDL_PARAM JAMB2 "FINISH" FRAME_FINISH
	SET_MDL_PARAM JAMB2 "GRAIN" 1
	SET_MDL_PARAM JAMB2 "EMJACNUM" "JAMB2-"+ITEM_NUM
	SET_MDL_PARAM JAMB2 "ANCHOR_QTY" ANCHOR_QTY
	SET_MDL_PARAM JAMB2 "ANCHOR_SPACING" ANCHOR_SPACING
	SET_MDL_PARAM JAMB2 "ANCHOR_JB_DIST" ANCHOR_JB_DIST

	SET_MDL_PARAM HEAD "SMT_THICKNESS" FR_THICKNESS
	SET_MDL_PARAM HEAD "TYPE" MAT_TYPE
	SET_MDL_PARAM HEAD "GRADE" FRAME_GRADE
	SET_MDL_PARAM HEAD "FINISH" FRAME_FINISH
	SET_MDL_PARAM HEAD "EMJACNUM" "HEAD-"+ITEM_NUM

	IF HEAD_GRAIN == "VERTICAL"
			SET_MDL_PARAM HEAD "GRAIN" 2
	ELSE_IF HEAD_GRAIN == "HORIZONTAL"
			SET_MDL_PARAM HEAD "GRAIN" 1
	END_IF

	IF FRAME_ELEVATION == 4
		SET_MDL_PARAM SILLL "SMT_THICKNESS" FR_THICKNESS
		SET_MDL_PARAM SILLL "TYPE" MAT_TYPE
		SET_MDL_PARAM SILLL "GRADE" FRAME_GRADE
		SET_MDL_PARAM SILLL "FINISH" FRAME_FINISH
		SET_MDL_PARAM SILLL "EMJACNUM" "HEAD-"+ITEM_NUM

		IF HEAD_GRAIN == "VERTICAL"
				SET_MDL_PARAM SILLL "GRAIN" 2
		ELSE_IF HEAD_GRAIN == "HORIZONTAL"
				SET_MDL_PARAM SILLL "GRAIN" 1
		END_IF
	END_IF

	SET_MDL_PARAM SECT_SKETCH "HEAD" HEAD
	SET_MDL_PARAM SECT_SKETCH "XHEAD" XHEAD
	SET_MDL_PARAM SECT_SKETCH "HEAD_STOPP" HEAD_STOPP
	SET_MDL_PARAM SECT_SKETCH "STD_REV" STD_REV
	SET_MDL_PARAM SECT_SKETCH "JD" JD
	SET_MDL_PARAM SECT_SKETCH "ANCHOR_CTR" ANCHOR_CTR
	SET_MDL_PARAM SECT_SKETCH "ANCHOR_RECESS" ANCHOR_RECESS
	SET_MDL_PARAM SECT_SKETCH "STD_REV" STD_REV

	IF FRAME_ELEVATION > 30
		SET_MDL_PARAM SECT_SKETCH "GLAZING_POCKET" SIDE_LITE_GLASS_THICKNESS+.125
		SET_MDL_PARAM SECT_SKETCH "MULLION" SIDE_LITE_MULLION
		
		
		IF (STD_REV == "STD" AND SIDE_LITE_STOPS == 0) 
			SET_MDL_PARAM FRAME_ASM "GLASS_STOP_OFFSET" RABBET - SIDE_LITE_GLASS_THICKNESS - .125 - (GLASS_STOP_WIDTH/2)
			SET_MDL_PARAM FRAME_ASM "SHOE" RABBET - ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF
		
		IF (STD_REV == "REV" AND SIDE_LITE_STOPS == 1)
			SET_MDL_PARAM FRAME_ASM "GLASS_STOP_OFFSET" RABBET - SIDE_LITE_GLASS_THICKNESS - .125 - (GLASS_STOP_WIDTH/2)		
			SET_MDL_PARAM FRAME_ASM "SHOE" RABBET - ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF
		
		IF (STD_REV == "STD" AND SIDE_LITE_STOPS == 1)
			SET_MDL_PARAM FRAME_ASM "GLASS_STOP_OFFSET" JD - XRABBET + SIDE_LITE_GLASS_THICKNESS + .125 + (GLASS_STOP_WIDTH/2)			
			SET_MDL_PARAM FRAME_ASM "SHOE" JD - RABBET + ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF
		
		IF (STD_REV == "REV" AND SIDE_LITE_STOPS == 0)
			SET_MDL_PARAM FRAME_ASM "GLASS_STOP_OFFSET" JD - XRABBET + SIDE_LITE_GLASS_THICKNESS + .125 + (GLASS_STOP_WIDTH/2)	
			SET_MDL_PARAM FRAME_ASM "SHOE" JD - RABBET + ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF

		SEARCH_MDL_REF FRAME_ASM CSYS "SHOE" ATTACH
		CREATE_UDF udf\hole FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM DIA .875
			UDF_INTERSECTION * PART_LEVEL
			UDF_EXP_REF HOLE FEATURE 0
		END_CREATE_UDF
		
		INVALIDATE_REF COMP
		RETRIEVE_MDL MULLION_SHOE.PRT COMP
		SEARCH_MDL_REF COMP CSYS "ATTACH" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE

			SET_MDL_PARAM COMP "A" JD-.25
			
		IF (STD_REV == "STD" AND SIDE_LITE_STOPS == 0) 
			SET_MDL_PARAM COMP "B" RABBET - ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF
		
		IF (STD_REV == "REV" AND SIDE_LITE_STOPS == 1)
			SET_MDL_PARAM COMP "B" RABBET - ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF
		
		IF (STD_REV == "STD" AND SIDE_LITE_STOPS == 1)
			SET_MDL_PARAM COMP "B" JD - RABBET + ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF
		
		IF (STD_REV == "REV" AND SIDE_LITE_STOPS == 0)
			SET_MDL_PARAM COMP "B" JD - RABBET + ((SIDE_LITE_GLASS_THICKNESS + .125 + GLASS_STOP_WIDTH)/2)
		END_IF

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX

		INVALIDATE_REF COMP
		RETRIEVE_MDL MULLION_SPACER.PRT COMP
		SEARCH_MDL_REF COMP CSYS "ATTACH" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER COMP "COMPONENTS"

			SET_MDL_PARAM COMP "d41" JD- FR_THICKNESS - FR_THICKNESS - 0.18
			SET_MDL_PARAM COMP "d40" SIDE_LITE_MULLION - .625
			
			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			
		REGEN_MDL FRAME_ASM

		DECLARE_VARIABLE INTEGER IDX
		IDX = 1
		SEARCH_MDL_REFS RECURSIVE ASSEM COMPONENT "GLAZING_STOP*" GLAZING_STOPS
		GET_ARRAY_SIZE GLAZING_STOPS SIZE
		PRINT "%" SIZE
		FOR GLAZING_STOP REF ARRAY GLAZING_STOPS
			SET_MDL_PARAM GLAZING_STOP "WIDTH" GLASS_STOP_WIDTH
			REGEN_MDL GLAZING_STOP
			COPY_MDL GLAZING_STOP "GS-"+ITEM_NUM+ "-" + itos(IDX) refNewStop

			SEARCH_MDL_REFS GLAZING_STOP DIMENSION "*" COMPDIMS
			GET_ARRAY_SIZE COMPDIMS SIZE
			PRINT "%" SIZE
			FOR COMPDIM REF ARRAY COMPDIMS
				GET_REF_NAME COMPDIM name
				SEARCH_MDL_PARAM GLAZING_STOP name CompValue
				PRINT "% % " name CompValue
				SET_MDL_PARAM refNewStop name CompValue
			END_FOR
			REPLACE_COMPONENT GLAZING_STOP refNewStop
			SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "GS-"+ITEM_NUM+ "-" + itos(IDX) NewStopRef
			REGEN_MDL NewStopRef

				SEARCH_MDL_REF NewStopRef AXIS "HOLE_AXIS" HOLE_AXIS
				SEARCH_MDL_REF NewStopRef PLANE "HOLES" HOLES
				CREATE_UDF udf\glazing_stop_hole FRAME_ASM STOP_HOLE
					UDF_REF SURF HOLES
					UDF_REF AX HOLE_AXIS
					UDF_INTERSECTION * PART_LEVEL
					UDF_EXP_REF HOLE FEATURE 0
				END_CREATE_UDF

				UNGROUP_FEATURES STOP_HOLE
				CREATE_REF_PATTERN  HOLE
			! UNSET_FLEXIBLE NewStopRef
			IDX++
		END_FOR		
	END_IF

	IF OPENING_TYPE == 4 AND BORROWED_LITE_TRIM_TYPE == 1
		SET_MDL_PARAM SECT_SKETCH "GLAZING_STOP_WIDTH" GLASS_STOP_WIDTH
		SET_MDL_PARAM SECT_SKETCH "GLAZING_SPACE" GLASS_THICKNESS + .125

		SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "GLAZING_STOPS" refFeat
		SET_FEATURE_STATE refFeat RESUMED
	END_IF

	IF (ANCHOR_TYPE <= 4 AND ANCHOR_TYPE >= 9) AND ANCHOR_TYPE <> 99
		SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "RECESS" refFeat
			SET_FEATURE_STATE refFeat SUPPRESSED
	END_IF

!X	! IF ANCHOR_TYPE <> 8 AND ANCHOR_TYPE <> 9 AND ANCHOR_TYPE <> 99
		! SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "ANCHORCTR" refFeat
			! SET_FEATURE_STATE refFeat SUPPRESSED
	! END_IF

	! IF HINGE_TYPE <> "NONE" AND HINGE_TYPE <> "HALF_MORTISE" AND HINGE_TYPE <> "ELIASON" AND HINGE_TYPE <> ""
		! IF SUB_TYPE == "S"
			! IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
			  ! HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HINGE2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
			! END_IF

			! IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
			  ! HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HINGE1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
			! END_IF
		! ELSE_IF SUB_TYPE == "P"
				! SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HINGE1" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
				! SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HINGE2" refFeat
				! SET_FEATURE_STATE refFeat RESUMED
		! END_IF
	! END_IF

	IF HINGE_TYPE == "HALF_MORTISE"
		IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
		  HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HINGE4" refFeat
			SET_FEATURE_STATE refFeat RESUMED

			IF FACEE >= 2
				SET_MDL_PARAM SECT_SKETCH "HM4" 1.625
			ELSE
				SET_MDL_PARAM SECT_SKETCH "HM4" FACEE - .375
			END_IF
		END_IF

		IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
		  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HINGE3" refFeat
			SET_FEATURE_STATE refFeat RESUMED

			IF FACEE >= 2
				SET_MDL_PARAM SECT_SKETCH "HM3" 1.625
			ELSE
				SET_MDL_PARAM SECT_SKETCH "HM3" FACEE - .375
			END_IF
		END_IF
	END_IF

	IF CLOSED_BACK == 1
		SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "CLOSED_BACK" refFeat
		SET_FEATURE_STATE refFeat RESUMED
		SET_MDL_PARAM SECT_SKETCH "CB" JD - RETURN - RETURN - .25
	END_IF

	REGEN_MDL ASSEM FORCE
	REGEN_MDL ASSEM FORCE

	IF FRAME_CONSTRUCTION == "FACE WELDED" OR (FRAME_CONSTRUCTION == "KNOCK DOWN" AND ANCHOR_TYPE <> 11)
		IF SECTION == 0
			SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "*TAB*" refFeats
				FOR refFeat REF ARRAY refFeats
					SET_FEATURE_STATE refFeat RESUMED
				END_FOR
		ELSE
			IF SECTION == 1
				SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "*TAB**" refFeats
					FOR refFeat REF ARRAY refFeats
						SET_FEATURE_STATE refFeat RESUMED
					END_FOR
			END_IF

			IF SECTION == 2 OR SECTION == 21
				SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "*TAB*" refFeats
					FOR refFeat REF ARRAY refFeats
						SET_FEATURE_STATE refFeat RESUMED
					END_FOR

				! SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "*TAB_SOFFIT*" refFeats
					! FOR refFeat REF ARRAY refFeats
						! SET_FEATURE_STATE refFeat RESUMED
					! END_FOR
				IF XRABBET < .75
					SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "*TAB*XRABBET*" refFeats
						FOR refFeat REF ARRAY refFeats
							SET_FEATURE_STATE refFeat SUPPRESSED
						END_FOR
				END_IF
			END_IF
		END_IF
	END_IF

	IF FRAME_CONSTRUCTION == "FULLY WELDED"
		SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "WELD" refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat RESUMED
			END_FOR
	END_IF

	IF FRAME_CONSTRUCTION == "KNOCK DOWN"
		IF  ANCHOR_TYPE == 11
			IF SECTION == 0 OR SECTION == 1
				SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "KD*" refFeats
					FOR refFeat REF ARRAY refFeats
						SET_FEATURE_STATE refFeat RESUMED
					END_FOR
			END_IF

			IF SECTION == 2 OR SECTION == 21
				IF RABBET >= .75
					SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "KD_RABBET" refFeats
						FOR refFeat REF ARRAY refFeats
							SET_FEATURE_STATE refFeat RESUMED
						END_FOR
				END_IF
				IF XRABBET >= .75
					SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "KD_XRABBET" refFeats
						FOR refFeat REF ARRAY refFeats
							SET_FEATURE_STATE refFeat RESUMED
						END_FOR
				END_IF
				IF SOFFIT >= 3
					SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "KD_SOFFIT" refFeats
						FOR refFeat REF ARRAY refFeats
							SET_FEATURE_STATE refFeat RESUMED
						END_FOR
				END_IF
			END_IF
		END_IF

		SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED FRAME_ASM FEATURE "KD_HOLES" refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat RESUMED
			END_FOR

		IF SECTION == 0 OR SECTION == 2 OR SECTION == 21
			SEARCH_MDL_REF FRAME_ASM CSYS "KD_CLIP" ATTACH
			INVALIDATE_REF COMP
			RETRIEVE_MDL KD_CORNER.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT*" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			SET_MDL_PARAM COMP "d41" FACEE -.25
			SET_MDL_PARAM COMP "d40" HEAD - .25

			IF DW_RTRN == "NO"
				SET_MDL_PARAM COMP "d51" RETURN - FR_THICKNESS
			ELSE
				SET_MDL_PARAM COMP "d51" RETURN - FR_THICKNESS - FR_THICKNESS - .03
			END_IF

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

		END_IF

		IF SECTION == 1
			SEARCH_MDL_REF FRAME_ASM CSYS "KD_CLIP" ATTACH
			RETRIEVE_MDL KD_CORNER.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT*" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			SET_MDL_PARAM COMP "d41" FACEE - .25
			SET_MDL_PARAM COMP "d40" HEAD - .25

			IF DW_RTRN == "NO"
				SET_MDL_PARAM COMP "d51" RETURN - FR_THICKNESS
			ELSE
				SET_MDL_PARAM COMP "d51" RETURN - FR_THICKNESS - FR_THICKNESS - .03
			END_IF

				CALL_EX instantiate.tab
					VAR_INOUT	COMP	COMP
				END_CALL_EX

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			RETRIEVE_MDL KD_CORNER.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT*" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			SET_MDL_PARAM COMP "d41" XFACEE - .25
			SET_MDL_PARAM COMP "d40" XHEAD - .25

			IF DW_RTRN == "NO"
				SET_MDL_PARAM COMP "d51" XRETURN - FR_THICKNESS
			ELSE
				SET_MDL_PARAM COMP "d51" XRETURN - FR_THICKNESS - FR_THICKNESS - .03
			END_IF

				CALL_EX instantiate.tab
					VAR_INOUT	COMP	COMP
				END_CALL_EX

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
		END_IF
	END_IF

	IF DW_RTRN <> "NO"
		SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED ASSEM FEATURE "DW*"+DW_RTRN refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat RESUMED
			END_FOR
	END_IF

	IF XDW_RTRN <> "NO"
		SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED ASSEM FEATURE "XDW*"+XDW_RTRN refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat RESUMED
			END_FOR
	END_IF

	! IF SUB_TYPE == "P"
		! SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
		! SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

		! CREATE_UDF udf\csys FRAME_ASM
			! UDF_REF ATTACH ASM_CSYS
			! UDF_DIM	ROTX 0
			! UDF_DIM	ROTY 0
			! UDF_DIM	ROTZ 0
			! UDF_DIM	LOCX DOOR_CTR
			! UDF_DIM	LOCY 0
			! UDF_DIM	LOCZ 0
			! UDF_EXP_REF DOOR_CTR_CSYS CSYS 0
		! END_CREATE_UDF
	! END_IF


	IF SECTION == 2 AND FLOOR_CLIPS == "INVERTED"
		SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB1 FEATURE "INVERTED_FLOOR_CLIP" refFeat
			SET_FEATURE_STATE refFeat RESUMED
		SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB2 FEATURE "INVERTED_FLOOR_CLIP" refFeat
			SET_FEATURE_STATE refFeat RESUMED
	END_IF

	IF HOSPITAL_STOPS == 1
		SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB1 FEATURE "*HOSPITAL*" refFeat1
			SET_FEATURE_STATE refFeat1 RESUMED
			SET_MDL_PARAM JAMB1 "HOSPITAL_STOPS_HEIGHT" HOSPITAL_STOPS_HEIGHT
			SET_MDL_PARAM JAMB1 "HOSPITAL_STOPS_ANGLE" HOSPITAL_STOPS_ANGLE

		SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB2 FEATURE "*HOSPITAL*" refFeat2
			SET_FEATURE_STATE refFeat2 RESUMED
			SET_MDL_PARAM JAMB2 "HOSPITAL_STOPS_HEIGHT" HOSPITAL_STOPS_HEIGHT
			SET_MDL_PARAM JAMB2 "HOSPITAL_STOPS_ANGLE" HOSPITAL_STOPS_ANGLE

		SEARCH_MDL_REF ALLOW_SUPPRESSED FRAME_TEMPLATE FEATURE "*HOSPITAL*" refFeat3
			SET_FEATURE_STATE refFeat3 RESUMED
			SET_MDL_PARAM FRAME_TEMPLATE "HOSPITAL_STOPS_HEIGHT" HOSPITAL_STOPS_HEIGHT
			SET_MDL_PARAM FRAME_TEMPLATE "HOSPITAL_STOPS_ANGLE" HOSPITAL_STOPS_ANGLE

		REGEN_MDL ASSEM FORCE
		REGEN_MDL ASSEM FORCE

		SEARCH_MDL_REF JAMB1 CSYS "HOSPITAL_STOP*" ATTACH
		RETRIEVE_MDL HOSPITAL_STOP_FILLER.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT*" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE


		SET_MDL_PARAM COMP "GRADE" FRAME_GRADE
		SET_MDL_PARAM COMP "FINISH" FRAME_FINISH

		SEARCH_MDL_PARAM JAMB1 "FILLER_WIDTH" FILLER_WIDTH
		SEARCH_MDL_PARAM JAMB1 "FILLER_LENGTH" FILLER_LENGTH

		SET_MDL_PARAM COMP "d42" FILLER_WIDTH
		SET_MDL_PARAM COMP "d43" FILLER_LENGTH
		SET_MDL_PARAM COMP "SMT_THICKNESS" FR_THICKNESS

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX

		SEARCH_MDL_REF JAMB2 CSYS "HOSPITAL_STOP*" ATTACH

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE

	END_IF

	REGEN_MDL ASSEM FORCE

	IF FULL_HEAD_REINFORCEMENT == 1
		IF SECTION == 2 OR SECTION == 21
			IF STD_REV == "STD"
				SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HEAD_ANGLE_STD" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF
			IF STD_REV == "REV"
				SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HEAD_ANGLE_REV" refFeat
				SET_FEATURE_STATE refFeat RESUMED
			END_IF

			IF XRABBET > 1.5 + FR_THICKNESS + .06
				SET_MDL_PARAM SECT_SKETCH "XRABBET_LEG" 1.5
			ELSE
				SET_MDL_PARAM SECT_SKETCH "XRABBET_LEG" XRABBET - FR_THICKNESS - .06
			END_IF

			IF XFACEE > 1.5 + FR_THICKNESS + FR_THICKNESS
				SET_MDL_PARAM SECT_SKETCH "XFACEE_LEG" 1.5
			ELSE
				SET_MDL_PARAM SECT_SKETCH "XFACEE_LEG" XFACEE - FR_THICKNESS - FR_THICKNESS - .06
			END_IF

			SEARCH_MDL_REF FRAME_ASM CSYS "CLSR" CLSR_REF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CLSR_REF
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY JD - FR_THICKNESS - .03
					UDF_DIM	LOCZ FR_THICKNESS + .03
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

			RETRIEVE_MDL HEAD_ANGLE.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				IF XRABBET > 1.5 + FR_THICKNESS + .06
					SET_MDL_PARAM COMP "XRABBET_LEG" 1.5
				ELSE
					SET_MDL_PARAM COMP "XRABBET_LEG" XRABBET - FR_THICKNESS - .06
				END_IF

				IF XFACEE > 1.5 + FR_THICKNESS + FR_THICKNESS
					SET_MDL_PARAM COMP "XFACEE_LEG" 1.5
				ELSE
					SET_MDL_PARAM COMP "XFACEE_LEG" XFACEE - FR_THICKNESS - FR_THICKNESS - .06
				END_IF

				SET_MDL_PARAM COMP "LENGTH" JOW - 1.5

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		END_IF

		IF SECTION == 1 OR SECTION == 11
			SEARCH_MDL_REF ALLOW_SUPPRESSED SECT_SKETCH FEATURE "HEAD_ANGLE" refFeat
				SET_FEATURE_STATE refFeat RESUMED

			IF XRABBET > 1.5 + FR_THICKNESS + .06
				SET_MDL_PARAM SECT_SKETCH "XRABBET_LEG" 1.5
			ELSE
				SET_MDL_PARAM SECT_SKETCH "XRABBET_LEG" XRABBET - FR_THICKNESS - .06
			END_IF

			IF XFACEE > 1.5 + FR_THICKNESS + FR_THICKNESS
				SET_MDL_PARAM SECT_SKETCH "XFACEE_LEG" 1.5
			ELSE
				SET_MDL_PARAM SECT_SKETCH "XFACEE_LEG" XFACEE - FR_THICKNESS - FR_THICKNESS - .06
			END_IF

			SEARCH_MDL_REF FRAME_ASM CSYS "CLSR" CLSR_REF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CLSR_REF
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX - HEAD_STOPP + FR_THICKNESS + .03
					UDF_DIM	LOCY JD - FR_THICKNESS - .03
					UDF_DIM	LOCZ FR_THICKNESS + .03
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

			RETRIEVE_MDL HEAD_ANGLE.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
				SET_ON_LAYER COMP "COMPONENTS"

				IF XRABBET > 1.5 + FR_THICKNESS + .06
					SET_MDL_PARAM COMP "XRABBET_LEG" 1.5
				ELSE
					SET_MDL_PARAM COMP "XRABBET_LEG" XRABBET - FR_THICKNESS - .06
				END_IF

				IF XFACEE > 1.5 + FR_THICKNESS + FR_THICKNESS
					SET_MDL_PARAM COMP "XFACEE_LEG" 1.5
				ELSE
					SET_MDL_PARAM COMP "XFACEE_LEG" XFACEE - FR_THICKNESS - FR_THICKNESS - .06
				END_IF

				SET_MDL_PARAM COMP "LENGTH" JOW - 1.5

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		END_IF
	END_IF

	IF HINGE_TYPE == "BUTT"
		CALL hinge_butt_frame.tab
	END_IF

	IF CLOSED_BACK == 1
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2) - FACEE + FR_THICKNESS
			UDF_DIM	LOCY (JOH+HEAD)/2
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL BU_FLAT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT4" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER COMP "COMPONENTS"

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" "999"
		SET_MDL_PARAM COMP "EMJACDESC" "CLOSED BACK"
		SET_MDL_PARAM COMP "d41" JOH+HEAD
		SET_MDL_PARAM COMP "d40" JD-RETURN-XRETURN
		SET_MDL_PARAM COMP "SMT_THICKNESS" FR_THICKNESS

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			SET_ON_LAYER COMP "COMPONENTS"

			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (JOW/2) + FACEE
			UDF_DIM	LOCY (JOH+HEAD)/2
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL BU_FLAT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT4" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER COMP "COMPONENTS"

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" "999"
		SET_MDL_PARAM COMP "EMJACDESC" "CLOSED BACK"
		SET_MDL_PARAM COMP "d41" JOH+HEAD
		SET_MDL_PARAM COMP "d40" JD-RETURN-XRETURN
		SET_MDL_PARAM COMP "SMT_THICKNESS" FR_THICKNESS

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			SET_ON_LAYER COMP "COMPONENTS"

			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY JOH + HEAD
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL BU_FLAT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT4" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER COMP "COMPONENTS"

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" "999"
		SET_MDL_PARAM COMP "EMJACDESC" "CLOSED BACK"
		SET_MDL_PARAM COMP "d41" JOW+FACEE+FACEE-FR_THICKNESS-FR_THICKNESS
		SET_MDL_PARAM COMP "d40" JD-RETURN-XRETURN
		SET_MDL_PARAM COMP "SMT_THICKNESS" FR_THICKNESS

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			SET_ON_LAYER COMP "COMPONENTS"

	END_IF

	IF (PRIMARY_STRIKE_TYPE == 1 OR PRIMARY_STRIKE_TYPE == 2 OR PRIMARY_STRIKE_TYPE == 3) AND SUB_TYPE == "S"
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
			UDF_DIM	STRIKE_LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
			UDF_DIM	STRIKE_LIP_DEPTH PRIMARY_STRIKE_LIP_THICKNESS
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
			UDF_DIM	STRIKE_LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
			UDF_DIM	STRIKE_LIP_DEPTH PRIMARY_STRIKE_LIP_THICKNESS
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE STRIKE FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
		LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == PRIMARY_STRIKE_HEIGHT" INST_NAME
		GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
		REPLACE_COMPONENT STRIKE STRIKE_INST
		SET_ON_LAYER STRIKE "COMPONENTS"

		IF PRIMARY_STRIKE_DESC == "ELECTRIC"
			RETRIEVE_MDL DUST_BOX_ELEC_STRIKE.PRT PRT
			SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE PRT FRAME_ASM
				CSYS refCsys PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER PRT "COMPONENTS"
		END_IF

		IF PRIMARY_STRIKE_DESC <> "ELECTRIC" AND DUST_BOXES == 1
			RETRIEVE_MDL DUST_BOX.PRT PRT
			SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE PRT FRAME_ASM
				CSYS refCsys PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER PRT "COMPONENTS"
		END_IF

	END_IF

	IF PRIMARY_STRIKE_DESC == "RIM" AND PRIMARY_STRIKE_TYPE == 4 AND SUB_TYPE == "S"
		DECLARE_VARIABLE DOUBLE TEMP_VALUE
		IF SOFFIT < 1.875
			TEMP_VALUE = SOFFIT - .25
		ELSE
			TEMP_VALUE = 1.625
		END_IF

		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2) + STOPP - FR_THICKNESS - .125
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2) - RABBET - .125 - (TEMP_VALUE/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2) - STOPP + FR_THICKNESS + .125
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2) - RABBET - .125 - (TEMP_VALUE/2)
			UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL BU_FLAT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT4" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
			SET_ON_LAYER COMP "COMPONENTS"

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" "999"
		SET_MDL_PARAM COMP "EMJACDESC" "RIM STRIKE REINFORCEMENT"
		SET_MDL_PARAM COMP "d41" 12
		SET_MDL_PARAM COMP "d40" TEMP_VALUE
		SET_MDL_PARAM COMP "SMT_THICKNESS" 0.105

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX
			SET_ON_LAYER COMP "COMPONENTS"
	END_IF

	IF PRIMARY_STRIKE_UDF == "STRIKE_VD_6111" AND SUB_TYPE == "S"
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
				CREATE_UDF udf\csys FRAME_ASM
				UDF_REF	ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(JOW/2)+STOPP
				UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
				UDF_DIM	LOCZ (JD/2)
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			SEARCH_MDL_REF JAMB2 SURFACE "STOPP" STOPP

			CREATE_UDF udf\strike_vd_6111 JAMB2
				UDF_REF	ATTACH refCsys
				UDF_REF	STOPP	STOPP
				UDF_DIM	BACKSET	RABBET+PRIMARY_STRIKE_BACKSET
				UDF_DIM	DEPTH 	(FR_THICKNESS+.03)*2
				UDF_DIM	FLAT_1	FR_THICKNESS+.03
				UDF_DIM	FLAT_2	FR_THICKNESS+.03
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 180
				UDF_DIM	LOCX (JOW/2)-STOPP
				UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
				UDF_DIM	LOCZ (JD/2)
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			SEARCH_MDL_REF JAMB1 SURFACE "STOPP" STOPP

			CREATE_UDF udf\strike_vd_6111 JAMB1
				UDF_REF	ATTACH refCsys
				UDF_REF	STOPP	STOPP
				UDF_DIM	BACKSET	RABBET+PRIMARY_STRIKE_BACKSET
				UDF_DIM	DEPTH 	(FR_THICKNESS+.03)*2
				UDF_DIM	FLAT_1	FR_THICKNESS+.03
				UDF_DIM	FLAT_2	FR_THICKNESS+.03
			END_CREATE_UDF
		END_IF


		RETRIEVE_MDL VD_6111.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE STRIKE FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
		SET_ON_LAYER STRIKE "COMPONENTS"
		SET_MDL_PARAM STRIKE "STRIKE_BACKSET" PRIMARY_STRIKE_BACKSET + RABBET
	END_IF

	IF PRIMARY_STRIKE_TYPE == 6 OR PRIMARY_STRIKE_TYPE == 7 OR PRIMARY_STRIKE_TYPE == 8
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike-d FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike-d FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE STRIKE FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
		LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == PRIMARY_STRIKE_HEIGHT" INST_NAME
		GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
		REPLACE_COMPONENT STRIKE STRIKE_INST
		! SET_ON_LAYER STRIKE_INST "COMPONENTS"
	END_IF

	IF SECONDARY_STRIKE_TYPE == 6 OR SECONDARY_STRIKE_TYPE == 7 OR SECONDARY_STRIKE_TYPE == 8
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY SECONDARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike-d FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH SECONDARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT SECONDARY_STRIKE_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY SECONDARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike-d FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH SECONDARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT SECONDARY_STRIKE_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE STRIKE FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
		LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == SECONDARY_STRIKE_HEIGHT" INST_NAME
		GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
		REPLACE_COMPONENT STRIKE STRIKE_INST
		! SET_ON_LAYER STRIKE_INST "COMPONENTS"
	END_IF



	IF SILENCERS == 1
		SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
		IF SUB_TYPE == "S"
			IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
			   HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) - (STOPP/2)
					UDF_DIM	LOCY JOH - 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH FR_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) - (STOPP/2)
					UDF_DIM	LOCY JOH/2
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH FR_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) - (STOPP/2)
					UDF_DIM	LOCY 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH FR_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
			END_IF
			IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
			  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
					UDF_DIM	LOCY JOH - 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH FR_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
					UDF_DIM	LOCY JOH/2
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH FR_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
					UDF_DIM	LOCY 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH FR_THICKNESS
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
			END_IF
		END_IF
		IF SUB_TYPE == "P"
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH DOOR_CTR_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 90
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 6
				UDF_DIM	LOCY JOH - (HEAD_STOPP/2)
				UDF_DIM	LOCZ (JD/2) - RABBET
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\hole FRAME_ASM
				UDF_REF ATTACH refCsys
				UDF_DIM	DIA SILENCER_HOLE_DIA
				UDF_DIM	DEPTH FR_THICKNESS
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH DOOR_CTR_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 90
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -6
				UDF_DIM	LOCY JOH - (HEAD_STOPP/2)
				UDF_DIM	LOCZ (JD/2) - RABBET
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\hole FRAME_ASM
				UDF_REF ATTACH refCsys
				UDF_DIM	DIA SILENCER_HOLE_DIA
				UDF_DIM	DEPTH FR_THICKNESS
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF
	END_IF

	! BEGIN FRAME PREPS - CONTINUOUS HINGE
	IF HINGE_TYPE == "CONTINUOUS" AND CONTINUOUS_HINGE_REINFORCEMENT == 1
		IF SUB_TYPE == "S"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" CHR_ATTACH
			IF HAND == "RH" OR HAND == "LHR"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CHR_ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS
					UDF_DIM	LOCY JOH -.125
					UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF
			IF HAND == "LH" OR HAND == "RHR"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CHR_ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) + FR_THICKNESS
					UDF_DIM	LOCY JOH -.125
					UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" "999"
			SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
			SET_MDL_PARAM COMP "d40" 1.5625
			SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
			SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
			SET_FEATURE_STATE refFeat SUPPRESSED

			IF EPT <> 1
				SET_MDL_PARAM COMP "d41" JOH - .25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

			ELSE_IF EPT == 1
				SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) -.25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -EPT_CTR - (EPT_LENGTH/2)
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" "999"
				SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
				SET_MDL_PARAM COMP "d41" JOH - EPT_CTR - (EPT_LENGTH/2) -.25
				SET_MDL_PARAM COMP "d40" 1.5625
				SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
				SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
				SET_FEATURE_STATE refFeat SUPPRESSED

					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
					SET_ON_LAYER COMP "COMPONENTS"
			END_IF
		END_IF

		IF SUB_TYPE == "P"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" CHR_ATTACH
			IF STD_REV == "STD"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CHR_ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) + FR_THICKNESS
					UDF_DIM	LOCY JOH -.125
					UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF
			IF STD_REV == "REV"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CHR_ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS
					UDF_DIM	LOCY JOH -.125
					UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" "999"
			SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
			SET_MDL_PARAM COMP "d40" 1.5625
			SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
			SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
			SET_FEATURE_STATE refFeat SUPPRESSED

			IF EPT <> 1 AND EPT <> 3
				SET_MDL_PARAM COMP "d41" JOH - .25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

			ELSE_IF EPT == 1 OR EPT == 3
				SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) -.25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -EPT_CTR - (EPT_LENGTH/2)
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" "999"
				SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
				SET_MDL_PARAM COMP "d41" JOH - EPT_CTR - (EPT_LENGTH/2) -.25
				SET_MDL_PARAM COMP "d40" 1.5625
				SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
				SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
				SET_FEATURE_STATE refFeat SUPPRESSED

					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
					SET_ON_LAYER COMP "COMPONENTS"
			END_IF

			IF STD_REV == "REV"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CHR_ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) + FR_THICKNESS
					UDF_DIM	LOCY JOH -.125
					UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF
			IF STD_REV == "STD"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CHR_ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS
					UDF_DIM	LOCY JOH -.125
					UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF
			END_IF

			RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" "999"
			SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
			SET_MDL_PARAM COMP "d40" 1.5625
			SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
			SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
			SET_FEATURE_STATE refFeat SUPPRESSED

			IF EPT <> 2 AND EPT <> 3
				SET_MDL_PARAM COMP "d41" JOH - .25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

			ELSE_IF EPT == 2
				SET_MDL_PARAM COMP "d41" EPT_CTR - (EPT_LENGTH/2) -.25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -EPT_CTR - (EPT_LENGTH/2)
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" "999"
				SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
				SET_MDL_PARAM COMP "d41" JOH - EPT_CTR - (EPT_LENGTH/2) -.25
				SET_MDL_PARAM COMP "d40" 1.5625
				SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
				SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
				SET_FEATURE_STATE refFeat SUPPRESSED

					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
					SET_ON_LAYER COMP "COMPONENTS"
					
			ELSE_IF EPT == 3
				SET_MDL_PARAM COMP "d41" EPT_2_CTR - (EPT_2_LENGTH/2) -.25
					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX

				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY -EPT_2_CTR - (EPT_2_LENGTH/2)
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

					ASSEMBLE COMP FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SET_MDL_PARAM COMP "STOCKTYPE" 1
				SET_MDL_PARAM COMP "EMJACNUM" "999"
				SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
				SET_MDL_PARAM COMP "d41" JOH - EPT_2_CTR - (EPT_2_LENGTH/2) -.25
				SET_MDL_PARAM COMP "d40" 1.5625
				SET_MDL_PARAM COMP "SMT_THICKNESS" 0.075
				SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
				SET_FEATURE_STATE refFeat SUPPRESSED

					CALL_EX instantiate.tab
						VAR_IN	COMP	COMP
					END_CALL_EX
					SET_ON_LAYER COMP "COMPONENTS"
			END_IF
		END_IF
	END_IF

	! END FRAME PREPS - CONTINUOUS HINGE

	! BEGIN FRAME PREPS - ELIASON HINGE
	IF HINGE_TYPE == "ELIASON"
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 180
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2) + FR_THICKNESS + .25
			UDF_DIM	LOCY JOH
			UDF_DIM	LOCZ (JD/2) - ANCHOR_CTR
			UDF_EXP_REF ATTACH1 CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL ELIASON_REINF.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH1 PLACEMENT
			END_ASSEMBLE

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" ""
		SET_MDL_PARAM COMP "d41" 6
		SET_MDL_PARAM COMP "d40" JD-.5

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX

		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 180
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY JOH + FR_THICKNESS + .25
			UDF_DIM	LOCZ (JD/2) - ANCHOR_CTR
			UDF_EXP_REF ATTACH1 CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL ELIASON_REINF.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH1 PLACEMENT
			END_ASSEMBLE

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" ""
		SET_MDL_PARAM COMP "d41" 12
		SET_MDL_PARAM COMP "d40" JD-.5

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX

		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX (JOW/2) + FR_THICKNESS + .25
			UDF_DIM	LOCY 24
			UDF_DIM	LOCZ (JD/2) - ANCHOR_CTR
			UDF_EXP_REF ATTACH1 CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL ELIASON_REINF.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH1 PLACEMENT
			END_ASSEMBLE

		SET_MDL_PARAM COMP "STOCKTYPE" 1
		SET_MDL_PARAM COMP "EMJACNUM" ""
		SET_MDL_PARAM COMP "d41" 24
		SET_MDL_PARAM COMP "d40" JD-.5

			CALL_EX instantiate.tab
				VAR_IN	COMP	COMP
			END_CALL_EX

		IF SUB_TYPE == "P"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS - .25
				UDF_DIM	LOCY JOH
				UDF_DIM	LOCZ (JD/2) - ANCHOR_CTR
				UDF_EXP_REF ATTACH1 CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL ELIASON_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH1 PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" ""
			SET_MDL_PARAM COMP "d41" 6
			SET_MDL_PARAM COMP "d40" JD-.5

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 270
				UDF_DIM	LOCX -(JOW/2)
				UDF_DIM	LOCY JOH + FR_THICKNESS + .25
				UDF_DIM	LOCZ (JD/2) - ANCHOR_CTR
				UDF_EXP_REF ATTACH1 CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL ELIASON_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH1 PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" ""
			SET_MDL_PARAM COMP "d41" 12
			SET_MDL_PARAM COMP "d40" JD-.5

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX

			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS - .25
				UDF_DIM	LOCY 24
				UDF_DIM	LOCZ (JD/2) - ANCHOR_CTR
				UDF_EXP_REF ATTACH1 CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL ELIASON_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH1 PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" ""
			SET_MDL_PARAM COMP "d41" 24
			SET_MDL_PARAM COMP "d40" JD-.5

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		END_IF
	END_IF
	! END FRAME PREPS - ELIASON HINGE

	! BEGIN FRAME PREPS - HALF MORTISE HINGE
	IF HINGE_TYPE == "HALF_MORTISE"
		IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
		  HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 90
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(JOW/2) - (FACEE/2) +.0625
				UDF_DIM	LOCY JOH
				UDF_DIM	LOCZ (JD/2) - .25
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" "999"
			SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
			SET_MDL_PARAM COMP "d41" JOH - 1

			IF FACEE >= 2
				SET_MDL_PARAM COMP "d40" 1.625
			ELSE
				SET_MDL_PARAM COMP "d40" FACEE - .375
			END_IF

			SET_MDL_PARAM COMP "SMT_THICKNESS" 0.105
			SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
			SET_FEATURE_STATE refFeat SUPPRESSED

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		END_IF

		IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
		  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 90
				UDF_DIM	ROTZ 180
				UDF_DIM	LOCX (JOW/2) + (FACEE/2) - .0625
				UDF_DIM	LOCY JOH
				UDF_DIM	LOCZ (JD/2) - .25
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL CONT_HINGE_REINF.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE COMP FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

			SET_MDL_PARAM COMP "STOCKTYPE" 1
			SET_MDL_PARAM COMP "EMJACNUM" "999"
			SET_MDL_PARAM COMP "EMJACDESC" "CONT HINGE REINT"
			SET_MDL_PARAM COMP "d41" JOH - 1

			IF FACEE >= 2
				SET_MDL_PARAM COMP "d40" 1.625
			ELSE
				SET_MDL_PARAM COMP "d40" FACEE - .375
			END_IF

			SET_MDL_PARAM COMP "SMT_THICKNESS" 0.105
			SEARCH_MDL_REF ALLOW_SUPPRESSED COMP FEATURE FID:727 refFeat
			SET_FEATURE_STATE refFeat SUPPRESSED

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
		END_IF
	END_IF
	! END FRAME PREPS - HALF MORTISE HINGE

	IF (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) AND SUB_TYPE == "P"
		IF STD_REV == "STD"
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH DOOR_CTR_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 180
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY JOH + FR_THICKNESS +.01
				UDF_DIM	LOCZ 0
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
		ELSE_IF STD_REV == "REV"
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH DOOR_CTR_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY JOH + FR_THICKNESS +.01
				UDF_DIM	LOCZ 0
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
		END_IF

		SET_REF_NAME refCsys FBREF

		CREATE_UDF udf\rect_cut FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	DIMY .25
			UDF_DIM	DIMZ 1.015
			UDF_DIM	DIMX 3.515
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
		RETRIEVE_MDL FLUSH_BOLT_HEAD_ASM.ASM FLBLT
		SEARCH_MDL_REF FLBLT CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE FLBLT FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE

		IF DUST_BOXES == 1
			IF ANCHOR_TYPE <> 8 AND ANCHOR_TYPE <> 9
				RETRIEVE_MDL DUST_BOX_FB.PRT COMP
				SEARCH_MDL_REF COMP CSYS "FB_PLACEMENT" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS refCsys PLACEMENT
				END_ASSEMBLE
			ELSE_IF (ANCHOR_TYPE == 8 OR ANCHOR_TYPE == 9) AND HEAD_ANCHORS == 0
				RETRIEVE_MDL DUST_BOX_FB.PRT COMP
				SEARCH_MDL_REF COMP CSYS "FB_PLACEMENT" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS refCsys PLACEMENT
				END_ASSEMBLE
			ELSE_IF (ANCHOR_TYPE == 8 OR ANCHOR_TYPE == 9) AND HEAD_ANCHORS == 1
				RETRIEVE_MDL DUST_BOX_FB_89.PRT COMP
				SEARCH_MDL_REF COMP CSYS "FB_PLACEMENT" PLACEMENT
				ASSEMBLE COMP FRAME_ASM
					CSYS refCsys PLACEMENT
				END_ASSEMBLE
			END_IF
		END_IF

	END_IF

	CALL anchors.tab

	IF CLOSER == 1 OR AUTO_OPERATOR == 1 OR MAG_LOCK == 1
		CALL closers.tab
	END_IF

	IF HOLDER_STOP == 1
		IF HS_TYPE == 2 OR HS_TYPE_2 == 2
			CALL holder_stop.tab
		END_IF
	END_IF

	IF DPS > 0
		CALL dps.tab
	END_IF

	IF EPT > 0
		CALL ept.tab
	END_IF

	IF HASP == 1
		CALL hasp.tab
	END_IF

	IF SUB_TYPE == "P" AND EXIT_MULLION == 1
		SEARCH_MDL_REF FRAME_ASM CSYS "CLSR" ATTACH

		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY RABBET+.1875
			UDF_DIM	LOCZ -STOPP+.25
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL SMCR.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT1" PLACEMENT
			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE

				SET_MDL_PARAM COMP "d41" 6
				SET_MDL_PARAM COMP "d40" SOFFIT - .375

				CALL_EX instantiate.tab
					VAR_IN	COMP	COMP
				END_CALL_EX
	END_IF

	IF SUB_TYPE == "P" AND (PRIMARY_STRIKE_TYPE == 81 OR PRIMARY_STRIKE_TYPE == 83)
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY JOH - STOPP + .1875
			UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .03
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL RIM_REINFORCEMENT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT5" PLACEMENT
			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
	END_IF

	IF SUB_TYPE == "P" AND (SURFACE_BOLTS == 1 OR SURFACE_BOLTS == 3) AND STD_REV == "REV"
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY JOH - STOPP + .1875
			UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .125
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL SURFACE_BOLT_REINFORCEMENT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "SURF_BOLT_NOTE" PLACEMENT
			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
	END_IF

	IF SUB_TYPE == "P" AND (SURFACE_BOLTS == 1 OR SURFACE_BOLTS == 3) AND STD_REV == "STD"
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ATTACH
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY JOH + 1
			UDF_DIM	LOCZ -(JD/2) + FR_THICKNESS + .125
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

		RETRIEVE_MDL SURFACE_BOLT_REINFORCEMENT.PRT COMP
		SEARCH_MDL_REF COMP CSYS "SURF_BOLT_NOTE" PLACEMENT
			ASSEMBLE COMP FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
	END_IF

	IF OPENING_TYPE == 4 AND BORROWED_LITE_TRIM_TYPE == 1 !TYPE "B" STOPS

		DECLARE_VARIABLE DOUBLE STOP_OFFSET
		STOP_OFFSET = -RABBET + GLASS_STOP_WIDTH + GLASS_THICKNESS +.125
		PRINT "%" STOP_OFFSET
		PRINT "%" RABBET
		PRINT "%" GLASS_THICKNESS
		PRINT "%" GLASS_STOP_WIDTH

		!SILL
		SEARCH_MDL_REF SILLL CSYS "PRT_CSYS_DEF" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ STOP_OFFSET
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL GLAZING_STOP.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				 CSYS ATTACH PLACEMENT
			END_ASSEMBLE

			SET_MDL_PARAM COMP	 "GRADE" FRAME_GRADE
			SET_MDL_PARAM COMP	 "FINISH" FRAME_FINISH

			IF HEAD_GRAIN == "HORIZONTAL"
				SET_MDL_PARAM COMP	 "GRAIN" 2
			ELSE_IF HEAD_GRAIN == "VERTICAL"
				SET_MDL_PARAM COMP	 "GRAIN" 1
			END_IF

			SET_MDL_PARAM COMP	 "SMT_THICKNESS" .05
			SET_MDL_PARAM COMP	 "d41" JOW - FRAME_WELD_ALLOWANCE - .03
			SET_MDL_PARAM COMP	 "d70" 1.9925
			SET_MDL_PARAM COMP	 "WIDTH" GLASS_STOP_WIDTH
			SET_MDL_PARAM COMP	 "HEIGHT" SILL_STOPP
			SET_MDL_PARAM COMP	 "MAX_HOLE_SPACE" MAX_GLAZING_HOLE_SPACE

		CALL_EX instantiate.tab
			VAR_IN	COMP	COMP
		END_CALL_EX

		SEARCH_MDL_REF COMP AXIS "HOLE_AXIS" HOLE_AXIS
		SEARCH_MDL_REF SILLL SURFACE "GLAZING_SURF" GLAZING_SURF
		CREATE_UDF udf\astragal_hole SILLL ASTRAGAL_HOLE
			UDF_REF SURF GLAZING_SURF
			UDF_REF AX HOLE_AXIS
			UDF_INTERSECTION * PART_LEVEL
			UDF_EXP_REF HOLE FEATURE 0
		END_CREATE_UDF

		UNGROUP_FEATURES ASTRAGAL_HOLE
		CREATE_REF_PATTERN  HOLE

		!HEAD
		SEARCH_MDL_REF HEAD CSYS "PRT_CSYS_DEF" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ STOP_OFFSET
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL GLAZING_STOP.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				 CSYS ATTACH PLACEMENT
			END_ASSEMBLE

			SET_MDL_PARAM COMP	 "GRADE" FRAME_GRADE
			SET_MDL_PARAM COMP	 "FINISH" FRAME_FINISH

			IF HEAD_GRAIN == "HORIZONTAL"
				SET_MDL_PARAM COMP	 "GRAIN" 2
			ELSE_IF HEAD_GRAIN == "VERTICAL"
				SET_MDL_PARAM COMP	 "GRAIN" 1
			END_IF

			SET_MDL_PARAM COMP	 "SMT_THICKNESS" .05
			SET_MDL_PARAM COMP	 "d41" JOW - FRAME_WELD_ALLOWANCE - .03
			SET_MDL_PARAM COMP	 "d70" 1.9925
			SET_MDL_PARAM COMP	 "WIDTH" GLASS_STOP_WIDTH
			SET_MDL_PARAM COMP	 "HEIGHT" HEAD_STOPP
			SET_MDL_PARAM COMP	 "MAX_HOLE_SPACE" MAX_GLAZING_HOLE_SPACE

		CALL_EX instantiate.tab
			VAR_IN	COMP	COMP
		END_CALL_EX

		SEARCH_MDL_REF COMP AXIS "HOLE_AXIS" HOLE_AXIS
		SEARCH_MDL_REF HEAD SURFACE "GLAZING_SURF" GLAZING_SURF
		CREATE_UDF udf\astragal_hole HEAD ASTRAGAL_HOLE
			UDF_REF SURF GLAZING_SURF
			UDF_REF AX HOLE_AXIS
			UDF_INTERSECTION * PART_LEVEL
			UDF_EXP_REF HOLE FEATURE 0
		END_CREATE_UDF

		UNGROUP_FEATURES ASTRAGAL_HOLE
		CREATE_REF_PATTERN  HOLE

		!JAMB1
		SEARCH_MDL_REF JAMB1 CSYS "PLACEMENT" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ STOP_OFFSET
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL GLAZING_STOP.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				 CSYS ATTACH PLACEMENT
			END_ASSEMBLE

			SET_MDL_PARAM COMP	 "GRADE" FRAME_GRADE
			SET_MDL_PARAM COMP	 "FINISH" FRAME_FINISH
			SET_MDL_PARAM COMP	 "GRAIN" 1
			SET_MDL_PARAM COMP	 "SMT_THICKNESS" .05
			SET_MDL_PARAM COMP	 "d41" JOH - HEAD_STOPP - SILL_STOPP - .03
			SET_MDL_PARAM COMP	 "d70" 1.9925 - STOPP
			SET_MDL_PARAM COMP	 "WIDTH" GLASS_STOP_WIDTH
			SET_MDL_PARAM COMP	 "HEIGHT" STOPP
			SET_MDL_PARAM COMP	 "MAX_HOLE_SPACE" MAX_GLAZING_HOLE_SPACE

		CALL_EX instantiate.tab
			VAR_IN	COMP	COMP
		END_CALL_EX

		SEARCH_MDL_REF COMP AXIS "HOLE_AXIS" HOLE_AXIS
		SEARCH_MDL_REF JAMB1 SURFACE "GLAZING_SURF" GLAZING_SURF
		CREATE_UDF udf\astragal_hole JAMB1 ASTRAGAL_HOLE
			UDF_REF SURF GLAZING_SURF
			UDF_REF AX HOLE_AXIS
			UDF_INTERSECTION * PART_LEVEL
			UDF_EXP_REF HOLE FEATURE 0
		END_CREATE_UDF

		UNGROUP_FEATURES ASTRAGAL_HOLE
		CREATE_REF_PATTERN  HOLE

		!JAMB2
		SEARCH_MDL_REF JAMB2 CSYS "PRT_CSYS_DEF" ATTACH
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY 0
				UDF_DIM	LOCZ STOP_OFFSET
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF

		RETRIEVE_MDL GLAZING_STOP.PRT COMP
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

			ASSEMBLE COMP FRAME_ASM
				 CSYS ATTACH PLACEMENT
			END_ASSEMBLE

			SET_MDL_PARAM COMP	 "GRADE" FRAME_GRADE
			SET_MDL_PARAM COMP	 "FINISH" FRAME_FINISH
			SET_MDL_PARAM COMP	 "GRAIN" 1
			SET_MDL_PARAM COMP	 "SMT_THICKNESS" .05
			SET_MDL_PARAM COMP	 "d41" JOH - HEAD_STOPP - SILL_STOPP - .03
			SET_MDL_PARAM COMP	 "d70" 1.9925 - STOPP
			SET_MDL_PARAM COMP	 "WIDTH" GLASS_STOP_WIDTH
			SET_MDL_PARAM COMP	 "HEIGHT" STOPP
			SET_MDL_PARAM COMP	 "MAX_HOLE_SPACE" MAX_GLAZING_HOLE_SPACE

		CALL_EX instantiate.tab
			VAR_IN	COMP	COMP
		END_CALL_EX

		SEARCH_MDL_REF COMP AXIS "HOLE_AXIS" HOLE_AXIS
		SEARCH_MDL_REF JAMB2 SURFACE "GLAZING_SURF" GLAZING_SURF
		CREATE_UDF udf\astragal_hole JAMB2 ASTRAGAL_HOLE
			UDF_REF SURF GLAZING_SURF
			UDF_REF AX HOLE_AXIS
			UDF_INTERSECTION * PART_LEVEL
			UDF_EXP_REF HOLE FEATURE 0
		END_CREATE_UDF

		UNGROUP_FEATURES ASTRAGAL_HOLE
		CREATE_REF_PATTERN  HOLE
	END_IF

	JOW = JOW-FRAME_WELD_ALLOWANCE

END_ASM_DESCR

