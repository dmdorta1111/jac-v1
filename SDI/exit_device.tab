BEGIN_GUI_DESCR
	SHOW_PARAM STRING PROCESS_MESSAGE
	
	SHOW_PARAM STRING LOCK_MANUFACTURER
	SHOW_PARAM STRING LOCK_DESC
	SHOW_PARAM DOUBLE LOCK_OFFSET
	SHOW_PARAM DOUBLE LOCK_BACKSET
	SHOW_PARAM DOUBLE LOCK_ARMOR_WIDTH
	SHOW_PARAM DOUBLE LOCK_ARMOR_HEIGHT
	SHOW_PARAM DOUBLE LOCK_ARMOR_THICKNESS
	SHOW_PARAM STRING LOCK_REINFORCEMENT
	SHOW_PARAM STRING LOCK_TRIM_MANUFACTURER
	SHOW_PARAM STRING LOCK_TRIM_DESC
	SHOW_PARAM DOUBLE LOCK_TRIM_OFFSET
	SHOW_PARAM DOUBLE LOCK_TRIM_BACKSET
	SHOW_PARAM STRING  LOCK_SHEET_NAME
	SHOW_PARAM INTEGER LOCK_ROW
	SHOW_PARAM STRING  LOCK_TRIM_SHEET_NAME
	SHOW_PARAM INTEGER LOCK_TRIM_ROW	
	! SHOW_PARAM INTEGER LOCK_TYPE
	! SHOW_PARAM STRING LOCK_MODEL
	! SHOW_PARAM STRING LOCK_UDF
	! SHOW_PARAM STRING LOCK_INST
	! SHOW_PARAM DOUBLE BEVEL_CALC
	! SHOW_PARAM STRING LOCK_TRIM
	! SHOW_PARAM STRING LOCK_TRIM_UDF
	! SHOW_PARAM STRING LOCK_TRIM_INST

	USER_INPUT_PARAM DOUBLE STRIKE_CENTER
	
	CHECKBOX_PARAM INTEGER VERIFY_STRIKE
	CHECKBOX_PARAM INTEGER SELECT_LOCK
	CHECKBOX_PARAM INTEGER SELECT_TRIM
	
END_GUI_DESCR

BEGIN_ASM_DESCR
	
	DECLARE_VARIABLE	INTEGER		LOCK_INDEX
	DECLARE_VARIABLE	INTEGER		EXCEL_LOCK_INFO 1
	DECLARE_VARIABLE	DOUBLE		BEVEL
	DECLARE_VARIABLE	DOUBLE		BEVEL_CALC
	DECLARE_VARIABLE	DOUBLE		DOOR_THICKNESS
	DECLARE_VARIABLE	INTEGER		OPERATION
	DECLARE_VARIABLE	DOUBLE		STOPP
	DECLARE_VARIABLE	STRING 		PROCESS_MESSAGE
	DECLARE_VARIABLE	INTEGER		UNEQUAL_EXITS
	DECLARE_VARIABLE	INTEGER		EXIT_MULLION
	DECLARE_VARIABLE	DOUBLE		MULLION_ADD_PER_DOOR	
	
	DECLARE_VARIABLE	STRING 		LOCK_MANUFACTURER
	DECLARE_VARIABLE	STRING 		LOCK_DESC
	DECLARE_VARIABLE	DOUBLE		LOCK_OFFSET
	DECLARE_VARIABLE	DOUBLE		LOCK_BACKSET
	DECLARE_VARIABLE	DOUBLE		LOCK_ARMOR_HEIGHT
	DECLARE_VARIABLE	DOUBLE		LOCK_ARMOR_THICKNESS
	DECLARE_VARIABLE	DOUBLE		LOCK_ARMOR_WIDTH
	DECLARE_VARIABLE	STRING 		LOCK_REINFORCEMENT
	DECLARE_VARIABLE	STRING 		LOCK_TRIM_MANUFACTURER
	DECLARE_VARIABLE	STRING 		LOCK_TRIM_DESC
	DECLARE_VARIABLE	DOUBLE		LOCK_TRIM_OFFSET
	DECLARE_VARIABLE	DOUBLE		LOCK_TRIM_BACKSET

	DECLARE_VARIABLE	STRING 		LOCK_SHEET_NAME
	DECLARE_VARIABLE	INTEGER		LOCK_ROW
	DECLARE_VARIABLE	STRING 		LOCK_TRIM_SHEET_NAME
	DECLARE_VARIABLE	INTEGER		LOCK_TRIM_ROW
	
	DECLARE_VARIABLE	STRING		STRIKE_DESC
	DECLARE_VARIABLE	DOUBLE		STRIKE_GAP
	DECLARE_VARIABLE	STRING 		STRIKE_EDGE_SHAPE
	DECLARE_VARIABLE	DOUBLE		STRIKE_CENTER
	DECLARE_VARIABLE	DOUBLE		STRIKE_HEIGHT
	DECLARE_VARIABLE	DOUBLE		STRIKE_WIDTH
	DECLARE_VARIABLE	DOUBLE		STRIKE_LIP_HEIGHT
	DECLARE_VARIABLE	DOUBLE		STRIKE_LIP_THICKNESS
	DECLARE_VARIABLE	DOUBLE		STRIKE_PLATE_THICKNESS
	DECLARE_VARIABLE	INTEGER		STRIKE_TYPE
	DECLARE_VARIABLE	STRING		STRIKE_UDF
	DECLARE_VARIABLE	STRING		STRIKE_REINF_MODEL
	DECLARE_VARIABLE	DOUBLE		STRIKE_BACKSET
	DECLARE_VARIABLE	STRING		STRIKE_MODEL
	DECLARE_VARIABLE	INTEGER		VERIFY_STRIKE

	DECLARE_ARRAY LOCK_INFO
	DECLARE_ARRAY LOCKCELLS
	DECLARE_ARRAY TRIM_INFO
	DECLARE_ARRAY TRIMCELLS
	DECLARE_ARRAY SELCELLS
	
	DECLARE_VARIABLE INTEGER COLX
	DECLARE_VARIABLE INTEGER COLY
	DECLARE_VARIABLE INTEGER COLSHAPE
	DECLARE_VARIABLE INTEGER COLDIA
	DECLARE_VARIABLE INTEGER COLSIDE
	DECLARE_VARIABLE DOUBLE LOCX
	DECLARE_VARIABLE DOUBLE LOCY
	DECLARE_VARIABLE STRING SHAPE
	DECLARE_VARIABLE STRING SHAPE_UDF
	DECLARE_VARIABLE DOUBLE DIA
	DECLARE_VARIABLE INTEGER SIDE
	DECLARE_VARIABLE INTEGER HTP
	DECLARE_VARIABLE INTEGER HINDEX
	DECLARE_VARIABLE DOUBLE OS
	DECLARE_VARIABLE DOUBLE IS
	
	
	! DECLARE_VARIABLE	STRING 		LOCK_MODEL
	! DECLARE_VARIABLE	STRING 		LOCK_TRIM
	! DECLARE_VARIABLE	STRING 		LOCK_TRIM_INST
	! DECLARE_VARIABLE	INTEGER		LOCK_TYPE
	! DECLARE_VARIABLE	STRING 		LOCK_UDF
	! DECLARE_VARIABLE	STRING 		LOCK_FUNCTION
	! DECLARE_VARIABLE	STRING 		LOCK_INST
	
	IF OPERATION == 0

		! CONFIG_ELEM
		
		IF SELECT_LOCK == 1
			PRINT "SELECT ONE CELL IN THE ROW YOU WANT"
			WAIT
			EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
			EXCEL_GET_SHEET_NAME EXCEL_INDEX LOCK_SHEET_NAME
			
			CLEAR_ARRAY LOCKCELLS
			EXCEL_GET_SELECTION LOCKCELLS
			FOR CELL REF ARRAY LOCKCELLS
				GET_ARRAY_ELEM CELL 0 LOCK_ROW
				BREAK
			END_FOR
			
			CLEAR_ARRAY SELCELLS
			EXCEL_GET_VALUES CELL_BY_INDEX LOCK_ROW 0 CELL_BY_INDEX LOCK_ROW 255 SELCELLS
			
			CLEAR_ARRAY LOCK_INFO
			FOR CELL REF ARRAY SELCELLS
				! GET_ARRAY_ELEM CELL 0 row
				! GET_ARRAY_ELEM CELL 1 col
				GET_ARRAY_ELEM CELL 2 content
				
				IF content == ""
					BREAK
				ELSE
					ADD_ARRAY_ELEM LOCK_INFO content
					PRINT "CONTENT - %  " content
				END_IF
			END_FOR

			GET_ARRAY_ELEM LOCK_INFO 2 LOCK_MANUFACTURER
			! GET_ARRAY_ELEM LOCK_INFO 3 LOCK_MODEL
			GET_ARRAY_ELEM LOCK_INFO 4 LOCK_DESC
			GET_ARRAY_ELEM LOCK_INFO 6 LOCK_REINFORCEMENT
			GET_ARRAY_ELEM LOCK_INFO 7 LOCK_OFFSET
			GET_ARRAY_ELEM LOCK_INFO 8 LOCK_BACKSET
			GET_ARRAY_ELEM LOCK_INFO 9 LOCK_ARMOR_HEIGHT
			GET_ARRAY_ELEM LOCK_INFO 10 LOCK_ARMOR_WIDTH
			GET_ARRAY_ELEM LOCK_INFO 11 LOCK_ARMOR_THICKNESS


			PRINT "LOCK SHEET NAME  %" LOCK_SHEET_NAME
			PRINT "LOCK ROW  %" LOCK_ROW			
			
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
			
			IF SUB_TYPE == "S" AND STRIKE_EDGE_SHAPE == "BEVEL"
				IF STOPP < .625
					PRINT " PLEASE CONFIRM FRAME STOP DIMENSION"
					USER_INPUT_PARAM DOUBLE STOPP
				END_IF
				PRINT "%" BEVEL
				PRINT "%" DOOR_THICKNESS
				BEVEL_CALC = BEVEL*PI/180*(DOOR_THICKNESS/2)
				PRINT "%" LOCK_BACKSET
				PRINT "%" STOPP
				PRINT "%" STRIKE_GAP
				PRINT "%" BEVEL_CALC
				
				LOCK_BACKSET = LOCK_BACKSET+STOPP-STRIKE_GAP-BEVEL_CALC	
			END_IF

			IF SUB_TYPE == "P" AND STRIKE_EDGE_SHAPE == "BEVEL" AND EXIT_MULLION == 1
				BEVEL_CALC = BEVEL*PI/180*(DOOR_THICKNESS/2)
				LOCK_BACKSET = LOCK_BACKSET+MULLION_ADD_PER_DOOR-(STRIKE_GAP/2)-BEVEL_CALC	
			END_IF
		END_IF

		IF SELECT_TRIM == 1
			PRINT "SELECT ONE CELL IN THE ROW YOU WANT"
			WAIT
			EXCEL_GET_ACTIVE_SHEET EXCEL_INDEX
			EXCEL_GET_SHEET_NAME EXCEL_INDEX LOCK_TRIM_SHEET_NAME
			
			CLEAR_ARRAY TRIMCELLS
			EXCEL_GET_SELECTION TRIMCELLS
			FOR CELL REF ARRAY TRIMCELLS
				GET_ARRAY_ELEM CELL 0 LOCK_TRIM_ROW
				BREAK
			END_FOR

			CLEAR_ARRAY SELCELLS
			EXCEL_GET_VALUES CELL_BY_INDEX LOCK_TRIM_ROW 0 CELL_BY_INDEX LOCK_TRIM_ROW 255 SELCELLS
			
			CLEAR_ARRAY TRIM_INFO
			FOR CELL REF ARRAY SELCELLS
				! GET_ARRAY_ELEM CELL 0 row
				! GET_ARRAY_ELEM CELL 1 col
				GET_ARRAY_ELEM CELL 2 content
				
				IF content == ""
					BREAK
				ELSE
					ADD_ARRAY_ELEM TRIM_INFO content
					PRINT "CONTENT - %  " content
				END_IF
			END_FOR

			GET_ARRAY_ELEM TRIM_INFO 2 LOCK_TRIM_MANUFACTURER
			! GET_ARRAY_ELEM TRIM_INFO 3 LOCK_TRIM_MODEL
			GET_ARRAY_ELEM TRIM_INFO 4 LOCK_TRIM_DESC
			GET_ARRAY_ELEM TRIM_INFO 6 LOCK_TRIM_REINFORCEMENT
			GET_ARRAY_ELEM TRIM_INFO 7 LOCK_TRIM_OFFSET
			GET_ARRAY_ELEM TRIM_INFO 8 LOCK_TRIM_BACKSET
			! GET_ARRAY_ELEM TRIM_INFO 9 LOCK_TRIM_ARMOR_HEIGHT
			! GET_ARRAY_ELEM TRIM_INFO 10 LOCK_TRIM_ARMOR_WIDTH
			! GET_ARRAY_ELEM TRIM_INFO 11 LOCK_TRIM_ARMOR_THICKNESS

			PRINT "LOCK SHEET NAME  %" LOCK_TRIM_SHEET_NAME
			PRINT "LOCK ROW  %" LOCK_TRIM_ROW			
			
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"

			IF SUB_TYPE == "S" AND STRIKE_EDGE_SHAPE == "BEVEL"
				IF STOPP < .625
					PRINT " PLEASE CONFIRM FRAME STOP DIMENSION"
					USER_INPUT_PARAM DOUBLE STOPP
				END_IF
				PRINT "%" BEVEL
				PRINT "%" DOOR_THICKNESS
				BEVEL_CALC = BEVEL*PI/180*(DOOR_THICKNESS/2)
				PRINT "%" LOCK_TRIM_BACKSET
				PRINT "%" STOPP
				PRINT "%" STRIKE_GAP
				PRINT "%" BEVEL_CALC
				
				LOCK_TRIM_BACKSET = LOCK_TRIM_BACKSET+STOPP-STRIKE_GAP-BEVEL_CALC	
			END_IF

			IF SUB_TYPE == "P" AND STRIKE_EDGE_SHAPE == "BEVEL" AND EXIT_MULLION == 1
				BEVEL_CALC = BEVEL*PI/180*(DOOR_THICKNESS/2)
				LOCK_TRIM_BACKSET = LOCK_TRIM_BACKSET+MULLION_ADD_PER_DOOR-(STRIKE_GAP/2)-BEVEL_CALC	
			END_IF
		END_IF				
	END_IF

	IF OPERATION > 0
		IF SUB_TYPE == "S" OR (SUB_TYPE == "P" AND DOOR_INDEX == 1) OR (SUB_TYPE == "P" AND DOOR_INDEX == 2 AND UNEQUAL_EXITS == 0)
			STRIKE_CENTER = PRIMARY_STRIKE_CENTER
			LOCK_MANUFACTURER = PRIMARY_LOCK_MANUFACTURER
			LOCK_DESC = PRIMARY_LOCK_DESC
			LOCK_OFFSET = PRIMARY_LOCK_OFFSET
			LOCK_BACKSET = PRIMARY_LOCK_BACKSET
			LOCK_REINFORCEMENT = PRIMARY_LOCK_REINFORCEMENT
			LOCK_ARMOR_HEIGHT = PRIMARY_LOCK_ARMOR_HEIGHT
			LOCK_ARMOR_WIDTH = PRIMARY_LOCK_ARMOR_WIDTH
			LOCK_ARMOR_THICKNESS = PRIMARY_LOCK_ARMOR_THICKNESS
			LOCK_TRIM_OFFSET = PRIMARY_LOCK_TRIM_OFFSET
			LOCK_TRIM_BACKSET = PRIMARY_LOCK_TRIM_BACKSET
			LOCK_SHEET_NAME = PRIMARY_LOCK_SHEET_NAME
			LOCK_ROW = PRIMARY_LOCK_ROW	
			LOCK_TRIM_SHEET_NAME = PRIMARY_LOCK_TRIM_SHEET_NAME
			LOCK_TRIM_ROW = PRIMARY_LOCK_TRIM_ROW	
			LOCK_TRIM_DESC = PRIMARY_LOCK_TRIM_DESC
			! LOCK_TYPE = PRIMARY_LOCK_TYPE
			! LOCK_MODEL = PRIMARY_LOCK_SERIES_MODEL
			! LOCK_FUNCTION = PRIMARY_LOCK_FUNCTION
			! LOCK_TRIM = PRIMARY_LOCK_TRIM
			! LOCK_UDF = PRIMARY_LOCK_UDF
			! LOCK_INST = PRIMARY_LOCK_INST
			! LOCK_TRIM_UDF = PRIMARY_LOCK_TRIM_UDF
			! LOCK_TRIM_INST = PRIMARY_LOCK_TRIM_INST
			! LOCK_INFO = PRIMARY_LOCK_INFO
		END_IF	

		IF SUB_TYPE == "P" AND DOOR_INDEX == 2 AND UNEQUAL_EXITS == 1
			! LOCK_MANUFACTURER = LOCK_MANUFACTURER
			! LOCK_TYPE = LOCK_TYPE_X2
			! LOCK_MODEL = LOCK_MODEL_X2
			! LOCK_BACKSET = LOCK_BACKSET_X2
			! LOCK_DESC = LOCK_DESC_X2
			! LOCK_FUNCTION = LOCK_FUNCTION_X2
			! LOCK_OFFSET = LOCK_OFFSET_X2
			! LOCK_REINFORCEMENT = LOCK_REINFORCEMENT_X2
			! LOCK_TRIM = LOCK_TRIM_X2
			! LOCK_UDF = LOCK_UDF_X2
			! LOCK_INST = LOCK_INST_X2
			! LOCK_TRIM_UDF = LOCK_TRIM_UDF_X2
			! LOCK_TRIM_INST = LOCK_TRIM_INST_X2
			! LOCK_TRIM_OFFSET = LOCK_TRIM_OFFSET_X2
			! LOCK_ARMOR_HEIGHT = LOCK_ARMOR_HEIGHT_X2
			! LOCK_ARMOR_WIDTH = LOCK_ARMOR_WIDTH_X2
			! LOCK_ARMOR_THICKNESS = LOCK_ARMOR_THICKNESS_X2
			! LOCK_TRIM_OFFSET = LOCK_TRIM_OFFSET_X2
			! STRIKE_CENTER = STRIKE_CENTER_X2
			! LOCK_SHEET_NAME = PRIMARY_LOCK_SHEET_NAME_X2
			! LOCK_ROW = PRIMARY_LOCK_ROW_X2
			! LOCK_INFO = PRIMARY_LOCK_INFO_X2
		END_IF
		
		IF	HAND_ == "LHR" OR HAND_ == "LHRA1" OR HAND_ == "LHR1"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
			SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
			IF DOOR_CONSTRUCTION == "SEAMLESS"
				SEARCH_MDL_REF BODY SURFACE "SURFACE_S2" BODY_ARMOR
				SEARCH_MDL_REF COVER SURFACE "SURFACE_S2" COVER_ARMOR
				BODY_ROTATION = 180
				COVER_ROTATION = 0
			END_IF
			IF STRIKE_EDGE_SHAPE == "BEVEL"
				ARMOR_BEVEL = -4
			ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
				ARMOR_BEVEL = 0
			END_IF
		END_IF

		IF	HAND_ == "RH" OR HAND_ == "RHA2"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS4" ATTACH
			SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
			IF DOOR_CONSTRUCTION == "SEAMLESS"
				SEARCH_MDL_REF BODY SURFACE "SURFACE_S2" BODY_ARMOR
				SEARCH_MDL_REF COVER SURFACE "SURFACE_S2" COVER_ARMOR
				BODY_ROTATION = 180
				COVER_ROTATION = 0
			END_IF
			IF STRIKE_EDGE_SHAPE == "BEVEL"
				ARMOR_BEVEL = -4
			ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
				ARMOR_BEVEL = 0
			END_IF
		END_IF

		IF	HAND_ == "RHR" OR HAND_ == "RHRA2" OR HAND_ == "RHR2"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
			SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
			IF DOOR_CONSTRUCTION == "SEAMLESS"
				SEARCH_MDL_REF BODY SURFACE "SURFACE_S1" BODY_ARMOR
				SEARCH_MDL_REF COVER SURFACE "SURFACE_S1" COVER_ARMOR
				BODY_ROTATION = 0
				COVER_ROTATION = 180
			END_IF
			IF STRIKE_EDGE_SHAPE == "BEVEL"
				ARMOR_BEVEL = 4
			ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
				ARMOR_BEVEL = 0
			END_IF
		END_IF

		IF	HAND_ == "LH" OR HAND_ == "LHA1"
			SEARCH_MDL_REF DOOR_ASM CSYS "ACS3" ATTACH
			SEARCH_MDL_REF DOOR_ASM CSYS "ASM_DEF_CSYS" ATTACH1
			IF DOOR_CONSTRUCTION == "SEAMLESS"
				SEARCH_MDL_REF BODY SURFACE "SURFACE_S1" BODY_ARMOR
				SEARCH_MDL_REF COVER SURFACE "SURFACE_S1" COVER_ARMOR
				BODY_ROTATION = 0
				COVER_ROTATION = 180
			END_IF
			IF STRIKE_EDGE_SHAPE == "BEVEL"
				ARMOR_BEVEL = 4
			ELSE_IF STRIKE_EDGE_SHAPE == "SQUARE"
				ARMOR_BEVEL =  0
			END_IF
		END_IF

		IF WELDED_PREPS == 1
			LOCK_ARMOR_HEIGHT = LOCK_ARMOR_HEIGHT + .18
			LOCK_ARMOR_WIDTH = LOCK_ARMOR_WIDTH +.18
			LOCK_REINFORCEMENT = LOCK_INST + ".ASM"
		ELSE
			LOCK_ARMOR_HEIGHT = LOCK_ARMOR_HEIGHT +.03
			LOCK_ARMOR_WIDTH = LOCK_ARMOR_WIDTH +.03
			LOCK_REINFORCEMENT = LOCK_REINFORCEMENT
		END_IF

		IF DOOR_CONSTRUCTION == "SEAMLESS" AND DOOR_THICKNESS - .125 - LOCK_ARMOR_WIDTH <= .4
			IF DOOR_GAUGE == 18 AND LOCK_ARMOR_WIDTH <= 1.265
				ARMOR_INST = "NO_TAB"
			ELSE_IF DOOR_GAUGE == 18 AND LOCK_ARMOR_WIDTH > 1.265
				ARMOR_INST = "WITH_TAB"
			ELSE_IF DOOR_GAUGE == 16 AND LOCK_ARMOR_WIDTH <= 1.265
				ARMOR_INST = "NO_TAB"
			ELSE_IF DOOR_GAUGE == 16 AND LOCK_ARMOR_WIDTH > 1.265
				ARMOR_INST = "WITH_TAB"
			ELSE_IF DOOR_GAUGE == 14 AND LOCK_ARMOR_WIDTH <= 1.140
				ARMOR_INST = "NO_TAB"
			ELSE_IF DOOR_GAUGE == 14 AND LOCK_ARMOR_WIDTH > 1.140
				ARMOR_INST = "WITH_TAB"
			ELSE_IF DOOR_GAUGE == 12
				ARMOR_INST = "WITH_TAB"
			END_IF
		END_IF

		IF LOCK_ROW <> 0 AND LOCK_ROW <> ""
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME LOCK_SHEET_NAME
			CLEAR_ARRAY SELCELLS
			EXCEL_GET_VALUES CELL_BY_INDEX LOCK_ROW 0 CELL_BY_INDEX LOCK_ROW 255 SELCELLS
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		
			CLEAR_ARRAY LOCK_INFO
			FOR CELL REF ARRAY SELCELLS
				! GET_ARRAY_ELEM CELL 0 row
				! GET_ARRAY_ELEM CELL 1 col
				GET_ARRAY_ELEM CELL 2 content
				
				IF content == ""
					BREAK
				ELSE
					ADD_ARRAY_ELEM LOCK_INFO content
					PRINT "CONTENT - %  " content
				END_IF
			END_FOR
		
			! GET_ARRAY_ELEM LOCK_INFO 7 LOCK_OFFSET
			! GET_ARRAY_ELEM LOCK_INFO 8 LOCK_BACKSET
			! GET_ARRAY_ELEM LOCK_INFO 9 LOCK_ARMOR_HEIGHT
			! GET_ARRAY_ELEM LOCK_INFO 10 LOCK_ARMOR_WIDTH
			! GET_ARRAY_ELEM LOCK_INFO 11 LOCK_ARMOR_THICKNESS

				CREATE_UDF udf\lock_dtms DOOR_ASM
					UDF_REF ATTACH1 ATTACH
					UDF_REF ATTACH2 ATTACH1
					UDF_DIM STRIKE_CTR STRIKE_CENTER
					UDF_DIM OFFSET -LOCK_OFFSET
					UDF_DIM BACKSET LOCK_BACKSET
					UDF_EXP_REF ATTACH2 CSYS 2
					UDF_EXP_REF ODCTR PLANE 3
					UDF_EXP_REF TOPP PLANE 4
				END_CREATE_UDF

			GET_ARRAY_SIZE LOCK_INFO SIZE
			HTP = (SIZE-8)/5
			HINDEX = 1
			COLX = 12
			COLY = 13
			COLSHAPE = 14
			COLDIA = 15
			COLSIDE = 16

			WHILE HINDEX <= HTP	
				GET_ARRAY_ELEM LOCK_INFO COLX LOCX
				GET_ARRAY_ELEM LOCK_INFO COLY LOCY
				GET_ARRAY_ELEM LOCK_INFO COLSHAPE SHAPE
				GET_ARRAY_ELEM LOCK_INFO COLDIA DIA
				GET_ARRAY_ELEM LOCK_INFO COLSIDE SIDE
				
				CREATE_UDF udf\xycsys DOOR_ASM
					UDF_REF ATTACH ATTACH2
					UDF_DIM	DIMX LOCX
					UDF_DIM	DIMY LOCY
					UDF_EXP_REF LOCREF CSYS 0
				END_CREATE_UDF
				
				IF SIDE == 0
					OS = 1
					IS = .1
				END_IF
				IF SIDE == 1
					OS = .1
					IS = 1
				END_IF
				IF SIDE == 2
					OS = 1
					IS = 1
				END_IF
				
				IF SHAPE == 1
					SHAPE_UDF = "udf\circle"
				ELSE
					SHAPE_UDF = "udf\\" + itos(SHAPE)
				END_IF
				
				PRINT "%" SHAPE_UDF
				
				CREATE_UDF &SHAPE_UDF DOOR_ASM
					UDF_REF ODCTR ODCTR
					UDF_REF TOPP TOPP
					UDF_REF LOCREF LOCREF
					UDF_DIM DIA DIA
					UDF_DIM IS IS
					UDF_DIM OS OS
					UDF_INTERSECTION * PART_LEVEL		
				END_CREATE_UDF
				
				HINDEX++
				COLX = COLX + 5
				COLY = COLY + 5
				COLSHAPE = COLSHAPE + 5
				COLDIA = COLDIA + 5
				COLSIDE = COLSIDE + 5
			END_WHILE		
		END_IF

		IF LOCK_TRIM_ROW <> 0 AND LOCK_TRIM_ROW <> ""
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME LOCK_TRIM_SHEET_NAME
			CLEAR_ARRAY SELCELLS
			EXCEL_GET_VALUES CELL_BY_INDEX LOCK_TRIM_ROW 0 CELL_BY_INDEX LOCK_TRIM_ROW 255 SELCELLS
			EXCEL_ACTIVATE_SHEET SHEET_BY_NAME "OPENING"
		
			CLEAR_ARRAY TRIM_INFO
			FOR CELL REF ARRAY SELCELLS
				! GET_ARRAY_ELEM CELL 0 row
				! GET_ARRAY_ELEM CELL 1 col
				GET_ARRAY_ELEM CELL 2 content
				
				IF content == ""
					BREAK
				ELSE
					ADD_ARRAY_ELEM TRIM_INFO content
					PRINT "CONTENT - %  " content
				END_IF
			END_FOR
		
			! GET_ARRAY_ELEM TRIM_INFO 7 TRIM_OFFSET
			! GET_ARRAY_ELEM TRIM_INFO 8 TRIM_BACKSET

				CREATE_UDF udf\lock_dtms DOOR_ASM
					UDF_REF ATTACH1 ATTACH
					UDF_REF ATTACH2 ATTACH1
					UDF_DIM STRIKE_CTR STRIKE_CENTER
					UDF_DIM OFFSET -LOCK_TRIM_OFFSET
					UDF_DIM BACKSET LOCK_TRIM_BACKSET
					UDF_EXP_REF ATTACH2 CSYS 2
					UDF_EXP_REF ODCTR PLANE 3
					UDF_EXP_REF TOPP PLANE 4
				END_CREATE_UDF

			GET_ARRAY_SIZE TRIM_INFO SIZE
			HTP = (SIZE-8)/5
			HINDEX = 1
			COLX = 12
			COLY = 13
			COLSHAPE = 14
			COLDIA = 15
			COLSIDE = 16

			WHILE HINDEX <= HTP	
				GET_ARRAY_ELEM TRIM_INFO COLX LOCX
				GET_ARRAY_ELEM TRIM_INFO COLY LOCY
				GET_ARRAY_ELEM TRIM_INFO COLSHAPE SHAPE
				GET_ARRAY_ELEM TRIM_INFO COLDIA DIA
				GET_ARRAY_ELEM TRIM_INFO COLSIDE SIDE
				
				CREATE_UDF udf\xycsys DOOR_ASM
					UDF_REF ATTACH ATTACH2
					UDF_DIM	DIMX LOCX
					UDF_DIM	DIMY LOCY
					UDF_EXP_REF LOCREF CSYS 0
				END_CREATE_UDF
				
				IF SIDE == 0
					OS = 1
					IS = .1
				END_IF
				IF SIDE == 1
					OS = .1
					IS = 1
				END_IF
				IF SIDE == 2
					OS = 1
					IS = 1
				END_IF
				
				IF SHAPE == 1
					CREATE_UDF udf\circle DOOR_ASM
						UDF_REF ODCTR ODCTR
						UDF_REF TOPP TOPP
						UDF_REF LOCREF LOCREF
						UDF_DIM DIA DIA
						UDF_DIM IS IS
						UDF_DIM OS OS
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF
				END_IF

				IF SHAPE <> 1
					SHAPE_UDF = "udf\\" + itos(SHAPE)
					CREATE_UDF &SHAPE_UDF DOOR_ASM
						UDF_REF ODCTR ODCTR
						UDF_REF TOPP TOPP
						UDF_REF LOCREF LOCREF
						UDF_DIM DIA DIA
						UDF_DIM IS IS
						UDF_DIM OS OS
						UDF_INTERSECTION * PART_LEVEL		
					END_CREATE_UDF
				END_IF
							
				HINDEX++
				COLX = COLX + 5
				COLY = COLY + 5
				COLSHAPE = COLSHAPE + 5
				COLDIA = COLDIA + 5
				COLSIDE = COLSIDE + 5
			END_WHILE		
		END_IF
		
		IF	HAND_ == "RHR" OR HAND_ == "LH" OR \
			HAND_ == "RHR2" OR HAND_ == "RHRA2" OR \
			HAND_ == "LH1" OR HAND_ == "LHA1"
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH2
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF
		END_IF

		IF	HAND_ == "LHR" OR HAND_ == "RH" OR \
			HAND_ == "LHR1" OR HAND_ == "LHRA1" OR \
			HAND_ == "RH2" OR HAND_ == "RHA2"

				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH2
					UDF_DIM	ROTX 180
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF
		END_IF

		PRINT "%" LOCK_REINFORCEMENT
		RETRIEVE_MDL &LOCK_REINFORCEMENT COMP
		
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

		ASSEMBLE COMP DOOR_ASM
			 CSYS ATTACH2 PLACEMENT
		END_ASSEMBLE
		
		CREATE_UDF udf\csys DOOR_ASM
			UDF_REF ATTACH ATTACH2
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 90
			UDF_DIM	LOCX -(DOOR_WIDTH-LOCK_BACKSET-3)
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH2 CSYS 0
		END_CREATE_UDF
		
		RETRIEVE_MDL EXIT_REINFORCEMENT_TAIL.ASM COMP
		
		SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT

		ASSEMBLE COMP DOOR_ASM
			 CSYS ATTACH2 PLACEMENT
		END_ASSEMBLE
			
		IF LOCK_TRIM_UDF <> "" AND LOCK_TRIM_UDF <> "X"
			TRIM_UDF = "udf\\"+ LOCK_TRIM_UDF
			CREATE_UDF &TRIM_UDF DOOR_ASM
				UDF_INSTANCE LOCK_TRIM_INST
				UDF_REF ATTACH1 ATTACH
				UDF_REF ATTACH2 ATTACH1
				UDF_DIM STRIKE_CTR STRIKE_CENTER
				UDF_DIM OFFSET -LOCK_OFFSET
				UDF_DIM BACKSET LOCK_BACKSET
				UDF_EXP_REF ATTACH2 CSYS 1
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		STRIKE_TYPE = PRIMARY_STRIKE_TYPE

		IF STRIKE_TYPE == 81 OR STRIKE_TYPE == 82 OR STRIKE_TYPE == 83
			IF	HAND_ == "LHR" OR HAND_ == "LHR1" OR HAND_ == "LHRA1"
				FLIP = 180
			END_IF
			IF HAND_ == "RHR" OR HAND_ == "RHR2" OR HAND_ == "RHRA2"
				FLIP = 0
			END_IF

			IF STRIKE_TYPE == 81 OR 	STRIKE_TYPE == 83
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX FLIP
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -PRIMARY_LOCK_BACKSET
					UDF_DIM	LOCY UNDERCUT + DOOR_HEIGHT - TOP_CHANNEL_DEPTH - 3.5
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL SVR_BOX.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH2 PLACEMENT
					END_ASSEMBLE						
			END_IF

			IF STRIKE_TYPE == 82 OR 	STRIKE_TYPE == 83
				CREATE_UDF udf\csys DOOR_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX FLIP
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -PRIMARY_LOCK_BACKSET
					UDF_DIM	LOCY UNDERCUT + BOTTOM_CHANNEL_DEPTH + 3.5
					UDF_DIM	LOCZ 0
					UDF_EXP_REF ATTACH2 CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL SVR_BOX.PRT COMP
				SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE COMP DOOR_ASM
						 CSYS ATTACH2 PLACEMENT
					END_ASSEMBLE
			END_IF
		END_IF
	END_IF
END_ASM_DESCR




