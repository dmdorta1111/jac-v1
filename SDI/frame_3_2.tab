
BEGIN_GUI_DESCR

	IF FRAME_GAUGE == 16
		FR_THICKNESS = .06
	ELSE_IF FRAME_GAUGE == 14
		FR_THICKNESS = .075
	ELSE_IF FRAME_GAUGE == 12
		FR_THICKNESS = .105
	END_IF

	!BEGIN VERIFY FRAME STANDARDS

	WHILE SECTION == 2 AND SOFFIT < MINIMUM_SOFFIT
		MESSAGE_BOX "THERE IS A PROBLEM WITH THE CONFIGURATION"
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE SECTION #"
		USER_INPUT_PARAM INTEGER SECTION
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE XRABBET"
		USER_INPUT_PARAM DOUBLE XRABBET
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE MINIMUM SOFFIT SIZE"
		USER_INPUT_PARAM DOUBLE MINIMUM_SOFFIT
	END_WHILE

	IF FR_GAUGE == 12
		IF RETURN < .625 OR XRETURN < .625 OR STOPP < .75 OR HEAD_STOPP < .75
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST THROAT"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
			MESSAGE_BOX_EX QUESTION "12 GAUGE RETURNS OR STOPS ARE TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE

			IF CHOICE == 0 OR CHOICE == 4
				EXIT
			END_IF

			IF CHOICE == 2 OR CHOICE == 3
				IF RETURN < .625
					RETURN = .625
				END_IF
				IF XRETURN < .625
					XRETURN = .625
				END_IF
				IF STOPP < .75
					STOPP = .75
				END_IF
				IF HEAD_STOPP < .75
					HEAD_STOPP = .75
				END_IF
				IF CHOICE == 2
					JD = THROAT+RETURN+XRETURN
				END_IF
				IF CHOICE == 3
					THROAT = JD-RETURN-XRETURN
				END_IF
			END_IF
		END_IF
	END_IF

	IF SECTION == 2
		IF JD-RABBET-XRABBET<MINIMUM_SOFFIT
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST XRABBET"
			ADD_ARRAY_ELEM arrayButtons "MAKE SINGLE RABBET"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
		MESSAGE_BOX_EX QUESTION "THE SOFFIT IS TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 5
				EXIT
			END_IF
			IF CHOICE == 2
				JD = RABBET + XRABBET + MIINIMUM_SOFFIT
			END_IF
			IF CHOICE == 3
				XRABBET = JD-MINIMUM_SOFFIT
			END_IF
			IF CHOICE == 4
				SECTION = 1
			END_IF
		END_IF
	END_IF

	IF FRAME_ELEVATION == 3 AND (SECTION == 0 OR SECTION == 1 OR SECTION == 2)

		IF FRAME_ELEVATION == 3 AND SECTION == 0
			RETRIEVE_MDL frame_3_0.asm FRAME_ASM
		ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 1
			RETRIEVE_MDL frame_3_1.asm FRAME_ASM
		ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 2
			RETRIEVE_MDL frame_3_2.asm FRAME_ASM
		END_IF

		SEARCH_MDL_REF ASSEM CSYS "FRAME" ATTACH
		SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
			ASSEMBLE FRAME_ASM ASSEM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE

		SET_MDL_NAME FRAME_ASM "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB*L*" JAMB1
		SET_MDL_NAME JAMB1 "JAMB1_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB1_"+SO_NUM+"_"+ ITEM_NUM JAMB1

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB*R*" JAMB2
		SET_MDL_NAME JAMB2 "JAMB2_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB2_"+SO_NUM+"_"+ ITEM_NUM JAMB2

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD*" HEAD
		SET_MDL_NAME HEAD "HEAD_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD_"+SO_NUM+"_"+ ITEM_NUM HEAD

		SET_MDL_PARAM FRAME_ASM "CUSTOMER_NAME" CUSTOMER_NAME
		SET_MDL_PARAM FRAME_ASM "JOB_NAME" JOB_NAME
		SET_MDL_PARAM FRAME_ASM "SO_NUM" SO_NUM

		SET_MDL_PARAM FRAME_ASM "SUB_JOB_NAME" SUB_JOB_NAME
		SET_MDL_PARAM FRAME_ASM "ITEM_NUM" ITEM_NUM
		SET_MDL_PARAM FRAME_ASM "QTY" QTY
		SET_MDL_PARAM FRAME_ASM "ITEM_DESC" FRAME_ITEM_DESC

		SET_MDL_PARAM FRAME_ASM "RABBET" RABBET
		SET_MDL_PARAM FRAME_ASM "XRABBET" XRABBET
		SET_MDL_PARAM FRAME_ASM "STOPP" STOPP
		SET_MDL_PARAM FRAME_ASM "HEAD_STOPP" HEAD_STOPP
		SET_MDL_PARAM FRAME_ASM "JD" JD
		SET_MDL_PARAM FRAME_ASM "JOW" JOW
		SET_MDL_PARAM FRAME_ASM "JOH" JOH+TRANSOM_PANEL_HEIGHT
		SET_MDL_PARAM FRAME_ASM "FACEE" FACEE
		SET_MDL_PARAM FRAME_ASM "XFACEE" XFACEE
		SET_MDL_PARAM FRAME_ASM "HEAD" HEAD
		SET_MDL_PARAM FRAME_ASM "XHEAD" XHEAD
		SET_MDL_PARAM FRAME_ASM "RETURN" RETURN
		SET_MDL_PARAM FRAME_ASM "XRETURN" XRETURN
		SET_MDL_PARAM FRAME_ASM "HAND" HAND
		SET_MDL_PARAM FRAME_ASM "ANCHOR_CTR" -ANCHOR_CTR


		SET_MDL_PARAM JAMB1 "SMT_THICKNESS" FR_THICKNESS
		SET_MDL_PARAM JAMB1 "TYPE" MAT_TYPE
		SET_MDL_PARAM JAMB1 "GRADE"FRAME_GRADE
		SET_MDL_PARAM JAMB1 "FINISH" FRAME_FINISH
		SET_MDL_PARAM JAMB1 "GRAIN" 1
		SET_MDL_PARAM JAMB1 "EMJACNUM" "JAMB1-"+ITEM_NUM

		SET_MDL_PARAM JAMB2 "SMT_THICKNESS" FR_THICKNESS
		SET_MDL_PARAM JAMB2 "TYPE" MAT_TYPE
		SET_MDL_PARAM JAMB2 "GRADE"FRAME_GRADE
		SET_MDL_PARAM JAMB2 "FINISH" FRAME_FINISH
		SET_MDL_PARAM JAMB2 "GRAIN" 1
		SET_MDL_PARAM JAMB2 "EMJACNUM" "JAMB2-"+ITEM_NUM

		SET_MDL_PARAM HEAD "SMT_THICKNESS" FR_THICKNESS
		SET_MDL_PARAM HEAD "TYPE" MAT_TYPE
		SET_MDL_PARAM HEAD "GRADE"FRAME_GRADE
		SET_MDL_PARAM HEAD "FINISH" FRAME_FINISH
		SET_MDL_PARAM HEAD "EMJACNUM" "HEAD-"+ITEM_NUM

		IF HEAD_GRAIN == "VERTICAL"
				SET_MDL_PARAM HEAD "GRAIN" 2
		ELSE_IF HEAD_GRAIN == "HORIZONTAL"
				SET_MDL_PARAM HEAD "GRAIN" 1
		END_IF
	END_IF

	IF FRAME_ELEVATION == 5 AND SECTION == 2
		RETRIEVE_MDL frame_5_20.asm FRAME_ASM

		IF TRANSOM_HEIGHT < 1
			PRINT "ENTER TRANSOM JOH"
			USER_INPUT_PARAM DOUBLE TRANSOM_JOH
			SET_MDL_PARAM FRAME_ASM "TRANSOM_HEIGHT" TRANSOM_JOH/25.4
		END_IF

		SEARCH_MDL_REF ASSEM CSYS "FRAME" ATTACH
		SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" PLACEMENT
			ASSEMBLE FRAME_ASM ASSEM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE

		SET_MDL_NAME FRAME_ASM "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
			SET_MDL_PARAM FRAME_ASM "CUSTOMER_NAME" CUSTOMER_NAME
			SET_MDL_PARAM FRAME_ASM "JOB_NAME" JOB_NAME
			SET_MDL_PARAM FRAME_ASM "SO_NUM" SO_NUM
			SET_MDL_PARAM FRAME_ASM "SUB_JOB_NAME" SUB_JOB_NAME
			SET_MDL_PARAM FRAME_ASM "ITEM_NUM" ITEM_NUM
			SET_MDL_PARAM FRAME_ASM "QTY" QTY
			SET_MDL_PARAM FRAME_ASM "ITEM_DESC" FRAME_ITEM_DESC
			SET_MDL_PARAM FRAME_ASM "RABBET" RABBET
			SET_MDL_PARAM FRAME_ASM "XRABBET" XRABBET
			SET_MDL_PARAM FRAME_ASM "STOPP" STOPP
			SET_MDL_PARAM FRAME_ASM "HEAD_STOPP" HEAD_STOPP
			SET_MDL_PARAM FRAME_ASM "JD" JD
			SET_MDL_PARAM FRAME_ASM "JOW" JOW
			SET_MDL_PARAM FRAME_ASM "JOH" JOH+TRANSOM_PANEL_HEIGHT
			SET_MDL_PARAM FRAME_ASM "FACEE" FACEE
			SET_MDL_PARAM FRAME_ASM "XFACEE" XFACEE
			SET_MDL_PARAM FRAME_ASM "HEAD" HEAD
			SET_MDL_PARAM FRAME_ASM "XHEAD" XHEAD
			SET_MDL_PARAM FRAME_ASM "RETURN" RETURN
			SET_MDL_PARAM FRAME_ASM "XRETURN" XRETURN
			SET_MDL_PARAM FRAME_ASM "HAND" HAND
			SET_MDL_PARAM FRAME_ASM "ANCHOR_CTR" -ANCHOR_CTR

		REGEN_MDL FRAME_ASM
		REGEN_MDL FRAME_ASM

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB_5_20L" JAMB1
		SET_MDL_NAME JAMB1 "JAMB1_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB1_"+SO_NUM+"_"+ ITEM_NUM JAMB1
			SET_MDL_PARAM JAMB1 "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM JAMB1 "TYPE" MAT_TYPE
			SET_MDL_PARAM JAMB1 "GRADE"FRAME_GRADE
			SET_MDL_PARAM JAMB1 "FINISH" FRAME_FINISH
			SET_MDL_PARAM JAMB1 "GRAIN" 1
			DELETE_FAMINSTANCE JAMB1 "*INST*"


		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*JAMB_5_20R" JAMB2
		SET_MDL_NAME JAMB2 "JAMB2_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "JAMB2_"+SO_NUM+"_"+ ITEM_NUM JAMB2
			SET_MDL_PARAM JAMB2 "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM JAMB2 "TYPE" MAT_TYPE
			SET_MDL_PARAM JAMB2 "GRADE"FRAME_GRADE
			SET_MDL_PARAM JAMB2 "FINISH" FRAME_FINISH
			SET_MDL_PARAM JAMB2 "GRAIN" 1

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "MULLION_5_20" HEAD
		SET_MDL_NAME HEAD "HEAD_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "HEAD_"+SO_NUM+"_"+ ITEM_NUM HEAD
			SET_MDL_PARAM HEAD "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM HEAD "TYPE" MAT_TYPE
			SET_MDL_PARAM HEAD "GRADE"FRAME_GRADE
			SET_MDL_PARAM HEAD "FINISH" FRAME_FINISH


		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "FILLER_5_20" MULLION_FILLER
		SET_MDL_NAME MULLION_FILLER "FILLER_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "FILLER_"+SO_NUM+"_"+ ITEM_NUM MULLION_FILLER
			SET_MDL_PARAM MULLION_FILLER "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM MULLION_FILLER "TYPE" MAT_TYPE
			SET_MDL_PARAM MULLION_FILLER "GRADE" FRAME_GRADE
			SET_MDL_PARAM MULLION_FILLER "FINISH" FRAME_FINISH


		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "*HEAD" TRANSOM_HEAD
		SET_MDL_NAME TRANSOM_HEAD "TRANSOM_HEAD_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_HEAD_"+SO_NUM+"_"+ ITEM_NUM TRANSOM_HEAD
			SET_MDL_PARAM TRANSOM_HEAD "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM TRANSOM_HEAD "TYPE" MAT_TYPE
			SET_MDL_PARAM TRANSOM_HEAD "GRADE" FRAME_GRADE
			SET_MDL_PARAM TRANSOM_HEAD "FINISH" FRAME_FINISH

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_L" TRANSOM_JAMB_L
		SET_MDL_NAME TRANSOM_JAMB_L "TRANSOM_JAMB_L_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_L_"+SO_NUM+"_"+ ITEM_NUM TRANSOM_JAMB_L
			SET_MDL_PARAM TRANSOM_JAMB_L "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM TRANSOM_JAMB_L "TYPE" MAT_TYPE
			SET_MDL_PARAM TRANSOM_JAMB_L "GRADE" FRAME_GRADE
			SET_MDL_PARAM TRANSOM_JAMB_L "FINISH" FRAME_FINISH
			SET_MDL_PARAM TRANSOM_JAMB_L "GRAIN" 1

		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_R" TRANSOM_JAMB_R
		SET_MDL_NAME TRANSOM_JAMB_R "TRANSOM_JAMB_R_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF RECURSIVE ASSEM COMPONENT "TRANSOM_JAMB_R_"+SO_NUM+"_"+ ITEM_NUM TRANSOM_JAMB_R
			SET_MDL_PARAM TRANSOM_JAMB_R "SMT_THICKNESS" FR_THICKNESS
			SET_MDL_PARAM TRANSOM_JAMB_R "TYPE" MAT_TYPE
			SET_MDL_PARAM TRANSOM_JAMB_R "GRADE" FRAME_GRADE
			SET_MDL_PARAM TRANSOM_JAMB_R "FINISH" FRAME_FINISH
			SET_MDL_PARAM TRANSOM_JAMB_R "GRAIN" 1

		IF GRAIN == "VERTICAL"
				SET_MDL_PARAM HEAD "GRAIN" 2
				SET_MDL_PARAM TRANSOM_HEAD "GRAIN" 2
				SET_MDL_PARAM MULLION_FILLER "GRAIN" 2
		ELSE_IF GRAIN == "HORIZONTAL"
				SET_MDL_PARAM HEAD "GRAIN" 1
				SET_MDL_PARAM TRANSOM_HEAD "GRAIN" 1
				SET_MDL_PARAM MULLION_FILLER "GRAIN" 1
		END_IF
	END_IF

	IF TRANSOM_PANEL == "YES"
		SEARCH_MDL_REF FRAME_ASM CSYS "T_PANEL"  T_PANEL_CSYS

		RETRIEVE_MDL	transom_panel.asm	T_PANEL
		SET_MDL_NAME T_PANEL "T_PANEL_"+SO_NUM+"_"+ ITEM_NUM
		SET_MDL_PARAM T_PANEL "LENGTH" JOW
		SET_MDL_PARAM T_PANEL "HEIGHT" TRANSOM_PANEL_HEIGHT
		SET_MDL_PARAM T_PANEL "RABBET" RABBET
		SET_MDL_PARAM T_PANEL "STOPP" STOPP
		SET_MDL_PARAM T_PANEL "THICKNESS" TRANSOM_PANEL_THICKNESS
		SET_MDL_PARAM T_PANEL "GRADE" GRADE
		SET_MDL_PARAM T_PANEL "FINISH" FINISH
		SET_MDL_PARAM T_PANEL "ATTACH_METHOD" TRANSOM_PANEL_ATTACH_METHOD
		SET_MDL_PARAM T_PANEL "CORE" TRANSOM_PANEL_CORE_DESC

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_PANEL_BODY" T_BODY
		SET_MDL_NAME T_BODY "T_PANEL_BODY_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_PANEL_BODY_"+SO_NUM+"_"+ ITEM_NUM T_BODY

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_PANEL_COVER" T_COVER
		SET_MDL_NAME T_COVER "T_PANEL_COVER_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_PANEL_COVER_"+SO_NUM+"_"+ ITEM_NUM T_COVER

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_CHANNEL" T_CHANNEL
		SET_MDL_NAME T_CHANNEL "T_CHANNEL_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_CHANNEL_"+SO_NUM+"_"+ ITEM_NUM T_CHANNEL

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_PANEL_CORE" T_CORE
		SET_MDL_NAME T_CORE "T_CORE_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_CORE_"+SO_NUM+"_"+ ITEM_NUM T_CORE

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_ASTRAGAL" T_ASTRAGAL
		SET_MDL_NAME T_ASTRAGAL "T_ASTRAGAL_"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_ASTRAGAL_"+SO_NUM+"_"+ ITEM_NUM T_ASTRAGAL

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_ANGLE_1" TANGLE1
		SET_MDL_NAME TANGLE1 "T_ANGLE1"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_ANGLE1"+SO_NUM+"_"+ ITEM_NUM TANGLE1

		SEARCH_MDL_REF T_PANEL COMPONENT "TRANSOM_ANGLE_2" TANGLE2
		SET_MDL_NAME TANGLE2 "T_ANGLE2"+SO_NUM+"_"+ ITEM_NUM
		SEARCH_MDL_REF T_PANEL COMPONENT "T_ANGLE2"+SO_NUM+"_"+ ITEM_NUM TANGLE2

		IF TRANSOM_PANEL_ATTACH_METHOD == 0 OR TRANSOM_PANEL_ATTACH_METHOD == 2
			SEARCH_MDL_REFS ALLOW_SUPPRESSED T_PANEL COMPONENT "*ANGLE*" refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat SUPPRESSED
			END_FOR
		END_IF

		SEARCH_MDL_REF T_PANEL CSYS "PLACEMENT" PLACEMENT

		ASSEMBLE T_PANEL FRAME_ASM
			CSYS T_PANEL_CSYS PLACEMENT
		END_ASSEMBLE
	END_IF

	IF DW_RTRN <> "NO"
		SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED ASSEM FEATURE "DW*"+DW_RTRN refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat RESUMED
			END_FOR
	END_IF

	IF XDW_RTRN <> "NO"
		SEARCH_MDL_REFS RECURSIVE ALLOW_SUPPRESSED ASSEM FEATURE "XDW*"+XDW_RTRN refFeats
			FOR refFeat REF ARRAY refFeats
				SET_FEATURE_STATE refFeat RESUMED
			END_FOR
	END_IF

	IF SUB_TYPE == "P"
		SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

		IF ACTIVE_LEAF < 1 OR ACTIVE_LEAF == JOW/2 OR ACTIVE_LEAF == 99
			DOOR_CTR = 0
		ELSE_IF HAND == "LHA" OR HAND == "RHRA"
			DOOR_CTR = (JOW/2) - ACTIVE_LEAF
		ELSE_IF HAND == "RHA" OR HAND == "LHRA"
			DOOR_CTR = -((JOW/2) - ACTIVE_LEAF)
		ELSE
			DOOR_CTR = 0
		END_IF

		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX DOOR_CTR
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ 0
			UDF_EXP_REF DOOR_CTR_CSYS CSYS 0
		END_CREATE_UDF
	END_IF

	IF HOSPITAL_STOPS == "YES"
		SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB1 FEATURE "*HOSPITAL*" refFeat1
			SET_FEATURE_STATE refFeat1 RESUMED
		SEARCH_MDL_REF ALLOW_SUPPRESSED JAMB2 FEATURE "*HOSPITAL*" refFeat2
			SET_FEATURE_STATE refFeat2 RESUMED
		REGEN_MDL ASSEM FORCE
		REGEN_MDL ASSEM FORCE
		SEARCH_MDL_REF JAMB1 CSYS "HOSPITAL_STOP*" FILLER
		SEARCH_FEAT_PARAM FILLER "MODEL" COMP
		SEARCH_FEAT_PARAM FILLER "LENGTH" LENGTH
		SEARCH_FEAT_PARAM FILLER "WIDTH" WIDTH
		RETRIEVE_MDL COMP COMP
		GET_MDL_NAME COMP PRT_NAME
		INSERT_FAMINSTANCE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM
		SET_FAMITEM_VALUE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM "LENGTH" LENGTH
		SET_FAMITEM_VALUE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM "WIDTH" WIDTH
		SET_FAMITEM_VALUE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM "SMT_THICKNESS" FR_THICKNESS
		GET_REF_FAMINSTANCE COMP "FILLER_" + SO_NUM + "_" + ITEM_NUM INST

		SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE INST FRAME_ASM
				CSYS FILLER PLACEMENT
			END_ASSEMBLE

		SEARCH_MDL_REF JAMB2 CSYS "HOSPITAL_STOP*" FILLER
			ASSEMBLE INST FRAME_ASM
				CSYS FILLER PLACEMENT
			END_ASSEMBLE
	END_IF

	REGEN_MDL ASSEM FORCE

	IF SILENCERS == "YES"
		SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
		IF SUB_TYPE == "S"
			IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
			   HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) - (STOPP/2)
					UDF_DIM	LOCY JOH - 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH .25
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) - (STOPP/2)
					UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH .25
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX (JOW/2) - (STOPP/2)
					UDF_DIM	LOCY 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH .25
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
			END_IF
			IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
			  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
					UDF_DIM	LOCY JOH - 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH .25
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
					UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH .25
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 90
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - (STOPP/2))
					UDF_DIM	LOCY 8
					UDF_DIM	LOCZ (JD/2) - RABBET
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
				CREATE_UDF udf\hole FRAME_ASM
					UDF_REF ATTACH refCsys
					UDF_DIM	DIA SILENCER_HOLE_DIA
					UDF_DIM	DEPTH .25
					UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF
			END_IF
		END_IF
		IF SUB_TYPE == "P"
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH DOOR_CTR_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 90
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 6
				UDF_DIM	LOCY JOH - (HEAD_STOPP/2)
				UDF_DIM	LOCZ (JD/2) - RABBET
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\hole FRAME_ASM
				UDF_REF ATTACH refCsys
				UDF_DIM	DIA SILENCER_HOLE_DIA
				UDF_DIM	DEPTH .25
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH DOOR_CTR_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 90
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -6
				UDF_DIM	LOCY JOH - (HEAD_STOPP/2)
				UDF_DIM	LOCZ (JD/2) - RABBET
				UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
			CREATE_UDF udf\hole FRAME_ASM
				UDF_REF ATTACH refCsys
				UDF_DIM	DIA SILENCER_HOLE_DIA
				UDF_DIM	DEPTH .25
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF
	END_IF

	IF (FLUSH_BOLTS == 1 OR FLUSH_BOLTS == 3) AND SUB_TYPE == "P"
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH DOOR_CTR_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY JOH + FR_THICKNESS +.01
			UDF_DIM	LOCZ (JD/2) - (RABBET/2)
			UDF_EXP_REF refCsys CSYS 0
		END_CREATE_UDF
		CREATE_UDF udf\rect_cut FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	DIMY .25
			UDF_DIM	DIMZ 1.015
			UDF_DIM	DIMX 3.515
			UDF_INTERSECTION * PART_LEVEL
		END_CREATE_UDF
	RETRIEVE_MDL FLUSH_BOLT_HEAD_ASM.ASM FLBLT
	SEARCH_MDL_REF FLBLT CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE FLBLT FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
	END_IF

	IF HINGE_TYPE == "BUTT"
		DECLARE_VARIABLE STRING LOOKUPSTRINGNO
						LOOKUPSTRINGNO = "HINGE_HEIGHT == " + ftos(HINGE_HEIGHT,3) + " AND HINGE_THICKNESS == " + ftos(HINGE_THICKNESS,3) + \
						 " AND FR_GA == " + ftos(FR_THICKNESS,3) + " AND GRADE == " +FRAME_GRADE + " AND ELEC == 0" + " AND WELDED_BOX == " + itos(WELDED_BOXES)
		DECLARE_VARIABLE STRING LOOKUPSTRINGYES
						LOOKUPSTRINGYES = "HINGE_HEIGHT == " + ftos(HINGE_HEIGHT,3) + " AND HINGE_THICKNESS == " + ftos(HINGE_THICKNESS,3)	 + \
						" AND FR_GA == " + ftos(FR_THICKNESS,3) + " AND GRADE == " +FRAME_GRADE	+ " AND ELEC == 1" + " AND WELDED_BOX == " + itos(WELDED_BOXES)

		IF HAND == "LHR" OR HAND == "RH" OR HAND == "LHRA" OR HAND == "RHRA" OR \
		   HAND == "LHR/RHR" OR HAND == "LHA"  OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY JOH
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF


			! HINGE_HEIGHT_CUT = HINGE_THICKNESS+.03
			! HINGE_WIDTH_CUT = RABBET - JAMB_HINGE_SETBACK + .01

			! HINGE_HEIGHT_CUT = HINGE_THICKNESS+.160
			! HINGE_WIDTH_CUT = RABBET - JAMB_HINGE_SETBACK + .065


				HINGE_INDEX = 1
			FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
				CREATE_UDF udf\frame_hinge FRAME_ASM
				UDF_REF ATTACH refCsys
				UDF_DIM LOCY -LOCY
				UDF_DIM DIMX HINGE_THICKNESS+.03
				UDF_DIM DIMY HINGE_HEIGHT + .02
				UDF_DIM DIMZ RABBET - JAMB_HINGE_SETBACK + .01
				UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
				UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF

				RETRIEVE_MDL frame_hinge_asm.asm HINGE_ASM
				SEARCH_MDL_REF HINGE_ASM CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE HINGE_ASM FRAME_ASM
					CSYS LOC+itos(HINGE_INDEX) PLACEMENT
				END_ASSEMBLE

				IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
					LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGYES instance_name
					GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
					REPLACE_COMPONENT HINGE_ASM instance
					IF DUST_BOXES == YES
						USE_LIBRARY_MDL dust_box part PRT
						GET_MDL_NAME PRT PRT_NAME
						INSERT_FAMINSTANCE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
						SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
						SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
						SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
						SET_FAMITEM_VALUE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 1
						GET_REF_FAMINSTANCE PRT PRT_NAME +"_R_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS LOC+itos(HINGE_INDEX) PLACEMENT
							END_ASSEMBLE
					END_IF
				ELSE
					LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGNO instance_name
					GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
					REPLACE_COMPONENT HINGE_ASM instance
					IF DUST_BOXES == YES
						RETRIEVE_MDL DUST_BOX.PRT PRT
						SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE PRT FRAME_ASM
							CSYS LOC+itos(HINGE_INDEX) PLACEMENT
						END_ASSEMBLE
						! USE_LIBRARY_MDL dust_box part PRT
						! GET_MDL_NAME PRT PRT_NAME
						! INSERT_FAMINSTANCE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 0
						! GET_REF_FAMINSTANCE PRT PRT_NAME +"_R_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
						! SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							! ASSEMBLE INST FRAME_ASM
								! CSYS LOC+itos(HINGE_INDEX) PLACEMENT
							! END_ASSEMBLE
					END_IF
				END_IF
				HINGE_INDEX ++
			END_FOR
		END_IF

		IF HAND == "RHR" OR HAND == "LH" OR HAND == "LHRA" OR HAND == "RHRA" OR \
		   HAND == "LHR/RHR" OR HAND == "LHA"  OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY JOH
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

				HINGE_INDEX = 1
			FOR LOCY REF ARRAY HINGE_LOCATIONS_ARRAY
				CREATE_UDF udf\frame_hinge FRAME_ASM
				UDF_REF ATTACH refCsys
				UDF_DIM LOCY LOCY
				UDF_DIM DIMX HINGE_THICKNESS+.03
				UDF_DIM DIMY HINGE_HEIGHT + .02
				UDF_DIM DIMZ RABBET - JAMB_HINGE_SETBACK + .01
				UDF_EXP_REF LOC+itos(HINGE_INDEX) CSYS 0
				UDF_INTERSECTION * PART_LEVEL
				END_CREATE_UDF

				RETRIEVE_MDL frame_hinge_asm.asm HINGE_ASM
				SEARCH_MDL_REF HINGE_ASM CSYS "PLACEMENT" PLACEMENT
				ASSEMBLE HINGE_ASM FRAME_ASM
					CSYS LOC+itos(HINGE_INDEX) PLACEMENT
				END_ASSEMBLE

				IF ELECTRIC_HINGE_POSITION == HINGE_INDEX
					LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGYES instance_name
					GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
					REPLACE_COMPONENT HINGE_ASM instance
					IF DUST_BOXES == YES
						USE_LIBRARY_MDL dust_box part PRT
						GET_MDL_NAME PRT PRT_NAME
						INSERT_FAMINSTANCE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
						SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
						SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
						SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
						SET_FAMITEM_VALUE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 1
						GET_REF_FAMINSTANCE PRT PRT_NAME +"_L_E_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							ASSEMBLE INST FRAME_ASM
								CSYS LOC+itos(HINGE_INDEX) PLACEMENT
							END_ASSEMBLE
					END_IF
				ELSE
					LOOKUP_FAMINSTANCE HINGE_ASM LOOKUPSTRINGNO instance_name
					GET_REF_FAMINSTANCE HINGE_ASM instance_name instance
					REPLACE_COMPONENT HINGE_ASM instance
					IF DUST_BOXES == YES
						RETRIEVE_MDL DUST_BOX.PRT PRT
						SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE PRT FRAME_ASM
							CSYS LOC+itos(HINGE_INDEX) PLACEMENT
						END_ASSEMBLE
						! USE_LIBRARY_MDL dust_box part PRT
						! GET_MDL_NAME PRT PRT_NAME
						! INSERT_FAMINSTANCE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "STOCKTYPE" 1
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "LENGTH" 10
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "WIDTH" 1.5
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "DEPTH" 1.0
						! SET_FAMITEM_VALUE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM "ELEC" 0
						! GET_REF_FAMINSTANCE PRT PRT_NAME +"_L_HINGE_"+itos(HINGE_INDEX)+"_"+ ITEM_NUM INST
						! SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
							! ASSEMBLE INST FRAME_ASM
								! CSYS LOC+itos(HINGE_INDEX) PLACEMENT
							! END_ASSEMBLE
					END_IF
				END_IF
				HINGE_INDEX ++
			END_FOR
		END_IF
	END_IF
	! END FRAME BUTT HINGE PREPS

	! BEGIN FRAME PREPS - CONTINUOUS HINGE
	IF HINGE_TYPE == "CONTINUOUS"
		IF HAND == "LHR" OR HAND == "LHRA" OR HAND == "LHR/RHR" OR \
		  HAND == "RH" OR HAND == "RHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX -(JOW/2) - FR_THICKNESS
				UDF_DIM	LOCY JOH
				UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
				UDF_EXP_REF ASM_CSYS CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL BU_FLAT.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE COMP FRAME_ASM
				 CSYS ASM_CSYS PLACEMENT
			END_ASSEMBLE

			INSERT_FAMINSTANCE COMP "COMP_1_"+ ITEM_NUM
			SET_FAMITEM_VALUE COMP "COMP_1_"+ ITEM_NUM "LENGTH" JOH - 2
			SET_FAMITEM_VALUE COMP "COMP_1_"+ ITEM_NUM "WIDTH" RABBET - ((FR_THICKNESS+.03)*2)
			SET_FAMITEM_VALUE COMP "COMP_1_"+ ITEM_NUM "SMT_THICKNESS" .105
			GET_REF_FAMINSTANCE COMP "COMP_1_"+ ITEM_NUM INST
			REPLACE_COMPONENT COMP INST
		END_IF

		IF HAND == "RHR" OR HAND == "RHRA" OR HAND == "LHR/RHR" OR \
		  HAND == "LH" OR HAND == "LHA" OR HAND == "LH/RH"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ASM_CSYS
				UDF_DIM	ROTX 180
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 180
				UDF_DIM	LOCX (JOW/2) + FR_THICKNESS
				UDF_DIM	LOCY JOH
				UDF_DIM	LOCZ (JD/2) - ((RABBET+FR_THICKNESS)/2)
				UDF_EXP_REF ASM_CSYS CSYS 0
			END_CREATE_UDF

			RETRIEVE_MDL BU_FLAT.PRT COMP
			SEARCH_MDL_REF COMP CSYS "PLACEMENT" PLACEMENT
			ASSEMBLE COMP FRAME_ASM
				 CSYS ASM_CSYS PLACEMENT
			END_ASSEMBLE

			INSERT_FAMINSTANCE COMP "COMP_2_"+ ITEM_NUM
			SET_FAMITEM_VALUE COMP "COMP_2_"+ ITEM_NUM "LENGTH" JOH - 2
			SET_FAMITEM_VALUE COMP "COMP_2_"+ ITEM_NUM "WIDTH" RABBET - ((FR_THICKNESS+.03)*2)
			SET_FAMITEM_VALUE COMP "COMP_2_"+ ITEM_NUM "SMT_THICKNESS" .105
			GET_REF_FAMINSTANCE COMP "COMP_2_"+ ITEM_NUM INST
			REPLACE_COMPONENT COMP INST
		END_IF
	END_IF
	! END FRAME PREPS - CONTINUOUS HINGE

	IF PRIMARY_STRIKE_UDF == "STRIKE T" AND SUB_TYPE == "S"
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
			UDF_DIM	STRIKE_LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
			UDF_DIM	STRIKE_LIP_DEPTH PRIMARY_STRIKE_LIP_THICKNESS
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH PRIMARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT PRIMARY_STRIKE_HEIGHT
			UDF_DIM	STRIKE_LIP_HEIGHT PRIMARY_STRIKE_LIP_HEIGHT
			UDF_DIM	STRIKE_LIP_DEPTH PRIMARY_STRIKE_LIP_THICKNESS
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE STRIKE FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
		LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == PRIMARY_STRIKE_HEIGHT" INST_NAME
		GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
		REPLACE_COMPONENT STRIKE STRIKE_INST
	END_IF

	IF PRIMARY_STRIKE_UDF == "RIM"

		DECLARE_VARIABLE DOUBLE TEMP_VALUE
		IF SOFFIT < 1.875
			TEMP_VALUE = SOFFIT - .375
		ELSE
			TEMP_VALUE = 1.5
		END_IF

		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2) + STOPP - FR_THICKNESS - .125
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2) - RABBET - .1875 - (TEMP_VALUE/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2) - STOPP + FR_THICKNESS + .125
			UDF_DIM	LOCY PRIMARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2) - RABBET - .1875 - (TEMP_VALUE/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
		END_IF

			RETRIEVE_MDL BU_FLAT.PRT BU
			GET_MDL_NAME BU BU_NAME
			INSERT_FAMINSTANCE BU BU_NAME + "_RIM_" + ITEM_NUM
			SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "LENGTH" 6
			SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "WIDTH" 1.5
			SET_FAMITEM_VALUE BU BU_NAME + "_RIM_" + ITEM_NUM "SMT_THICKNESS" .105
			GET_REF_FAMINSTANCE BU BU_NAME + "_RIM_" + ITEM_NUM INST
			SEARCH_MDL_REF INST CSYS "PLACEMENT4" PLACEMENT4
			ASSEMBLE INST FRAME_ASM
				CSYS refCsys PLACEMENT4
			END_ASSEMBLE
	END_IF


	IF PRIMARY_LOCK_TYPE == "*EXIT*" AND (SURFACE_VERTICAL_RODS == 1 OR SURFACE_VERTICAL_RODS == 3)
		SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
		SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

		IF HAND == "LHR" OR HAND == "RH"
			CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 90
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX ((JOW/2) - 5.5)
					UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
					UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .06
					UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF
		END_IF

		IF HAND == "RHR" OR HAND == "LH"
			CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 90
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) - 5.5)
					UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
					UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .06
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
		END_IF

		IF SUB_TYPE == "P"
			CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ASM_CSYS
					UDF_DIM	ROTX 90
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX DOOR_CTR
					UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
					UDF_DIM	LOCZ (JD/2) - RABBET - FR_THICKNESS - .06
					UDF_EXP_REF refCsys CSYS 0
				END_CREATE_UDF
		END_IF

		DECLARE_VARIABLE DOUBLE BU_WIDTH
		IF SOFFIT - FR_THICKNESS - FR_THICKNESS - .12 < 1.5
			BU_WIDTH = SOFFIT - FR_THICKNESS - FR_THICKNESS - .12
		ELSE
			BU_WIDTH = 1.5
		END_IF
			RETRIEVE_MDL BU_FLAT.PRT BU
			GET_MDL_NAME BU BU_NAME
			INSERT_FAMINSTANCE BU BU_NAME + "_SVR_" + ITEM_NUM
			SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "LENGTH" 9
			SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "WIDTH" 1.5
			SET_FAMITEM_VALUE BU BU_NAME + "_SVR_" + ITEM_NUM "SMT_THICKNESS" .105
			GET_REF_FAMINSTANCE BU BU_NAME + "_SVR_" + ITEM_NUM INST
			SEARCH_MDL_REF INST CSYS "PLACEMENT2" PLACEMENT2
			ASSEMBLE INST FRAME_ASM
				CSYS refCsys PLACEMENT2
			END_ASSEMBLE
	END_IF

	IF SECONDARY_STRIKE_UDF == "STRIKE D"
		IF HAND == "LH" OR HAND == "RHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX -(JOW/2)
			UDF_DIM	LOCY SECONDARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike-d FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH SECONDARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT SECONDARY_STRIKE_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		IF HAND == "RH" OR HAND == "LHR"
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
			CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ASM_CSYS
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX (JOW/2)
			UDF_DIM	LOCY SECONDARY_STRIKE_CENTER
			UDF_DIM	LOCZ (JD/2)
			UDF_EXP_REF refCsys CSYS 0
			END_CREATE_UDF

			CREATE_UDF udf\strike-d FRAME_ASM
			UDF_REF ATTACH refCsys
			UDF_DIM	SETBACK RABBET/2
			UDF_DIM	STRIKE_WIDTH SECONDARY_STRIKE_WIDTH
			UDF_DIM	STRIKE_HEIGHT SECONDARY_STRIKE_HEIGHT
			UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_IF

		RETRIEVE_MDL FRAME_STRIKE.ASM STRIKE
		SEARCH_MDL_REF STRIKE CSYS "PLACEMENT" PLACEMENT
		ASSEMBLE STRIKE FRAME_ASM
			CSYS refCsys PLACEMENT
		END_ASSEMBLE
		LOOKUP_FAMINSTANCE STRIKE "STRIKE_HEIGHT == SECONDARY_STRIKE_HEIGHT" INST_NAME
		GET_REF_FAMINSTANCE STRIKE INST_NAME STRIKE_INST
		REPLACE_COMPONENT STRIKE STRIKE_INST
	END_IF

	! END FRAME PREPS - STRIKES

	! BEGIN FRAME PREPS - FLOOR CLIPS & ANCHORS
	DECLARE_ARRAY ANCHORS_ARRAY
	DECLARE_VARIABLE 	INTEGER 	ANCHOR_INDEX

	ANCHOR_QTY = ceil((JOH+TRANSOM_PANEL_HEIGHT - ANCHOR_JB_DIST - ANCHOR_JT_DIST)/ANCHOR_JMAX)+1
	ANCHOR_SPACING = (JOH+TRANSOM_PANEL_HEIGHT - ANCHOR_JB_DIST - ANCHOR_JT_DIST) / (ANCHOR_QTY-1)
	SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
	CREATE_UDF udf\csys FRAME_ASM
		UDF_REF ATTACH ATTACH
		UDF_DIM	ROTX 180
		UDF_DIM	ROTY 180
		UDF_DIM	ROTZ 0
		UDF_DIM	LOCX ((JOW/2) + FR_THICKNESS + .03)
		UDF_DIM	LOCY ANCHOR_JB_DIST
		UDF_DIM	LOCZ -ANCHOR_CTR
		UDF_EXP_REF ATTACH CSYS 0
	END_CREATE_UDF
	ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

	ANCHOR_INDEX = 2
	WHILE ANCHOR_INDEX <= ANCHOR_QTY
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY -ANCHOR_SPACING
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

		ANCHOR_INDEX ++
	END_WHILE

	ANCHOR_QTY = ceil((JOH +TRANSOM_PANEL_HEIGHT- ANCHOR_JB_DIST - ANCHOR_JT_DIST)/ANCHOR_JMAX)+1
	ANCHOR_SPACING = (JOH+TRANSOM_PANEL_HEIGHT - ANCHOR_JB_DIST - ANCHOR_JT_DIST) / (ANCHOR_QTY-1)
	SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
	CREATE_UDF udf\csys FRAME_ASM
		UDF_REF ATTACH ATTACH
		UDF_DIM	ROTX 180
		UDF_DIM	ROTY 180
		UDF_DIM	ROTZ 180
		UDF_DIM	LOCX -((JOW/2) + FR_THICKNESS + .03)
		UDF_DIM	LOCY ANCHOR_JB_DIST
		UDF_DIM	LOCZ -ANCHOR_CTR
		UDF_EXP_REF ATTACH CSYS 0
	END_CREATE_UDF
	ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

	ANCHOR_INDEX = 2
	WHILE ANCHOR_INDEX <= ANCHOR_QTY
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 0
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY ANCHOR_SPACING
			UDF_DIM	LOCZ 0
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH
		ANCHOR_INDEX ++
	END_WHILE

	IF ANCHOR_MDL == "*wire*" OR ANCHOR_MDL == "*loose_t*"
		RETRIEVE_MDL ANCHOR_MDL ANCHOR
	END_IF

	IF ANCHOR_MDL == "*stud*"
		RETRIEVE_MDL ANCHOR_MDL GENERIC
		GET_MDL_NAME GENERIC GENERIC_NAME
		INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM
		GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM ANCHOR
		SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM

		IF ANCHOR_DESC == "LOOSE*"
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "LENGTH" JD - (FR_THICKNESS*2) - .06
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "CHAMFER" "Y"
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RABBET" RABBET - FR_THICKNESS - .06
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "XRABBET" XRABBET - FR_THICKNESS - .06
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "OFFSET" FR_THICKNESS + .03
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
		ELSE_IF ANCHOR_DESC == "*WELDED*"
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "LENGTH" JD - RETURN - XRETURN + .1
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "CHAMFER" "N"
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RABBET" RABBET - RETURN +.02
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "XRABBET" XRABBET - XRETURN +.02
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
			IF DW_RTRN == "IN"
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "OFFSET" .5
			ELSE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "OFFSET" FR_THICKNESS
			END_IF
		END_IF
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "WIDTH" FACEE - (FR_THICKNESS*2) - .06
		IF SECTION == 0 OR SECTION == 2
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" 0
		ELSE_IF SECTION == 1
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" STOPP
		END_IF
		IF ANCHOR_DESC == "*WOOD*"
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "WOOD" "Y"
		ELSE
			SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "WOOD" "N"
		END_IF
	END_IF

	IF ANCHOR_MDL == "*pd*"
		CLEAR_ARRAY ARRAYITEMS
		DECLARE_VARIABLE INTEGER ARRAY_INDEX
		DECLARE_VARIABLE STRING NEW_VALUE
		RETRIEVE_MDL ANCHOR_MDL GENERIC
		GET_MDL_NAME GENERIC GENERIC_NAME
		SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
		INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "JD" JD
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "ANCHOR_CTR" ANCHOR_CTR
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FACEE" FACEE
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" STOPP
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
		GET_FAMITEMS GENERIC ARRAYITEMS
		GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
		ARRAY_INDEX = 0

		WHILE ARRAY_INDEX <= ARRAY_SIZE-1
			GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
			IF VALUE == "M*"
				NEW_VALUE = "FID:" + strmid(VALUE,1)
				SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
				GET_REF_GENERIC INST COMP_GENERIC
				GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
				INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_" + ITEM_NUM
			END_IF
			ARRAY_INDEX ++
		END_WHILE

		FOR ATTACH REF ARRAY ANCHORS_ARRAY
			CREATE_UDF udf\hole FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	DIA .385
				UDF_DIM	DEPTH STOPP+.25
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_FOR

		GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM ANCHOR
	END_IF

	IF ANCHOR_MDL == "*conc*"
		CLEAR_ARRAY ARRAYITEMS
		DECLARE_VARIABLE INTEGER ARRAY_INDEX
		DECLARE_VARIABLE STRING NEW_VALUE
		RETRIEVE_MDL ANCHOR_MDL GENERIC
		GET_MDL_NAME GENERIC GENERIC_NAME
		SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
		INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "JD" JD
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "ANCHOR_CTR" ANCHOR_CTR
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FACEE" FACEE
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "STOPP" STOPP
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "SOFFIT" SOFFIT
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "GRADE"FRAME_GRADE
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "TYPE" MAT_TYPE
		SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM "FINISH" "2B"

		GET_FAMITEMS GENERIC ARRAYITEMS
		GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
		ARRAY_INDEX = 0

		WHILE ARRAY_INDEX <= ARRAY_SIZE-1
			GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
			IF VALUE == "M*"
				NEW_VALUE = "FID:" + strmid(VALUE,1)
				SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
				GET_REF_GENERIC INST COMP_GENERIC
				GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
				INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_" + ITEM_NUM
			END_IF
			ARRAY_INDEX ++
		END_WHILE

		FOR ATTACH REF ARRAY ANCHORS_ARRAY
			CREATE_UDF udf\hole FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	DIA 1.015
				UDF_DIM	DEPTH STOPP+.25
				UDF_INTERSECTION * PART_LEVEL
			END_CREATE_UDF
		END_FOR

		GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_" + ITEM_NUM ANCHOR
	END_IF

	SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
		FOR ATTACH REF ARRAY ANCHORS_ARRAY
			ASSEMBLE ANCHOR FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE
		END_FOR

	IF ANCHOR_MDL == "*pd*" AND ANCHOR_BOLTS == "YES"
		RETRIEVE_MDL bolt_pd.prt PRT
		SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
			FOR ATTACH REF ARRAY ANCHORS_ARRAY
				ASSEMBLE PRT FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			END_FOR
	END_IF

	IF ANCHOR_MDL == "*conc*" AND ANCHOR_BOLTS == "YES"
		RETRIEVE_MDL bolt_ewa.prt PRT
		SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
			FOR ATTACH REF ARRAY ANCHORS_ARRAY
				ASSEMBLE PRT FRAME_ASM
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE
			END_FOR
	END_IF

				RETRIEVE_MDL DRAWING_ANCHOR.ASM SECTION
				GET_MDL_NAME SECTION SECTION_NAME
				INSERT_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM
				GET_REF_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM SECTION
				SET_MDL_PARAM SECTION "ANCHOR_CTR" -ANCHOR_CTR
				SET_MDL_PARAM SECTION "OFFSET" FR_THICKNESS + .03
				SEARCH_MDL_REF SECTION CSYS "PLACEMENT" ATTACH
				GET_MDL_NAME JAMB1 JAMB1_NAME
				INSERT_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM
				GET_REF_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM JAMB
				SEARCH_MDL_REF JAMB CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE JAMB SECTION
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				SEARCH_MDL_REF SECTION CSYS "ACS0" ATTACH
				SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT

				ASSEMBLE ANCHOR SECTION
					CSYS ATTACH PLACEMENT
				END_ASSEMBLE

				ASSEMBLE SECTION ASSEM
					PACKAGED
				END_ASSEMBLE

				SET_FEATURE_STATE SECTION SUPPRESSED

	! BEGIN TRANSOM FRAME ANCHORS PREPS
	IF FRAME_ELEVATION == 5
		DECLARE_ARRAY ANCHORS_ARRAY
		CLEAR_ARRAY ANCHORS_ARRAY
		DECLARE_VARIABLE 	INTEGER 	ANCHOR_INDEX
		ANCHOR_QTY = ceil((TRANSOM_HEIGHT + HEAD+ ANCHOR_JT_DIST - ANCHOR_JT_DIST)/ANCHOR_JMAX)
		ANCHOR_SPACING = (TRANSOM_HEIGHT +HEAD+ ANCHOR_JT_DIST - ANCHOR_JT_DIST) / ANCHOR_QTY
		SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 180
			UDF_DIM	ROTY 180
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX ((JOW/2) + FR_THICKNESS + .03)
			UDF_DIM	LOCY JOH - ANCHOR_JT_DIST + ANCHOR_SPACING
			UDF_DIM	LOCZ -TRANSOM_ANCHOR_CENTER
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

		ANCHOR_INDEX = 2
		WHILE ANCHOR_INDEX <= ANCHOR_QTY
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY -ANCHOR_SPACING
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

			ANCHOR_INDEX ++
		END_WHILE

		SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 180
			UDF_DIM	ROTY 180
			UDF_DIM	ROTZ 180
			UDF_DIM	LOCX -((JOW/2) + FR_THICKNESS + .03)
			UDF_DIM	LOCY JOH - ANCHOR_JT_DIST + ANCHOR_SPACING
			UDF_DIM	LOCZ -TRANSOM_ANCHOR_CENTER
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF
		ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH

		ANCHOR_INDEX = 2
		WHILE ANCHOR_INDEX <= ANCHOR_QTY
			CREATE_UDF udf\csys FRAME_ASM
				UDF_REF ATTACH ATTACH
				UDF_DIM	ROTX 0
				UDF_DIM	ROTY 0
				UDF_DIM	ROTZ 0
				UDF_DIM	LOCX 0
				UDF_DIM	LOCY ANCHOR_SPACING
				UDF_DIM	LOCZ 0
				UDF_EXP_REF ATTACH CSYS 0
			END_CREATE_UDF
			ADD_ARRAY_ELEM ANCHORS_ARRAY ATTACH
			ANCHOR_INDEX ++
		END_WHILE

		IF ANCHOR_MDL == "*wire*" OR ANCHOR_MDL == "*loose_t*"
			RETRIEVE_MDL ANCHOR_MDL ANCHOR
		END_IF

		IF ANCHOR_MDL == "*stud*" OR TRANSOM_SECTION == SECTION
			SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					ASSEMBLE ANCHOR FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				END_FOR
		END_IF

		IF TRANSOM_SECTION == SECTION AND ANCHOR_CTR == TRANSOM_ANCHOR_CENTER
			IF ANCHOR_MDL == "*pd*"
				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	DIA .385
						UDF_DIM	DEPTH STOPP+.25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_FOR
			END_IF

			IF ANCHOR_MDL == "*conc*"
				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	DIA 1.015
						UDF_DIM	DEPTH STOPP+.25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_FOR
			END_IF

			SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					ASSEMBLE ANCHOR FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				END_FOR

			IF ANCHOR_MDL == "*pd*" AND ANCHOR_BOLTS == "YES"
				RETRIEVE_MDL bolt_pd.prt PRT
				SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
					FOR ATTACH REF ARRAY ANCHORS_ARRAY
						ASSEMBLE PRT FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_FOR
			END_IF

			IF ANCHOR_MDL == "*conc*" AND ANCHOR_BOLTS == "YES"
				RETRIEVE_MDL bolt_ewa.prt PRT
				SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
					FOR ATTACH REF ARRAY ANCHORS_ARRAY
						ASSEMBLE PRT FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_FOR
			END_IF
		END_IF

		IF TRANSOM_SECTION <> SECTION OR ANCHOR_CTR <> TRANSOM_ANCHOR_CENTER
			IF ANCHOR_MDL == "*pd*"
				CLEAR_ARRAY ARRAYITEMS
				DECLARE_VARIABLE INTEGER ARRAY_INDEX
				DECLARE_VARIABLE STRING NEW_VALUE
				RETRIEVE_MDL ANCHOR_MDL GENERIC
				GET_MDL_NAME GENERIC GENERIC_NAME
				SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
				INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOCKTYPE" 1
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "JD" JD
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "ANCHOR_CTR" TRANSOM_ANCHOR_CENTER
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FACEE" FACEE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOPP" TRANSOM_STOPP
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
				GET_FAMITEMS GENERIC ARRAYITEMS
				GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
				ARRAY_INDEX = 0

				WHILE ARRAY_INDEX <= ARRAY_SIZE-1
					GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
					IF VALUE == "M*"
						NEW_VALUE = "FID:" + strmid(VALUE,1)
						SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
						GET_REF_GENERIC INST COMP_GENERIC
						GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
						INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_T_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_T_" + ITEM_NUM
					END_IF
					ARRAY_INDEX ++
				END_WHILE

				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	DIA .385
						UDF_DIM	DEPTH TRANSOM_STOPP+.25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_FOR

				GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM ANCHOR
			END_IF

			IF ANCHOR_MDL == "*conc*"
				CLEAR_ARRAY ARRAYITEMS
				DECLARE_VARIABLE INTEGER ARRAY_INDEX
				DECLARE_VARIABLE STRING NEW_VALUE
				RETRIEVE_MDL ANCHOR_MDL GENERIC
				GET_MDL_NAME GENERIC GENERIC_NAME
				SEARCH_MDL_PARAM GENERIC "EMJACNUM" EMJACNUM
				INSERT_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOCKTYPE" 1
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "JD" JD
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "ANCHOR_CTR" TRANSOM_ANCHOR_CENTER
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FACEE" FACEE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "STOPP" TRANSOM_STOPP
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FR_THICKNESS" FR_THICKNESS
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "SOFFIT" SOFFIT
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "GRADE"FRAME_GRADE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "TYPE" MAT_TYPE
				SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM "FINISH" "2B"

				GET_FAMITEMS GENERIC ARRAYITEMS
				GET_ARRAY_SIZE ARRAYITEMS ARRAY_SIZE
				ARRAY_INDEX = 0

				WHILE ARRAY_INDEX <= ARRAY_SIZE-1
					GET_ARRAY_ELEM ARRAYITEMS ARRAY_INDEX VALUE
					IF VALUE == "M*"
						NEW_VALUE = "FID:" + strmid(VALUE,1)
						SEARCH_MDL_REF GENERIC COMPONENT NEW_VALUE INST
						GET_REF_GENERIC INST COMP_GENERIC
						GET_MDL_NAME COMP_GENERIC COMP_GENERIC_NAME
						INSERT_FAMINSTANCE COMP_GENERIC COMP_GENERIC_NAME +"_T_" + ITEM_NUM
						SET_FAMITEM_VALUE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM VALUE COMP_GENERIC_NAME +"_T_" + ITEM_NUM
					END_IF
					ARRAY_INDEX ++
				END_WHILE

				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					CREATE_UDF udf\hole FRAME_ASM
						UDF_REF ATTACH ATTACH
						UDF_DIM	DIA 1.015
						UDF_DIM	DEPTH TRANSOM_STOPP+.25
						UDF_INTERSECTION * PART_LEVEL
					END_CREATE_UDF
				END_FOR

				GET_REF_FAMINSTANCE GENERIC GENERIC_NAME +"_T_" + ITEM_NUM ANCHOR
			END_IF

			SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT
				FOR ATTACH REF ARRAY ANCHORS_ARRAY
					ASSEMBLE ANCHOR FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
				END_FOR

			IF ANCHOR_MDL == "*pd*" AND ANCHOR_BOLTS == "YES"
				RETRIEVE_MDL bolt_pd.prt PRT
				SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
					FOR ATTACH REF ARRAY ANCHORS_ARRAY
						ASSEMBLE PRT FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_FOR
			END_IF

			IF ANCHOR_MDL == "*conc*" AND ANCHOR_BOLTS == "YES"
				RETRIEVE_MDL bolt_ewa.prt PRT
				SEARCH_MDL_REF PRT CSYS "PLACEMENT" PLACEMENT
					FOR ATTACH REF ARRAY ANCHORS_ARRAY
						ASSEMBLE PRT FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_FOR
			END_IF
		END_IF

				! RETRIEVE_MDL DRAWING_ANCHOR.ASM SECTION
				! GET_MDL_NAME SECTION SECTION_NAME
				! INSERT_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM
				! GET_REF_FAMINSTANCE SECTION SECTION_NAME+"_"+ ITEM_NUM SECTION
				! SET_MDL_PARAM SECTION "ANCHOR_CTR" -ANCHOR_CTR
				! SET_MDL_PARAM SECTION "OFFSET" FR_THICKNESS + .03
				! SEARCH_MDL_REF SECTION CSYS "PLACEMENT" ATTACH

				! GET_MDL_NAME JAMB1 JAMB1_NAME
				! INSERT_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM
				! GET_REF_FAMINSTANCE JAMB1 "JAMB_"+ ITEM_NUM JAMB
				! SEARCH_MDL_REF JAMB CSYS "PLACEMENT" PLACEMENT

				! ASSEMBLE JAMB SECTION
					! CSYS ATTACH PLACEMENT
				! END_ASSEMBLE

				! SEARCH_MDL_REF SECTION CSYS "ACS0" ATTACH
				! SEARCH_MDL_REF ANCHOR CSYS "PLACEMENT" PLACEMENT

				! ASSEMBLE ANCHOR SECTION
					! CSYS ATTACH PLACEMENT
				! END_ASSEMBLE

				! ASSEMBLE SECTION ASSEM
					! PACKAGED
				! END_ASSEMBLE

				! SET_FEATURE_STATE SECTION SUPPRESSED
	END_IF

	! FLOOR CLIPS
	IF FLOOR_CLIPS <> "NONE"
		DECLARE_VARIABLE STRING FLOOR_CLIP_MDL
		FLOOR_CLIP_MDL = "floor_clip_" + mklower(FLOOR_CLIPS)

			USE_LIBRARY_MDL FLOOR_CLIP_MDL part PRT
			GET_MDL_NAME PRT PRT_NAME
			SEARCH_MDL_PARAM PRT "EMJACNUM" EMJACNUM
			INSERT_FAMINSTANCE PRT PRT_NAME +"_" + ITEM_NUM
			SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOCKTYPE" 1
			SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-" + ITEM_NUM

			SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "LENGTH" JD - RETURN - XRETURN + .1
			IF DW_RTRN == "IN"
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "WIDTH" FACEE - FR_THICKNESS - .53
			ELSE
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "WIDTH" FACEE - (FR_THICKNESS*2) - .12
			END_IF

			IF SECTION == 0
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOPP" 0
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RABBET" 1.75 - RETURN +.02
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "XRABBET" 1.75 - XRETURN +.02
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
			ELSE_IF SECTION == 1
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOPP" STOPP
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RABBET" RABBET - RETURN +.02
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "XRABBET" JD - RABBET - RETURN - .5
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
			ELSE_IF SECTION == 2
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "STOPP" 0
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RABBET" RABBET - RETURN +.02
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "XRABBET" XRABBET - XRETURN +.02
				SET_FAMITEM_VALUE PRT PRT_NAME +"_" + ITEM_NUM "RECESS" ANCHOR_RECESS
			END_IF

			GET_REF_FAMINSTANCE PRT PRT_NAME +"_"+ ITEM_NUM INST
			SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

				SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX ((JOW/2) + FR_THICKNESS + .03)
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ -JD/2
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE

				SEARCH_MDL_REF FRAME_ASM CSYS "ASM_DEF_CSYS" ATTACH
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH ATTACH
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 180
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX -((JOW/2) + FR_THICKNESS + .03)
					UDF_DIM	LOCY 0
					UDF_DIM	LOCZ -JD/2
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
	END_IF
	! END FRAME PREPS - FLOOR CLIPS & ANCHORS

! FRAME CLOSERS
	DECLARE_VARIABLE INTEGER CLOSER_QTY 10
	DECLARE_VARIABLE INTEGER CLOSER_INDEX
	CLOSER_INDEX = 10

	IF SUB_TYPE == "S"
		CLOSER_QTY = 10
	ELSE_IF SUB_TYPE == "P"
		CLOSER_QTY = 20
	END_IF

	WHILE CLOSER_INDEX <= CLOSER_QTY

		IF (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA")) OR \
		  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
			CLOSER_TYPE_ =	CLOSER_TYPE_2
			CLOSER_SIDE_ =	CLOSER_SIDE_2
			CLOSER_DESC_ =	CLOSER_DESC_2
			SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH_2
			SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH_2
			CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER_2
			CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER_2
			HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER_2
			HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE_2
			HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL_2
		ELSE
			CLOSER_TYPE_ =	CLOSER_TYPE
			CLOSER_SIDE_ =	CLOSER_SIDE
			CLOSER_DESC_ =	CLOSER_DESC
			SURFACE_CLOSER_LENGTH_ =	SURFACE_CLOSER_LENGTH
			SURFACE_CLOSER_WIDTH_ =	SURFACE_CLOSER_WIDTH
			CONCEALED_CLOSER_MANUFACTURER_ =	CONCEALED_CLOSER_MANUFACTURER
			CONCEALED_CLOSER_MODEL_NUMBER_ =	CONCEALED_CLOSER_MODEL_NUMBER
			HOLDER_STOP_MANUFACTURER_ =	HOLDER_STOP_MANUFACTURER
			HOLDER_STOP_TYPE_ =	HOLDER_STOP_TYPE
			HOLDER_STOP_MODEL_ =	HOLDER_STOP_MODEL
		END_IF

			DECLARE_VARIABLE INTEGER CLSR_INDEX
			CLSR_INDEX = CLOSER_INDEX + 1
			SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" CLSR_REF
			IF CLOSER_TYPE_ == "SURFACE" AND (CLOSER_SIDE_ == "PULL*" OR CLOSER_SIDE_ == "MULTI*")
				IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
				  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "LHA" OR HAND == "RHRA"))
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
						UDF_DIM	LOCY JOH + (FACEE/2)
						UDF_DIM	LOCZ (JD/2) - .25
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL SMCR.PRT SMCR
					GET_MDL_NAME SMCR SMCR_NAME
					INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" FACEE - .375
					GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					CLSR_INDEX ++
				END_IF

				IF (SUB_TYPE == "S" AND (HAND <> "LH" AND HAND <> "RHR")) OR \
				  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "RHA" OR HAND == "LHRA"))
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
						UDF_DIM	LOCY JOH + (FACEE/2)
						UDF_DIM	LOCZ (JD/2) - .25
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL SMCR.PRT SMCR
					GET_MDL_NAME SMCR SMCR_NAME
					INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" FACEE - .375
					GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					CLSR_INDEX ++
				END_IF
			END_IF
			IF CLOSER_INDEX == 10 AND CLOSER_TYPE_ == "OPERATOR" AND (CLOSER_SIDE_ == "PULL*" OR CLOSER_SIDE_ == "MULTI*")
				CREATE_UDF udf\csys FRAME_ASM
					UDF_REF ATTACH CLSR_REF
					UDF_DIM	ROTX 0
					UDF_DIM	ROTY 0
					UDF_DIM	ROTZ 0
					UDF_DIM	LOCX 0
					UDF_DIM	LOCY JOH + (FACEE/2)
					UDF_DIM	LOCZ (JD/2) - .25
					UDF_EXP_REF ATTACH CSYS 0
				END_CREATE_UDF

				RETRIEVE_MDL SMCR.PRT SMCR
					GET_MDL_NAME SMCR SMCR_NAME
					INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" FACEE - .375
					GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					CLSR_INDEX ++
			END_IF
			IF SECTION == 1
				IF CLOSER_TYPE_ == "SURFACE" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
					IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
							UDF_DIM	LOCY (JOH-HEAD_STOPP) + (XFACEE/2)
							UDF_DIM	LOCZ -((JD/2) - .25)
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++

						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2) - STOPP)
							UDF_DIM	LOCY JOH-HEAD_STOPP+.25
							UDF_DIM	LOCZ -((JD/2) - (SOFFIT/2))
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++
					END_IF
					IF (SUB_TYPE == "S" AND (HAND <> "LH" AND HAND <> "RHR")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
							UDF_DIM	LOCY (JOH-HEAD_STOPP) + (XFACEE/2)
							UDF_DIM	LOCZ -((JD/2) - .25)
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++

						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH/_2) - STOPP)
							UDF_DIM	LOCY jOH-HEAD_STOPP+ .25
							UDF_DIM	LOCZ -((JD/2) - (SOFFIT/2))
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++
					END_IF
				END_IF
				IF CLOSER_INDEX == 10 AND CLOSER_TYPE_ == "OPERATOR" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY (JOH-HEAD_STOPP) + (XFACEE/2)
						UDF_DIM	LOCZ -((JD/2) - .25)
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL SMCR.PRT SMCR
					GET_MDL_NAME SMCR SMCR_NAME
					INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW - (2*STOPP)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
					GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					CLSR_INDEX ++

					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY JOH-STOPP+.25
						UDF_DIM	LOCZ -((JD/2) - (SOFFIT/2))
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

					RETRIEVE_MDL SMCR.PRT SMCR
					GET_MDL_NAME SMCR SMCR_NAME
					INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW - (STOPP*2)
					SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
					GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
					SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
					ASSEMBLE INST FRAME_ASM
						CSYS ATTACH PLACEMENT
					END_ASSEMBLE
					CLSR_INDEX ++
				END_IF
			END_IF
			IF SECTION == 2
				IF CLOSER_TYPE_ == "SURFACE" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
					IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "LHA" OR HAND == "RHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
							UDF_DIM	LOCY JOH + (XFACEE/2)
							UDF_DIM	LOCZ -((JD/2) - .25)
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++

						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ((JOW/2) - (SURFACE_CLOSER_LENGTH_/2) - STOPP)
							UDF_DIM	LOCY JOH - HEAD_STOPP + .25
							UDF_DIM	LOCZ -((JD/2) - XRABBET - (SOFFIT/2))
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++
					END_IF
					IF (SUB_TYPE == "S" AND (HAND <> "LH" AND HAND <> "RHR")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "RHA" OR HAND == "LHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2))
							UDF_DIM	LOCY JOH + (XFACEE/2)
							UDF_DIM	LOCZ -((JD/2) - .25)
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++

						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH CLSR_REF
							UDF_DIM	ROTX 90
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - (SURFACE_CLOSER_LENGTH_/2) - STOPP)
							UDF_DIM	LOCY jOH - HEAD_STOPP + .25
							UDF_DIM	LOCZ -((JD/2) - XRABBET - (SOFFIT/2))
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" SURFACE_CLOSER_LENGTH_
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++
					END_IF
				END_IF

				IF CLOSER_INDEX == 10 AND CLOSER_TYPE_ == "OPERATOR" AND (CLOSER_SIDE_ == "PUSH*" OR CLOSER_SIDE_ == "MULTI*")
					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 0
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY JOH + (XFACEE/2)
						UDF_DIM	LOCZ -((JD/2) - .25)
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" XFACEE - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++

					CREATE_UDF udf\csys FRAME_ASM
						UDF_REF ATTACH CLSR_REF
						UDF_DIM	ROTX 90
						UDF_DIM	ROTY 0
						UDF_DIM	ROTZ 0
						UDF_DIM	LOCX 0
						UDF_DIM	LOCY JOH - HEAD_STOPP + .25
						UDF_DIM	LOCZ -((JD/2) - XRABBET -(SOFFIT/2))
						UDF_EXP_REF ATTACH CSYS 0
					END_CREATE_UDF

						RETRIEVE_MDL SMCR.PRT SMCR
						GET_MDL_NAME SMCR SMCR_NAME
						INSERT_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "STOCKTYPE" 1
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "LENGTH" JOW - (2*STOPP)
						SET_FAMITEM_VALUE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) "WIDTH" SOFFIT - .375
						GET_REF_FAMINSTANCE SMCR SMCR_NAME + "_" + ITEM_NUM + "_" + itos(CLSR_INDEX) INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE INST FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
						CLSR_INDEX ++
				END_IF
			END_IF

			IF CLOSER_TYPE_ == "HOLDER" AND HOLDER_STOP_MANUFACTURER_ == "ABH"
				IF HOLDER_STOP_TYPE_ == "SURFACE"
					SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS
					DECLARE_VARIABLE DOUBLE BU_WIDTH

					IF SOFFIT - FR_THICKNESS - FR_THICKNESS - .12 < 1.5
						BU_WIDTH = SOFFIT - FR_THICKNESS - FR_THICKNESS - .12
					ELSE
						BU_WIDTH = 1.5
					END_IF

					IF (SUB_TYPE == "S" AND (HAND <> "RHR" AND HAND <> "LH")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -((JOW/2) - STOPP)
							UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - RABBET - (BU_WIDTH/2) - FR_THICKNESS - .06
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL BU_FLAT.PRT BU
						GET_MDL_NAME BU BU_NAME
						SEARCH_MDL_PARAM BU "EMJACNUM" EMJACNUM
						INSERT_FAMINSTANCE BU BU_NAME +"_HS1_" + ITEM_NUM
						SET_FAMITEM_VALUE BU BU_NAME +"_HS1_" + ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE BU BU_NAME +"_HS1_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-1-" + ITEM_NUM
						SET_FAMITEM_VALUE BU BU_NAME + "_HS1_" + ITEM_NUM "LENGTH" ABH_DIM_B + 4.5
						SET_FAMITEM_VALUE BU BU_NAME + "_HS1_" + ITEM_NUM "WIDTH" 1.5
						SET_FAMITEM_VALUE BU BU_NAME + "_HS1_" + ITEM_NUM "SMT_THICKNESS" .105
						GET_REF_FAMINSTANCE BU BU_NAME + "_HS1_" + ITEM_NUM INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT3" PLACEMENT3
						ASSEMBLE INST FRAME_ASM
							CSYS refCsys PLACEMENT3
						END_ASSEMBLE
					END_IF

					IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 180
							UDF_DIM	LOCX ((JOW/2) - STOPP)
							UDF_DIM	LOCY JOH - HEAD_STOPP + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - RABBET - (BU_WIDTH/2) - FR_THICKNESS - .06
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF

						RETRIEVE_MDL BU_FLAT.PRT BU
						GET_MDL_NAME BU BU_NAME
						SEARCH_MDL_PARAM BU "EMJACNUM" EMJACNUM
						INSERT_FAMINSTANCE BU BU_NAME + "_HS2_" + ITEM_NUM
						SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "STOCKTYPE" 1
						SET_FAMITEM_VALUE BU BU_NAME +"_HS2_" + ITEM_NUM "EMJACNUM" EMJACNUM + "-2-" + ITEM_NUM
						SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "LENGTH" ABH_DIM_B + 4.5
						SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "WIDTH" 1.5
						SET_FAMITEM_VALUE BU BU_NAME + "_HS2_" + ITEM_NUM "SMT_THICKNESS" .105
						GET_REF_FAMINSTANCE BU BU_NAME + "_HS2_" + ITEM_NUM INST
						SEARCH_MDL_REF INST CSYS "PLACEMENT3" PLACEMENT3
						ASSEMBLE INST FRAME_ASM
							CSYS refCsys PLACEMENT3
						END_ASSEMBLE
					END_IF
				END_IF

				IF HOLDER_STOP_TYPE_ == "CONCEALED"
					SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
					SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

					IF (SUB_TYPE == "S" AND (HAND <> "RH" AND HAND <> "LHR")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 10 AND (HAND == "RHA" OR HAND == "LHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX -(JOW/2)
							UDF_DIM	LOCY JOH + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - (RABBET/2)
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 0
							UDF_DIM	LOCX ABH_DIM_B + 1.4375 + (HINGE_GAP/2)
							UDF_DIM	LOCY -.1
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\rect_cut FRAME_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM	DIMY .25
							UDF_DIM	DIMZ .765
							UDF_DIM	DIMX 2.89
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						RETRIEVE_MDL HOLDER_STOP_ASM.ASM BU
						SEARCH_MDL_REF BU CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE BU FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_IF

					IF (SUB_TYPE == "S" AND (HAND <> "RHR" AND HAND <> "LH")) OR \
					  (SUB_TYPE == "P" AND CLOSER_INDEX == 20 AND (HAND == "LHA" OR HAND == "RHRA"))
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH ASM_CSYS
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 180
							UDF_DIM	LOCX (JOW/2)
							UDF_DIM	LOCY JOH + FR_THICKNESS + .1
							UDF_DIM	LOCZ (JD/2) - (RABBET/2)
							UDF_EXP_REF refCsys CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\csys FRAME_ASM
							UDF_REF ATTACH refCsys
							UDF_DIM	ROTX 0
							UDF_DIM	ROTY 0
							UDF_DIM	ROTZ 180
							UDF_DIM	LOCX ABH_DIM_B + 1.4375 + (HINGE_GAP/2)
							UDF_DIM	LOCY .1
							UDF_DIM	LOCZ 0
							UDF_EXP_REF ATTACH CSYS 0
						END_CREATE_UDF
						CREATE_UDF udf\rect_cut FRAME_ASM
							UDF_REF ATTACH ATTACH
							UDF_DIM	DIMY .25
							UDF_DIM	DIMZ .765
							UDF_DIM	DIMX 2.89
							UDF_INTERSECTION * PART_LEVEL
						END_CREATE_UDF

						RETRIEVE_MDL HOLDER_STOP_ASM.ASM BU
						SEARCH_MDL_REF BU CSYS "PLACEMENT" PLACEMENT
						ASSEMBLE BU FRAME_ASM
							CSYS ATTACH PLACEMENT
						END_ASSEMBLE
					END_IF
				END_IF
			END_IF
		CLOSER_INDEX = CLOSER_INDEX + 10
	END_WHILE
!END FRAME CLOSERS
! EXIT
!FRAME DPS
	! IF DPS_MODEL <> ""
		! SEARCH_MDL_REF ASSEM ASSEMBLY "FRAME_ASM_"+SO_NUM+"_"+ ITEM_NUM FRAME_ASM
		! SEARCH_MDL_REF FRAME_ASM CSYS "ORIENT" ASM_CSYS

		! IF DPS_POSITION == "HEAD"
			! IF HAND == "LHR" OR HAND == "RH"
				! CREATE_UDF udf\csys FRAME_ASM
					! UDF_REF ATTACH ASM_CSYS
					! UDF_DIM	ROTX 0
					! UDF_DIM	ROTY 0
					! UDF_DIM	ROTZ 90
					! UDF_DIM	LOCX (JOW/2) - DPS_LOCATION - STRIKE_GAP
					! UDF_DIM	LOCY JOH
					! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
					! UDF_EXP_REF refCsys CSYS 0
				! END_CREATE_UDF

				! CREATE_UDF udf\hole FRAME_ASM
					! UDF_REF ATTACH refCsys
					! UDF_DIM	DIA DPS_HOLE_DIA
					! UDF_DIM	DEPTH 1
					! UDF_INTERSECTION * PART_LEVEL
				! END_CREATE_UDF
			! END_IF

			! IF HAND == "RHR" OR HAND == "LH"
				! CREATE_UDF udf\csys FRAME_ASM
					! UDF_REF ATTACH ASM_CSYS
					! UDF_DIM	ROTX 0
					! UDF_DIM	ROTY 0
					! UDF_DIM	ROTZ 90
					! UDF_DIM	LOCX -((JOW/2) - DPS_LOCATION - STRIKE_GAP)
					! UDF_DIM	LOCY JOH
					! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
					! UDF_EXP_REF refCsys CSYS 0
				! END_CREATE_UDF

				! CREATE_UDF udf\hole FRAME_ASM
					! UDF_REF ATTACH refCsys
					! UDF_DIM	DIA DPS_HOLE_DIA
					! UDF_DIM	DEPTH 1
					! UDF_INTERSECTION * PART_LEVEL
				! END_CREATE_UDF
			! END_IF

			! IF SUB_TYPE == "P"
				! CREATE_UDF udf\csys FRAME_ASM
					! UDF_REF ATTACH DOOR_CTR_CSYS
					! UDF_DIM	ROTX 0
					! UDF_DIM	ROTY 0
					! UDF_DIM	ROTZ 90
					! UDF_DIM	LOCX  -(DPS_LOCATION + (STRIKE_GAP/2))
					! UDF_DIM	LOCY JOH
					! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
					! UDF_EXP_REF refCsys CSYS 0
				! END_CREATE_UDF

				! CREATE_UDF udf\hole FRAME_ASM
					! UDF_REF ATTACH refCsys
					! UDF_DIM	DIA DPS_HOLE_DIA
					! UDF_DIM	DEPTH 1
					! UDF_INTERSECTION * PART_LEVEL
				! END_CREATE_UDF


				! CREATE_UDF udf\csys FRAME_ASM
					! UDF_REF ATTACH ASM_CSYS
					! UDF_DIM	ROTX 0
					! UDF_DIM	ROTY 0
					! UDF_DIM	ROTZ 90
					! UDF_DIM	LOCX (DPS_LOCATION + (STRIKE_GAP/2))
					! UDF_DIM	LOCY JOH
					! UDF_DIM	LOCZ (JD/2) - (RABBET/2)
					! UDF_EXP_REF refCsys CSYS 0
				! END_CREATE_UDF

				! CREATE_UDF udf\hole FRAME_ASM
					! UDF_REF ATTACH refCsys
					! UDF_DIM	DIA DPS_HOLE_DIA
					! UDF_DIM	DEPTH 1
					! UDF_INTERSECTION * PART_LEVEL
				! END_CREATE_UDF
			! END_IF
		! END_IF
	! END_IF

! BEGIN FRAME PREPS - SPREADER

	USE_LIBRARY_MDL spreader part PRT
	GET_MDL_NAME PRT PRT_NAME
	SEARCH_MDL_PARAM PRT "EMJACNUM" EMJACNUM
	INSERT_FAMINSTANCE PRT PRT_NAME +"_1_"+ ITEM_NUM
	SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "STOCKTYPE" 1
	SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "EMJACNUM" EMJACNUM +"-"+ ftos(JOW + (FACEE*2) - .25)

		IF FLOOR_CLIPS == "FIXED" OR FLOOR_CLIPS == "ADJUSTABLE"
			SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "LENGTH" JOW + (FACEE*2) - .25 - (ANCHOR_RECESS*2)
		ELSE_IF FLOOR_CLIPS == "NONE"
			SET_FAMITEM_VALUE PRT PRT_NAME +"_1_"+ ITEM_NUM "LENGTH" JOW
		END_IF

	GET_REF_FAMINSTANCE PRT PRT_NAME +"_1_"+ ITEM_NUM INST
	SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT

		SEARCH_MDL_REF FRAME_ASM CSYS "ANCHORS" ATTACH
			ASSEMBLE INST FRAME_ASM
				CSYS ATTACH PLACEMENT
			END_ASSEMBLE

		CREATE_UDF udf\csys FRAME_ASM
			UDF_REF ATTACH ATTACH
			UDF_DIM	ROTX 0
			UDF_DIM	ROTY 180
			UDF_DIM	ROTZ 0
			UDF_DIM	LOCX 0
			UDF_DIM	LOCY 0
			UDF_DIM	LOCZ -JD
			UDF_EXP_REF ATTACH CSYS 0
		END_CREATE_UDF

	IF SECTION == 1 AND HOSPITAL_STOPS == "NO"
		USE_LIBRARY_MDL spreader part PRT
		GET_MDL_NAME PRT PRT_NAME
		INSERT_FAMINSTANCE PRT PRT_NAME +"_2_"+ ITEM_NUM
		SET_FAMITEM_VALUE PRT PRT_NAME +"_2_"+ ITEM_NUM "STOCKTYPE" 1

		IF FLOOR_CLIPS == "FIXED" OR FLOOR_CLIPS == "ADJUSTABLE"
			SET_FAMITEM_VALUE PRT PRT_NAME +"_2_"+ ITEM_NUM "LENGTH" JOW + (FACEE*2) - .25 - (ANCHOR_RECESS*2)
		ELSE_IF FLOOR_CLIPS == "NONE"
			SET_FAMITEM_VALUE PRT PRT_NAME +"_2_"+ ITEM_NUM "LENGTH" JOW - STOPP - STOPP
		END_IF

		GET_REF_FAMINSTANCE PRT PRT_NAME +"_2_"+ ITEM_NUM INST
		SEARCH_MDL_REF INST CSYS "PLACEMENT" PLACEMENT
	END_IF

		ASSEMBLE INST FRAME_ASM
			CSYS ATTACH PLACEMENT
		END_ASSEMBLE
			





END_ASM_DESCR

