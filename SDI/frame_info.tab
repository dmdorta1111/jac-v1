
BEGIN_GUI_DESCR

CHECKBOX_PARAM INTEGER HELP "YES/NO"

! IF JD == 4.5
	! XRABBET = 1.25
! ELSE
	! XRABBET = 1.9375
! END_IF

! IF HAND == "L*"
	! SIDE_LITE_SIDE = 2
! ELSE_IF HAND == "R*"
	! SIDE_LITE_SIDE = 1
! END_IF

IF HELP == 1
	IF FRAME_ELEVATION == 3 AND SECTION == 2
		GLOBAL_PICTURE frame_3_2.GIF
	ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 1
		! GLOBAL_PICTURE Blank.GIF
	ELSE_IF FRAME_ELEVATION == 3 AND SECTION == 0
		! GLOBAL_PICTURE Blank.GIF
	END_IF
END_IF

SHOW_PARAM STRING ITEM_NUM
SHOW_PARAM DOUBLE STOPP
SHOW_PARAM DOUBLE RABBET
SHOW_PARAM DOUBLE XRABBET
SHOW_PARAM DOUBLE RETURN
SHOW_PARAM DOUBLE XRETURN
SHOW_PARAM DOUBLE XFACEE
SHOW_PARAM DOUBLE XHEAD
SHOW_PARAM DOUBLE HEAD_STOPP
SHOW_PARAM STRING HEAD_GRAIN
SHOW_PARAM DOUBLE JD
SHOW_PARAM DOUBLE SOFFIT
SHOW_PARAM DOUBLE THROAT
SHOW_PARAM DOUBLE ACTIVE_LEAF
SHOW_PARAM DOUBLE TRANSOM_PANEL

IF OPENING_TYPE == 4
	FRAME_ELEVATION = 4
ELSE
	USER_INPUT_PARAM INTEGER FRAME_ELEVATION REQUIRED
END_IF

USER_INPUT_PARAM INTEGER SECTION REQUIRED
USER_INPUT_PARAM DOUBLE JD REQUIRED
USER_INPUT_PARAM INTEGER FRAME_GAUGE REQUIRED
USER_INPUT_PARAM STRING  FRAME_GRADE
USER_INPUT_PARAM STRING  FRAME_FINISH

IF SECTION == 1 OR SECTION == 2 OR SECTION == 21
	USER_INPUT_PARAM DOUBLE STOPP DECIMAL_PLACES 4
ELSE
	STOPP = 0
END_IF

IF SECTION == 1 OR SECTION == 2 OR SECTION == 21
	USER_INPUT_PARAM DOUBLE RABBET DECIMAL_PLACES 4
ELSE
	RABBET = (JD-2)/2
END_IF

IF SECTION == 2 OR SECTION == 21
	USER_INPUT_PARAM DOUBLE XRABBET DECIMAL_PLACES 4
ELSE
	XRABBET = RABBET
END_IF

USER_INPUT_PARAM DOUBLE RETURN DECIMAL_PLACES 4
USER_INPUT_PARAM DOUBLE XRETURN DECIMAL_PLACES 4
USER_INPUT_PARAM DOUBLE FACEE DECIMAL_PLACES 4
USER_INPUT_PARAM DOUBLE XFACEE DECIMAL_PLACES 4
USER_INPUT_PARAM DOUBLE HEAD DECIMAL_PLACES 4
USER_INPUT_PARAM DOUBLE XHEAD DECIMAL_PLACES 4

IF SECTION == 1 OR SECTION == 2 OR SECTION == 21
	USER_INPUT_PARAM DOUBLE HEAD_STOPP DECIMAL_PLACES 4
ELSE
	HEAD_STOPP = 0
END_IF	

IF HOSPITAL_STOPS == 1
	USER_INPUT_PARAM DOUBLE HOSPITAL_STOPS_HEIGHT DECIMAL_PLACES 4
	USER_INPUT_PARAM DOUBLE HOSPITAL_STOPS_ANGLE DECIMAL_PLACES 4
END_IF

IF FRAME_ELEVATION == 4 OR FRAME_ELEVATION > 30
	USER_INPUT_PARAM	INTEGER		SIDE_LITE_QTY
	USER_INPUT_PARAM	DOUBLE		SILL DECIMAL_PLACES 4
	USER_INPUT_PARAM	DOUBLE		XSILL DECIMAL_PLACES 4
	USER_INPUT_PARAM	DOUBLE		SILL_STOPP DECIMAL_PLACES 4
	USER_INPUT_PARAM	DOUBLE		SIDE_LITE_JOW DECIMAL_PLACES 4
	USER_INPUT_PARAM	DOUBLE		SIDE_LITE_MULLION DECIMAL_PLACES 4
	USER_INPUT_PARAM	DOUBLE		SIDE_LITE_GLASS_THICKNESS DECIMAL_PLACES 4
END_IF

IF SUB_TYPE == "P" AND OPENING_TYPE <> 4
	USER_INPUT_PARAM DOUBLE ACTIVE_LEAF 99
END_IF

RADIOBUTTON_PARAM INTEGER CONSTRUCTION_  "FACE WELD" "FULLY WELDED" "KNOCK DOWN"
RADIOBUTTON_PARAM INTEGER DW_RTRN_ NO IN OUT
RADIOBUTTON_PARAM INTEGER XDW_RTRN_ NO IN OUT
RADIOBUTTON_PARAM INTEGER HEAD_GRAIN_ "HORIZONTAL" "VERTICAL"

IF SECTION == 1 OR SECTION == 2 OR SECTION == 21
	CHECKBOX_PARAM INTEGER SILENCERS "YES/NO"
	CHECKBOX_PARAM INTEGER HOSPITAL_STOPS "YES/NO"
END_IF

CHECKBOX_PARAM INTEGER CUSTOM_ANCHORS "YES/NO"
CHECKBOX_PARAM INTEGER FULL_HEAD_REINFORCEMENT "YES/NO"
IF HINGE_TYPE == "CONTINUOUS"
	CHECKBOX_PARAM INTEGER CONTINUOUS_HINGE_REINFORCEMENT "(YES/NO)"
END_IF
! CHECKBOX_PARAM INTEGER TRANSOM_PANEL_ "YES/NO"

CHECKBOX_PARAM INTEGER CLOSED_BACK "YES/NO"

IF FRAME_ELEVATION > 30	
	RADIOBUTTON_PARAM INTEGER	SIDE_LITE_SIDE "NONE" "LEFT" "RIGHT" "BOTH"
	RADIOBUTTON_PARAM INTEGER	SIDE_LITE_STOPS "INSIDE (UNSECURE - STD)" "OUTSIDE (SECURE)"
END_IF


IF OPENING_TYPE == 4
	USER_INPUT_PARAM	DOUBLE	GLASS_THICKNESS REQUIRED
	USER_INPUT_PARAM	DOUBLE	GLASS_STOP_WIDTH REQUIRED
	USER_INPUT_PARAM	DOUBLE	MAX_GLAZING_HOLE_SPACE
	
	
	IF GLASS_SUPPLIER_ == 1 AND GLASS_TYPE_ == 4
		USER_INPUT_PARAM	STRING	GLASS_TYPE
	END_IF
	
	CHECKBOX_PARAM INTEGER GLASS_SUPPLIER_ "OTHERS" "SDI"
	CHECKBOX_PARAM INTEGER GLASS_INSTALLER_ "OTHERS" "SDI"
	IF GLASS_SUPPLIER_ == 1
		RADIOBUTTON_PARAM INTEGER	GLASS_TYPE_ "CLEAR" "WIRED" "INSULATED" "LEXAN" "OTHER"
	END_IF
		RADIOBUTTON_PARAM INTEGER	BORROWED_LITE_TRIM_TYPE "DOUBLE GLAZED" "B"		
		
	IF GLASS_SUPPLIER_ == 0
		GLASS_SUPPLIER = "OTHERS"
		GLASS_TYPE = ""
	ELSE_IF GLASS_SUPPLIER_ == 1
		GLASS_SUPPLIER = "SDI"
		IF GLASS_TYPE_ == 0
			GLASS_TYPE = "CLEAR TEMPERED GLASS"
		ELSE_IF GLASS_TYPE_ == 1
			GLASS_TYPE = "WIRED GLASS"
		ELSE_IF GLASS_TYPE_ == 2
			GLASS_TYPE = "INSULATED GLASS"
		ELSE_IF GLASS_TYPE_ == 3
			GLASS_TYPE = "CLEAR LEXAN"
		END_IF
	END_IF

	IF GLASS_INSTALLER_ == 0
		GLASS_INSTALLER = "OTHERS"
	ELSE_IF GLASS_INSTALLER_ == 1
		GLASS_INSTALLER = "SDI"
	END_IF
END_IF


IF CONSTRUCTION_ == 0
	FRAME_CONSTRUCTION = "FACE WELDED" 
ELSE_IF CONSTRUCTION_ == 1
	FRAME_CONSTRUCTION = "FULLY WELDED"
ELSE_IF CONSTRUCTION_ == 2
	FRAME_CONSTRUCTION = "KNOCK DOWN"
END_IF

IF DW_RTRN_ == 0
	DW_RTRN = "NO"
ELSE_IF DW_RTRN_ == 1
	DW_RTRN = "IN"
ELSE_IF DW_RTRN_ == 2
	DW_RTRN = "OUT"
END_IF

IF XDW_RTRN_ == 0
	XDW_RTRN = "NO"
ELSE_IF XDW_RTRN_ == 1
	XDW_RTRN = "IN"
ELSE_IF XDW_RTRN_ == 2
	XDW_RTRN = "OUT"
END_IF

IF HEAD_GRAIN_ == 0
	HEAD_GRAIN = "HORIZONTAL"
ELSE_IF HEAD_GRAIN_ == 1
	HEAD_GRAIN = "VERTICAL"
END_IF

TRANSOM_PANEL_ = 0
IF TRANSOM_PANEL_ == 0
	TRANSOM_PANEL = "NO"
	TRANSOM_PANEL_HEIGHT = 0
ELSE_IF TRANSOM_PANEL_ == 1
	TRANSOM_PANEL = "YES"
END_IF


THROAT = (JD-RETURN-XRETURN)

IF SECTION == 0
	SOFFIT = JD
ELSE_IF SECTION == 1
	SOFFIT = JD - RABBET
ELSE_IF SECTION == 2 OR SECTION == 21
	SOFFIT = JD - RABBET - XRABBET
END_IF 
	
END_GUI_DESCR

BEGIN_ASM_DESCR


DECLARE_VARIABLE	INTEGER	FRAME_ELEVATION
DECLARE_VARIABLE	DOUBLE	FACEE
DECLARE_VARIABLE	DOUBLE	HEAD
DECLARE_VARIABLE	DOUBLE	MINIMUM_SOFFIT
DECLARE_VARIABLE 	STRING 	ITEM_NUM
DECLARE_VARIABLE	INTEGER	SECTION
DECLARE_VARIABLE	INTEGER	OPENING_TYPE
DECLARE_VARIABLE	DOUBLE	STOPP
DECLARE_VARIABLE	DOUBLE	RABBET
DECLARE_VARIABLE	DOUBLE	XRABBET
DECLARE_VARIABLE	DOUBLE	RETURN
DECLARE_VARIABLE	DOUBLE	XRETURN
DECLARE_VARIABLE	DOUBLE	DW_RTRN
DECLARE_VARIABLE	DOUBLE	XDW_RTRN	
DECLARE_VARIABLE	DOUBLE	XFACEE
DECLARE_VARIABLE	DOUBLE	XHEAD
DECLARE_VARIABLE	DOUBLE	HEAD_STOPP	
DECLARE_VARIABLE 	STRING 	HEAD_GRAIN	
DECLARE_VARIABLE 	STRING 	HINGE_TYPE
DECLARE_VARIABLE	DOUBLE	JD
DECLARE_VARIABLE	DOUBLE	THROAT
DECLARE_VARIABLE	DOUBLE	SOFFIT
DECLARE_VARIABLE 	INTEGER HOSPITAL_STOPS
DECLARE_VARIABLE	INTEGER	FRAME_GAUGE
DECLARE_VARIABLE 	STRING 	FRAME_GRADE
DECLARE_VARIABLE 	STRING 	FRAME_FINISH
DECLARE_VARIABLE 	INTEGER	SILENCERS
DECLARE_VARIABLE 	STRING 	FRAME_CONSTRUCTION
DECLARE_VARIABLE 	STRING 	TRANSOM_PANEL
DECLARE_VARIABLE 	DOUBLE	TRANSOM_PANEL_HEIGHT
DECLARE_VARIABLE 	STRING	SUB_TYPE
DECLARE_VARIABLE 	STRING	HAND
DECLARE_VARIABLE	DOUBLE	HOSPITAL_STOPS_HEIGHT
DECLARE_VARIABLE	DOUBLE	HOSPITAL_STOPS_ANGLE
DECLARE_VARIABLE	INTEGER	CUSTOM_ANCHORS
DECLARE_VARIABLE	DOUBLE	SILL
DECLARE_VARIABLE	DOUBLE	XSILL
DECLARE_VARIABLE	DOUBLE	SILL_STOPP
DECLARE_VARIABLE	DOUBLE	SIDE_LITE_JOW
DECLARE_VARIABLE	DOUBLE	SIDE_LITE_GLASS_THICKNESS
DECLARE_VARIABLE	DOUBLE	SIDE_LITE_MULLION
DECLARE_VARIABLE	INTEGER	SIDE_LITE_QTY
DECLARE_VARIABLE	INTEGER	SIDE_LITE_SIDE
DECLARE_VARIABLE	INTEGER	SIDE_LITE_STOPS

DECLARE_VARIABLE INTEGER DW_RTRN_
DECLARE_VARIABLE INTEGER XDW_RTRN_
DECLARE_VARIABLE INTEGER CONSTRUCTION_
DECLARE_VARIABLE INTEGER TRANSOM_PANEL_
DECLARE_VARIABLE INTEGER HEAD_GRAIN_
DECLARE_VARIABLE INTEGER FULL_HEAD_REINFORCEMENT
DECLARE_VARIABLE INTEGER CONTINUOUS_HINGE_REINFORCEMENT
DECLARE_VARIABLE INTEGER CLOSED_BACK

DECLARE_VARIABLE	STRING	GLASS_SUPPLIER
DECLARE_VARIABLE	STRING	GLASS_INSTALLER
DECLARE_VARIABLE	DOUBLE	GLASS_THICKNESS
DECLARE_VARIABLE	DOUBLE	GLASS_STOP_WIDTH
DECLARE_VARIABLE	STRING	GLASS_TYPE
DECLARE_VARIABLE	DOUBLE	MAX_GLAZING_HOLE_SPACE
DECLARE_VARIABLE	INTEGER	BORROWED_LITE_TRIM_TYPE

DECLARE_VARIABLE 	INTEGER GLASS_SUPPLIER_
DECLARE_VARIABLE 	INTEGER GLASS_INSTALLER_
DECLARE_VARIABLE	INTEGER	GLASS_TYPE_
DECLARE_VARIABLE	INTEGER	INSTALATION_

! IF SECTION == 1
	! XFACEE = FACEE + STOPP
	! XHEAD = HEAD + HEAD_STOPP
! END_IF

!PROCESS FRAME INFORMATION

	IF XFACEE == "" OR XFACE == 0
		XFACEE = FACEE
	END_IF
	IF XHEAD == "" OR HEAD == 0
		XHEAD = HEAD
	END_IF
	IF HEAD_STOPP == "" OR HEAD_STOPP == 0
		HEAD_STOPP = STOPP
	END_IF

	! IF (SECTION == 2  OR SECTION == 21)AND SOFFIT < MINIMUM_SOFFIT
			! MESSAGE_BOX "PLEASE ADJUST THE XRABBET BEFORE PROCEEDING"
	! END_IF

	! !BEGIN VERIFY FRAME STANDARDS

	! WHILE (SECTION == 2 OR SECTION == 21) AND SOFFIT < MINIMUM_SOFFIT
		! MESSAGE_BOX "THERE IS A PROBLEM WITH THE CONFIGURATION"
		! PRINT "PLEASE VERIFY THE AND RE-ENTER THE SECTION #"
		! USER_INPUT_PARAM INTEGER SECTION
		! PRINT "PLEASE VERIFY THE AND RE-ENTER THE XRABBET"
		! USER_INPUT_PARAM DOUBLE XRABBET
		! PRINT "PLEASE VERIFY THE AND RE-ENTER THE MINIMUM SOFFIT SIZE"
		! USER_INPUT_PARAM DOUBLE MINIMUM_SOFFIT		
	! END_WHILE	


	! IF SECTION == 2 OR SECTION == 21
		! IF JD-RABBET-XRABBET<MINIMUM_SOFFIT
			! PRINT "MINIMUM SOFIT %" MINIMUM_SOFFIT
			! PRINT "SOFIT %" SOFFIT
			! DECLARE_ARRAY arrayButtons
			! ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			! ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			! ADD_ARRAY_ELEM arrayButtons "ADJUST XRABBET"
			! ADD_ARRAY_ELEM arrayButtons "MAKE SINGLE RABBET"
			! ADD_ARRAY_ELEM arrayButtons "EXIT"
		! MESSAGE_BOX_EX QUESTION "THE SOFFIT IS TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			! IF CHOICE == 0 OR CHOICE == 5
				! EXIT
			! END_IF
			! IF CHOICE == 2
				! JD = RABBET + XRABBET + MIINIMUM_SOFFIT
			! END_IF
			! IF CHOICE == 3
				! XRABBET = JD-MINIMUM_SOFFIT
			! END_IF
			! IF CHOICE == 4
				! SECTION = 1
			! END_IF
		! END_IF
	! END_IF
!END VERIFY FRAME STANDARDS

	IF DW_RTRN == "NO"
		DW_RTRN_ = 0
	ELSE_IF DW_RTRN == "IN" 
		DW_RTRN_ = 1
	ELSE_IF DW_RTRN == "OUT"
		DW_RTRN_ = 2
	END_IF

	IF XDW_RTRN == "NO"
		XDW_RTRN_ = 0
	ELSE_IF XDW_RTRN == "IN"
		XDW_RTRN_ = 1
	ELSE_IF XDW_RTRN == "OUT"
		XDW_RTRN_ = 2
	END_IF

	IF FRAME_CONSTRUCTION == "FACE WELDED" 
		CONSTRUCTION_ = 0
	ELSE_IF FRAME_CONSTRUCTION == "FULLY WELDED"
		CONSTRUCTION_ = 1
	ELSE_IF FRAME_CONSTRUCTION == "KNOCK DOWN"
		CONSTRUCTION_ = 2
	END_IF
	
	IF HEAD_GRAIN == "HORIZONTAL"
		HEAD_GRAIN_ = 0
	ELSE_IF HEAD_GRAIN == "VERTICAL"
		HEAD_GRAIN_ = 1
	END_IF
	
	IF SEILENCES == "NO" 
		SILENCERS_ = 0
	ELSE_IF SOLENCERS == "YES"
		SILENCERS_ = 1
	END_IF	
	
	IF TRANSOM_PANEL == "NO"
		TRANSOM_PANEL_ = 0
	ELSE_IF TRANSOM_PANEL == "YES"
		TRANSOM_PANEL_ = 1
	END_IF
	
	IF FRAME_ELEVATION == "" OR FRAME_ELEVATION == 0
		FRAME_ELEVATION = 3
		! SECTION = 2
		SILL_STOPP = STOPP
	END_IF
	
	CONFIG_ELEM		1200	1200

	IF SECTION > 0 AND FRAME_GAUGE == 12 AND STOPP < .75
	  MESSAGE_BOX "12 GAUGE STOPS ARE < 3/4"
		PRINT "DO YOU WANT TO CHANGE THE STOPS? Y/N"
		USER_INPUT_PARAM STRING CHANGE
		IF CHANGE == "Y"
			CONFIG_ELEM		1200	1200
		END_IF
	END_IF
	
	IF SECTION > 0 AND FRAME_GAUGE == 12 AND RETURN < .625
	  MESSAGE_BOX "12 GAUGE RETURNS ARE < 5/8"
		PRINT "DO YOU WANT TO CHANGE THE RETURNS? Y/N"
		USER_INPUT_PARAM STRING CHANGE
		IF CHANGE == "Y"
			CONFIG_ELEM		1200	1200
		END_IF
	END_IF
	
!PROCESS FRAME INFORMATION

	IF (SECTION == 2 OR SECTION == 21) AND SOFFIT < MINIMUM_SOFFIT
		PRINT "MINIMUM SOFIT %" MINIMUM_SOFFIT
		PRINT "SOFIT %" SOFFIT
		MESSAGE_BOX "PLEASE ADJUST THE XRABBET BEFORE PROCEEDING"
	END_IF

	!BEGIN VERIFY FRAME STANDARDS

	WHILE (SECTION == 2 OR SECTION == 21) AND SOFFIT < MINIMUM_SOFFIT
		MESSAGE_BOX "THERE IS A PROBLEM WITH THE CONFIGURATION"
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE SECTION #"
		USER_INPUT_PARAM INTEGER SECTION
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE XRABBET"
		USER_INPUT_PARAM DOUBLE XRABBET
		PRINT "PLEASE VERIFY THE AND RE-ENTER THE MINIMUM SOFFIT SIZE"
		USER_INPUT_PARAM DOUBLE MINIMUM_SOFFIT		
	END_WHILE	

	IF FR_GAUGE == 12
		IF RETURN < .625 OR XRETURN < .625 OR STOPP < .75 OR HEAD_STOPP < .75
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST THROAT"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
	  MESSAGE_BOX_EX QUESTION "12 GAUGE RETURNS OR STOPS ARE TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 4
				EXIT
			END_IF
			IF CHOICE == 2 OR CHOICE == 3
				IF RETURN < .625
					RETURN = .625
				END_IF
				IF XRETURN < .625
					XRETURN = .625
				END_IF
				IF STOPP < .75
					STOPP = .75
				END_IF
				IF HEAD_STOPP < .75
					HEAD_STOPP = .75
				END_IF
				IF CHOICE == 2
					JD = THROAT+RETURN+XRETURN
				END_IF
				IF CHOICE == 3
					THROAT = JD-RETURN-XRETURN
				END_IF
			END_IF
		END_IF
	END_IF

	IF SECTION == 2 OR SECTION == 21
		IF JD-RABBET-XRABBET<MINIMUM_SOFFIT
			PRINT "MINIMUM SOFIT %" MINIMUM_SOFFIT
			PRINT "SOFIT %" SOFFIT
			DECLARE_ARRAY arrayButtons
			ADD_ARRAY_ELEM arrayButtons "CONTIUNE"
			ADD_ARRAY_ELEM arrayButtons "ADJUST JD"
			ADD_ARRAY_ELEM arrayButtons "ADJUST XRABBET"
			ADD_ARRAY_ELEM arrayButtons "MAKE SINGLE RABBET"
			ADD_ARRAY_ELEM arrayButtons "EXIT"
		MESSAGE_BOX_EX QUESTION "THE SOFFIT IS TOO SMALL" "WHAT DO YOU WANT TO DO?" arrayButtons CHOICE
			IF CHOICE == 0 OR CHOICE == 5
				EXIT
			END_IF
			IF CHOICE == 2
				JD = RABBET + XRABBET + MIINIMUM_SOFFIT
			END_IF
			IF CHOICE == 3
				XRABBET = JD-MINIMUM_SOFFIT
			END_IF
			IF CHOICE == 4
				SECTION = 1
			END_IF
		END_IF
	END_IF
	
	IF FRAME_ELEVATION > 30 AND FRAME_ELEVATION < 40
		SIDE_LITE_QTY = FRAME_ELEVATION - 30
	ELSE_IF FRAME_ELEVATION > 40 AND FRAME_ELEVATION < 50
		SIDE_LITE_QTY = FRAME_ELEVATION - 30
	END_IF
!END VERIFY FRAME STANDARDS	
	
END_ASM_DESCR

